- en: Mining Input Grammars
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 矿输入语法
- en: 原文：[http://www.fuzzingbook.org/html/GrammarMiner.html](http://www.fuzzingbook.org/html/GrammarMiner.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[http://www.fuzzingbook.org/html/GrammarMiner.html](http://www.fuzzingbook.org/html/GrammarMiner.html)
- en: So far, the grammars we have seen have been mostly specified manually – that
    is, you (or the person knowing the input format) had to design and write a grammar
    in the first place. While the grammars we have seen so far have been rather simple,
    creating a grammar for complex inputs can involve quite some effort. In this chapter,
    we therefore introduce techniques that *automatically mine grammars from programs*
    – by executing the programs and observing how they process which parts of the
    input. In conjunction with a grammar fuzzer, this allows us to
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们看到的语法大多是手动指定的——也就是说，您（或了解输入格式的人）最初必须设计和编写一个语法。虽然我们迄今为止看到的语法相对简单，但为复杂输入创建语法可能需要相当多的努力。因此，在本章中，我们介绍了从程序中*自动挖掘语法*的技术——通过执行程序并观察它们如何处理输入的哪些部分。结合语法模糊器，这使我们能够
- en: take a program,
  id: totrans-3
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取一个程序，
- en: extract its input grammar, and
  id: totrans-4
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提取其输入语法，并且
- en: fuzz it with high efficiency and effectiveness, using the concepts in this book.
  id: totrans-5
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用本书中的概念以高效率和效果进行模糊测试，
- en: '[PRE0]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Prerequisites**'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '**先决条件**'
- en: You should have read the [chapter on grammars](Grammars.html).
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您应该已经阅读了[语法章节](Grammars.html)。
- en: The [chapter on configuration fuzzing](ConfigurationFuzzer.html) introduces
    grammar mining for configuration options, as well as observing variables and values
    during execution.
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置模糊化章节](ConfigurationFuzzer.html)介绍了配置选项的语法挖掘，以及执行过程中的变量和值观察。'
- en: We use the tracer from the [chapter on coverage](Coverage.html).
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们使用[覆盖率章节](Coverage.html)中的跟踪器。
- en: The concept of parsing from the [chapter on parsers](Parser.html) is also useful.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从[解析器章节](Parser.html)中关于解析的概念也是很有用的。
- en: Synopsis
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 概述
- en: To [use the code provided in this chapter](Importing.html), write
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用本章节提供的代码（[导入](Importing.html)），请编写
- en: '[PRE1]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: and then make use of the following features.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 然后利用以下功能。
- en: This chapter provides a number of classes to mine input grammars from existing
    programs. The function `recover_grammar()` could be the easiest to use. It takes
    a function and a set of inputs, and returns a grammar that describes its input
    language.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 本章提供了一些类，可以从现有程序中挖掘输入语法。函数`recover_grammar()`可能是最容易使用的。它接受一个函数和一组输入，并返回一个描述其输入语言的语法。
- en: 'We apply `recover_grammar()` on a `url_parse()` function that takes and decomposes
    URLs:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在`url_parse()`函数上应用`recover_grammar()`，该函数接收并分解URL：
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We extract the input grammar for `url_parse()` using `recover_grammar()`:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用`recover_grammar()`从`url_parse()`中提取输入语法：
- en: '[PRE3]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The names of nonterminals are a bit technical; but the grammar nicely represents
    the structure of the input; for instance, the different schemes (`"http"`, `"https"`)
    are all identified:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 非终结符的名称有点技术性；但语法很好地代表了输入的结构；例如，不同的方案（`"http"`，`"https"`）都被识别出来：
- en: '[PRE4]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
- en: '[PRE5]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 560.0 62" width="560.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="405.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 560.0 62" width="560.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="405.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
- en: '[PRE6]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 182.5 92" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">https</text></g></g></g></g></svg>
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 182.5 92" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">https</text></g></g></g></g></svg>
- en: '[PRE7]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="142.25" y="35">//</text></g>
    <g class="non-terminal"><text x="271.5" y="35">urlparse@396:netloc</text></g>
    <g class="terminal"><text x="396.5" y="35">/</text></g></g> <g><g class="terminal"><text
    x="78.5" y="65">//</text></g> <g class="non-terminal"><text x="207.75" y="65">urlparse@396:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="65">urlsplit@494:url</text></g></g></g></g></svg>
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="142.25" y="35">//</text></g>
    <g class="non-terminal"><text x="271.5" y="35">urlparse@396:netloc</text></g>
    <g class="terminal"><text x="396.5" y="35">/</text></g></g> <g><g class="terminal"><text
    x="78.5" y="65">//</text></g> <g class="non-terminal"><text x="207.75" y="65">urlparse@396:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="65">urlsplit@494:url</text></g></g></g></g></svg>
- en: '[PRE8]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 369.5 122" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 369.5 122" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE9]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 543.0 92" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="35">#</text></g> <g class="non-terminal"><text
    x="383.75" y="35">urlparse@396:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="65">/#</text></g> <g class="non-terminal"><text x="300.0" y="65">urlparse@396:fragment</text></g></g></g></g></svg>
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 543.0 92" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="35">#</text></g> <g class="non-terminal"><text
    x="383.75" y="35">urlparse@396:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="65">/#</text></g> <g class="non-terminal"><text x="300.0" y="65">urlparse@396:fragment</text></g></g></g></g></svg>
- en: '[PRE10]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
- en: '[PRE11]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE12]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: The grammar can be immediately used for fuzzing, producing arbitrary combinations
    of input elements, which are all syntactically valid.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 该语法可以立即用于模糊测试，生成任意组合的输入元素，这些元素都是语法上有效的。
- en: '[PRE13]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Being able to automatically extract a grammar and to use this grammar for fuzzing
    makes for very effective test generation with a minimum of manual work.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 能够自动提取语法并使用该语法进行模糊测试，可以以最少的手动工作生成非常有效的测试。
- en: A Grammar Challenge
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 语法挑战
- en: 'Consider the `process_inventory()` method from the [chapter on parsers](Parser.html):'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑[解析器章节](Parser.html)中的`process_inventory()`方法：
- en: '[PRE14]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: It takes inputs of the following form.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 它接受以下形式的输入。
- en: '[PRE17]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We found from the [chapter on parsers](Parser.html) that coarse grammars do
    not work well for fuzzing when the input format includes details expressed only
    in code. That is, even though we have the formal specification of CSV files ([RFC
    4180](https://tools.ietf.org/html/rfc4180)), the inventory system includes further
    rules as to what is expected at each index of the CSV file. The solution of simply
    recombining existing inputs, while practical, is incomplete. In particular, it
    relies on a formal input specification being available in the first place. However,
    we have no assurance that the program obeys the input specification given.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 从[解析器章节](Parser.html)中我们发现，当输入格式包括仅在代码中表达的具体细节时，粗略的语法在模糊测试中效果不佳。也就是说，尽管我们有CSV文件的正式规范([RFC
    4180](https://tools.ietf.org/html/rfc4180))，库存系统还包括针对CSV文件每个索引处期望内容的进一步规则。简单地重新组合现有输入虽然实用，但并不完整。特别是，它依赖于最初就存在正式的输入规范。然而，我们无法保证程序遵守所提供的输入规范。
- en: One of the ways out of this predicament is to interrogate the program under
    test as to what its input specification is. That is, if the program under test
    is written in a style such that specific methods are responsible for handling
    specific parts of the input, one can recover the parse tree by observing the process
    of parsing. Further, one can recover a reasonable approximation of the grammar
    by abstraction from multiple input trees.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这一困境的一种方法是对正在测试的程序进行询问，以了解其输入规范是什么。也就是说，如果正在测试的程序是以特定方法负责处理输入特定部分的方式编写的，那么可以通过观察解析过程来恢复解析树。此外，可以通过从多个输入树中抽象出合理的语法近似。
- en: '*We start with the assumption (1) that the program is written in such a fashion
    that specific methods are responsible for parsing specific fragments of the program
    -- This includes almost all ad hoc parsers.*'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们首先假设（1）程序是以这样的方式编写的，即特定方法负责解析程序的特定片段--这几乎包括所有临时解析器*。'
- en: 'The idea is as follows:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 理念如下：
- en: Hook into the Python execution and observe the fragments of input string as
    they are produced and named in different methods.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将钩子连接到Python执行中，并观察输入字符串片段在不同方法中被产生和命名。
- en: Stitch the input fragments together in a tree structure to retrieve the **Parse
    Tree**.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将输入片段以树状结构拼接起来以检索**解析树**。
- en: Abstract common elements from multiple parse trees to produce the **Context
    Free Grammar** of the input.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从多个解析树中提取公共元素以生成输入的**上下文无关语法**。
- en: A Simple Grammar Miner
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简单语法挖掘器
- en: Say we want to obtain the input grammar for the function `process_vehicle()`.
    We first collect the sample inputs for this function.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要获取`process_vehicle()`函数的输入语法。我们首先收集这个函数的样本输入。
- en: '[PRE20]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The set of methods responsible for processing inventory are the following.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 负责处理库存的方法集合如下。
- en: '[PRE21]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: We have seen from the chapter on [configuration fuzzing](ConfigurationFuzzer.html)
    that one can hook into the Python runtime to observe the arguments to a function
    and any local variables created. We have also seen that one can obtain the context
    of execution by inspecting the `frame` argument. Here is a simple tracer that
    can return the local variables and other contextual information in a traced function.
    We reuse the `Coverage` tracing class.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从[配置模糊测试](ConfigurationFuzzer.html)章节中看到，可以连接到Python运行时来观察函数的参数和创建的任何局部变量。我们还看到，可以通过检查`frame`参数来获得执行上下文。这里有一个简单的跟踪器，可以返回跟踪函数中的局部变量和其他上下文信息。我们重用了`Coverage`跟踪类。
- en: Tracer
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 跟踪器
- en: '[PRE22]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: We run the code under trace context.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在跟踪上下文中运行代码。
- en: '[PRE25]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: The main thing that we want out of tracing is a list of assignments of input
    fragments to different variables. We can use the tracing facility `settrace()`
    to get that as we showed above.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从跟踪中想要得到的主要是输入片段分配给不同变量的列表。我们可以使用跟踪设施`settrace()`来获取，就像上面所展示的那样。
- en: However, the `settrace()` function hooks into the Python debugging facility.
    When it is in operation, no debugger can hook into the program. That is, if there
    is a problem with our grammar miner, we will not be able to attach a debugger
    to it to understand what is happening. This is not ideal. Hence, we limit the
    tracer to the simplest implementation possible, and implement the core of grammar
    mining in later stages.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，`settrace()`函数连接到Python调试设施。当它在运行时，没有任何调试器可以连接到程序。也就是说，如果我们的语法挖掘器存在问题，我们将无法将其附加到调试器上来理解发生了什么。这并不理想。因此，我们将跟踪器限制在可能的最简单实现中，并在后续阶段实现语法挖掘的核心。
- en: The `traceit()` function relies on information from the `frame` variable which
    exposes Python internals. We define a `context` class that encapsulates the information
    that we need from the `frame`.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '`traceit()`函数依赖于`frame`变量提供的信息，该变量暴露了Python的内部信息。我们定义了一个`context`类，用于封装我们从`frame`中需要的信息。'
- en: Context
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 上下文
- en: The `Context` class provides easy access to the information such as the current
    module, and parameter names.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '`Context`类提供了对当前模块和参数名称等信息轻松访问的接口。'
- en: '[PRE27]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Here we add a few convenience methods that operate on the `frame` to `Context`.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们添加了一些方便的方法，这些方法在`frame`上操作以转换为`Context`。
- en: '[PRE28]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: We hook printing the context to our `traceit()` to see it in action. First we
    define a `log_event()` for displaying events.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将打印上下文挂钩到`traceit()`，以观察其作用。首先，我们定义一个`log_event()`来显示事件。
- en: '[PRE29]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: And use the `log_event()` in the `traceit()` function.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 并在`traceit()`函数中使用`log_event()`。
- en: '[PRE30]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Running `process_vehicle()` under trace prints the contexts encountered.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在跟踪模式下运行`process_vehicle()`会打印遇到的上下文。
- en: '[PRE31]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '[PRE32]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The trace produced by executing any function can get overwhelmingly large. Hence,
    we need to restrict our attention to specific modules. Further, we also restrict
    our attention exclusively to `str` variables since these variables are more likely
    to contain input fragments. (We will show how to deal with complex objects later
    in exercises.)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 执行任何函数产生的跟踪信息可能会非常大。因此，我们需要将注意力限制在特定的模块上。此外，我们还专门将注意力限制在`str`变量上，因为这些变量更有可能包含输入片段。（我们将在练习中展示如何处理复杂对象。）
- en: The `Context` class we developed earlier is used to decide which modules to
    monitor, and which variables to trace.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前开发的`Context`类用于决定要监控哪些模块以及要跟踪哪些变量。
- en: We store the current *input string* so that it can be used to determine if any
    particular string fragments came from the current input string. Any optional arguments
    are processed separately.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们存储当前的*输入字符串*，以便可以用来确定是否有任何特定的字符串片段来自当前输入字符串。任何可选参数都单独处理。
- en: '[PRE33]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: We use an optional argument `files` to indicate the specific source files we
    are interested in, and `methods` to indicate which specific methods are of interest.
    Further, we also use `log` to specify whether verbose logging should be enabled
    during trace. We use the `log_event()` method we defined earlier for logging.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用可选参数`files`来指示我们感兴趣的特定源文件，使用`methods`来指示感兴趣的特定方法。此外，我们还使用`log`来指定在跟踪期间是否启用详细日志记录。我们使用之前定义的`log_event()`方法进行日志记录。
- en: The options processing is as below.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 选项处理如下。
- en: '[PRE34]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: The `files` and `methods` are checked to determine, if a particular event should
    be traced or not
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 检查`files`和`methods`以确定特定事件是否应该被跟踪。
- en: '[PRE35]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Similar to the context of events, we also want to restrict our attention to
    specific variables. For now, we want to focus only on strings. (See the Exercises
    at the end of the chapter on how to extend it to other kinds of objects).
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 与事件上下文类似，我们还想将注意力限制在特定的变量上。目前，我们只想关注字符串。（请参阅本章末尾的练习，了解如何将其扩展到其他类型的对象。）
- en: '[PRE36]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: We modify the `traceit()` to call an `on_event()` function with the context
    information only on the specific events we are interested in.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们修改了`traceit()`，使其仅在特定事件上调用带有上下文信息的`on_event()`函数。
- en: '[PRE37]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: The `Tracer` class can now focus on specific kinds of events on specific files.
    Further, it provides a first level filter for variables that we find interesting.
    For example, we want to focus specifically on variables from `process_*` methods
    that contain input fragments. Here is how our updated `Tracer` can be used.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '`Tracer`类现在可以专注于特定文件上的特定类型的事件。此外，它为我们感兴趣的变量提供了一个一级过滤器。例如，我们只想关注包含输入片段的`process_*`方法中的变量。以下是我们的更新后的`Tracer`如何使用。'
- en: '[PRE38]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: The execution produced the following trace.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 执行产生了以下跟踪信息。
- en: '[PRE40]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Since we are saving the input already in `Tracer`, it is redundant to specify
    it separately again as an argument.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经在`Tracer`中保存了输入，因此再次将输入作为参数指定是多余的。
- en: '[PRE42]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '[PRE43]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: DefineTracker
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: DefineTracker
- en: We define a `DefineTracker` class that processes the trace from the `Tracer`.
    The idea is to store different variable definitions which are input fragments.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一个`DefineTracker`类，用于处理来自`Tracer`的跟踪信息。其思路是存储不同的变量定义，这些定义是输入片段。
- en: The tracker identifies string fragments that are part of the input string, and
    stores them in a dictionary `my_assignments`. It saves the trace, and the corresponding
    input for processing. Finally, it calls `process()` to process the `trace` it
    was given. We will start with a simple tracker that relies on certain assumptions,
    and later see how these assumptions can be relaxed.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 跟踪器识别出输入字符串中的字符串片段，并将它们存储在字典 `my_assignments` 中。它保存了跟踪记录，以及相应的输入以进行处理。最后，它调用
    `process()` 来处理它所接收的 `trace`。我们将从一个依赖于某些假设的简单跟踪器开始，稍后我们将看到这些假设如何被放宽。
- en: '[PRE44]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: One of the problems of using substring search is that short string sequences
    tend to be included in other string sequences even though they may not have come
    from the original string. That is, say the input fragment is `v`, it could have
    equally come from either `van` or `chevy`. We rely on being able to predict the
    exact place in the input where a given fragment occurred. Hence, we define a constant
    `FRAGMENT_LEN` such that we ignore strings up to that length. We also incorporate
    a logging facility as before.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 使用子串搜索的一个问题是，短字符串序列往往包含在其他字符串序列中，即使它们可能不是来自原始字符串。也就是说，如果输入片段是 `v`，它同样可能来自 `van`
    或 `chevy`。我们依赖于能够预测给定片段在输入中确切位置的能力。因此，我们定义了一个常量 `FRAGMENT_LEN`，这样我们忽略长度不超过该长度的字符串。我们同样也加入了日志记录功能。
- en: '[PRE45]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '[PRE46]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Our tracer simply records the variable values as they occur. We next need to
    check if the variables contain values from the **input string**. Common ways to
    do this is to rely on symbolic execution or at least dynamic tainting, which are
    powerful, but also complex. However, one can obtain a reasonable approximation
    by simply relying on substring search. That is, we consider any value produced
    that is a substring of the original input string to have come from the original
    input.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的跟踪器简单地记录变量值，正如它们出现时。接下来，我们需要检查变量是否包含来自 **输入字符串** 的值。常见的做法是依赖于符号执行或至少动态污染，这些方法强大但复杂。然而，通过简单地依赖子串搜索可以获得一个合理的近似。也就是说，我们考虑任何产生的子串，如果它是原始输入字符串的子串，我们就认为它来自原始输入。
- en: We define an `is_input_fragment()` method that relies on string inclusion to
    detect if the string came from the input.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一个 `is_input_fragment()` 方法，该方法依赖于字符串包含来检测字符串是否来自输入。
- en: '[PRE47]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: We can use `is_input_fragment()` to select only a subset of variables defined,
    as implemented below in `fragments()`.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 `is_input_fragment()` 来选择仅定义的变量子集，如下所示在 `fragments()` 中实现。
- en: '[PRE48]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: The tracker processes each event, and at each event, it updates the dictionary
    `my_assignments` with the current local variables that contain strings that are
    part of the input. Note that there is a choice here with respect to what happens
    during reassignment. We can either discard all the reassignments, or keep only
    the last assignment. Here, we choose the latter. If you want the former behavior,
    check whether the value exists in `my_assignments` before storing a fragment.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 跟踪器处理每个事件，并在每个事件中，它将包含输入字符串部分的当前局部变量更新到字典 `my_assignments` 中。请注意，这里有一个关于重新赋值期间发生什么的选择。我们可以丢弃所有重新赋值，或者只保留最后的赋值。在这里，我们选择后者。如果您想要前者行为，在存储片段之前检查值是否存在于
    `my_assignments` 中。
- en: '[PRE49]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Using the tracker, we can obtain the input fragments. For example, say we are
    only interested in strings that are at least `5` characters long.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用跟踪器，我们可以获取输入片段。例如，假设我们只对至少 `5` 个字符长的字符串感兴趣。
- en: '[PRE50]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '[PRE51]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Or strings that are `2` characters long (the default).
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 或者长度为 `2` 个字符的字符串（默认）。
- en: '[PRE52]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '[PRE54]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Assembling a Derivation Tree
  id: totrans-130
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 组装推导树
- en: '[PRE55]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '[PRE56]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'The input fragments from the `DefineTracker` only tell half the story. The
    fragments may be created at different stages of parsing. Hence, we need to assemble
    the fragments to a derivation tree of the input. The basic idea is as follows:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 来自 `DefineTracker` 的输入片段只讲述了故事的一半。片段可能在解析的不同阶段被创建。因此，我们需要将片段组装成输入的推导树。基本思路如下：
- en: 'Our input from the previous step was:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我们上一步的输入是：
- en: '[PRE57]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: We start a derivation tree, and associate it with the start symbol in the grammar.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们开始一个推导树，并将其与文法中的起始符号关联。
- en: '[PRE58]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '[PRE59]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: <svg width="120pt" height="73pt" viewBox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif"
    font-size="14.00">1997,van,Ford,E350</text></g> <g id="edge1" class="edge"><title>0->1</title></g></g></svg>
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="120pt" height="73pt" viewBox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif"
    font-size="14.00">1997,van,Ford,E350</text></g> <g id="edge1" class="edge"><title>0->1</title></g></g></svg>
- en: 'The next input was:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个输入是：
- en: '[PRE60]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: Since vehicle covers the `<start>` node's value completely, we replace the value
    with the vehicle node.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 由于车辆节点完全覆盖了 `<start>` 节点的值，我们用车辆节点替换了该值。
- en: '[PRE61]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '[PRE62]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: <svg width="120pt" height="123pt" viewBox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-101.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g></g></svg>
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="120pt" height="123pt" viewBox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-101.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g></g></svg>
- en: 'The next input was:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个输入是：
- en: '[PRE63]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: Traversing the derivation tree from `<start>`, we see that it replaces a portion
    of the `<vehicle>` node's value. Hence we split the `<vehicle>` node's value to
    two children, where one corresponds to the value `"1997"` and the other to `",van,Ford,E350"`,
    and replace the first one with the node `<year>`.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 从 `<start>` 遍历推导树，我们看到它替换了 `<vehicle>` 节点值的一部分。因此，我们将 `<vehicle>` 节点的值分割成两个子节点，其中一个对应于值
    `"1997"`，另一个对应于 `",van,Ford,E350"`，并将第一个替换为 `<year>` 节点。
- en: '[PRE64]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '[PRE65]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: <svg width="150pt" height="173pt" viewBox="0.00 0.00 150.25 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="59.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="59.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="99.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,Ford,E350</text></g>
    <g id="edge4" class="edge"><title>1->4</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g></g></svg>
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="150pt" height="173pt" viewBox="0.00 0.00 150.25 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="59.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="59.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="99.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,Ford,E350</text></g>
    <g id="edge4" class="edge"><title>1->4</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g></g></svg>
- en: We perform similar operations for
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我们对以下进行类似操作：
- en: '[PRE66]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: '[PRE67]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '[PRE68]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: <svg width="228pt" height="173pt" viewBox="0.00 0.00 228.00 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="102.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="102.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="70.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,</text></g>
    <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="135.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge5" class="edge"><title>1->5</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="203.88" y="-51.2" font-family="Times,serif" font-size="14.00">,E350</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="135.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g></g></svg>
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="228pt" height="173pt" viewBox="0.00 0.00 228.00 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="102.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="102.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="70.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,</text></g>
    <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="135.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge5" class="edge"><title>1->5</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="203.88" y="-51.2" font-family="Times,serif" font-size="14.00">,E350</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="135.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g></g></svg>
- en: Similarly for
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，对于
- en: '[PRE69]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: and
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: '[PRE70]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '[PRE71]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: '[PRE72]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
- en: We now develop the complete algorithm with the above described steps. The derivation
    tree `TreeMiner` is initialized with the input string, and the variable assignments,
    and it converts the assignments to the corresponding derivation tree.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在根据上述描述的步骤开发完整的算法。`TreeMiner` 初始化为输入字符串、变量分配，并将其转换为相应的推导树。
- en: '[PRE73]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: The `log_call()` is as follows.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '`log_call()` 如下。'
- en: '[PRE74]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'The basic idea is as follows:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 基本思想如下：
- en: '**For now, we assume that the value assigned to a variable is stable. That
    is, it is never reassigned. In particular, there are no recursive calls, or multiple
    calls to the same function from different parts.** (We will show how to overcome
    this limitation later).'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**目前，我们假设分配给变量的值是稳定的。也就是说，它不会被重新分配。特别是，没有递归调用，或者从不同部分对同一函数的多次调用。**（我们将在稍后展示如何克服这个限制）。'
- en: 'For each pair *var*, *value* found in `my_assignments`:'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于在 `my_assignments` 中找到的每个 *var*，*value* 对：
- en: We search for occurrences of *value* `val` in the derivation tree recursively.
  id: totrans-171
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们在推导树中递归地搜索 *value* `val` 的出现。
- en: If an occurrence was found as a value `V1` of a node `P1`, we partition the
    value of the node `P1` into three parts, with the central part matching the *value*
    `val`, and the first and last part, the corresponding prefix and suffix in `V1`.
  id: totrans-172
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果在节点 `P1` 的值 `V1` 中找到一个出现，我们将节点 `P1` 的值分成三部分，中间部分匹配 *value* `val`，第一部分和最后一部分是
    `V1` 中的对应的前缀和后缀。
- en: Reconstitute the node `P1` with three children, where prefix and suffix mentioned
    earlier are string values, and the matching value `val` is replaced by a node
    `var` with a single value `val`.
  id: totrans-173
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新构建具有三个子节点的节点 `P1`，其中前面提到的前缀和后缀是字符串值，匹配的值 `val` 被替换为一个具有单个值 `val` 的节点 `var`。
- en: First, we define a wrapper to generate a nonterminal from a variable name.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们定义一个包装器来从变量名生成一个非终结符。
- en: '[PRE75]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: The `string_part_of_value()` method checks whether the given `part` value was
    part of the whole.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '`string_part_of_value()` 方法检查给定的 `part` 值是否是整体的一部分。'
- en: '[PRE76]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: The `partition_by_part()` splits the `value` by the given part if it matches,
    and returns a list containing the first part, the part that was replaced, and
    the last part. This is a format that can be used as a part of the list of children.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '`partition_by_part()` 方法如果匹配，则按给定的部分分割 `value`，并返回一个包含第一个部分、被替换的部分和最后一个部分的列表。这是一个可以作为子列表一部分的格式。'
- en: '[PRE77]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: '[PRE78]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: The `insert_into_tree()` method accepts a given tree `tree` and a `(k,v)` pair.
    It recursively checks whether the given pair can be applied. If the pair can be
    applied, it applies the pair and returns `True`.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`insert_into_tree()` 方法接受一个给定的树 `tree` 和一个 `(k,v)` 对。它递归地检查给定的对是否可以应用。如果对可以应用，它应用该对并返回
    `True`。'
- en: '[PRE79]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: Here is how `insert_into_tree()` is used.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 `insert_into_tree()` 的用法。
- en: '[PRE80]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: First, we have our input string as the only node.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们的输入字符串作为唯一的节点。
- en: '[PRE81]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: <svg width="120pt" height="73pt" viewBox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif"
    font-size="14.00">1997,van,Ford,E350</text></g> <g id="edge1" class="edge"><title>0->1</title></g></g></svg>
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="120pt" height="73pt" viewBox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif"
    font-size="14.00">1997,van,Ford,E350</text></g> <g id="edge1" class="edge"><title>0->1</title></g></g></svg>
- en: Inserting the `<vehicle>` node.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 插入 `<vehicle>` 节点。
- en: '[PRE82]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: '[PRE83]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: '[PRE84]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: <svg width="120pt" height="123pt" viewBox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-101.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g></g></svg>
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="120pt" height="123pt" viewBox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="55.88"
    y="-101.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="55.88"
    y="-51.2" font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g></g></svg>
- en: Inserting `<model>` node.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 插入 `<model>` 节点。
- en: '[PRE85]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: '[PRE86]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: '[PRE87]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: <svg width="160pt" height="173pt" viewBox="0.00 0.00 160.12 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="83.62"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="83.62" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="41.62" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,Ford,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="126.62" y="-51.2" font-family="Times,serif" font-size="14.00"><model></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="126.62" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge4" class="edge"><title>3->4</title></g></g></svg>
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="160pt" height="173pt" viewBox="0.00 0.00 160.12 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="83.62"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="83.62" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="41.62" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,Ford,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="126.62" y="-51.2" font-family="Times,serif" font-size="14.00"><model></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="126.62" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge4" class="edge"><title>3->4</title></g></g></svg>
- en: Inserting `<company>`.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 插入 `<company>`。
- en: '[PRE88]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: '[PRE89]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: '[PRE90]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: <svg width="264pt" height="173pt" viewBox="0.00 0.00 263.50 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="138" y="-151.7"
    font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="138" y="-101.45" font-family="Times,serif" font-size="14.00"><vehicle></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="105" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="171" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>1->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="230" y="-51.2" font-family="Times,serif"
    font-size="14.00"><model></text></g> <g id="edge6" class="edge"><title>1->6</title></g>
    <g id="node5" class="node"><title>4</title> <text text-anchor="middle" x="105"
    y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g> <g id="edge4"
    class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="230" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g></g></svg>
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="264pt" height="173pt" viewBox="0.00 0.00 263.50 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="138" y="-151.7"
    font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="138" y="-101.45" font-family="Times,serif" font-size="14.00"><vehicle></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="105" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="171" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>1->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="230" y="-51.2" font-family="Times,serif"
    font-size="14.00"><model></text></g> <g id="edge6" class="edge"><title>1->6</title></g>
    <g id="node5" class="node"><title>4</title> <text text-anchor="middle" x="105"
    y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g> <g id="edge4"
    class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="230" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g></g></svg>
- en: Inserting `<kind>`.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 插入 `<kind>`。
- en: '[PRE91]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: '[PRE92]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: '[PRE93]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: <svg width="347pt" height="173pt" viewBox="0.00 0.00 346.88 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="155.38"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="155.38" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="15.38" y="-51.2" font-family="Times,serif" font-size="14.00">1997,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="69.38" y="-51.2" font-family="Times,serif" font-size="14.00"><kind></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="122.38" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>1->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="188.38" y="-51.2"
    font-family="Times,serif" font-size="14.00"><company></text></g> <g id="edge6"
    class="edge"><title>1->6</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="254.38" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge8" class="edge"><title>1->8</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="313.38" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge9" class="edge"><title>1->9</title></g>
    <g id="node5" class="node"><title>4</title> <text text-anchor="middle" x="69.38"
    y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g> <g id="edge4"
    class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="313.38" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="347pt" height="173pt" viewBox="0.00 0.00 346.88 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="155.38"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="155.38" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="15.38" y="-51.2" font-family="Times,serif" font-size="14.00">1997,</text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="69.38" y="-51.2" font-family="Times,serif" font-size="14.00"><kind></text></g>
    <g id="edge3" class="edge"><title>1->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="122.38" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>1->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="188.38" y="-51.2"
    font-family="Times,serif" font-size="14.00"><company></text></g> <g id="edge6"
    class="edge"><title>1->6</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="254.38" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge8" class="edge"><title>1->8</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="313.38" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge9" class="edge"><title>1->9</title></g>
    <g id="node5" class="node"><title>4</title> <text text-anchor="middle" x="69.38"
    y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g> <g id="edge4"
    class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="313.38" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
- en: Inserting `<year>`.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 插入 `<year>`。
- en: '[PRE94]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: '[PRE95]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: '[PRE96]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
- en: To make life simple, we define a wrapper function `nt_var()` that will convert
    a token to its corresponding nonterminal symbol.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化生活，我们定义了一个包装函数 `nt_var()`，它将把一个标记转换为相应的非终结符符号。
- en: '[PRE97]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: Now, we need to apply a new definition to an entire grammar.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要将一个新的定义应用到整个语法中。
- en: '[PRE98]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: This algorithm is implemented as `get_derivation_tree()`.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 此算法实现为 `get_derivation_tree()`。
- en: '[PRE99]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'The `TreeMiner` is used as follows:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '`TreeMiner` 的用法如下：'
- en: '[PRE100]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: '[PRE101]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: '[PRE102]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: The obtained derivation tree is as below.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 获得的推导树如下。
- en: '[PRE103]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="403pt" height="173pt" viewBox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="178.88"
    y="-151.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="178.88" y="-101.45"
    font-family="Times,serif" font-size="14.00"><vehicle></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00"><year></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="125.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><kind></text></g> <g id="edge5" class="edge"><title>1->5</title></g>
    <g id="node8" class="node"><title>7</title> <text text-anchor="middle" x="178.88"
    y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text></g> <g id="edge7"
    class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00"><company></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>1->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="369.88" y="-51.2"
    font-family="Times,serif" font-size="14.00"><model></text></g> <g id="edge11"
    class="edge"><title>1->11</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g></g></svg>
- en: 'Combining all the pieces:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 结合所有片段：
- en: '[PRE104]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: '[PRE105]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: The corresponding derivation trees are below.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 对应的推导树如下。
- en: '[PRE106]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE106]'
- en: '[PRE107]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: Recovering Grammars from Derivation Trees
  id: totrans-232
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从推导树恢复语法
- en: We define a class `Miner` that can combine multiple derivation trees to produce
    the grammar. The initial grammar is empty.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一个名为 `Miner` 的类，它可以组合多个推导树以生成语法。初始语法为空。
- en: '[PRE108]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: The `tree_to_grammar()` method converts our derivation tree to a grammar by
    picking one node at a time, and adding it to the grammar. The node name becomes
    the key, and any list of children it has becomes another alternative for that
    key.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '`tree_to_grammar()` 方法通过一次选择一个节点，并将其添加到语法中，将我们的推导树转换为语法。节点名称成为键，它拥有的任何子列表都成为该键的另一个备选方案。'
- en: '[PRE109]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: '[PRE110]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: '[PRE111]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: The grammar being generated here is `canonical`. We define a function `readable()`
    that takes in a canonical grammar and returns it in a readable form.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 这里生成的语法是 `规范化的`。我们定义了一个函数 `readable()`，它接受一个规范化的语法，并以可读的形式返回它。
- en: '[PRE112]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE112]'
- en: '[PRE113]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE113]'
- en: '[PRE114]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE114]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">vehicle</text></g></g></g></g></svg>
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">vehicle</text></g></g></g></g></svg>
- en: '[PRE115]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE115]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 575.5 62" width="575.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="87.0" y="35">year</text></g>
    <g class="terminal"><text x="148.25" y="35">,</text></g> <g class="non-terminal"><text
    x="209.5" y="35">kind</text></g> <g class="terminal"><text x="270.75" y="35">,</text></g>
    <g class="non-terminal"><text x="344.75" y="35">company</text></g> <g class="terminal"><text
    x="418.75" y="35">,</text></g> <g class="non-terminal"><text x="484.25" y="35">model</text></g></g></g></g></svg>
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 575.5 62" width="575.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="87.0" y="35">year</text></g>
    <g class="terminal"><text x="148.25" y="35">,</text></g> <g class="non-terminal"><text
    x="209.5" y="35">kind</text></g> <g class="terminal"><text x="270.75" y="35">,</text></g>
    <g class="non-terminal"><text x="344.75" y="35">company</text></g> <g class="terminal"><text
    x="418.75" y="35">,</text></g> <g class="non-terminal"><text x="484.25" y="35">model</text></g></g></g></g></svg>
- en: '[PRE116]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE116]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
- en: '[PRE117]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE117]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 165.5 62" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">van</text></g></g></g></g></svg>
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 165.5 62" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">van</text></g></g></g></g></svg>
- en: '[PRE118]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE118]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
- en: '[PRE119]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
- en: The `add_tree()` method gets a combined list of non-terminals from current grammar,
    and the tree to be added to the grammar, and updates the definitions of each non-terminal.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '`add_tree()` 方法从当前语法中获取非终结符的组合列表，以及要添加到语法中的树，并更新每个非终结符的定义。'
- en: '[PRE120]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE120]'
- en: '[PRE121]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE121]'
- en: 'The `add_tree()` is used as follows:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: '`add_tree()` 的使用如下：'
- en: '[PRE122]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE122]'
- en: '[PRE123]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE123]'
- en: '[PRE124]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE124]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">vehicle</text></g></g></g></g></svg>
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">vehicle</text></g></g></g></g></svg>
- en: '[PRE125]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE125]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 575.5 62" width="575.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="87.0" y="35">year</text></g>
    <g class="terminal"><text x="148.25" y="35">,</text></g> <g class="non-terminal"><text
    x="209.5" y="35">kind</text></g> <g class="terminal"><text x="270.75" y="35">,</text></g>
    <g class="non-terminal"><text x="344.75" y="35">company</text></g> <g class="terminal"><text
    x="418.75" y="35">,</text></g> <g class="non-terminal"><text x="484.25" y="35">model</text></g></g></g></g></svg>
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 575.5 62" width="575.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="87.0" y="35">year</text></g>
    <g class="terminal"><text x="148.25" y="35">,</text></g> <g class="non-terminal"><text
    x="209.5" y="35">kind</text></g> <g class="terminal"><text x="270.75" y="35">,</text></g>
    <g class="non-terminal"><text x="344.75" y="35">company</text></g> <g class="terminal"><text
    x="418.75" y="35">,</text></g> <g class="non-terminal"><text x="484.25" y="35">model</text></g></g></g></g></svg>
- en: '[PRE126]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE126]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 174.0 122" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g> <g><g class="terminal"><text
    x="87.0" y="95">1997</text></g></g></g></g></svg>
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 174.0 122" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g> <g><g class="terminal"><text
    x="87.0" y="95">1997</text></g></g></g></g></svg>
- en: '[PRE127]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE127]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE128]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE128]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Ford</text></g></g></g></g></svg>
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Ford</text></g></g></g></g></svg>
- en: '[PRE129]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">E350</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Cougar</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Venture</text></g></g></g></g></svg>
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">E350</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Cougar</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Venture</text></g></g></g></g></svg>
- en: Given execution traces from various inputs, one can define `update_grammar()`
    to obtain the complete grammar from the traces.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 给定来自各种输入的执行跟踪，可以定义 `update_grammar()` 以从跟踪中获取完整的语法。
- en: '[PRE130]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: The complete grammar recovery is implemented in `recover_grammar()`.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的语法恢复在 `recover_grammar()` 中实现。
- en: '[PRE131]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: Note that the grammar could have been retrieved directly from the tracker, without
    the intermediate derivation tree stage. However, going through the derivation
    tree allows one to inspect the inputs being fragmented and verify that it happens
    correctly.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，语法可以直接从跟踪器中检索，而不需要中间的推导树阶段。然而，通过推导树可以检查正在分段的输入，并验证它是否正确发生。
- en: Example 1\. Recovering the Inventory Grammar
  id: totrans-277
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例 1. 恢复库存语法
- en: '[PRE132]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: '[PRE133]'
  id: totrans-279
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: '[PRE134]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE134]'
- en: Example 2\. Recovering URL Grammar
  id: totrans-281
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例 2. 恢复 URL 语法
- en: Our algorithm is robust enough to recover grammar from real world programs.
    For example, the `urlparse` function in the Python `urlib` module accepts the
    following sample URLs.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的算法足够鲁棒，可以从现实世界的程序中恢复语法。例如，Python `urlib` 模块中的 `urlparse` 函数接受以下示例 URL。
- en: '[PRE135]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: The urllib caches its intermediate results for faster access. Hence, we need
    to disable it using `clear_cache()` after every invocation.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '`urllib` 缓存其中间结果以实现快速访问。因此，我们需要在每次调用后使用 `clear_cache()` 禁用它。'
- en: '[PRE136]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: We use the sample URLs to recover grammar as follows. The `urlparse` function
    tends to cache its previous parsing results. Hence, we define a new method `url_parse()`
    that clears the cache before each call.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用样本 URL 如下恢复语法。`urlparse` 函数倾向于缓存其之前的解析结果。因此，我们定义了一个新的方法 `url_parse()`，在每次调用之前清除缓存。
- en: '[PRE137]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE137]'
- en: '[PRE138]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: '[PRE139]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: 'Let us use `url_parse()` to recover the grammar:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用 `url_parse()` 来恢复语法：
- en: '[PRE140]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE140]'
- en: '[PRE141]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: '[PRE142]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 165.5 62" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="82.75" y="35">url</text></g></g></g></g></svg>
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 165.5 62" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="82.75" y="35">url</text></g></g></g></g></svg>
- en: '[PRE143]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 643.5 122" width="643.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="95.5" y="35">scheme</text></g>
    <g class="terminal"><text x="173.75" y="35">://</text></g> <g class="non-terminal"><text
    x="252.0" y="35">netloc</text></g> <g class="terminal"><text x="326.0" y="35">/?</text></g>
    <g class="non-terminal"><text x="395.75" y="35">query</text></g> <g class="terminal"><text
    x="461.25" y="35">#</text></g> <g class="non-terminal"><text x="539.5" y="35">fragment</text></g></g>
    <g><g class="non-terminal"><text x="219.25" y="65">scheme</text></g> <g class="terminal"><text
    x="297.5" y="65">://</text></g> <g class="non-terminal"><text x="375.75" y="65">netloc</text></g>
    <g class="terminal"><text x="445.5" y="65">/</text></g></g> <g><g class="non-terminal"><text
    x="161.0" y="95">scheme</text></g> <g class="terminal"><text x="239.25" y="95">://</text></g>
    <g class="non-terminal"><text x="317.5" y="95">netloc</text></g> <g class="terminal"><text
    x="391.5" y="95">/#</text></g> <g class="non-terminal"><text x="474.0" y="95">fragment</text></g></g></g></g></svg>
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 643.5 122" width="643.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="95.5" y="35">scheme</text></g>
    <g class="terminal"><text x="173.75" y="35">://</text></g> <g class="non-terminal"><text
    x="252.0" y="35">netloc</text></g> <g class="terminal"><text x="326.0" y="35">/?</text></g>
    <g class="non-terminal"><text x="395.75" y="35">query</text></g> <g class="terminal"><text
    x="461.25" y="35">#</text></g> <g class="non-terminal"><text x="539.5" y="35">fragment</text></g></g>
    <g><g class="non-terminal"><text x="219.25" y="65">scheme</text></g> <g class="terminal"><text
    x="297.5" y="65">://</text></g> <g class="non-terminal"><text x="375.75" y="65">netloc</text></g>
    <g class="terminal"><text x="445.5" y="65">/</text></g></g> <g><g class="non-terminal"><text
    x="161.0" y="95">scheme</text></g> <g class="terminal"><text x="239.25" y="95">://</text></g>
    <g class="non-terminal"><text x="317.5" y="95">netloc</text></g> <g class="terminal"><text
    x="391.5" y="95">/#</text></g> <g class="non-terminal"><text x="474.0" y="95">fragment</text></g></g></g></g></svg>
- en: '[PRE144]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 182.5 92" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">https</text></g></g></g></g></svg>
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 182.5 92" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">https</text></g></g></g></g></svg>
- en: '[PRE145]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE145]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 369.5 122" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 369.5 122" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE146]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE146]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE147]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE147]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: The recovered grammar describes the URL format reasonably well.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复的语法对 URL 格式的描述相当合理。
- en: Fuzzing
  id: totrans-306
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 模糊测试
- en: We can now use our recovered grammar for fuzzing as follows.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以使用恢复的语法进行如下模糊测试。
- en: First, the inventory grammar.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，库存语法。
- en: '[PRE148]'
  id: totrans-309
  prefs: []
  type: TYPE_PRE
  zh: '[PRE148]'
- en: '[PRE149]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE149]'
- en: Next, the URL grammar.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，是 URL 语法。
- en: '[PRE150]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE150]'
- en: '[PRE151]'
  id: totrans-313
  prefs: []
  type: TYPE_PRE
  zh: '[PRE151]'
- en: What this means is that we can now take a program and a few samples, extract
    its grammar, and then use this very grammar for fuzzing. Now that's quite an opportunity!
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着我们现在可以取一个程序和一些样本，提取其语法，然后使用这个语法进行模糊测试。这真是个好机会！
- en: Problems with the Simple Miner
  id: totrans-315
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 简单挖掘器的问题
- en: One of the problems with our simple grammar miner is the assumption that the
    values assigned to variables are stable. Unfortunately, that may not hold true
    in all cases. For example, here is a URL with a slightly different format.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 我们简单语法挖掘器的问题之一是假设变量分配的值是稳定的。不幸的是，这可能在所有情况下都不成立。例如，这里有一个格式略有不同的 URL。
- en: '[PRE152]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE152]'
- en: The grammar generated from this set of samples is not as nice as what we got
    earlier
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 从这组样本生成的语法不如我们之前得到的那么好
- en: '[PRE153]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE153]'
- en: '[PRE154]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE154]'
- en: '[PRE155]'
  id: totrans-321
  prefs: []
  type: TYPE_PRE
  zh: '[PRE155]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 413.0 92" width="413.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="206.5" y="35">url</text></g></g>
    <g><g class="non-terminal"><text x="95.5" y="65">scheme</text></g> <g class="terminal"><text
    x="173.75" y="65">://</text></g> <g class="non-terminal"><text x="252.0" y="65">netloc</text></g>
    <g class="non-terminal"><text x="330.25" y="65">url</text></g></g></g></g></svg>
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 413.0 92" width="413.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="206.5" y="35">url</text></g></g>
    <g><g class="non-terminal"><text x="95.5" y="65">scheme</text></g> <g class="terminal"><text
    x="173.75" y="65">://</text></g> <g class="non-terminal"><text x="252.0" y="65">netloc</text></g>
    <g class="non-terminal"><text x="330.25" y="65">url</text></g></g></g></g></svg>
- en: '[PRE156]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE156]'
- en: <svg class="railroad-diagram" height="152" viewBox="0 0 643.5 152" width="643.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="95.5" y="65">scheme</text></g>
    <g class="terminal"><text x="173.75" y="65">://</text></g> <g class="non-terminal"><text
    x="252.0" y="65">netloc</text></g> <g class="terminal"><text x="326.0" y="65">/?</text></g>
    <g class="non-terminal"><text x="395.75" y="65">query</text></g> <g class="terminal"><text
    x="461.25" y="65">#</text></g> <g class="non-terminal"><text x="539.5" y="65">fragment</text></g></g>
    <g><g class="terminal"><text x="321.75" y="35">/releases/5.8</text></g></g> <g><g
    class="non-terminal"><text x="219.25" y="95">scheme</text></g> <g class="terminal"><text
    x="297.5" y="95">://</text></g> <g class="non-terminal"><text x="375.75" y="95">netloc</text></g>
    <g class="terminal"><text x="445.5" y="95">/</text></g></g> <g><g class="non-terminal"><text
    x="161.0" y="125">scheme</text></g> <g class="terminal"><text x="239.25" y="125">://</text></g>
    <g class="non-terminal"><text x="317.5" y="125">netloc</text></g> <g class="terminal"><text
    x="391.5" y="125">/#</text></g> <g class="non-terminal"><text x="474.0" y="125">fragment</text></g></g></g></g></svg>
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="152" viewBox="0 0 643.5 152" width="643.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="95.5" y="65">scheme</text></g>
    <g class="terminal"><text x="173.75" y="65">://</text></g> <g class="non-terminal"><text
    x="252.0" y="65">netloc</text></g> <g class="terminal"><text x="326.0" y="65">/?</text></g>
    <g class="non-terminal"><text x="395.75" y="65">query</text></g> <g class="terminal"><text
    x="461.25" y="65">#</text></g> <g class="non-terminal"><text x="539.5" y="65">fragment</text></g></g>
    <g><g class="terminal"><text x="321.75" y="35">/releases/5.8</text></g></g> <g><g
    class="non-terminal"><text x="219.25" y="95">scheme</text></g> <g class="terminal"><text
    x="297.5" y="95">://</text></g> <g class="non-terminal"><text x="375.75" y="95">netloc</text></g>
    <g class="terminal"><text x="445.5" y="95">/</text></g></g> <g><g class="non-terminal"><text
    x="161.0" y="125">scheme</text></g> <g class="terminal"><text x="239.25" y="125">://</text></g>
    <g class="non-terminal"><text x="317.5" y="125">netloc</text></g> <g class="terminal"><text
    x="391.5" y="125">/#</text></g> <g class="non-terminal"><text x="474.0" y="125">fragment</text></g></g></g></g></svg>
- en: '[PRE157]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE157]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
- en: '[PRE158]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE158]'
- en: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE159]'
  id: totrans-329
  prefs: []
  type: TYPE_PRE
  zh: '[PRE159]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE160]'
  id: totrans-331
  prefs: []
  type: TYPE_PRE
  zh: '[PRE160]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: Clearly, something has gone wrong.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，出了些问题。
- en: To investigate why the `url` definition has gone wrong, let us inspect the trace
    for the URL.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 为了调查 `url` 定义出错的原因，让我们检查 URL 的跟踪。
- en: '[PRE161]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE161]'
- en: '[PRE162]'
  id: totrans-336
  prefs: []
  type: TYPE_PRE
  zh: '[PRE162]'
- en: Notice how the value of `url` changes as the parsing progresses? This violates
    our assumption that the value assigned to a variable is stable. We next look at
    how this limitation can be removed.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，随着解析的进行，`url` 的值是如何变化的？这违反了我们对变量赋值值稳定的假设。接下来，我们将探讨如何消除这种限制。
- en: Grammar Miner with Reassignment
  id: totrans-338
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 带有重新分配的语法挖掘器
- en: One way to uniquely identify different variables is to annotate them with *line
    numbers* both when they are defined and also when their value changes. Consider
    the code fragment below
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 唯一识别不同变量的方法之一是在它们定义和值变化时都使用 *行号* 进行注释。考虑下面的代码片段
- en: Tracking variable assignment locations
  id: totrans-340
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 跟踪变量赋值位置
- en: '[PRE163]'
  id: totrans-341
  prefs: []
  type: TYPE_PRE
  zh: '[PRE163]'
- en: '[PRE164]'
  id: totrans-342
  prefs: []
  type: TYPE_PRE
  zh: '[PRE164]'
- en: '[PRE165]'
  id: totrans-343
  prefs: []
  type: TYPE_PRE
  zh: '[PRE165]'
- en: Notice how all variables are either named corresponding to either where they
    are defined, or the value is annotated to indicate that it was changed.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，所有变量要么命名与它们定义的位置相对应，要么值被注释以表明它已被更改。
- en: Let us run this under the trace.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行这个带有跟踪的代码。
- en: '[PRE166]'
  id: totrans-346
  prefs: []
  type: TYPE_PRE
  zh: '[PRE166]'
- en: '[PRE167]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE167]'
- en: 'Each variable was referenced first as follows:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 每个变量首先被引用如下：
- en: '`cp_1` -- *call* `1:C`'
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cp_1` -- *调用* `1:C`'
- en: '`c_2` -- *line* `3:C` (but the previous event was *line* `2:C`)'
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`c_2` -- *行* `3:C`（但上一个事件是*行* `2:C`）'
- en: '`c_3` -- *line* `4:C` (but the previous event was *line* `3:C`)'
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`c_3` -- *行* `4:C`（但上一个事件是*行* `3:C`）'
- en: '`bp_7` -- *call* `7:B`'
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bp_7` -- *调用* `7:B`'
- en: '`b_8` -- *line* `9:B` (but the previous event was *line* `8:B`)'
  id: totrans-353
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`b_8` -- *行* `9:B`（但上一个事件是*行* `8:B`）'
- en: '`ap_12` -- *call* `12:A`'
  id: totrans-354
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ap_12` -- *调用* `12:A`'
- en: '`a_13` -- *line* `14:A` (but the previous event was *line* `13:A`)'
  id: totrans-355
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`a_13` -- *行* `14:A`（但上一个事件是*行* `13:A`）'
- en: '`a_14` -- *line* `15:A` (the previous event was *return* `9:B`. However, the
    previous event in `A()` was *line* `14:A`)'
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`a_14` -- *行* `15:A`（上一个事件是*返回* `9:B`。然而，`A()`中的上一个事件是*行* `14:A`）'
- en: reassign `a_14` at *15* -- *line* `16:A` (the previous event was *line* `15:A`)
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第15行重新分配`a_14` -- *行* `16:A`（上一个事件是*行* `15:A`）
- en: reassign `a_13` at *16* -- *line* `17:A` (the previous event was *line* `16:A`)
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第16行重新分配`a_13` -- *行* `17:A`（上一个事件是*行* `16:A`）
- en: reassign `a_14` at *17* -- *return* `17:A` (the previous event in `A()` was
    *line* `17:A`)
  id: totrans-359
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第17行重新分配`a_14` -- *返回* `17:A`（`A()`中的上一个事件是*行* `17:A`）
- en: reassign `a_14` at *18* -- *return* `18:A` (the previous event in `A()` was
    *line* `18:A`)
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第18行重新分配`a_14` -- *返回* `18:A`（`A()`中的上一个事件是*行* `18:A`）
- en: So, our observations are that, if it is a call, the current location is the
    right one for any new variables being defined. On the other hand, if the variable
    being referenced for the first time (or reassigned a new value), then the right
    location to consider is the previous location *in the same method invocation*.
    Next, let us see how we can incorporate this information into variable naming.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们的观察结果是，如果是一个调用，当前位置是定义任何新变量的正确位置。另一方面，如果首次引用变量（或重新分配了新值），那么考虑的正确位置是*同一方法调用中的*上一个位置。接下来，让我们看看我们如何将此信息纳入变量命名。
- en: Next, we need a way to track the individual method calls as they are being made.
    For this we define the class `CallStack`. Each method invocation gets a separate
    identifier, and when the method call is over, the identifier is reset.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要一种方法来跟踪正在进行的单个方法调用。为此，我们定义了类`CallStack`。每次方法调用都会获得一个单独的标识符，当方法调用结束时，标识符会被重置。
- en: CallStack
  id: totrans-363
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: CallStack
- en: '[PRE168]'
  id: totrans-364
  prefs: []
  type: TYPE_PRE
  zh: '[PRE168]'
- en: A few extra functions to make life simpler.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 几个额外的函数以简化生活。
- en: '[PRE169]'
  id: totrans-366
  prefs: []
  type: TYPE_PRE
  zh: '[PRE169]'
- en: We also define a convenience method to display a given stack.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还定义了一个方便的方法来显示给定的堆栈。
- en: '[PRE170]'
  id: totrans-368
  prefs: []
  type: TYPE_PRE
  zh: '[PRE170]'
- en: Here is how we can use the `CallStack`.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们可以使用`CallStack`的方法。
- en: '[PRE171]'
  id: totrans-370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE171]'
- en: '[PRE172]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE172]'
- en: '[PRE173]'
  id: totrans-372
  prefs: []
  type: TYPE_PRE
  zh: '[PRE173]'
- en: '[PRE174]'
  id: totrans-373
  prefs: []
  type: TYPE_PRE
  zh: '[PRE174]'
- en: '[PRE175]'
  id: totrans-374
  prefs: []
  type: TYPE_PRE
  zh: '[PRE175]'
- en: '[PRE176]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE176]'
- en: '[PRE177]'
  id: totrans-376
  prefs: []
  type: TYPE_PRE
  zh: '[PRE177]'
- en: '[PRE178]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE178]'
- en: '[PRE179]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE179]'
- en: '[PRE180]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE180]'
- en: '[PRE181]'
  id: totrans-380
  prefs: []
  type: TYPE_PRE
  zh: '[PRE181]'
- en: '[PRE182]'
  id: totrans-381
  prefs: []
  type: TYPE_PRE
  zh: '[PRE182]'
- en: In order to account for variable reassignments, we need to have a more intelligent
    data structure than a dictionary for storing variables. We first define a simple
    interface `Vars`. It acts as a container for variables, and is instantiated at
    `my_assignments`.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理变量重新分配，我们需要一个比字典更智能的数据结构来存储变量。我们首先定义了一个简单的接口`Vars`。它作为变量的容器，并在`my_assignments`处实例化。
- en: Vars
  id: totrans-383
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Vars
- en: The `Vars` stores references to variables as they occur during parsing in its
    internal dictionary `defs`. We initialize the dictionary with the original string.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: '`Vars`在其内部字典`defs`中存储变量引用，该字典在解析过程中出现。我们用原始字符串初始化字典。'
- en: '[PRE183]'
  id: totrans-385
  prefs: []
  type: TYPE_PRE
  zh: '[PRE183]'
- en: 'The dictionary needs two methods: `update()` that takes a set of key-value
    pairs to update itself, and `_set_kv()` that updates a particular key-value pair.'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 字典需要两个方法：`update()`，它接受一组键值对以更新自身，以及`_set_kv()`，它更新特定的键值对。
- en: '[PRE184]'
  id: totrans-387
  prefs: []
  type: TYPE_PRE
  zh: '[PRE184]'
- en: The `Vars` is a proxy for the internal dictionary. For example, here is how
    one can use it.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: '`Vars`是内部字典的代理。例如，以下是使用它的方法。'
- en: '[PRE185]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE185]'
- en: '[PRE186]'
  id: totrans-390
  prefs: []
  type: TYPE_PRE
  zh: '[PRE186]'
- en: '[PRE187]'
  id: totrans-391
  prefs: []
  type: TYPE_PRE
  zh: '[PRE187]'
- en: '[PRE188]'
  id: totrans-392
  prefs: []
  type: TYPE_PRE
  zh: '[PRE188]'
- en: '[PRE189]'
  id: totrans-393
  prefs: []
  type: TYPE_PRE
  zh: '[PRE189]'
- en: '[PRE190]'
  id: totrans-394
  prefs: []
  type: TYPE_PRE
  zh: '[PRE190]'
- en: AssignmentVars
  id: totrans-395
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: AssignmentVars
- en: We now extend the simple `Vars` to account for variable reassignments. For this,
    we define `AssignmentVars`.
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在扩展简单的`Vars`以处理变量重新分配。为此，我们定义了`AssignmentVars`。
- en: 'The idea for detecting reassignments and renaming variables is as follows:
    We keep track of the previous reassignments to particular variables using `accessed_seq_var`.
    It contains the last rename of any particular variable as its corresponding value.
    The `new_vars` contains a list of all new variables that were added on this iteration.'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 检测重新分配和重命名变量的想法如下：我们使用`accessed_seq_var`跟踪特定变量的上一个重新分配。它包含任何特定变量的最后重命名作为其对应值。`new_vars`包含在本迭代中添加的所有新变量的列表。
- en: '[PRE191]'
  id: totrans-398
  prefs: []
  type: TYPE_PRE
  zh: '[PRE191]'
- en: The `method_init()` method takes care of keeping track of method invocations
    using records saved in the `call_stack`. `event_locations` is for keeping track
    of the locations accessed *within this method*. This is used for line number tracking
    of variable definitions.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: '`method_init()`方法负责使用`call_stack`中保存的记录来跟踪方法调用。`event_locations`用于跟踪此方法内访问的位置。这是用于变量定义行号跟踪的。'
- en: '[PRE192]'
  id: totrans-400
  prefs: []
  type: TYPE_PRE
  zh: '[PRE192]'
- en: The `update()` is now modified to track the changed line numbers if any, using
    `var_location_register()`. We reinitialize the `new_vars` after use for the next
    event.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '`update()`现在被修改为使用`var_location_register()`跟踪任何更改的行号。我们使用后重新初始化`new_vars`以供下一个事件使用。'
- en: '[PRE193]'
  id: totrans-402
  prefs: []
  type: TYPE_PRE
  zh: '[PRE193]'
- en: The variable name now incorporates an index of how many reassignments it has
    gone through, effectively making each reassignment a unique variable.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 变量名现在包含一个索引，表示它经历了多少次重新赋值，从而使得每次重新赋值都是一个唯一的变量。
- en: '[PRE194]'
  id: totrans-404
  prefs: []
  type: TYPE_PRE
  zh: '[PRE194]'
- en: While storing variables, we need to first check whether it was previously known.
    If it is not, we need to initialize the rename count. This is accomplished by
    `var_access`.
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 在存储变量时，我们首先需要检查它之前是否已知。如果它不是，我们需要初始化重命名计数。这是通过`var_access`完成的。
- en: '[PRE195]'
  id: totrans-406
  prefs: []
  type: TYPE_PRE
  zh: '[PRE195]'
- en: During a variable reassignment, we update the `accessed_seq_var` to reflect
    the new count.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 在变量重新赋值期间，我们更新`accessed_seq_var`以反映新的计数。
- en: '[PRE196]'
  id: totrans-408
  prefs: []
  type: TYPE_PRE
  zh: '[PRE196]'
- en: These methods can be used as follows
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方法可以这样使用
- en: '[PRE197]'
  id: totrans-410
  prefs: []
  type: TYPE_PRE
  zh: '[PRE197]'
- en: '[PRE198]'
  id: totrans-411
  prefs: []
  type: TYPE_PRE
  zh: '[PRE198]'
- en: '[PRE199]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE199]'
- en: '[PRE200]'
  id: totrans-413
  prefs: []
  type: TYPE_PRE
  zh: '[PRE200]'
- en: '[PRE201]'
  id: totrans-414
  prefs: []
  type: TYPE_PRE
  zh: '[PRE201]'
- en: '[PRE202]'
  id: totrans-415
  prefs: []
  type: TYPE_PRE
  zh: '[PRE202]'
- en: Assigning to it again increments the counter.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 再次赋值给它会增加计数器。
- en: '[PRE203]'
  id: totrans-417
  prefs: []
  type: TYPE_PRE
  zh: '[PRE203]'
- en: '[PRE204]'
  id: totrans-418
  prefs: []
  type: TYPE_PRE
  zh: '[PRE204]'
- en: The core of the logic is in `_set_kv()`. When a variable is being assigned,
    we get the sequenced variable name `s_var`. If the sequenced variable name was
    previously unknown in `defs`, then we have no further concerns. We add the sequenced
    variable to `defs`.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑的核心在于`_set_kv()`。当一个变量被赋值时，我们获取序列化变量名`s_var`。如果序列化变量名在`defs`中之前是未知的，那么我们就没有进一步的担忧。我们将序列化变量添加到`defs`中。
- en: If the variable is previously known, then it is an indication of a possible
    reassignment. In this case, we look at the value the variable is holding. We check
    if the value changed. If it has not, then it is not.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 如果变量之前已知，那么这是一个可能重新赋值的指示。在这种情况下，我们查看变量所持有的值。我们检查值是否已更改。如果没有，那么它就不是。
- en: If the value has changed, it is a reassignment. We first increment the variable
    usage sequence using `var_assign`, retrieve the new name, update the new name
    in `defs`.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 如果值已经改变，它就是一个重新赋值。我们首先使用`var_assign`增加变量使用序列，检索新名称，并在`defs`中更新新名称。
- en: '[PRE205]'
  id: totrans-422
  prefs: []
  type: TYPE_PRE
  zh: '[PRE205]'
- en: Here is how it can be used. Assigning a variable the first time initializes
    its counter.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是如何使用它的。第一次将变量赋值初始化其计数器。
- en: '[PRE206]'
  id: totrans-424
  prefs: []
  type: TYPE_PRE
  zh: '[PRE206]'
- en: '[PRE207]'
  id: totrans-425
  prefs: []
  type: TYPE_PRE
  zh: '[PRE207]'
- en: If the variable is assigned again with the same value, it is probably not a
    reassignment.
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 如果变量再次以相同的值赋值，那么它可能不是重新赋值。
- en: '[PRE208]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE208]'
- en: '[PRE209]'
  id: totrans-428
  prefs: []
  type: TYPE_PRE
  zh: '[PRE209]'
- en: However, if the value changed, it is a reassignment.
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果值发生了变化，它就是一个重新赋值。
- en: '[PRE210]'
  id: totrans-430
  prefs: []
  type: TYPE_PRE
  zh: '[PRE210]'
- en: '[PRE211]'
  id: totrans-431
  prefs: []
  type: TYPE_PRE
  zh: '[PRE211]'
- en: There is a subtlety here. It is possible for a child method to be called from
    the middle of a parent method, and for both to use the same variable name with
    different values. In this case, when the child returns, parent will have the old
    variable with old value in context. With our implementation, we consider this
    as a reassignment. However, this is OK because adding a new reassignment is harmless,
    but missing one is not. Further, we will discuss later how this can be avoided.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个微妙之处。子方法可以从父方法的中部被调用，并且两者可以使用不同的值具有相同的变量名。在这种情况下，当子方法返回时，父方法将具有上下文中的旧变量和旧值。在我们的实现中，我们将其视为重新赋值。然而，这是可以的，因为添加新的重新赋值是无害的，但遗漏一个则不行。此外，我们稍后还会讨论如何避免这种情况。
- en: We also define bookkeeping codes for `register_event()` `method_enter()` and
    `method_exit()` which are the methods responsible for keeping track of the method
    stack. The basic idea is that, each `method_enter()` represents a new method invocation.
    Hence, it merits a new method id, which is generated from the `method_register`,
    and saved in the `method_id`. Since this is a new method, the method stack is
    extended by one element with this id. In the case of `method_exit()`, we pop the
    method stack, and reset the current `method_id` to what was below the current
    one.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还定义了`register_event()`、`method_enter()`和`method_exit()`的记账代码，这些是负责跟踪方法栈的方法。基本思想是，每个`method_enter()`代表一个新的方法调用。因此，它值得一个新的方法ID，该ID由`method_register`生成，并保存在`method_id`中。由于这是一个新的方法，方法栈通过一个具有此ID的元素进行扩展。在`method_exit()`的情况下，我们弹出方法栈，并将当前`method_id`重置为当前一个以下的值。
- en: '[PRE212]'
  id: totrans-434
  prefs: []
  type: TYPE_PRE
  zh: '[PRE212]'
- en: For each of the method events, we also register the event using `register_event()`
    which keeps track of the line numbers that were referenced in *this* method.
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个方法事件，我们还会使用 `register_event()` 注册事件，该事件跟踪 *此* 方法中引用的行号。
- en: '[PRE213]'
  id: totrans-436
  prefs: []
  type: TYPE_PRE
  zh: '[PRE213]'
- en: The `var_location_register()` keeps the locations of newly added variables.
    The definition location of variables in a `call` is the *current* location. However,
    for a `line`, it would be the previous event in the current method.
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: '`var_location_register()` 保存新添加变量的位置。在 `call` 中的变量定义位置是 *当前* 位置。然而，对于 `line`，它将是当前方法中的前一个事件。'
- en: '[PRE214]'
  id: totrans-438
  prefs: []
  type: TYPE_PRE
  zh: '[PRE214]'
- en: We define `defined_vars()` which returns the names of variables annotated with
    the line numbers as below.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义 `defined_vars()`，它返回以下标注行号的变量的名称。
- en: '[PRE215]'
  id: totrans-440
  prefs: []
  type: TYPE_PRE
  zh: '[PRE215]'
- en: Similar to `defined_vars()` we define `seq_vars()` which annotates different
    variables with the number of times they were used.
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 与 `defined_vars()` 类似，我们定义了 `seq_vars()`，它用使用次数标注不同的变量。
- en: '[PRE216]'
  id: totrans-442
  prefs: []
  type: TYPE_PRE
  zh: '[PRE216]'
- en: AssignmentTracker
  id: totrans-443
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: AssignmentTracker
- en: The `AssignmentTracker` keeps the assignment definitions using the `AssignmentVars`
    we defined previously.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: '`AssignmentTracker` 使用我们之前定义的 `AssignmentVars` 保存赋值定义。'
- en: '[PRE217]'
  id: totrans-445
  prefs: []
  type: TYPE_PRE
  zh: '[PRE217]'
- en: To fine-tune the process, we define an optional parameter called `track_return`.
    During tracing a method return, Python produces a virtual variable that contains
    the result of the returned value. If the `track_return` is set, we capture this
    value as a variable.
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 为了微调过程，我们定义了一个可选参数，称为 `track_return`。在跟踪方法返回时，Python会产生一个包含返回值结果的虚拟变量。如果设置 `track_return`，我们将捕获此值作为变量。
- en: '`track_return` -- if true, add a *virtual variable* to the Vars representing
    the return value'
  id: totrans-447
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`track_return` -- 如果为真，则向 Vars 添加一个 *虚拟变量* 来表示返回值'
- en: '[PRE218]'
  id: totrans-448
  prefs: []
  type: TYPE_PRE
  zh: '[PRE218]'
- en: There can be different kinds of events during a trace, which includes `call`
    when a function is entered, `return` when the function returns, `exception` when
    an exception is thrown and `line` when a statement is executed.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 在跟踪过程中，可能会有不同类型的事件，包括 `call`（当函数进入时），`return`（当函数返回时），`exception`（当抛出异常时）和 `line`（当执行语句时）。
- en: The previous `Tracker` was too simplistic in that it did not distinguish between
    the different events. We rectify that and define `on_call()`, `on_return()`, and
    `on_line()` respectively, which get called on their corresponding events.
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的 `Tracker` 过于简单，因为它没有区分不同的事件。我们纠正了这一点，并分别定义了 `on_call()`、`on_return()` 和
    `on_line()`，它们将在对应的事件上被调用。
- en: Note that `on_line()` is called also for `on_return()`. The reason is, that
    Python invokes the trace function *before* the corresponding line is executed.
    Hence, effectively, the `on_return()` is called with the binding produced by the
    execution of the previous statement in the environment. Our processing in effect
    is done on values that were bound by the previous statement. Hence, calling `on_line()`
    here is appropriate as it provides the event handler a chance to work on the previous
    binding.
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，`on_line()` 也会被调用于 `on_return()`。原因是，Python在执行相应的行之前会调用跟踪函数。因此，实际上，`on_return()`
    是在环境执行前一个语句产生的绑定下被调用的。我们的处理实际上是在前一个语句绑定的值上进行的。因此，在这里调用 `on_line()` 是合适的，因为它给事件处理程序提供了一个机会来处理前一个绑定。
- en: '[PRE219]'
  id: totrans-452
  prefs: []
  type: TYPE_PRE
  zh: '[PRE219]'
- en: We can now use `AssignmentTracker` to track the different variables. To verify
    that our variable line number inference works, we recover definitions from the
    functions `A()`, `B()` and `C()` (with data annotations removed so that the input
    fragments are correctly identified).
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以使用 `AssignmentTracker` 跟踪不同的变量。为了验证我们的变量行号推断是否有效，我们从函数 `A()`、`B()` 和 `C()`（移除了数据注释，以便正确识别输入片段）中恢复定义。
- en: '[PRE220]'
  id: totrans-454
  prefs: []
  type: TYPE_PRE
  zh: '[PRE220]'
- en: '[PRE221]'
  id: totrans-455
  prefs: []
  type: TYPE_PRE
  zh: '[PRE221]'
- en: '[PRE222]'
  id: totrans-456
  prefs: []
  type: TYPE_PRE
  zh: '[PRE222]'
- en: Running `A()` with sufficient input.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 用足够的输入运行 `A()`。
- en: '[PRE223]'
  id: totrans-458
  prefs: []
  type: TYPE_PRE
  zh: '[PRE223]'
- en: '[PRE224]'
  id: totrans-459
  prefs: []
  type: TYPE_PRE
  zh: '[PRE224]'
- en: As can be seen, the line numbers are now correctly identified for each variable.
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 如所示，现在每个变量的行号都已正确识别。
- en: Let us try retrieving the assignments for a real world example.
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试检索一个真实世界示例的赋值。
- en: '[PRE225]'
  id: totrans-462
  prefs: []
  type: TYPE_PRE
  zh: '[PRE225]'
- en: '[PRE226]'
  id: totrans-463
  prefs: []
  type: TYPE_PRE
  zh: '[PRE226]'
- en: The line numbers of variables can be verified from the source code of [urllib/parse.py](https://github.com/python/cpython/blob/3.6/Lib/urllib/parse.py).
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 变量的行号可以从 [urllib/parse.py](https://github.com/python/cpython/blob/3.6/Lib/urllib/parse.py)
    的源代码中进行验证。
- en: Recovering a Derivation Tree
  id: totrans-465
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 恢复推导树
- en: Does handling variable reassignments help with our URL examples? We look at
    these next.
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 处理变量重新赋值是否有助于我们的URL示例？我们接下来看看这些。
- en: '[PRE227]'
  id: totrans-467
  prefs: []
  type: TYPE_PRE
  zh: '[PRE227]'
- en: 'Example 1: Recovering URL Derivation Tree'
  id: totrans-468
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例 1：恢复URL推导树
- en: First we obtain the derivation tree of the URL 1
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们获取URL 1的推导树
- en: URL 1 derivation tree
  id: totrans-470
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: URL 1推导树
- en: '[PRE228]'
  id: totrans-471
  prefs: []
  type: TYPE_PRE
  zh: '[PRE228]'
- en: '<svg width="506pt" height="324pt" viewBox="0.00 0.00 505.88 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="123.38"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00"><url@374></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="45.38" y="-201.95" font-family="Times,serif" font-size="14.00"><scheme@492></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="123.38" y="-201.95" font-family="Times,serif" font-size="14.00">:
    (58)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="188.38" y="-201.95"
    font-family="Times,serif" font-size="14.00"><url@492></text></g> <g id="edge5"
    class="edge"><title>1->5</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00">http</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.38" y="-151.7" font-family="Times,serif" font-size="14.00">//</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-151.7" font-family="Times,serif" font-size="14.00"><netloc@494></text></g>
    <g id="edge7" class="edge"><title>5->7</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="336.38" y="-151.7" font-family="Times,serif" font-size="14.00"><url@494></text></g>
    <g id="edge9" class="edge"><title>5->9</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="159.38" y="-101.45" font-family="Times,serif" font-size="14.00">user:pass@www.google.com:80</text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="297.38" y="-101.45" font-family="Times,serif" font-size="14.00"><url@502></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="364.38" y="-101.45" font-family="Times,serif" font-size="14.00">#
    (35)</text></g> <g id="edge14" class="edge"><title>9->14</title></g> <g id="node16"
    class="node"><title>15</title> <text text-anchor="middle" x="448.38" y="-101.45"
    font-family="Times,serif" font-size="14.00"><fragment@502></text></g> <g id="edge15"
    class="edge"><title>9->15</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="265.38" y="-51.2" font-family="Times,serif" font-size="14.00">/?</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="328.38" y="-51.2" font-family="Times,serif" font-size="14.00"><query@504></text></g>
    <g id="edge12" class="edge"><title>10->12</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="328.38" y="-0.95" font-family="Times,serif" font-size="14.00">q=path</text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="448.38" y="-51.2" font-family="Times,serif" font-size="14.00">ref</text></g>
    <g id="edge16" class="edge"><title>15->16</title></g></g></svg>'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: '<svg width="506pt" height="324pt" viewBox="0.00 0.00 505.88 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="123.38"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00"><url@374></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="45.38" y="-201.95" font-family="Times,serif" font-size="14.00"><scheme@492></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="123.38" y="-201.95" font-family="Times,serif" font-size="14.00">:
    (58)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="188.38" y="-201.95"
    font-family="Times,serif" font-size="14.00"><url@492></text></g> <g id="edge5"
    class="edge"><title>1->5</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00">http</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.38" y="-151.7" font-family="Times,serif" font-size="14.00">//</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-151.7" font-family="Times,serif" font-size="14.00"><netloc@494></text></g>
    <g id="edge7" class="edge"><title>5->7</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="336.38" y="-151.7" font-family="Times,serif" font-size="14.00"><url@494></text></g>
    <g id="edge9" class="edge"><title>5->9</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="159.38" y="-101.45" font-family="Times,serif" font-size="14.00">user:pass@www.google.com:80</text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="297.38" y="-101.45" font-family="Times,serif" font-size="14.00"><url@502></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="364.38" y="-101.45" font-family="Times,serif" font-size="14.00">#
    (35)</text></g> <g id="edge14" class="edge"><title>9->14</title></g> <g id="node16"
    class="node"><title>15</title> <text text-anchor="middle" x="448.38" y="-101.45"
    font-family="Times,serif" font-size="14.00"><fragment@502></text></g> <g id="edge15"
    class="edge"><title>9->15</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="265.38" y="-51.2" font-family="Times,serif" font-size="14.00">/?</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="328.38" y="-51.2" font-family="Times,serif" font-size="14.00"><query@504></text></g>
    <g id="edge12" class="edge"><title>10->12</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="328.38" y="-0.95" font-family="Times,serif" font-size="14.00">q=path</text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="448.38" y="-51.2" font-family="Times,serif" font-size="14.00">ref</text></g>
    <g id="edge16" class="edge"><title>15->16</title></g></g></svg>'
- en: Next, we obtain the derivation tree of URL 4
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们获取URL 4的推导树
- en: URL 4 derivation tree
  id: totrans-474
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: URL 4推导树
- en: '[PRE229]'
  id: totrans-475
  prefs: []
  type: TYPE_PRE
  zh: '[PRE229]'
- en: '<svg width="322pt" height="274pt" viewBox="0.00 0.00 322.12 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="123.38" y="-201.95"
    font-family="Times,serif" font-size="14.00"><url@374></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00"><scheme@492></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="123.38" y="-151.7" font-family="Times,serif" font-size="14.00">:
    (58)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="188.38" y="-151.7"
    font-family="Times,serif" font-size="14.00"><url@492></text></g> <g id="edge5"
    class="edge"><title>1->5</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="45.38" y="-101.45" font-family="Times,serif" font-size="14.00">ftp</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.38" y="-101.45" font-family="Times,serif" font-size="14.00">//</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-101.45" font-family="Times,serif" font-size="14.00"><netloc@494></text></g>
    <g id="edge7" class="edge"><title>5->7</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="280.38" y="-101.45" font-family="Times,serif" font-size="14.00"><url@494></text></g>
    <g id="edge9" class="edge"><title>5->9</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="188.38" y="-51.2" font-family="Times,serif" font-size="14.00">freebsd.org</text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="280.38" y="-51.2" font-family="Times,serif" font-size="14.00"><url@396></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="280.38" y="-0.95" font-family="Times,serif" font-size="14.00">/releases/5.8</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g></g></svg>'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: '<svg width="322pt" height="274pt" viewBox="0.00 0.00 322.12 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="123.38" y="-201.95"
    font-family="Times,serif" font-size="14.00"><url@374></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00"><scheme@492></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="123.38" y="-151.7" font-family="Times,serif" font-size="14.00">:
    (58)</text></g> <g id="edge4" class="edge"><title>1->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="188.38" y="-151.7"
    font-family="Times,serif" font-size="14.00"><url@492></text></g> <g id="edge5"
    class="edge"><title>1->5</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="45.38" y="-101.45" font-family="Times,serif" font-size="14.00">ftp</text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="125.38" y="-101.45" font-family="Times,serif" font-size="14.00">//</text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="188.38" y="-101.45" font-family="Times,serif" font-size="14.00"><netloc@494></text></g>
    <g id="edge7" class="edge"><title>5->7</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="280.38" y="-101.45" font-family="Times,serif" font-size="14.00"><url@494></text></g>
    <g id="edge9" class="edge"><title>5->9</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="188.38" y="-51.2" font-family="Times,serif" font-size="14.00">freebsd.org</text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="280.38" y="-51.2" font-family="Times,serif" font-size="14.00"><url@396></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="280.38" y="-0.95" font-family="Times,serif" font-size="14.00">/releases/5.8</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g></g></svg>'
- en: The derivation trees seem to belong to the same grammar. Hence, we obtain the
    grammar for the complete set. First, we update the `recover_grammar()` to use
    `AssignTracker`.
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 分析树似乎属于同一个语法。因此，我们获得了整个集合的语法。首先，我们更新`recover_grammar()`以使用`AssignTracker`。
- en: Recover Grammar
  id: totrans-478
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 恢复语法
- en: '[PRE230]'
  id: totrans-479
  prefs: []
  type: TYPE_PRE
  zh: '[PRE230]'
- en: Next, we use the modified `recover_grammar()` on derivation trees obtained from
    URLs.
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用修改后的`recover_grammar()`对从URL获得的推导树进行处理。
- en: '[PRE231]'
  id: totrans-481
  prefs: []
  type: TYPE_PRE
  zh: '[PRE231]'
- en: The recovered grammar is below.
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复的语法如下。
- en: '[PRE232]'
  id: totrans-483
  prefs: []
  type: TYPE_PRE
  zh: '[PRE232]'
- en: '[PRE233]'
  id: totrans-484
  prefs: []
  type: TYPE_PRE
  zh: '[PRE233]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">url@374</text></g></g></g></g></svg>
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 199.5 62" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">url@374</text></g></g></g></g></svg>
- en: '[PRE234]'
  id: totrans-486
  prefs: []
  type: TYPE_PRE
  zh: '[PRE234]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 373.0 62" width="373.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="112.5" y="35">scheme@492</text></g>
    <g class="terminal"><text x="199.25" y="35">:</text></g> <g class="non-terminal"><text
    x="273.25" y="35">url@492</text></g></g></g></g></svg>
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 373.0 62" width="373.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="112.5" y="35">scheme@492</text></g>
    <g class="terminal"><text x="199.25" y="35">:</text></g> <g class="non-terminal"><text
    x="273.25" y="35">url@492</text></g></g></g></g></svg>
- en: '[PRE235]'
  id: totrans-488
  prefs: []
  type: TYPE_PRE
  zh: '[PRE235]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
- en: '[PRE236]'
  id: totrans-490
  prefs: []
  type: TYPE_PRE
  zh: '[PRE236]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 381.5 92" width="381.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">//</text></g>
    <g class="non-terminal"><text x="169.5" y="35">netloc@494</text></g> <g class="non-terminal"><text
    x="281.75" y="35">url@494</text></g></g> <g><g class="terminal"><text x="104.0"
    y="65">//</text></g> <g class="non-terminal"><text x="195.0" y="65">netloc@494</text></g>
    <g class="terminal"><text x="281.75" y="65">/</text></g></g></g></g></svg>
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 381.5 92" width="381.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">//</text></g>
    <g class="non-terminal"><text x="169.5" y="35">netloc@494</text></g> <g class="non-terminal"><text
    x="281.75" y="35">url@494</text></g></g> <g><g class="terminal"><text x="104.0"
    y="65">//</text></g> <g class="non-terminal"><text x="195.0" y="65">netloc@494</text></g>
    <g class="terminal"><text x="281.75" y="65">/</text></g></g></g></g></svg>
- en: '[PRE237]'
  id: totrans-492
  prefs: []
  type: TYPE_PRE
  zh: '[PRE237]'
- en: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE238]'
  id: totrans-494
  prefs: []
  type: TYPE_PRE
  zh: '[PRE238]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 390.0 122" width="390.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="195.0" y="35">url@396</text></g></g>
    <g><g class="terminal"><text x="124.0" y="65">/#</text></g> <g class="non-terminal"><text
    x="223.5" y="65">fragment@502</text></g></g> <g><g class="non-terminal"><text
    x="99.75" y="95">url@502</text></g> <g class="terminal"><text x="173.75" y="95">#</text></g>
    <g class="non-terminal"><text x="269.0" y="95">fragment@502</text></g></g></g></g></svg>
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 390.0 122" width="390.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="195.0" y="35">url@396</text></g></g>
    <g><g class="terminal"><text x="124.0" y="65">/#</text></g> <g class="non-terminal"><text
    x="223.5" y="65">fragment@502</text></g></g> <g><g class="non-terminal"><text
    x="99.75" y="95">url@502</text></g> <g class="terminal"><text x="173.75" y="95">#</text></g>
    <g class="non-terminal"><text x="269.0" y="95">fragment@502</text></g></g></g></g></svg>
- en: '[PRE239]'
  id: totrans-496
  prefs: []
  type: TYPE_PRE
  zh: '[PRE239]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 273.5 62" width="273.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="165.25" y="35">query@504</text></g></g></g></g></svg>
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 273.5 62" width="273.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="165.25" y="35">query@504</text></g></g></g></g></svg>
- en: '[PRE240]'
  id: totrans-498
  prefs: []
  type: TYPE_PRE
  zh: '[PRE240]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE241]'
  id: totrans-500
  prefs: []
  type: TYPE_PRE
  zh: '[PRE241]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: '[PRE242]'
  id: totrans-502
  prefs: []
  type: TYPE_PRE
  zh: '[PRE242]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
- en: Let us fuzz a little to see if the produced values are sane.
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们稍微模糊一下，看看产生的值是否合理。
- en: '[PRE243]'
  id: totrans-505
  prefs: []
  type: TYPE_PRE
  zh: '[PRE243]'
- en: '[PRE244]'
  id: totrans-506
  prefs: []
  type: TYPE_PRE
  zh: '[PRE244]'
- en: Our modifications do seem to help. Next, we check whether we can still retrieve
    the grammar for inventory.
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的修改似乎有所帮助。接下来，我们检查是否还能检索到库存的语法。
- en: 'Example 2: Recovering Inventory Grammar'
  id: totrans-508
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例2：恢复库存语法
- en: '[PRE245]'
  id: totrans-509
  prefs: []
  type: TYPE_PRE
  zh: '[PRE245]'
- en: '[PRE246]'
  id: totrans-510
  prefs: []
  type: TYPE_PRE
  zh: '[PRE246]'
- en: '[PRE247]'
  id: totrans-511
  prefs: []
  type: TYPE_PRE
  zh: '[PRE247]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 225.0 62" width="225.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="112.5" y="35">vehicle@29</text></g></g></g></g></svg>
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 225.0 62" width="225.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="112.5" y="35">vehicle@29</text></g></g></g></g></svg>
- en: '[PRE248]'
  id: totrans-513
  prefs: []
  type: TYPE_PRE
  zh: '[PRE248]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 677.5 62" width="677.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">year@30</text></g>
    <g class="terminal"><text x="173.75" y="35">,</text></g> <g class="non-terminal"><text
    x="247.75" y="35">kind@30</text></g> <g class="terminal"><text x="321.75" y="35">,</text></g>
    <g class="non-terminal"><text x="408.5" y="35">company@30</text></g> <g class="terminal"><text
    x="495.25" y="35">,</text></g> <g class="non-terminal"><text x="573.5" y="35">model@30</text></g></g></g></g></svg>
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 677.5 62" width="677.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="99.75" y="35">year@30</text></g>
    <g class="terminal"><text x="173.75" y="35">,</text></g> <g class="non-terminal"><text
    x="247.75" y="35">kind@30</text></g> <g class="terminal"><text x="321.75" y="35">,</text></g>
    <g class="non-terminal"><text x="408.5" y="35">company@30</text></g> <g class="terminal"><text
    x="495.25" y="35">,</text></g> <g class="non-terminal"><text x="573.5" y="35">model@30</text></g></g></g></g></svg>
- en: '[PRE249]'
  id: totrans-515
  prefs: []
  type: TYPE_PRE
  zh: '[PRE249]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 174.0 122" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g> <g><g class="terminal"><text
    x="87.0" y="95">1997</text></g></g></g></g></svg>
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 174.0 122" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g> <g><g class="terminal"><text
    x="87.0" y="95">1997</text></g></g></g></g></svg>
- en: '[PRE250]'
  id: totrans-517
  prefs: []
  type: TYPE_PRE
  zh: '[PRE250]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE251]'
  id: totrans-519
  prefs: []
  type: TYPE_PRE
  zh: '[PRE251]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Ford</text></g></g></g></g></svg>
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Ford</text></g></g></g></g></svg>
- en: '[PRE252]'
  id: totrans-521
  prefs: []
  type: TYPE_PRE
  zh: '[PRE252]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">E350</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Cougar</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Venture</text></g></g></g></g></svg>
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 199.5 122" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">E350</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Cougar</text></g></g> <g><g class="terminal"><text
    x="99.75" y="95">Venture</text></g></g></g></g></svg>
- en: Using fuzzing to produce values from the grammar.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 使用模糊化从语法中产生值。
- en: '[PRE253]'
  id: totrans-524
  prefs: []
  type: TYPE_PRE
  zh: '[PRE253]'
- en: '[PRE254]'
  id: totrans-525
  prefs: []
  type: TYPE_PRE
  zh: '[PRE254]'
- en: Problems with the Grammar Miner with Reassignment
  id: totrans-526
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 语法挖掘器重新赋值的问题
- en: One of the problems with our grammar miner is that it doesn't yet account for
    the current context. That is, when replacing, a variable can replace tokens that
    it does not have access to (and hence, it is not a fragment of). Consider this
    example.
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: 我们语法挖掘器的一个问题是它还没有考虑到当前上下文。也就是说，在替换时，一个变量可以替换它无法访问的标记（因此，它不是一个片段）。考虑以下例子。
- en: '[PRE255]'
  id: totrans-528
  prefs: []
  type: TYPE_PRE
  zh: '[PRE255]'
- en: <svg width="508pt" height="598pt" viewBox="0.00 0.00 508.25 598.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 594.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="19.88"
    y="-256.95" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="123" y="-256.95"
    font-family="Times,serif" font-size="14.00"><inventory@22></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="247.12" y="-464.95" font-family="Times,serif" font-size="14.00"><vehicle@24></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="247.12" y="-288.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge14" class="edge"><title>1->14</title></g> <g id="node16"
    class="node"><title>15</title> <text text-anchor="middle" x="247.12" y="-256.95"
    font-family="Times,serif" font-size="14.00"><vehicle@24></text></g> <g id="edge15"
    class="edge"><title>1->15</title></g> <g id="node28" class="node"><title>27</title>
    <text text-anchor="middle" x="247.12" y="-224.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge27" class="edge"><title>1->27</title></g> <g id="node29"
    class="node"><title>28</title> <text text-anchor="middle" x="247.12" y="-80.95"
    font-family="Times,serif" font-size="14.00"><vehicle@24></text></g> <g id="edge28"
    class="edge"><title>1->28</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="370.5" y="-576.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="370.5" y="-544.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>2->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="370.5" y="-512.95"
    font-family="Times,serif" font-size="14.00"><kind@30></text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="370.5" y="-480.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge8" class="edge"><title>2->8</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="370.5" y="-448.95"
    font-family="Times,serif" font-size="14.00"><company@30></text></g> <g id="edge9"
    class="edge"><title>2->9</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="370.5" y="-416.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge11" class="edge"><title>2->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="370.5" y="-384.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge12"
    class="edge"><title>2->12</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="476.62" y="-576.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="476.62" y="-512.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="476.62" y="-448.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="476.62" y="-384.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="370.5" y="-352.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="370.5" y="-320.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge18" class="edge"><title>15->18</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="370.5" y="-288.95"
    font-family="Times,serif" font-size="14.00"><kind@30></text></g> <g id="edge19"
    class="edge"><title>15->19</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="370.5" y="-256.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge21" class="edge"><title>15->21</title></g> <g id="node23"
    class="node"><title>22</title> <text text-anchor="middle" x="370.5" y="-224.95"
    font-family="Times,serif" font-size="14.00"><company@30></text></g> <g id="edge22"
    class="edge"><title>15->22</title></g> <g id="node25" class="node"><title>24</title>
    <text text-anchor="middle" x="370.5" y="-192.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge24" class="edge"><title>15->24</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="370.5" y="-160.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge25"
    class="edge"><title>15->25</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="476.62" y="-352.95" font-family="Times,serif" font-size="14.00">2000</text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="476.62" y="-288.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="476.62" y="-224.95" font-family="Times,serif" font-size="14.00">Mercury</text></g>
    <g id="edge23" class="edge"><title>22->23</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="476.62" y="-160.95" font-family="Times,serif" font-size="14.00">Cougar</text></g>
    <g id="edge26" class="edge"><title>25->26</title></g> <g id="node30" class="node"><title>29</title>
    <text text-anchor="middle" x="370.5" y="-128.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge29" class="edge"><title>28->29</title></g> <g id="node32" class="node"><title>31</title>
    <text text-anchor="middle" x="370.5" y="-96.95" font-family="Times,serif" font-size="14.00">,car,</text></g>
    <g id="edge31" class="edge"><title>28->31</title></g> <g id="node33" class="node"><title>32</title>
    <text text-anchor="middle" x="370.5" y="-64.95" font-family="Times,serif" font-size="14.00"><company@30></text></g>
    <g id="edge32" class="edge"><title>28->32</title></g> <g id="node35" class="node"><title>34</title>
    <text text-anchor="middle" x="370.5" y="-32.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge34" class="edge"><title>28->34</title></g> <g id="node36"
    class="node"><title>35</title> <text text-anchor="middle" x="370.5" y="-0.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge35"
    class="edge"><title>28->35</title></g> <g id="node31" class="node"><title>30</title>
    <text text-anchor="middle" x="476.62" y="-128.95" font-family="Times,serif" font-size="14.00">1999</text></g>
    <g id="edge30" class="edge"><title>29->30</title></g> <g id="node34" class="node"><title>33</title>
    <text text-anchor="middle" x="476.62" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text></g>
    <g id="edge33" class="edge"><title>32->33</title></g> <g id="node37" class="node"><title>36</title>
    <text text-anchor="middle" x="476.62" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text></g>
    <g id="edge36" class="edge"><title>35->36</title></g></g></svg>
  id: totrans-529
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="508pt" height="598pt" viewBox="0.00 0.00 508.25 598.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 594.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="19.88"
    y="-256.95" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="123" y="-256.95"
    font-family="Times,serif" font-size="14.00"><inventory@22></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="247.12" y="-464.95" font-family="Times,serif" font-size="14.00"><vehicle@24></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="247.12" y="-288.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge14" class="edge"><title>1->14</title></g> <g id="node16"
    class="node"><title>15</title> <text text-anchor="middle" x="247.12" y="-256.95"
    font-family="Times,serif" font-size="14.00"><vehicle@24></text></g> <g id="edge15"
    class="edge"><title>1->15</title></g> <g id="node28" class="node"><title>27</title>
    <text text-anchor="middle" x="247.12" y="-224.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge27" class="edge"><title>1->27</title></g> <g id="node29"
    class="node"><title>28</title> <text text-anchor="middle" x="247.12" y="-80.95"
    font-family="Times,serif" font-size="14.00"><vehicle@24></text></g> <g id="edge28"
    class="edge"><title>1->28</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="370.5" y="-576.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="370.5" y="-544.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge5" class="edge"><title>2->5</title></g> <g id="node7"
    class="node"><title>6</title> <text text-anchor="middle" x="370.5" y="-512.95"
    font-family="Times,serif" font-size="14.00"><kind@30></text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="370.5" y="-480.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge8" class="edge"><title>2->8</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="370.5" y="-448.95"
    font-family="Times,serif" font-size="14.00"><company@30></text></g> <g id="edge9"
    class="edge"><title>2->9</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="370.5" y="-416.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge11" class="edge"><title>2->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="370.5" y="-384.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge12"
    class="edge"><title>2->12</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="476.62" y="-576.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="476.62" y="-512.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="476.62" y="-448.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="476.62" y="-384.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="370.5" y="-352.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="370.5" y="-320.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge18" class="edge"><title>15->18</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="370.5" y="-288.95"
    font-family="Times,serif" font-size="14.00"><kind@30></text></g> <g id="edge19"
    class="edge"><title>15->19</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="370.5" y="-256.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge21" class="edge"><title>15->21</title></g> <g id="node23"
    class="node"><title>22</title> <text text-anchor="middle" x="370.5" y="-224.95"
    font-family="Times,serif" font-size="14.00"><company@30></text></g> <g id="edge22"
    class="edge"><title>15->22</title></g> <g id="node25" class="node"><title>24</title>
    <text text-anchor="middle" x="370.5" y="-192.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge24" class="edge"><title>15->24</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="370.5" y="-160.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge25"
    class="edge"><title>15->25</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="476.62" y="-352.95" font-family="Times,serif" font-size="14.00">2000</text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="476.62" y="-288.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="476.62" y="-224.95" font-family="Times,serif" font-size="14.00">Mercury</text></g>
    <g id="edge23" class="edge"><title>22->23</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="476.62" y="-160.95" font-family="Times,serif" font-size="14.00">Cougar</text></g>
    <g id="edge26" class="edge"><title>25->26</title></g> <g id="node30" class="node"><title>29</title>
    <text text-anchor="middle" x="370.5" y="-128.95" font-family="Times,serif" font-size="14.00"><year@30></text></g>
    <g id="edge29" class="edge"><title>28->29</title></g> <g id="node32" class="node"><title>31</title>
    <text text-anchor="middle" x="370.5" y="-96.95" font-family="Times,serif" font-size="14.00">,car,</text></g>
    <g id="edge31" class="edge"><title>28->31</title></g> <g id="node33" class="node"><title>32</title>
    <text text-anchor="middle" x="370.5" y="-64.95" font-family="Times,serif" font-size="14.00"><company@30></text></g>
    <g id="edge32" class="edge"><title>28->32</title></g> <g id="node35" class="node"><title>34</title>
    <text text-anchor="middle" x="370.5" y="-32.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge34" class="edge"><title>28->34</title></g> <g id="node36"
    class="node"><title>35</title> <text text-anchor="middle" x="370.5" y="-0.95"
    font-family="Times,serif" font-size="14.00"><model@30></text></g> <g id="edge35"
    class="edge"><title>28->35</title></g> <g id="node31" class="node"><title>30</title>
    <text text-anchor="middle" x="476.62" y="-128.95" font-family="Times,serif" font-size="14.00">1999</text></g>
    <g id="edge30" class="edge"><title>29->30</title></g> <g id="node34" class="node"><title>33</title>
    <text text-anchor="middle" x="476.62" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text></g>
    <g id="edge33" class="edge"><title>32->33</title></g> <g id="node37" class="node"><title>36</title>
    <text text-anchor="middle" x="476.62" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text></g>
    <g id="edge36" class="edge"><title>35->36</title></g></g></svg>
- en: As can be seen, the derivation tree obtained is not quite what we expected.
    The issue is easily seen if we enable logging in the `TreeMiner`.
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: 如所示，我们获得的分析树并不完全符合我们的预期。如果我们启用`TreeMiner`的日志记录，问题就很容易被发现。
- en: '[PRE256]'
  id: totrans-531
  prefs: []
  type: TYPE_PRE
  zh: '[PRE256]'
- en: '[PRE257]'
  id: totrans-532
  prefs: []
  type: TYPE_PRE
  zh: '[PRE257]'
- en: Look at the last statement. We have a value `1999,car,` where only the `year`
    got replaced. We no longer have a `'car'` variable to continue the replacement
    here. This happens because the `'car'` value in `'1999,car,Chevy,Venture'` is
    not treated as a new value because the value `'car'` had occurred for `'vehicle'`
    variable in the exact same location for a *different* method call (for `'2000,car,Mercury,Cougar'`).
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: 看看最后一条语句。我们有一个值`1999,car,`，其中只有`year`被替换了。我们不再有`'car'`变量来继续这里的替换。这是因为`'1999,car,Chevy,Venture'`中的`'car'`值没有被当作新值处理，因为`'car'`值在另一个方法调用（`'2000,car,Mercury,Cougar'`）的相同位置已经出现过。
- en: A Grammar Miner with Scope
  id: totrans-534
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 带作用域的语法挖掘器
- en: We need to incorporate inspection of the variables in the current context. We
    already have a stack of method calls so that we can obtain the current method
    at any point. We need to do the same for variables.
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要将当前上下文中的变量检查纳入其中。我们已经有了一个方法调用栈，这样我们可以在任何时刻获取当前方法。我们需要对变量做同样的处理。
- en: For that, we extend the `CallStack` to a new class `InputStack` which holds
    the method invoked as well as the parameters observed. It is essentially the record
    of activation of the method. We start with the original input at the base of the
    stack, and for each new method-call, we push the parameters of that call into
    the stack as a new record.
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: 为了做到这一点，我们将`CallStack`扩展到新的类`InputStack`，该类保存了调用的方法以及观察到的参数。它本质上是对方法激活的记录。我们从栈底的原始输入开始，对于每个新的方法调用，我们将该调用的参数作为新记录推入栈中。
- en: Input Stack
  id: totrans-537
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 输入栈
- en: '[PRE258]'
  id: totrans-538
  prefs: []
  type: TYPE_PRE
  zh: '[PRE258]'
- en: In order to check if a particular variable be saved, we define `in_current_record()`
    which checks only the variables in the current scope for inclusion (rather than
    the original input string).
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查特定变量是否需要保存，我们定义了`in_current_record()`，它只检查当前作用域中的变量是否包含（而不是原始输入字符串）。
- en: '[PRE259]'
  id: totrans-540
  prefs: []
  type: TYPE_PRE
  zh: '[PRE259]'
- en: '[PRE260]'
  id: totrans-541
  prefs: []
  type: TYPE_PRE
  zh: '[PRE260]'
- en: '[PRE261]'
  id: totrans-542
  prefs: []
  type: TYPE_PRE
  zh: '[PRE261]'
- en: '[PRE262]'
  id: totrans-543
  prefs: []
  type: TYPE_PRE
  zh: '[PRE262]'
- en: '[PRE263]'
  id: totrans-544
  prefs: []
  type: TYPE_PRE
  zh: '[PRE263]'
- en: '[PRE264]'
  id: totrans-545
  prefs: []
  type: TYPE_PRE
  zh: '[PRE264]'
- en: '[PRE265]'
  id: totrans-546
  prefs: []
  type: TYPE_PRE
  zh: '[PRE265]'
- en: '[PRE266]'
  id: totrans-547
  prefs: []
  type: TYPE_PRE
  zh: '[PRE266]'
- en: '[PRE267]'
  id: totrans-548
  prefs: []
  type: TYPE_PRE
  zh: '[PRE267]'
- en: '[PRE268]'
  id: totrans-549
  prefs: []
  type: TYPE_PRE
  zh: '[PRE268]'
- en: '[PRE269]'
  id: totrans-550
  prefs: []
  type: TYPE_PRE
  zh: '[PRE269]'
- en: We define the method `ignored()` that returns true if either the variable is
    not a string, or the variable length is less than the defined `fragment_len`.
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一个`ignored()`方法，如果变量不是字符串，或者变量长度小于定义的`fragment_len`，则返回true。
- en: '[PRE270]'
  id: totrans-552
  prefs: []
  type: TYPE_PRE
  zh: '[PRE270]'
- en: '[PRE271]'
  id: totrans-553
  prefs: []
  type: TYPE_PRE
  zh: '[PRE271]'
- en: '[PRE272]'
  id: totrans-554
  prefs: []
  type: TYPE_PRE
  zh: '[PRE272]'
- en: '[PRE273]'
  id: totrans-555
  prefs: []
  type: TYPE_PRE
  zh: '[PRE273]'
- en: '[PRE274]'
  id: totrans-556
  prefs: []
  type: TYPE_PRE
  zh: '[PRE274]'
- en: '[PRE275]'
  id: totrans-557
  prefs: []
  type: TYPE_PRE
  zh: '[PRE275]'
- en: '[PRE276]'
  id: totrans-558
  prefs: []
  type: TYPE_PRE
  zh: '[PRE276]'
- en: We can now define the `in_scope()` method that checks whether the variable needs
    to be ignored, and if it is not to be ignored, whether the variable value is present
    in the current scope.
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以定义一个`in_scope()`方法，该方法检查变量是否需要被忽略，如果不忽略，则检查变量值是否存在于当前作用域中。
- en: '[PRE277]'
  id: totrans-560
  prefs: []
  type: TYPE_PRE
  zh: '[PRE277]'
- en: Finally, we update `enter()` that pushes relevant variables in the current context
    to the stack.
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们更新`enter()`，将当前上下文中的相关变量推送到栈中。
- en: '[PRE278]'
  id: totrans-562
  prefs: []
  type: TYPE_PRE
  zh: '[PRE278]'
- en: When a method returns, we also need a corresponding `leave()` to pop out the
    inputs and unwind the stack.
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: 当一个方法返回时，我们还需要一个相应的`leave()`来弹出输入并展开栈。
- en: '[PRE279]'
  id: totrans-564
  prefs: []
  type: TYPE_PRE
  zh: '[PRE279]'
- en: ScopedVars
  id: totrans-565
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ScopedVars
- en: We need to update our `AssignmentVars` to include information about which scope
    the variable was defined in. We start by updating `method_init()`.
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要更新我们的`AssignmentVars`，包括变量定义的作用域信息。我们首先从更新`method_init()`开始。
- en: '[PRE280]'
  id: totrans-567
  prefs: []
  type: TYPE_PRE
  zh: '[PRE280]'
- en: Similarly, the `method_enter()` now initializes the `accessed_seq_var` for the
    current method call.
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，`method_enter()`现在初始化当前方法调用的`accessed_seq_var`。
- en: '[PRE281]'
  id: totrans-569
  prefs: []
  type: TYPE_PRE
  zh: '[PRE281]'
- en: The `update()` method now saves the context in which the value is defined. In
    the case of a parameter to a function, the context should be the context in which
    the function was called. On the other hand, a value defined during a statement
    execution would have the current context.
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: '`update()`方法现在保存定义值的上下文。在函数参数的情况下，上下文应该是函数被调用的上下文。另一方面，在语句执行期间定义的值将具有当前上下文。'
- en: Further, we annotate on value rather than key because we do not want to duplicate
    variables when parameters are in context in the next line. They will have same
    value, but different context because they are present in a statement execution.
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们在值上而不是在键上做注释，因为我们不希望在下一行参数上下文中重复变量。它们将具有相同的值，但不同的上下文，因为它们存在于语句执行中。
- en: '[PRE282]'
  id: totrans-572
  prefs: []
  type: TYPE_PRE
  zh: '[PRE282]'
- en: We also need to save the current method invocation to determine which variables
    are in scope. This information is now incorporated in the variable name as `accessed_seq_var[method_id][var]`.
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要保存当前方法调用以确定哪些变量在作用域中。现在，这个信息被纳入变量名作为`accessed_seq_var[method_id][var]`。
- en: '[PRE283]'
  id: totrans-574
  prefs: []
  type: TYPE_PRE
  zh: '[PRE283]'
- en: As before, `var_access` simply initializes the corresponding counter, this time
    in the context of `method_id`.
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，`var_access`简单地初始化相应的计数器，这次是在`method_id`的上下文中。
- en: '[PRE284]'
  id: totrans-576
  prefs: []
  type: TYPE_PRE
  zh: '[PRE284]'
- en: During a variable reassignment, we update the `accessed_seq_var` to reflect
    the new count.
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 在变量重新赋值期间，我们更新`accessed_seq_var`以反映新的计数。
- en: '[PRE285]'
  id: totrans-578
  prefs: []
  type: TYPE_PRE
  zh: '[PRE285]'
- en: We now update `defined_vars()` to account for the new information.
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在更新`defined_vars()`以考虑新的信息。
- en: '[PRE286]'
  id: totrans-580
  prefs: []
  type: TYPE_PRE
  zh: '[PRE286]'
- en: Updating `seq_vars()` to account for new information.
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 更新`seq_vars()`以考虑新的信息。
- en: '[PRE287]'
  id: totrans-582
  prefs: []
  type: TYPE_PRE
  zh: '[PRE287]'
- en: Scope Tracker
  id: totrans-583
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 作用域跟踪器
- en: With the `InputStack` and `Vars` defined, we can now define the `ScopeTracker`.
    The `ScopeTracker` only saves variables if the value is present in the current
    scope.
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义了`InputStack`和`Vars`之后，我们现在可以定义`ScopeTracker`。`ScopeTracker`只保存当前作用域中存在的变量。
- en: '[PRE288]'
  id: totrans-585
  prefs: []
  type: TYPE_PRE
  zh: '[PRE288]'
- en: We define a wrapper for checking whether a variable is present in the scope.
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一个检查变量是否存在于作用域中的包装器。
- en: '[PRE289]'
  id: totrans-587
  prefs: []
  type: TYPE_PRE
  zh: '[PRE289]'
- en: We can use the `ScopeTracker` as follows.
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以这样使用`ScopeTracker`。
- en: '[PRE290]'
  id: totrans-589
  prefs: []
  type: TYPE_PRE
  zh: '[PRE290]'
- en: '[PRE291]'
  id: totrans-590
  prefs: []
  type: TYPE_PRE
  zh: '[PRE291]'
- en: Recovering a Derivation Tree
  id: totrans-591
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 恢复推导树
- en: The main difference in `apply_new_definition()` is that we add a second condition
    that checks for scope. In particular, variables are only allowed to replace portions
    of string fragments that were in scope. The variable scope is indicated by `scope`.
    However, merely accounting for scope is not sufficient. For example, consider
    the fragment below.
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: 在`apply_new_definition()`中的主要区别是，我们添加了一个第二个条件来检查作用域。特别是，变量只能替换作用域中存在的字符串片段的部分。变量作用域由`scope`指示。然而，仅仅考虑作用域是不够的。例如，考虑下面的片段。
- en: '[PRE292]'
  id: totrans-593
  prefs: []
  type: TYPE_PRE
  zh: '[PRE292]'
- en: Here, `v1` and `v2` get their values from a previous function call. Not from
    their current context. That is, we have to provide an exception for cases where
    an internal child method call may have generated a large fragment as we showed
    above. To account for that, we define `mseq()` that retrieves the method call
    sequence. In the above case, the `mseq()` of the internal child method call would
    be larger than the current `mseq()`. If so, we allow the replacement to proceed.
  id: totrans-594
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`v1`和`v2`从先前的函数调用中获取它们的值，而不是从它们当前上下文中获取。也就是说，我们必须为内部子方法调用可能生成的大片段的情况提供异常。为了考虑这一点，我们定义了`mseq()`，它检索方法调用序列。在上面的情况下，内部子方法调用的`mseq()`将大于当前的`mseq()`。如果是这样，我们允许替换进行。
- en: '[PRE293]'
  id: totrans-595
  prefs: []
  type: TYPE_PRE
  zh: '[PRE293]'
- en: The `nt_var()` method needs to take the tuple and generate a non-terminal symbol
    out of it. We skip the method sequence because it is not relevant for the grammar.
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: '`nt_var()`方法需要接受元组并从中生成一个非终结符号。我们跳过方法序列，因为它与语法无关。'
- en: '[PRE294]'
  id: totrans-597
  prefs: []
  type: TYPE_PRE
  zh: '[PRE294]'
- en: We now redefine the `apply_new_definition()` to account for context and scope.
    In particular, a variable is allowed to replace a part of a value only if the
    variable is in *scope* -- that is, it's scope (method sequence number of either
    its calling context in case it is a parameter or the current context in case it
    is a statement) is same as that of the value's method sequence number. An exception
    is made when the value's method sequence number is greater than the variable's
    method sequence number. In that case, the value may have come from an internal
    call. We allow the replacement to proceed in that case.
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在重新定义`apply_new_definition()`以考虑上下文和作用域。特别是，只有当变量在*作用域*内时，变量才能替换值的一部分 --
    即，它的作用域（方法序列号）与值的序列号相同，无论是作为参数的调用上下文还是当前上下文。当值的序列号大于变量的序列号时，会做出例外。在这种情况下，值可能来自内部调用。在这种情况下，我们允许替换继续进行。
- en: '[PRE295]'
  id: totrans-599
  prefs: []
  type: TYPE_PRE
  zh: '[PRE295]'
- en: The `apply_new_definition()` is now modified to carry additional contextual
    information `mseq`.
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: '`apply_new_definition()`现在被修改为携带额外的上下文信息`mseq`。'
- en: '[PRE296]'
  id: totrans-601
  prefs: []
  type: TYPE_PRE
  zh: '[PRE296]'
- en: We also modify `get_derivation_tree()` so that the initial node carries the
    context.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也修改了`get_derivation_tree()`，使得初始节点携带上下文。
- en: '[PRE297]'
  id: totrans-603
  prefs: []
  type: TYPE_PRE
  zh: '[PRE297]'
- en: 'Example 1: Recovering URL Parse Tree'
  id: totrans-604
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例 1：恢复URL解析树
- en: We verify that our URL parse tree recovery still works as expected.
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: 我们验证我们的URL解析树恢复仍然按预期工作。
- en: '[PRE298]'
  id: totrans-606
  prefs: []
  type: TYPE_PRE
  zh: '[PRE298]'
- en: '[PRE299]'
  id: totrans-607
  prefs: []
  type: TYPE_PRE
  zh: '[PRE299]'
- en: 'Example 2: Recovering Inventory Parse Tree'
  id: totrans-608
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例 2：恢复库存解析树
- en: Next, we look at recovering the parse tree from `process_inventory()` which
    failed last time.
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们看看如何从上次失败的`process_inventory()`中恢复解析树。
- en: '[PRE300]'
  id: totrans-610
  prefs: []
  type: TYPE_PRE
  zh: '[PRE300]'
- en: '[PRE301]'
  id: totrans-611
  prefs: []
  type: TYPE_PRE
  zh: '[PRE301]'
- en: <svg width="1852pt" height="662pt" viewBox="0.00 0.00 1851.50 662.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 658.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="19.88"
    y="-320.95" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="174.38"
    y="-320.95" font-family="Times,serif" font-size="14.00"><process_inventory@22:inventory></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="407.62" y="-320.95" font-family="Times,serif" font-size="14.00"><process_inventory@22:inventory></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="634.5" y="-432.95" font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="634.5" y="-352.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge23" class="edge"><title>2->23</title></g> <g id="node25"
    class="node"><title>24</title> <text text-anchor="middle" x="634.5" y="-320.95"
    font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge24" class="edge"><title>2->24</title></g> <g id="node45" class="node"><title>44</title>
    <text text-anchor="middle" x="634.5" y="-288.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge44" class="edge"><title>2->44</title></g> <g id="node46"
    class="node"><title>45</title> <text text-anchor="middle" x="634.5" y="-216.95"
    font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge45" class="edge"><title>2->45</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="848.62" y="-464.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="1056.38" y="-528.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="1269.75" y="-640.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="1269.75" y="-608.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>5->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="1269.75" y="-576.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge11" class="edge"><title>5->11</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="1269.75" y="-544.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge13" class="edge"><title>5->13</title></g> <g id="node15"
    class="node"><title>14</title> <text text-anchor="middle" x="1269.75" y="-512.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge14" class="edge"><title>5->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="1269.75" y="-480.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge18" class="edge"><title>5->18</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="1269.75" y="-448.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge19" class="edge"><title>5->19</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="1479" y="-640.95" font-family="Times,serif" font-size="14.00"><process_van@40:year></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="1678.5" y="-640.95" font-family="Times,serif" font-size="14.00"><process_van@40:year></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="1819.88" y="-640.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="1479" y="-576.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="1479" y="-512.95" font-family="Times,serif" font-size="14.00"><process_van@40:company></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="1678.5" y="-512.95" font-family="Times,serif" font-size="14.00"><process_van@40:company></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="1819.88" y="-512.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="1479" y="-448.95" font-family="Times,serif" font-size="14.00"><process_van@40:model></text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="1678.5" y="-448.95" font-family="Times,serif" font-size="14.00"><process_van@40:model></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="1819.88" y="-448.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node26" class="node"><title>25</title>
    <text text-anchor="middle" x="848.62" y="-320.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge25" class="edge"><title>24->25</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="1056.38" y="-320.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge26" class="edge"><title>25->26</title></g> <g id="node28" class="node"><title>27</title>
    <text text-anchor="middle" x="1269.75" y="-416.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge27" class="edge"><title>26->27</title></g> <g id="node32" class="node"><title>31</title>
    <text text-anchor="middle" x="1269.75" y="-384.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge31" class="edge"><title>26->31</title></g> <g id="node33"
    class="node"><title>32</title> <text text-anchor="middle" x="1269.75" y="-352.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge32" class="edge"><title>26->32</title></g> <g id="node35" class="node"><title>34</title>
    <text text-anchor="middle" x="1269.75" y="-320.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge34" class="edge"><title>26->34</title></g> <g id="node36"
    class="node"><title>35</title> <text text-anchor="middle" x="1269.75" y="-288.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge35" class="edge"><title>26->35</title></g> <g id="node40" class="node"><title>39</title>
    <text text-anchor="middle" x="1269.75" y="-256.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge39" class="edge"><title>26->39</title></g> <g id="node41"
    class="node"><title>40</title> <text text-anchor="middle" x="1269.75" y="-224.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge40" class="edge"><title>26->40</title></g> <g id="node29" class="node"><title>28</title>
    <text text-anchor="middle" x="1479" y="-416.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge28" class="edge"><title>27->28</title></g> <g id="node30" class="node"><title>29</title>
    <text text-anchor="middle" x="1678.5" y="-416.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge29" class="edge"><title>28->29</title></g> <g id="node31" class="node"><title>30</title>
    <text text-anchor="middle" x="1819.88" y="-416.95" font-family="Times,serif" font-size="14.00">2000</text></g>
    <g id="edge30" class="edge"><title>29->30</title></g> <g id="node34" class="node"><title>33</title>
    <text text-anchor="middle" x="1479" y="-352.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge33" class="edge"><title>32->33</title></g> <g id="node37" class="node"><title>36</title>
    <text text-anchor="middle" x="1479" y="-288.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge36" class="edge"><title>35->36</title></g> <g id="node38" class="node"><title>37</title>
    <text text-anchor="middle" x="1678.5" y="-288.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge37" class="edge"><title>36->37</title></g> <g id="node39" class="node"><title>38</title>
    <text text-anchor="middle" x="1819.88" y="-288.95" font-family="Times,serif" font-size="14.00">Mercury</text></g>
    <g id="edge38" class="edge"><title>37->38</title></g> <g id="node42" class="node"><title>41</title>
    <text text-anchor="middle" x="1479" y="-224.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge41" class="edge"><title>40->41</title></g> <g id="node43" class="node"><title>42</title>
    <text text-anchor="middle" x="1678.5" y="-224.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge42" class="edge"><title>41->42</title></g> <g id="node44" class="node"><title>43</title>
    <text text-anchor="middle" x="1819.88" y="-224.95" font-family="Times,serif" font-size="14.00">Cougar</text></g>
    <g id="edge43" class="edge"><title>42->43</title></g> <g id="node47" class="node"><title>46</title>
    <text text-anchor="middle" x="848.62" y="-136.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge46" class="edge"><title>45->46</title></g> <g id="node48" class="node"><title>47</title>
    <text text-anchor="middle" x="1056.38" y="-112.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge47" class="edge"><title>46->47</title></g> <g id="node49" class="node"><title>48</title>
    <text text-anchor="middle" x="1269.75" y="-192.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge48" class="edge"><title>47->48</title></g> <g id="node53" class="node"><title>52</title>
    <text text-anchor="middle" x="1269.75" y="-160.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge52" class="edge"><title>47->52</title></g> <g id="node54"
    class="node"><title>53</title> <text text-anchor="middle" x="1269.75" y="-128.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge53" class="edge"><title>47->53</title></g> <g id="node56" class="node"><title>55</title>
    <text text-anchor="middle" x="1269.75" y="-96.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge55" class="edge"><title>47->55</title></g> <g id="node57"
    class="node"><title>56</title> <text text-anchor="middle" x="1269.75" y="-64.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge56" class="edge"><title>47->56</title></g> <g id="node61" class="node"><title>60</title>
    <text text-anchor="middle" x="1269.75" y="-32.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge60" class="edge"><title>47->60</title></g> <g id="node62"
    class="node"><title>61</title> <text text-anchor="middle" x="1269.75" y="-0.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge61" class="edge"><title>47->61</title></g> <g id="node50" class="node"><title>49</title>
    <text text-anchor="middle" x="1479" y="-192.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge49" class="edge"><title>48->49</title></g> <g id="node51" class="node"><title>50</title>
    <text text-anchor="middle" x="1678.5" y="-192.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge50" class="edge"><title>49->50</title></g> <g id="node52" class="node"><title>51</title>
    <text text-anchor="middle" x="1819.88" y="-192.95" font-family="Times,serif" font-size="14.00">1999</text></g>
    <g id="edge51" class="edge"><title>50->51</title></g> <g id="node55" class="node"><title>54</title>
    <text text-anchor="middle" x="1479" y="-128.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge54" class="edge"><title>53->54</title></g> <g id="node58" class="node"><title>57</title>
    <text text-anchor="middle" x="1479" y="-64.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge57" class="edge"><title>56->57</title></g> <g id="node59" class="node"><title>58</title>
    <text text-anchor="middle" x="1678.5" y="-64.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge58" class="edge"><title>57->58</title></g> <g id="node60" class="node"><title>59</title>
    <text text-anchor="middle" x="1819.88" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text></g>
    <g id="edge59" class="edge"><title>58->59</title></g> <g id="node63" class="node"><title>62</title>
    <text text-anchor="middle" x="1479" y="-0.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge62" class="edge"><title>61->62</title></g> <g id="node64" class="node"><title>63</title>
    <text text-anchor="middle" x="1678.5" y="-0.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge63" class="edge"><title>62->63</title></g> <g id="node65" class="node"><title>64</title>
    <text text-anchor="middle" x="1819.88" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text></g>
    <g id="edge64" class="edge"><title>63->64</title></g></g></svg>
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="1852pt" height="662pt" viewBox="0.00 0.00 1851.50 662.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 658.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="19.88"
    y="-320.95" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="174.38"
    y="-320.95" font-family="Times,serif" font-size="14.00"><process_inventory@22:inventory></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="407.62" y="-320.95" font-family="Times,serif" font-size="14.00"><process_inventory@22:inventory></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="634.5" y="-432.95" font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="634.5" y="-352.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge23" class="edge"><title>2->23</title></g> <g id="node25"
    class="node"><title>24</title> <text text-anchor="middle" x="634.5" y="-320.95"
    font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge24" class="edge"><title>2->24</title></g> <g id="node45" class="node"><title>44</title>
    <text text-anchor="middle" x="634.5" y="-288.95" font-family="Times,serif" font-size="14.00">\n
    (10)</text></g> <g id="edge44" class="edge"><title>2->44</title></g> <g id="node46"
    class="node"><title>45</title> <text text-anchor="middle" x="634.5" y="-216.95"
    font-family="Times,serif" font-size="14.00"><process_inventory@24:vehicle></text></g>
    <g id="edge45" class="edge"><title>2->45</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="848.62" y="-464.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="1056.38" y="-528.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="1269.75" y="-640.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="1269.75" y="-608.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge10" class="edge"><title>5->10</title></g> <g id="node12"
    class="node"><title>11</title> <text text-anchor="middle" x="1269.75" y="-576.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge11" class="edge"><title>5->11</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="1269.75" y="-544.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge13" class="edge"><title>5->13</title></g> <g id="node15"
    class="node"><title>14</title> <text text-anchor="middle" x="1269.75" y="-512.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge14" class="edge"><title>5->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="1269.75" y="-480.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge18" class="edge"><title>5->18</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="1269.75" y="-448.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge19" class="edge"><title>5->19</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="1479" y="-640.95" font-family="Times,serif" font-size="14.00"><process_van@40:year></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="1678.5" y="-640.95" font-family="Times,serif" font-size="14.00"><process_van@40:year></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="1819.88" y="-640.95" font-family="Times,serif" font-size="14.00">1997</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="1479" y="-576.95" font-family="Times,serif" font-size="14.00">van</text></g>
    <g id="edge12" class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="1479" y="-512.95" font-family="Times,serif" font-size="14.00"><process_van@40:company></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="1678.5" y="-512.95" font-family="Times,serif" font-size="14.00"><process_van@40:company></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="1819.88" y="-512.95" font-family="Times,serif" font-size="14.00">Ford</text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="1479" y="-448.95" font-family="Times,serif" font-size="14.00"><process_van@40:model></text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="1678.5" y="-448.95" font-family="Times,serif" font-size="14.00"><process_van@40:model></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="1819.88" y="-448.95" font-family="Times,serif" font-size="14.00">E350</text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node26" class="node"><title>25</title>
    <text text-anchor="middle" x="848.62" y="-320.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge25" class="edge"><title>24->25</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="1056.38" y="-320.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge26" class="edge"><title>25->26</title></g> <g id="node28" class="node"><title>27</title>
    <text text-anchor="middle" x="1269.75" y="-416.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge27" class="edge"><title>26->27</title></g> <g id="node32" class="node"><title>31</title>
    <text text-anchor="middle" x="1269.75" y="-384.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge31" class="edge"><title>26->31</title></g> <g id="node33"
    class="node"><title>32</title> <text text-anchor="middle" x="1269.75" y="-352.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge32" class="edge"><title>26->32</title></g> <g id="node35" class="node"><title>34</title>
    <text text-anchor="middle" x="1269.75" y="-320.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge34" class="edge"><title>26->34</title></g> <g id="node36"
    class="node"><title>35</title> <text text-anchor="middle" x="1269.75" y="-288.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge35" class="edge"><title>26->35</title></g> <g id="node40" class="node"><title>39</title>
    <text text-anchor="middle" x="1269.75" y="-256.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge39" class="edge"><title>26->39</title></g> <g id="node41"
    class="node"><title>40</title> <text text-anchor="middle" x="1269.75" y="-224.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge40" class="edge"><title>26->40</title></g> <g id="node29" class="node"><title>28</title>
    <text text-anchor="middle" x="1479" y="-416.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge28" class="edge"><title>27->28</title></g> <g id="node30" class="node"><title>29</title>
    <text text-anchor="middle" x="1678.5" y="-416.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge29" class="edge"><title>28->29</title></g> <g id="node31" class="node"><title>30</title>
    <text text-anchor="middle" x="1819.88" y="-416.95" font-family="Times,serif" font-size="14.00">2000</text></g>
    <g id="edge30" class="edge"><title>29->30</title></g> <g id="node34" class="node"><title>33</title>
    <text text-anchor="middle" x="1479" y="-352.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge33" class="edge"><title>32->33</title></g> <g id="node37" class="node"><title>36</title>
    <text text-anchor="middle" x="1479" y="-288.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge36" class="edge"><title>35->36</title></g> <g id="node38" class="node"><title>37</title>
    <text text-anchor="middle" x="1678.5" y="-288.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge37" class="edge"><title>36->37</title></g> <g id="node39" class="node"><title>38</title>
    <text text-anchor="middle" x="1819.88" y="-288.95" font-family="Times,serif" font-size="14.00">Mercury</text></g>
    <g id="edge38" class="edge"><title>37->38</title></g> <g id="node42" class="node"><title>41</title>
    <text text-anchor="middle" x="1479" y="-224.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge41" class="edge"><title>40->41</title></g> <g id="node43" class="node"><title>42</title>
    <text text-anchor="middle" x="1678.5" y="-224.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge42" class="edge"><title>41->42</title></g> <g id="node44" class="node"><title>43</title>
    <text text-anchor="middle" x="1819.88" y="-224.95" font-family="Times,serif" font-size="14.00">Cougar</text></g>
    <g id="edge43" class="edge"><title>42->43</title></g> <g id="node47" class="node"><title>46</title>
    <text text-anchor="middle" x="848.62" y="-136.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge46" class="edge"><title>45->46</title></g> <g id="node48" class="node"><title>47</title>
    <text text-anchor="middle" x="1056.38" y="-112.95" font-family="Times,serif" font-size="14.00"><process_vehicle@29:vehicle></text></g>
    <g id="edge47" class="edge"><title>46->47</title></g> <g id="node49" class="node"><title>48</title>
    <text text-anchor="middle" x="1269.75" y="-192.95" font-family="Times,serif" font-size="14.00"><process_vehicle@30:year></text></g>
    <g id="edge48" class="edge"><title>47->48</title></g> <g id="node53" class="node"><title>52</title>
    <text text-anchor="middle" x="1269.75" y="-160.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge52" class="edge"><title>47->52</title></g> <g id="node54"
    class="node"><title>53</title> <text text-anchor="middle" x="1269.75" y="-128.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:kind></text></g>
    <g id="edge53" class="edge"><title>47->53</title></g> <g id="node56" class="node"><title>55</title>
    <text text-anchor="middle" x="1269.75" y="-96.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge55" class="edge"><title>47->55</title></g> <g id="node57"
    class="node"><title>56</title> <text text-anchor="middle" x="1269.75" y="-64.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:company></text></g>
    <g id="edge56" class="edge"><title>47->56</title></g> <g id="node61" class="node"><title>60</title>
    <text text-anchor="middle" x="1269.75" y="-32.95" font-family="Times,serif" font-size="14.00">,
    (44)</text></g> <g id="edge60" class="edge"><title>47->60</title></g> <g id="node62"
    class="node"><title>61</title> <text text-anchor="middle" x="1269.75" y="-0.95"
    font-family="Times,serif" font-size="14.00"><process_vehicle@30:model></text></g>
    <g id="edge61" class="edge"><title>47->61</title></g> <g id="node50" class="node"><title>49</title>
    <text text-anchor="middle" x="1479" y="-192.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge49" class="edge"><title>48->49</title></g> <g id="node51" class="node"><title>50</title>
    <text text-anchor="middle" x="1678.5" y="-192.95" font-family="Times,serif" font-size="14.00"><process_car@49:year></text></g>
    <g id="edge50" class="edge"><title>49->50</title></g> <g id="node52" class="node"><title>51</title>
    <text text-anchor="middle" x="1819.88" y="-192.95" font-family="Times,serif" font-size="14.00">1999</text></g>
    <g id="edge51" class="edge"><title>50->51</title></g> <g id="node55" class="node"><title>54</title>
    <text text-anchor="middle" x="1479" y="-128.95" font-family="Times,serif" font-size="14.00">car</text></g>
    <g id="edge54" class="edge"><title>53->54</title></g> <g id="node58" class="node"><title>57</title>
    <text text-anchor="middle" x="1479" y="-64.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge57" class="edge"><title>56->57</title></g> <g id="node59" class="node"><title>58</title>
    <text text-anchor="middle" x="1678.5" y="-64.95" font-family="Times,serif" font-size="14.00"><process_car@49:company></text></g>
    <g id="edge58" class="edge"><title>57->58</title></g> <g id="node60" class="node"><title>59</title>
    <text text-anchor="middle" x="1819.88" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text></g>
    <g id="edge59" class="edge"><title>58->59</title></g> <g id="node63" class="node"><title>62</title>
    <text text-anchor="middle" x="1479" y="-0.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge62" class="edge"><title>61->62</title></g> <g id="node64" class="node"><title>63</title>
    <text text-anchor="middle" x="1678.5" y="-0.95" font-family="Times,serif" font-size="14.00"><process_car@49:model></text></g>
    <g id="edge63" class="edge"><title>62->63</title></g> <g id="node65" class="node"><title>64</title>
    <text text-anchor="middle" x="1819.88" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text></g>
    <g id="edge64" class="edge"><title>63->64</title></g></g></svg>
- en: The recovered parse tree seems reasonable.
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复的解析树看起来是合理的。
- en: One of the things that one might notice from our Example (2) is that the three
    subtrees -- `vehicle[2:1]`, `vehicle[4:1]` and `vehicle[6:1]` are quite alike.
    We will examine how this can be exploited to generate a grammar directly, next.
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们的示例（2）中，人们可能会注意到三个子树 -- `vehicle[2:1]`、`vehicle[4:1]`和`vehicle[6:1]`非常相似。我们将探讨如何利用这一点直接生成语法。
- en: Grammar Mining
  id: totrans-615
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 语法挖掘
- en: The `tree_to_grammar()` is now redefined as follows, to account for the extra
    scope in nodes.
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: '`tree_to_grammar()`现在重新定义为如下，以考虑节点中的额外作用域。'
- en: '[PRE302]'
  id: totrans-617
  prefs: []
  type: TYPE_PRE
  zh: '[PRE302]'
- en: The grammar is in canonical form, which needs to be massaged to display. First,
    the recovered grammar for inventory.
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
  zh: 语法是规范形式，需要调整以显示。首先，恢复的库存语法。
- en: '[PRE303]'
  id: totrans-619
  prefs: []
  type: TYPE_PRE
  zh: '[PRE303]'
- en: '[PRE304]'
  id: totrans-620
  prefs: []
  type: TYPE_PRE
  zh: '[PRE304]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
- en: '[PRE305]'
  id: totrans-622
  prefs: []
  type: TYPE_PRE
  zh: '[PRE305]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 1031.0 62" width="1031.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="189.0" y="35">process_inventory@24:vehicle</text></g><g
    class="non-terminal"><text x="515.5" y="35">process_inventory@24:vehicle</text></g><g
    class="non-terminal"><text x="842.0" y="35">process_inventory@24:vehicle</text></g></g></g></g></svg>
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 1031.0 62" width="1031.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="189.0" y="35">process_inventory@24:vehicle</text></g><g
    class="non-terminal"><text x="515.5" y="35">process_inventory@24:vehicle</text></g><g
    class="non-terminal"><text x="842.0" y="35">process_inventory@24:vehicle</text></g></g></g></g></svg>
- en: '[PRE306]'
  id: totrans-624
  prefs: []
  type: TYPE_PRE
  zh: '[PRE306]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 361.0 62" width="361.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 361.0 62" width="361.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
- en: '[PRE307]'
  id: totrans-626
  prefs: []
  type: TYPE_PRE
  zh: '[PRE307]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
- en: '[PRE308]'
  id: totrans-628
  prefs: []
  type: TYPE_PRE
  zh: '[PRE308]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
- en: '[PRE309]'
  id: totrans-630
  prefs: []
  type: TYPE_PRE
  zh: '[PRE309]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
- en: '[PRE310]'
  id: totrans-632
  prefs: []
  type: TYPE_PRE
  zh: '[PRE310]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-633
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE311]'
  id: totrans-634
  prefs: []
  type: TYPE_PRE
  zh: '[PRE311]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
- en: '[PRE312]'
  id: totrans-636
  prefs: []
  type: TYPE_PRE
  zh: '[PRE312]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
- en: '[PRE313]'
  id: totrans-638
  prefs: []
  type: TYPE_PRE
  zh: '[PRE313]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
- en: '[PRE314]'
  id: totrans-640
  prefs: []
  type: TYPE_PRE
  zh: '[PRE314]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
- en: '[PRE315]'
  id: totrans-642
  prefs: []
  type: TYPE_PRE
  zh: '[PRE315]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
- en: '[PRE316]'
  id: totrans-644
  prefs: []
  type: TYPE_PRE
  zh: '[PRE316]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
- en: '[PRE317]'
  id: totrans-646
  prefs: []
  type: TYPE_PRE
  zh: '[PRE317]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
- en: The recovered grammar for URLs.
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复的URL语法。
- en: '[PRE318]'
  id: totrans-649
  prefs: []
  type: TYPE_PRE
  zh: '[PRE318]'
- en: '[PRE319]'
  id: totrans-650
  prefs: []
  type: TYPE_PRE
  zh: '[PRE319]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlparse@374:url</text></g></g></g></g></svg>
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlparse@374:url</text></g></g></g></g></svg>
- en: '[PRE320]'
  id: totrans-652
  prefs: []
  type: TYPE_PRE
  zh: '[PRE320]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
- en: '[PRE321]'
  id: totrans-654
  prefs: []
  type: TYPE_PRE
  zh: '[PRE321]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 526.0 62" width="526.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlsplit@492:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="388.0" y="35">urlsplit@492:url</text></g></g></g></g></svg>
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 526.0 62" width="526.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlsplit@492:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="388.0" y="35">urlsplit@492:url</text></g></g></g></g></svg>
- en: '[PRE322]'
  id: totrans-656
  prefs: []
  type: TYPE_PRE
  zh: '[PRE322]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 301.5 62" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g></g></g></g></svg>
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 301.5 62" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g></g></g></g></svg>
- en: '[PRE323]'
  id: totrans-658
  prefs: []
  type: TYPE_PRE
  zh: '[PRE323]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
- en: '[PRE324]'
  id: totrans-660
  prefs: []
  type: TYPE_PRE
  zh: '[PRE324]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 310.0 62" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 310.0 62" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
- en: '[PRE325]'
  id: totrans-662
  prefs: []
  type: TYPE_PRE
  zh: '[PRE325]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">//</text></g>
    <g class="non-terminal"><text x="207.75" y="35">urlsplit@494:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="35">urlsplit@494:url</text></g></g>
    <g><g class="terminal"><text x="142.25" y="65">//</text></g> <g class="non-terminal"><text
    x="271.5" y="65">urlsplit@494:netloc</text></g> <g class="terminal"><text x="396.5"
    y="65">/</text></g></g></g></g></svg>
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">//</text></g>
    <g class="non-terminal"><text x="207.75" y="35">urlsplit@494:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="35">urlsplit@494:url</text></g></g>
    <g><g class="terminal"><text x="142.25" y="65">//</text></g> <g class="non-terminal"><text
    x="271.5" y="65">urlsplit@494:netloc</text></g> <g class="terminal"><text x="396.5"
    y="65">/</text></g></g></g></g></svg>
- en: '[PRE326]'
  id: totrans-664
  prefs: []
  type: TYPE_PRE
  zh: '[PRE326]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 335.5 62" width="335.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">_checknetloc@421:netloc</text></g></g></g></g></svg>
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 335.5 62" width="335.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">_checknetloc@421:netloc</text></g></g></g></g></svg>
- en: '[PRE327]'
  id: totrans-666
  prefs: []
  type: TYPE_PRE
  zh: '[PRE327]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 301.5 62" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:netloc</text></g></g></g></g></svg>
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 301.5 62" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:netloc</text></g></g></g></g></svg>
- en: '[PRE328]'
  id: totrans-668
  prefs: []
  type: TYPE_PRE
  zh: '[PRE328]'
- en: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE329]'
  id: totrans-670
  prefs: []
  type: TYPE_PRE
  zh: '[PRE329]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 543.0 122" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="271.5" y="35">urlparse@396:url</text></g></g>
    <g><g class="non-terminal"><text x="138.0" y="65">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="65">#</text></g> <g class="non-terminal"><text
    x="383.75" y="65">urlsplit@502:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="95">/#</text></g> <g class="non-terminal"><text x="300.0" y="95">urlsplit@502:fragment</text></g></g></g></g></svg>
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 543.0 122" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="271.5" y="35">urlparse@396:url</text></g></g>
    <g><g class="non-terminal"><text x="138.0" y="65">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="65">#</text></g> <g class="non-terminal"><text
    x="383.75" y="65">urlsplit@502:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="95">/#</text></g> <g class="non-terminal"><text x="300.0" y="95">urlsplit@502:fragment</text></g></g></g></g></svg>
- en: '[PRE330]'
  id: totrans-672
  prefs: []
  type: TYPE_PRE
  zh: '[PRE330]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlsplit@504:query</text></g></g></g></g></svg>
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlsplit@504:query</text></g></g></g></g></svg>
- en: '[PRE331]'
  id: totrans-674
  prefs: []
  type: TYPE_PRE
  zh: '[PRE331]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 293.0 62" width="293.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="146.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
  id: totrans-675
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 293.0 62" width="293.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="146.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
- en: '[PRE332]'
  id: totrans-676
  prefs: []
  type: TYPE_PRE
  zh: '[PRE332]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE333]'
  id: totrans-678
  prefs: []
  type: TYPE_PRE
  zh: '[PRE333]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 318.5 62" width="318.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="159.25" y="35">urlparse@396:fragment</text></g></g></g></g></svg>
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 318.5 62" width="318.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="159.25" y="35">urlparse@396:fragment</text></g></g></g></g></svg>
- en: '[PRE334]'
  id: totrans-680
  prefs: []
  type: TYPE_PRE
  zh: '[PRE334]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: '[PRE335]'
  id: totrans-682
  prefs: []
  type: TYPE_PRE
  zh: '[PRE335]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
- en: One might notice that the grammar is not entirely human-readable, with a number
    of single token definitions.
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: 人们可能会注意到语法并非完全可读，有许多单标记定义。
- en: Hence, the last piece of the puzzle is the cleanup method `clean_grammar()`,
    which cleans up such definitions. The idea is to look for single token definitions
    such that a key is defined exactly by another key (single alternative, single
    token, nonterminal).
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，最后一部分拼图是清理方法`clean_grammar()`，它清理了这样的定义。想法是寻找单标记定义，其中键正好由另一个键（单选方案、单标记、非终结符）定义。
- en: '[PRE336]'
  id: totrans-686
  prefs: []
  type: TYPE_PRE
  zh: '[PRE336]'
- en: Once we have such a list, iteratively replace the original key where ever it
    is used with the token we found earlier. Repeat until none is left.
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们有了这样一个列表，就迭代地用我们之前找到的标记替换原始键的任何位置。重复此操作，直到没有剩余的键。
- en: '[PRE337]'
  id: totrans-688
  prefs: []
  type: TYPE_PRE
  zh: '[PRE337]'
- en: 'The `clean_grammar()` is used as follows:'
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: '`clean_grammar()`的使用如下：'
- en: '[PRE338]'
  id: totrans-690
  prefs: []
  type: TYPE_PRE
  zh: '[PRE338]'
- en: '[PRE339]'
  id: totrans-691
  prefs: []
  type: TYPE_PRE
  zh: '[PRE339]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
- en: '[PRE340]'
  id: totrans-693
  prefs: []
  type: TYPE_PRE
  zh: '[PRE340]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
- en: '[PRE341]'
  id: totrans-695
  prefs: []
  type: TYPE_PRE
  zh: '[PRE341]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
- en: '[PRE342]'
  id: totrans-697
  prefs: []
  type: TYPE_PRE
  zh: '[PRE342]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
- en: '[PRE343]'
  id: totrans-699
  prefs: []
  type: TYPE_PRE
  zh: '[PRE343]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
- en: '[PRE344]'
  id: totrans-701
  prefs: []
  type: TYPE_PRE
  zh: '[PRE344]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE345]'
  id: totrans-703
  prefs: []
  type: TYPE_PRE
  zh: '[PRE345]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
- en: '[PRE346]'
  id: totrans-705
  prefs: []
  type: TYPE_PRE
  zh: '[PRE346]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
- en: '[PRE347]'
  id: totrans-707
  prefs: []
  type: TYPE_PRE
  zh: '[PRE347]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
- en: '[PRE348]'
  id: totrans-709
  prefs: []
  type: TYPE_PRE
  zh: '[PRE348]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
- en: '[PRE349]'
  id: totrans-711
  prefs: []
  type: TYPE_PRE
  zh: '[PRE349]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
  id: totrans-712
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
- en: '[PRE350]'
  id: totrans-713
  prefs: []
  type: TYPE_PRE
  zh: '[PRE350]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
- en: '[PRE351]'
  id: totrans-715
  prefs: []
  type: TYPE_PRE
  zh: '[PRE351]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
- en: We update the `update_grammar()` to use the right tracker and miner.
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: 我们更新了`update_grammar()`以使用正确的跟踪器和挖掘器。
- en: '[PRE352]'
  id: totrans-718
  prefs: []
  type: TYPE_PRE
  zh: '[PRE352]'
- en: The `recover_grammar()` uses the right miner, and returns a cleaned grammar.
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: '`recover_grammar()`使用正确的挖掘器，并返回一个清理过的语法。'
- en: '[PRE353]'
  id: totrans-720
  prefs: []
  type: TYPE_PRE
  zh: '[PRE353]'
- en: '[PRE354]'
  id: totrans-721
  prefs: []
  type: TYPE_PRE
  zh: '[PRE354]'
- en: '[PRE355]'
  id: totrans-722
  prefs: []
  type: TYPE_PRE
  zh: '[PRE355]'
- en: '[PRE356]'
  id: totrans-723
  prefs: []
  type: TYPE_PRE
  zh: '[PRE356]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 276.0 62" width="276.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="138.0" y="35">urlsplit@452:url</text></g></g></g></g></svg>
- en: '[PRE357]'
  id: totrans-725
  prefs: []
  type: TYPE_PRE
  zh: '[PRE357]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 560.0 62" width="560.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="405.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
  id: totrans-726
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 560.0 62" width="560.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">urlparse@396:scheme</text></g>
    <g class="terminal"><text x="275.75" y="35">:</text></g> <g class="non-terminal"><text
    x="405.0" y="35">_splitnetloc@413:url</text></g></g></g></g></svg>
- en: '[PRE358]'
  id: totrans-727
  prefs: []
  type: TYPE_PRE
  zh: '[PRE358]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 182.5 122" width="182.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="91.25" y="35">http</text></g></g>
    <g><g class="terminal"><text x="91.25" y="65">ftp</text></g></g> <g><g class="terminal"><text
    x="91.25" y="95">https</text></g></g></g></g></svg>
- en: '[PRE359]'
  id: totrans-729
  prefs: []
  type: TYPE_PRE
  zh: '[PRE359]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="142.25" y="35">//</text></g>
    <g class="non-terminal"><text x="271.5" y="35">urlparse@396:netloc</text></g>
    <g class="terminal"><text x="396.5" y="35">/</text></g></g> <g><g class="terminal"><text
    x="78.5" y="65">//</text></g> <g class="non-terminal"><text x="207.75" y="65">urlparse@396:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="65">urlsplit@494:url</text></g></g></g></g></svg>
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 534.5 92" width="534.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="142.25" y="35">//</text></g>
    <g class="non-terminal"><text x="271.5" y="35">urlparse@396:netloc</text></g>
    <g class="terminal"><text x="396.5" y="35">/</text></g></g> <g><g class="terminal"><text
    x="78.5" y="65">//</text></g> <g class="non-terminal"><text x="207.75" y="65">urlparse@396:netloc</text></g>
    <g class="non-terminal"><text x="396.5" y="65">urlsplit@494:url</text></g></g></g></g></svg>
- en: '[PRE360]'
  id: totrans-731
  prefs: []
  type: TYPE_PRE
  zh: '[PRE360]'
- en: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="152" viewBox="0 0 369.5 152" width="369.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="184.75" y="65">www.fuzzingbook.org</text></g></g>
    <g><g class="terminal"><text x="184.75" y="35">www.cispa.saarland:80</text></g></g>
    <g><g class="terminal"><text x="184.75" y="95">freebsd.org</text></g></g> <g><g
    class="terminal"><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g></g></g></svg>
- en: '[PRE361]'
  id: totrans-733
  prefs: []
  type: TYPE_PRE
  zh: '[PRE361]'
- en: <svg class="railroad-diagram" height="122" viewBox="0 0 543.0 122" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="271.5" y="35">urlparse@396:url</text></g></g>
    <g><g class="non-terminal"><text x="138.0" y="65">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="65">#</text></g> <g class="non-terminal"><text
    x="383.75" y="65">urlparse@396:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="95">/#</text></g> <g class="non-terminal"><text x="300.0" y="95">urlparse@396:fragment</text></g></g></g></g></svg>
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="122" viewBox="0 0 543.0 122" width="543.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="271.5" y="35">urlparse@396:url</text></g></g>
    <g><g class="non-terminal"><text x="138.0" y="65">urlsplit@502:url</text></g>
    <g class="terminal"><text x="250.25" y="65">#</text></g> <g class="non-terminal"><text
    x="383.75" y="65">urlparse@396:fragment</text></g></g> <g><g class="terminal"><text
    x="162.25" y="95">/#</text></g> <g class="non-terminal"><text x="300.0" y="95">urlparse@396:fragment</text></g></g></g></g></svg>
- en: '[PRE362]'
  id: totrans-735
  prefs: []
  type: TYPE_PRE
  zh: '[PRE362]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
  id: totrans-736
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 350.0 62" width="350.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="78.5" y="35">/?</text></g>
    <g class="non-terminal"><text x="203.5" y="35">urlparse@396:query</text></g></g></g></g></svg>
- en: '[PRE363]'
  id: totrans-737
  prefs: []
  type: TYPE_PRE
  zh: '[PRE363]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 191.0 62" width="191.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="95.5" y="35">q=path</text></g></g></g></g></svg>
- en: '[PRE364]'
  id: totrans-739
  prefs: []
  type: TYPE_PRE
  zh: '[PRE364]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">News</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">ref</text></g></g></g></g></svg>
- en: '[PRE365]'
  id: totrans-741
  prefs: []
  type: TYPE_PRE
  zh: '[PRE365]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
  id: totrans-742
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 250.5 62" width="250.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="125.25" y="35">/releases/5.8</text></g></g></g></g></svg>
- en: '[PRE366]'
  id: totrans-743
  prefs: []
  type: TYPE_PRE
  zh: '[PRE366]'
- en: '[PRE367]'
  id: totrans-744
  prefs: []
  type: TYPE_PRE
  zh: '[PRE367]'
- en: '[PRE368]'
  id: totrans-745
  prefs: []
  type: TYPE_PRE
  zh: '[PRE368]'
- en: '[PRE369]'
  id: totrans-746
  prefs: []
  type: TYPE_PRE
  zh: '[PRE369]'
- en: '[PRE370]'
  id: totrans-747
  prefs: []
  type: TYPE_PRE
  zh: '[PRE370]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 395.0 62" width="395.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="197.5" y="35">process_inventory@22:inventory</text></g></g></g></g></svg>
- en: '[PRE371]'
  id: totrans-749
  prefs: []
  type: TYPE_PRE
  zh: '[PRE371]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
- en: '[PRE372]'
  id: totrans-751
  prefs: []
  type: TYPE_PRE
  zh: '[PRE372]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
  id: totrans-752
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
- en: '[PRE373]'
  id: totrans-753
  prefs: []
  type: TYPE_PRE
  zh: '[PRE373]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
- en: '[PRE374]'
  id: totrans-755
  prefs: []
  type: TYPE_PRE
  zh: '[PRE374]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
- en: '[PRE375]'
  id: totrans-757
  prefs: []
  type: TYPE_PRE
  zh: '[PRE375]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE376]'
  id: totrans-759
  prefs: []
  type: TYPE_PRE
  zh: '[PRE376]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
- en: '[PRE377]'
  id: totrans-761
  prefs: []
  type: TYPE_PRE
  zh: '[PRE377]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
  id: totrans-762
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
- en: '[PRE378]'
  id: totrans-763
  prefs: []
  type: TYPE_PRE
  zh: '[PRE378]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
  id: totrans-764
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
- en: '[PRE379]'
  id: totrans-765
  prefs: []
  type: TYPE_PRE
  zh: '[PRE379]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
- en: '[PRE380]'
  id: totrans-767
  prefs: []
  type: TYPE_PRE
  zh: '[PRE380]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
- en: '[PRE381]'
  id: totrans-769
  prefs: []
  type: TYPE_PRE
  zh: '[PRE381]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
  id: totrans-770
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
- en: '[PRE382]'
  id: totrans-771
  prefs: []
  type: TYPE_PRE
  zh: '[PRE382]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
  id: totrans-772
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
- en: '[PRE383]'
  id: totrans-773
  prefs: []
  type: TYPE_PRE
  zh: '[PRE383]'
- en: '[PRE384]'
  id: totrans-774
  prefs: []
  type: TYPE_PRE
  zh: '[PRE384]'
- en: We see how tracking scope helps us to extract an even more precise grammar.
  id: totrans-775
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到跟踪作用域如何帮助我们提取更精确的语法。
- en: Notice that we use *String* inclusion testing as a way of determining whether
    a particular string fragment came from the original input string. While this may
    seem rather error-prone compared to dynamic tainting, we note that numerous tracing
    tools such as `dtrace()` and `ptrace()` allow one to obtain the information we
    seek from execution of binaries directly in different platforms. However, methods
    for obtaining dynamic taints almost always involve instrumenting the binaries
    before they can be used. Hence, this method of string inclusion can be more generally
    applied than dynamic tainting approaches. Further, dynamic taints are often lost
    due to implicit transmission, or at the boundary between *Python* and *C* code.
    String inclusion has not such problems. Hence, our approach can often obtain better
    results than relying on dynamic tainting.
  id: totrans-776
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们使用 *字符串* 包含测试作为确定特定字符串片段是否来自原始输入字符串的一种方式。虽然与动态污染相比，这可能看起来相当容易出错，但我们注意到，许多跟踪工具，如
    `dtrace()` 和 `ptrace()`，允许在不同的平台上直接从二进制执行中获取我们所需的信息。然而，获取动态污染的方法几乎总是涉及在它们可以使用之前对二进制文件进行仪器化。因此，这种字符串包含的方法可以比动态污染方法更普遍地应用。此外，动态污染通常由于隐式传输或在
    *Python* 和 *C* 代码之间的边界而丢失。字符串包含没有这样的问题。因此，我们的方法通常可以获得比依赖于动态污染更好的结果。
- en: Lessons Learned
  id: totrans-777
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 经验教训
- en: Given a set of sample inputs for a program, we can learn an input grammar by
    examining variable values during execution if the program relies on handwritten
    parsers.
  id: totrans-778
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 给定一组程序的样本输入，如果程序依赖于手写解析器，我们可以通过检查执行过程中的变量值来学习输入语法。
- en: Simple string inclusion checks are sufficient to obtain reasonably accurate
    grammars from real world programs.
  id: totrans-779
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 简单的字符串包含检查足以从现实世界程序中获得相当准确的语法。
- en: The resulting grammars can be directly used for fuzzing, and can have a multiplier
    effect on any samples you have.
  id: totrans-780
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果语法可以直接用于模糊测试，并且可以对您拥有的任何样本产生乘数效应。
- en: Next Steps
  id: totrans-781
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下一步
- en: Learn how to use [information flow](InformationFlow.html) to further improve
    mapping inputs to states.
  id: totrans-782
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学习如何使用 [信息流](InformationFlow.html) 来进一步提高映射输入到状态。
- en: Background
  id: totrans-783
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 背景
- en: Recovering the language from a *set of samples* (i.e., not taking into account
    a possible program that might process them) is a well researched topic. The excellent
    reference by Higuera [De la Higuera *et al*, 2010] covers all the classical approaches.
    The current state of the art in black box grammar mining is described by Clark
    [Clark *et al*, 2013].
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: 从一组样本中恢复语言（即不考虑可能处理它们的程序）是一个经过充分研究的话题。Higuera 的优秀参考文献 [De la Higuera 等人，2010]
    涵盖了所有经典方法。黑盒语法挖掘的最新状态由Clark 等人 [Clark 等人，2013] 描述。
- en: Learning an input language from a *program*, with or without samples, is yet
    an emerging topic, despite its potential for fuzzing. The pioneering work in this
    area was done by Lin et al. [[Lin *et al*, 2008](https://doi.org/10.1145/1453101.1453114)]
    who invented a way to retrieve the parse trees from top down and bottom up parsers.
    The approach described in this chapter is based directly on the AUTOGRAM work
    of Hoschele et al. [[Höschele *et al*, 2017](https://doi.org/10.1109/ICSE-C.2017.14)].
  id: totrans-785
  prefs: []
  type: TYPE_NORMAL
  zh: 从一个程序中学习输入语言，无论是否有样本，尽管它具有模糊测试的潜力，但仍然是一个新兴话题。在这个领域，Lin 等人进行了开创性的工作 [[Lin 等人，2008](https://doi.org/10.1145/1453101.1453114)]，他们发明了一种从自顶向下和自底向上解析器中检索解析树的方法。本章中描述的方法直接基于Hoschele
    等人的AUTOGRAM工作 [[Höschele 等人，2017](https://doi.org/10.1109/ICSE-C.2017.14)]。
- en: Exercises
  id: totrans-786
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习
- en: 'Exercise 1: Flattening complex objects'
  id: totrans-787
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 1：简化复杂对象
- en: Our grammar miners only check for string fragments. However, programs may often
    pass containers or custom objects containing input fragments. For example, consider
    the plausible modification for our inventory processor, where we use a custom
    object `Vehicle` to carry fragments.
  id: totrans-788
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的语法挖掘器只检查字符串片段。然而，程序可能经常传递包含输入片段的容器或自定义对象。例如，考虑我们对库存处理器的合理修改，我们使用自定义对象 `Vehicle`
    来携带片段。
- en: '[PRE385]'
  id: totrans-789
  prefs: []
  type: TYPE_PRE
  zh: '[PRE385]'
- en: '[PRE386]'
  id: totrans-790
  prefs: []
  type: TYPE_PRE
  zh: '[PRE386]'
- en: '[PRE387]'
  id: totrans-791
  prefs: []
  type: TYPE_PRE
  zh: '[PRE387]'
- en: '[PRE388]'
  id: totrans-792
  prefs: []
  type: TYPE_PRE
  zh: '[PRE388]'
- en: '[PRE389]'
  id: totrans-793
  prefs: []
  type: TYPE_PRE
  zh: '[PRE389]'
- en: We recover the grammar as before.
  id: totrans-794
  prefs: []
  type: TYPE_NORMAL
  zh: 我们像以前一样恢复语法。
- en: '[PRE390]'
  id: totrans-795
  prefs: []
  type: TYPE_PRE
  zh: '[PRE390]'
- en: The new vehicle grammar is missing in details, especially as to the different
    models and company for a van and car.
  id: totrans-796
  prefs: []
  type: TYPE_NORMAL
  zh: 新的车辆语法在细节上缺失，特别是关于货车和汽车的不同的模型和公司。
- en: '[PRE391]'
  id: totrans-797
  prefs: []
  type: TYPE_PRE
  zh: '[PRE391]'
- en: '[PRE392]'
  id: totrans-798
  prefs: []
  type: TYPE_PRE
  zh: '[PRE392]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
  id: totrans-799
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 980.0 62" width="980.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><g
    class="non-terminal"><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g></g></g></svg>
- en: '[PRE393]'
  id: totrans-800
  prefs: []
  type: TYPE_PRE
  zh: '[PRE393]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
  id: totrans-801
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 1221.5 62" width="1221.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="167.75" y="35">process_vehicle@30:year</text></g>
    <g class="terminal"><text x="309.75" y="35">,</text></g> <g class="non-terminal"><text
    x="451.75" y="35">process_vehicle@30:kind</text></g> <g class="terminal"><text
    x="593.75" y="35">,</text></g> <g class="non-terminal"><text x="748.5" y="35">process_vehicle@30:company</text></g>
    <g class="terminal"><text x="903.25" y="35">,</text></g> <g class="non-terminal"><text
    x="1049.5" y="35">process_vehicle@30:model</text></g></g></g></g></svg>
- en: '[PRE394]'
  id: totrans-802
  prefs: []
  type: TYPE_PRE
  zh: '[PRE394]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
  id: totrans-803
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 301.5 92" width="301.5"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="150.75" y="35">process_car@49:year</text></g></g>
    <g><g class="non-terminal"><text x="150.75" y="65">process_van@40:year</text></g></g></g></g></svg>
- en: '[PRE395]'
  id: totrans-804
  prefs: []
  type: TYPE_PRE
  zh: '[PRE395]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
  id: totrans-805
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1997</text></g></g></g></g></svg>
- en: '[PRE396]'
  id: totrans-806
  prefs: []
  type: TYPE_PRE
  zh: '[PRE396]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
  id: totrans-807
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 165.5 92" width="165.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="82.75" y="35">car</text></g></g>
    <g><g class="terminal"><text x="82.75" y="65">van</text></g></g></g></g></svg>
- en: '[PRE397]'
  id: totrans-808
  prefs: []
  type: TYPE_PRE
  zh: '[PRE397]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
  id: totrans-809
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 327.0 92" width="327.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="163.5" y="35">process_van@40:company</text></g></g>
    <g><g class="non-terminal"><text x="163.5" y="65">process_car@49:company</text></g></g></g></g></svg>
- en: '[PRE398]'
  id: totrans-810
  prefs: []
  type: TYPE_PRE
  zh: '[PRE398]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
  id: totrans-811
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">Ford</text></g></g></g></g></svg>
- en: '[PRE399]'
  id: totrans-812
  prefs: []
  type: TYPE_PRE
  zh: '[PRE399]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 310.0 92" width="310.0"><g
    transform="translate(.5 .5)"><g><g><g class="non-terminal"><text x="155.0" y="35">process_van@40:model</text></g></g>
    <g><g class="non-terminal"><text x="155.0" y="65">process_car@49:model</text></g></g></g></g></svg>
- en: '[PRE400]'
  id: totrans-814
  prefs: []
  type: TYPE_PRE
  zh: '[PRE400]'
- en: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
  id: totrans-815
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="62" viewBox="0 0 174.0 62" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">E350</text></g></g></g></g></svg>
- en: '[PRE401]'
  id: totrans-816
  prefs: []
  type: TYPE_PRE
  zh: '[PRE401]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
  id: totrans-817
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 174.0 92" width="174.0"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="87.0" y="35">1999</text></g></g>
    <g><g class="terminal"><text x="87.0" y="65">2000</text></g></g></g></g></svg>
- en: '[PRE402]'
  id: totrans-818
  prefs: []
  type: TYPE_PRE
  zh: '[PRE402]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Mercury</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Chevy</text></g></g></g></g></svg>
- en: '[PRE403]'
  id: totrans-820
  prefs: []
  type: TYPE_PRE
  zh: '[PRE403]'
- en: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
  id: totrans-821
  prefs: []
  type: TYPE_NORMAL
  zh: <svg class="railroad-diagram" height="92" viewBox="0 0 199.5 92" width="199.5"><g
    transform="translate(.5 .5)"><g><g><g class="terminal"><text x="99.75" y="35">Cougar</text></g></g>
    <g><g class="terminal"><text x="99.75" y="65">Venture</text></g></g></g></g></svg>
- en: The problem is that, we are looking specifically for string objects that contain
    fragments of the input string during tracing. Can you modify our grammar miner
    to correctly account for the complex objects too?
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: 问题在于，我们在追踪过程中特别寻找包含输入字符串片段的字符串对象。你能修改我们的语法挖掘器，以便正确地考虑复杂的对象吗？
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises)来处理练习并查看解决方案。'
- en: 'Exercise 2: Incorporating Taints from InformationFlow'
  id: totrans-824
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习2：从InformationFlow中引入污点
- en: We have been using *string inclusion* to check whether a particular fragment
    came from the input string. This is unsatisfactory as it required us to compromise
    on the size of the strings tracked, which was limited to those greater than `FRAGMENT_LEN`.
    Further, it is possible that a single method could process a string where a fragment
    repeats, but is part of different tokens. For example, an embedded comma in the
    CSV file would cause our parser to fail. One way to avoid this is to rely on *dynamic
    taints*, and check for taint inclusion rather than string inclusion.
  id: totrans-825
  prefs: []
  type: TYPE_NORMAL
  zh: 我们一直使用*字符串包含*来检查特定的片段是否来自输入字符串。这并不令人满意，因为它要求我们在跟踪字符串的大小上做出妥协，这限制在大于`FRAGMENT_LEN`的字符串。此外，可能存在一种方法可以处理一个字符串，其中片段重复，但属于不同的标记。例如，CSV文件中的嵌套逗号会导致我们的解析器失败。避免这种情况的一种方法是通过*动态污点*，并检查污点包含而不是字符串包含。
- en: The chapter on [information flow](InformationFlow.html) details how to incorporate
    dynamic taints. Can you update our grammar miner based on scope to use *dynamic
    taints* instead?
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: 关于[信息流](InformationFlow.html)的章节详细说明了如何引入动态污点。你能根据作用域更新我们的语法挖掘器，使用*动态污点*吗？
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises)来处理练习并查看解决方案。'
- en: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)
    The content of this project is licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike
    4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).
    The source code that is part of the content, as well as the source code used to
    format and display that content is licensed under the [MIT License](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license).
    [Last change: 2023-11-11 18:18:06+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/GrammarMiner.ipynb)
    • [Cite](#citation) • [Imprint](https://cispa.de/en/impressum)'
  id: totrans-828
  prefs: []
  type: TYPE_IMG
  zh: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)本项目的内容受[Creative
    Commons Attribution-NonCommercial-ShareAlike 4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/)许可。作为内容一部分的源代码，以及用于格式化和显示该内容的源代码受[MIT
    License](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license)许可。
    [最后更改：2023-11-11 18:18:06+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/GrammarMiner.ipynb)
    • [引用](#citation) • [印记](https://cispa.de/en/impressum)'
- en: How to Cite this Work
  id: totrans-829
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何引用这篇作品
- en: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler: "[Mining Input Grammars](https://www.fuzzingbook.org/html/GrammarMiner.html)".
    In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler, "[The Fuzzing Book](https://www.fuzzingbook.org/)", [https://www.fuzzingbook.org/html/GrammarMiner.html](https://www.fuzzingbook.org/html/GrammarMiner.html).
    Retrieved 2023-11-11 18:18:06+01:00.'
  id: totrans-830
  prefs: []
  type: TYPE_NORMAL
  zh: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler: "[Mining Input Grammars](https://www.fuzzingbook.org/html/GrammarMiner.html)".
    In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler, "[The Fuzzing Book](https://www.fuzzingbook.org/)", [https://www.fuzzingbook.org/html/GrammarMiner.html](https://www.fuzzingbook.org/html/GrammarMiner.html).
    Retrieved 2023-11-11 18:18:06+01:00.'
- en: '[PRE404]'
  id: totrans-831
  prefs: []
  type: TYPE_PRE
  zh: '[PRE404]'
