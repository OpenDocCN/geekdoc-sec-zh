# 第十四部分:旗帜

> 原文：<https://0xinfection.github.io/reversing/pages/part-14-flags.html>

如需所有课程的完整目录，请点击下方，因为除了课程涵盖的主题之外，它还会为您提供每个课程的简介。[`github . com/mytechnotalent/逆向工程-教程`](https://github.com/mytechnotalent/Reverse-Engineering-Tutorial)

在逆向工程中，标志是汇编语言和程序流程控制中最复杂的概念之一。当我们进入培训的最后阶段，将 C 应用程序逆向工程为汇编语言时，下面的信息将变得更加清晰。

这里重要的是，标志有助于控制、检查和验证程序执行，并且是一种确定处理器执行的每个操作是否成功的机制。

标志对于汇编语言应用程序是至关重要的，因为它们是检验每个程序功能是否成功执行的一种手段。

我们处理的是 32 位汇编，其中有一个包含一组状态、控制和系统标志的 32 位寄存器。该寄存器称为 EFLAGS 寄存器，因为它包含 32 位信息，这些信息被映射以表示特定的信息标志。

有三种标志，即状态标志、控制标志和系统标志。

状态标志如下:

**CF** :进位标志

**PF** :奇偶校验标志

**的 T1:调整标志**

**ZF** :零标志

**SF** :标志标志

的**:溢出标志**

当对无符号整数值的数学运算产生最高有效位的进位或借位时，进位标志被置位。这是涉及数学运算的寄存器的溢出条件。发生这种情况时，寄存器中的剩余数据不是数学运算的正确答案。

奇偶校验标志用于指示寄存器中数学运算导致的损坏数据。选中时，如果结果中 1 位的总数为偶数，则奇偶校验标志被置位，如果结果中 1 位的总数为奇数，则奇偶校验标志被清除。当检查奇偶标志时，应用程序可以确定寄存器在操作后是否被破坏。

adjust 标志用于二进制编码的十进制数学运算，如果用于计算的寄存器的位 3 发生进位或借位操作，则该标志置 1。

如果运算结果为零，则设置零标志。

符号标志被设置为结果的最高有效位，即符号位，并指示结果是正还是负。

当正值太大或负值太小而无法在寄存器中表示时，溢出标志用于有符号整数运算。

控制标志用于控制处理器中的特定行为。DF 标志是方向标志，用于控制处理器处理字符串的方式。设置后，字符串指令自动递减内存地址，以获取字符串中的下一个字节。清零后，字符串指令自动递增内存地址，以获取字符串中的下一个字节。

系统标志用于控制 OS 级操作，任何相应的程序或应用程序都不应修改这些操作。

**TF** :陷阱标志

**IF** :中断使能标志

**IOPL** : I/O 特权级别标志

**NT** :嵌套任务标志

**RF** :恢复标志

**VM** :虚拟 8086 模式标志

**AC** :对准检查标志

**VIF** :虚拟中断标志

**VIP** :虚拟中断挂起标志

**ID** :识别标志

trap 标志设置为启用单步模式，在该模式下，处理器一次仅执行一个指令代码，等待执行下一条指令的信号。这在调试时是必不可少的。

中断使能标志控制处理器如何响应从外部源接收的信号。

I/O 特权字段指示当前运行任务的输入-输出特权级别，并定义输入-输出地址空间的访问级别，该访问级别必须小于或等于访问相应地址空间所需的访问级别。在不小于或等于所要求的访问级别的情况下，任何访问该地址空间的请求都将被拒绝。

嵌套任务标志控制当前运行的任务是否链接到先前执行的任务，并用于链接中断和调用的任务。

resume 标志控制处理器在调试模式下如何响应异常。

VM 标志表示处理器运行在 virtual-8086 模式，而不是保护或实模式。

对齐检查标志与 CR0 控制寄存器中的 AM 位配合使用，使能存储器参考的对齐检查。

当处理器在虚拟模式下运行时，虚拟中断标志复制 IF 标志。

当处理器在虚拟模式下运行时，使用虚拟中断挂起标志来指示 n 中断挂起。

ID 标志表示处理器是否支持 CPUID 指令。

在我们的下一个教程中，我们将讨论堆栈。