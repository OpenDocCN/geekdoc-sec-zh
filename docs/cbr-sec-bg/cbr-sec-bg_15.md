# 1.  当事情出错时该怎么办。

在本章中，我们涵盖了：

+   安全事件与事故之间的区别

+   安全事件管理

+   何时升级

你可能注意到本章标题中使用了‘when’而不是‘if’事情出错。

统计上不太可能相信任何规模的组织永远不会遭受任何形式的入侵、恶意软件或其他损害其数字设备并需要修复的材料。尽管现实如此，一些组织选择把头埋在沙子里，相信否认是一个潜在的解决方案。

根据 PWC 为英国商务和创新部门进行的 2014 年调查，只有 73%的大型组织承认他们在过去一年中遭受了病毒或恶意软件感染。那么其他 27%到底发生了什么？他们是否有很好的安全实践或者检测率很低？统计上，他们很可能检测率低。

鉴于网络安全漏洞将会发生的必然性，对于每个企业来说，在事情出错之前都有一个称为安全事件管理的流程是至关重要的。即使是只有一个安全人员的组织也需要有一本指南来在发生事情时遵循。

拥有一个牢固、可靠的处理安全事件的流程对于减少其成本和影响以及缩短中断持续时间至关重要。清理这些事件所需的流程和能力被称为安全事件和事件管理，或称为 SIEM。

安全事件与事件管理（SIEM）

首先了解安全事件和安全事件之间的区别是很有用的。

| 安全事件 - 用于描述被认为是无意的数字领域的轻微干扰的术语。 例子包括单个故障设备或单个用户忘记密码。 安全事件的不寻常模式可能是安全事件的指示器。安全事件 - 有意的损坏、盗窃和/或未经授权的访问，对组织的任何重要部分的信息、系统、设备、服务或产品产生直接或间接影响。 |
| --- |

监控安全事件可以为制定安全改进提供有用信息。安全事件也是安全事件检测过程的重要情报来源。

检测和报告事件（违规或其他有意的侵入）是安全事件生命周期的第一步。

安全事件可能会造成巨额损失，显著干扰组织的业务运作，并造成品牌损害。早期和有效的事件管理有助于减轻这种影响的严重性（时间和成本）。

有效的安全事件管理要求在发生事件时能够激活适当的流程和具有必要技能的事件响应团队。

需要确保安全事件响应团队明确定义并定期测试此流程。如果没有一个准备充分且经过测试的安全事件流程，任何攻击或其他妥协的成本和影响将大大增加。

作为一个设计良好的安全事件管理流程的一部分，确保明确定义参与流程的人员的角色和责任至关重要。这意味着不仅要定义安全事件响应者的角色，还要定义与流程关键的所有其他角色。如果某人（如外部顾问或来自其他内部团队的工作人员）被召集来帮助安全事件响应者，他们需要在能够发挥作用之前明确其具体责任。

安全事件流程包括五个关键的生命周期阶段（如果包括建立流程的需求则为六个）。这些阶段最好总结为：

+   检测和报告。

+   验证。

+   隔离（也称为隔离）。

+   清理（缓解和恢复）。

+   复审（分析模式和流程缺陷）。

一些框架，包括 NIST，将这些阶段描述为检测、响应和恢复。

检测和报告

组织内的人员需要知道如何将任何疑似或确认的事件报告到安全事件流程中。事件应能够直接通过手动渠道触发。

可疑模式或安全事件的集中应自动触发事件。

直到报告事件并触发事件响应流程之前，违规造成的损害将持续。

一旦有潜在事件报告，就必须为其分配初始优先级。在事件进行过程中，随着额外信息的出现，此优先级可能会发生变化。

通常，事件响应流程将提供一个包含 4 至 7 个优先级选项的简要列表。每个优先级水平都需要具有明确易懂的标准。毕竟，在一些组织中，某些事件如果不加以修复，可能每分钟就会造成数百万美元的损失，而其他事件则可能根本没有或几乎没有财务影响。

选择特定事件的优先级通常由以下因素决定：潜在的财务影响和/或受影响的人员和/或客户数量，他们受到的影响程度以及涉及的数据或服务的敏感性。

如果一个安全事件只影响十个低价值系统上的用户，那么影响将远远小于它影响数百、数千甚至数百万人的业务关键系统。低价值、低用户的系统可能可以允许短时间下线。相反，许多企业不能承受某些系统完全没有停机时间。想想航空公司或酒店预订系统，或拍卖和房地产网站。即使是几秒钟或几分钟的中断也可能导致巨大的财务损失。

在分配优先级时，同样重要的是要注意考虑不仅是眼前的事件，还有更广泛的影响。例如，如果我在一个小型系统上发现了恶意软件感染，可能仍然需要为其分配一个优先级类别，如果在验证阶段确定问题可能迅速传播到攻击面的更高价值部分。

明确定义的优先级也将帮助响应者确定安全事件何时需要升级。如果预计安全事件将导致重大业务中断，或者因为无法在正常容忍度内管理事件，则可以在事件发生期间的任何时候将其升级到管理层。

设置优先级水平还将定义完成每个未完成阶段所允许的目标时间。如果某个阶段的允许时间超过了，或者安全事件经理预计时间将超过，这应该导致事件被升级并标记为警报状态。

| 警报状态 - 可以分配给安全事件的升级标志，以指示其无法在组织的安全流程中管理在允许的时间限制或其他可接受的容忍度内。 |
| --- |

验证

一旦潜在事件报告到流程中，安全事件响应者（在本书的较早章节中描述的角色）将需要验证事件是否真实，并进一步对其分类。

正如本书前面所讨论的，可以使用明确定义的类别和多项选择列表来帮助加快事件响应过程。这意味着网络安全人员不仅应该对事件进行分类，还应该尽可能多地收集有关组织的关键部分（站点、服务和产品）和攻击面（设备、系统、应用程序、数据、网络段）的信息。

美国计算机应急响应团队（US CERT）为安全事件定义了六个类别。这些是：

1.  未经授权的访问。

1.  拒绝服务。

1.  恶意代码（包括恶意软件）。

1.  不当使用。

1.  未遂入侵。

1.  调查。

组织的具体流程可能对这些类别有不同的标签。如果一个事件涉及多个类别，这将是重要的信息需要收集和解决。

第六类别（调查）主要是一个占位符，用来指示事件的原因和影响仍在研究中。

在第八章（技术网络安全）中，我们讨论了主要网络攻击的典型生命周期。我们之前也讨论过，问题被早期发现，修复成本就会更低。虽然预防比事件管理更便宜，但同样也是事实，攻击或入侵生命周期中问题被早期发现，修复成本也会更低。因此，一个被称为杀伤链的概念经常被用来帮助事件团队了解问题被检测到生命周期的多远。

| 杀伤链 - 一个概念上的网络防御模型，使用攻击结构作为建立网络防御策略的模型。典型的高级持续性威胁的阶段通常被用作框架，考虑到每个阶段的网络防御策略（检测、拒绝、干扰、降级、欺骗、遏制）。该模型基于这样一个前提：在生命周期中攻击越早被检测到和击败，产生的成本和损害就越低。这个模型可以作为防御策略的一个有用的附属品，但也存在固有的缺陷；例如，它在应用于防御范围之外的信息时效果最好，但在应用于内部组织网络时效果较差。然而，该模型非常成功地强调了当网络攻击在网络攻击生命周期的早期被识别时，处理它们的成本要低得多。这个相同的模型也在事件管理中使用，以确定攻击的进展程度，以帮助经理确定可能的成本和击败它的策略。 |
| --- |

安全事件响应者还可能召集相关学科的专家来帮助管理事件。重要的是提前达成协议，以确保这些专家在需要时可用于将其添加到事件响应团队中。

隔离（隔离）

如果确认发生了事件，必须隔离受影响的组件以最小化影响并防止数字景观的其他部分受到影响。

这可能是事件响应过程中的一个棘手步骤，因为重要的是要平衡组织继续运行和提供服务的需求与违规的潜在成本和影响。

正如外科医生必须小心地精确限制他或她切割的身体组织的数量一样，事件响应者努力精确和谨慎地隔离受影响的数字组件，以最小化系统中断并最大化组织范围的支持以响应事件。如果网络分割和冗余系统已经存在，则事件响应团队更容易减少业务中断的程度。

如果无法避免对运营的干扰，那么有必要提前准备好明确定义的沟通和通知程序，以便依赖受影响的系统或设备的人员能够立即并简洁地得到通知，并估计恢复其服务所需的时间。

在可能的情况下，应首先通知或咨询关键企业流程的管理者。未能及时与受影响的管理者商议可能会给安全响应团队带来不愉快的后果。

还应该预料到安全事件通常会被任何攻击者故意安排在正常工作时间之外发生。

清理

一旦确定了原因和受影响的组件，事件响应团队就需要能够迅速调用具有专业知识的人员来清理和恢复这些组件。

在某些情况下，可能无法立即清理和恢复组件到原样。这使得团队必须包含，或者能够紧急访问，能够识别临时解决方案的专家，以便在受影响的组件本身得到修复之前采取替代解决方案。在此阶段，适当访问业务连续性和灾难恢复计划可能至关重要。

在清理阶段的另一个关键考虑因素是确保保留可能在将来的调查中需要的任何证据。可能需要涉及数字取证专家来捕获所有必要信息，以在事件之后追踪、证明过失或起诉攻击者。

再次强调，有必要在事件响应过程中定义何时需要保留证据的标准，尽管事件响应团队仍可能需要数字取证专家的帮助或建议，这些专家可能是公司员工或外部顾问。

审查

一旦即时事件得到解决，总是建议进一步查看发生了什么，无论是在事件还是过程层面。

这样的审查涉及到提出诸如：这种事件是否可能发生在其他类似的组件上？它是否是一个更大的模式的一部分？是否需要采取额外的即时步骤来保护数字环境？

过程运作如何？有效吗？是否有任何过长的地方？角色和责任是否定义得足够清晰？是否有任何需要作为改进过程的教训？

任何事后响应审查最终都会分析事件响应过程的各个部分，即定义安全事件和事故如何优先处理和升级的部分，是否运作良好或应该进行修改。这需要了解在建立这些优先级和升级标准时考虑了哪些因素。

由于响应安全事件非常重要，拥有全面、设计良好且经过充分测试的事件响应流程对于成功的网络安全至关重要。

同样重要的是，必须确保参与组织功能的人员知道如何向正确的部门或个人报告潜在事件，以触发安全事件流程。

记住，据报道，在任何客户数据被窃取之前，Target 收到了一条反恶意软件警报。如果确实发生了这种情况，并且警报触发了适当的事件响应流程，那么潜在地数据泄露可能已经被阻止了。
