# 1.  案例研究 - 索尼（2014）

| 组织： | 索尼 |
| --- | --- |
| 违规日期： | 未知至未知 |
| 发现日期： | 2014 年 11 月 24 日 |
| 披露日期： | 2014 年 11 月 24 日 |
| 违规性质： | 敏感电子邮件、未发布的电影、员工数据，... |
| 违规规模： | 据信超过 100 太字节。 |
| 影响： | 估计超过 300 百万美元 |

摘要：

作为一个高度依赖技术的大型公司，索尼过去经常成为网络攻击的目标。

为了为他们多样化的部门提供灵活性，索尼对其系统的安全采取了灵活的方法，允许每个公司组实施和管理各自所需的内容，同时还有一些跨所有部门运作的整体安全系统。

这种方法的优势在于允许不同部门整合新技术，以帮助扩展和交付产品，以满足客户需求，从而增加收入。

这种策略可以运作良好，但相比自上而下的安全执行，运营成本要高得多。在为每个部门单独运行安全性时，了解每个部分的责任和边界至关重要。必须有足够的资金，并且必须足够以允许每个部门管理安全的全面方法，包括我们在本书中探讨的所有组成部分。

2014 年 11 月 21 日星期五，索尼的少数高管电子邮件账户收到了一个自称为“上帝使徒”的团体的通讯，要求支付金钱赔偿以防止索尼“被整体轰炸”。据报道，收件人忽视或将此通讯视为垃圾邮件。

2014 年 11 月 24 日星期一，索尼影视娱乐公司，索尼公司的一个部门，发现他们的大量系统遭到入侵。已经有大量数据被窃取，并且一些关键服务无法运行。此时，确切的原因和渗透点尚不清楚。

首次有关攻击被检测到的报告出现在索尼影视娱乐公司位于加利福尼亚州卡尔弗城的总部的员工计算机屏幕上，屏幕上闪烁着黑客的消息。消息中包含黑客收集的一些被盗数据的链接。此时，攻击者自称为“和平卫士”。

同一天，有关违规的信息迅速传播到社交媒体上。一些被盗的数据已经发布在网上，媒体开始审查内容。

攻击的程度以及识别攻击方法所需的时间对索尼的即时运营产生了重大影响。事实上，据称全球范围内的索尼员工在许多天内继续工作，却无法使用他们的计算机、电子邮件或语音信箱。

在接下来的几周里，越来越多的被盗数据被发布在线，同时攻击者发出威胁和要求。

这次泄露的程度是巨大的。在线发布的数据包括：

+   高管的整个电子邮件档案。

+   一些员工的信息，包括工资信息和社会安全号码。

+   未发布的电影。

+   公司财务信息。

+   ...

攻击者泄露的信息类型列表将填满几页。攻击者（和平卫士）最初（同一个月）透露他们设法获取了 12TB 的信息。

据显示，黑客使用的恶意软件在攻击被检测到后仍然继续运作一段时间。最终评估显示黑客窃取的数据量超过 100TB。为了让这个数字更具体，整个美国国会图书馆的数字化格式只有这个大小的 10%。

这些信息持续泄露表明恶意软件是多态的（如前一章所述），当时无法用现有的反恶意软件软件阻止或隔离。因此，尽管索尼的安全团队试图隔离或清除被盗的数据，但这些尝试都失败了。

其他已经部署的安全措施，如应急情况下应该关闭系统的防火墙，也未能立即阻止或防止信息的持续泄露。这表明恶意软件绕过了这些防御措施，同时也规避了反恶意软件软件。

被盗信息的敏感级别是混合的，相对无关紧要的数据经常存在于高度敏感信息的小部分旁边。

指示表明这次攻击是出于政治动机，原因是即将发布一部名为《采访》的电影，据称冒犯了朝鲜政府。

索尼聘请外部安全公司协助阻止和清除泄露的数据，并帮助恢复内部系统和服务。这次攻击的规模也促使美国政府机构提供援助。

在 12 月 19 日，美国计算机应急响应小组发布了关于一种新型破坏性恶意软件的信息，该软件最近被用来攻击一家主要媒体公司。

https://www.us-cert.gov/ncas/alerts/TA14-353A

对恶意软件的分析确认其能够监听、访问、指挥和破坏感染设备上的信息。分析人员将这种恶意软件描述为蠕虫。

| 蠕虫 - 一种恶意软件，旨在寻找其他可以复制的位置。这有助于保护恶意软件免受清除，并增加受攻击面积。 |
| --- |

它通过利用一种称为服务器消息块（SMB）的标准文件共享协议来运作。因为这种蠕虫也可以删除信息，所以它也被称为“擦除者”。这种方法已经在其他攻击中使用过，而且有一些补丁可以帮助解决这个漏洞。

在撰写本书时，财务影响，包括收入损失、业务中断、补救成本和赔偿支付仍在持续。这些成本预计将达到数亿美元，甚至更多。

这次攻击的规模、程度和影响完全超出了索尼当时所拥有的网络安全能力。

根本原因分析：

索尼网络安全团队从未充分考虑或准备好可能影响索尼本身或索尼影业部门的这种规模的攻击。

当索尼影业制作了一部冒犯了一个与世隔绝、敏感和反应迅速的国家的电影时，索尼将一个实质性和强大的对手添加到了对其系统感兴趣的攻击者名单中。

与其他攻击不同，其动机通常与金钱有关，国家赞助的攻击通常包含非常不同的目标。

一个充分的网络安全防御策略的基础在于告知公司高管风险的程度，并确保对暴露水平的整体理解存在。

根据渗透的程度和造成的损害，很明显一个关键的根本原因是防御层中存在大量的漏洞。总的来说，被窃取的数据量表明网络和设备级别的数据丢失预防工具被绕过或缺失；无论哪种情况，这些工具都被证明是无效的。

尽管当时几乎不可能完全保护系统免受使用多态恶意软件的攻击，但这种恶意软件本身主要利用已知的漏洞，而这些漏洞的保护措施已经存在。这意味着，尽管使用多态恶意软件的攻击可能造成损害，但当所有其他安全措施有效运行时，其规模和影响可以大大减少。

正如我们在上一章中所讨论的，建立坚固、多层次的防御措施是昂贵的，根据攻击方法的演变定期更新网络防御也是昂贵的。但这种类型的攻击揭示了一个事实，即不投资于全面、经常更新的防御措施可能会比强大、适应性强的多层次防御成本更高。

尽管有关索尼遭受的攻击是否真的是由朝鲜发起的的猜测一直在持续，但一些关键事实表明了这一点。

用于渗透索尼的软件类型，尽管经过修改以帮助其规避反恶意软件，但与 2013 年 3 月对韩国发动的早期攻击中使用的软件非常相似。那次攻击也被归因于朝鲜。

此外，‘和平卫士’已经渗透并复制了索尼未发布的电影，并将这些电影发布到了网络上，除了《采访》这部电影——这部电影冒犯了朝鲜政府。

最初的渗透被追溯到泰国曼谷瑞吉酒店。

分析人员还发现，恶意软件可能在被攻击日期之前就存在于索尼系统中，并且在攻击被揭露之前一段时间内一直未被发现。这些证据支持了这样的观察结果：在不到几个月的时间内收集和窃取如此大量的数据是非常困难的。

使用了已知一段时间的漏洞利用技术，并且如果索尼安装了软件制造商提供的补丁（更新），他们的系统就可以抵抗这些‘已知’的漏洞利用。

一旦发现攻击正在进行中，公司似乎无法迅速更新其入侵检测和预防例程以阻止攻击。这进一步支持了这样的论点：不定期安装更新在增加索尼面对这种规模攻击的脆弱性方面起到了重要作用。

分析人员还发现，至少对于电子邮件系统来说，索尼的记录保留和销毁程序要么不存在，要么极其不足。自动在特定有限时间后删除和销毁电子邮件，除非明确指定保留，否则会大大减少数据暴露的影响。

换句话说，由于补丁管理和记录保留和销毁政策的不足，攻击面的大小和敏感性比必要的要大且更易受攻击。

此外，攻击者能够在非敏感数据旁边找到一些敏感数据。这表明信息分类流程并未完全建立。敏感信息与非敏感数据的分离和比非敏感数据更高的安全措施并不一致。

有人推测攻击的另一个根本原因涉及到不满的前雇员利用内部信息。这一指控的部分理由是，如果攻击者合理地了解了索尼系统、网络位置和易受攻击点，就可以更合理地解释损害和渗透的程度，以帮助他们制定攻击策略。

数据泄露的最终根本原因之一是所有良好安全性的一个关键特征：单一责任制。

| 单一责任点（SPA 或 SPOA）- 所有关键资产、流程和行动必须具有明确的所有权，并可追溯到单一责任人的原则。理由是，未定义单一所有者是流程或资产保护失败的常见原因。共同所有权被视为重要的安全漏洞，因为一般情况下，当有多个人负责时，安全漏洞持续存在的可能性增加。 |
| --- |

在本书的开头，我提出了这样一句话：“从来没有人为了表彰一个委员会而建立雕像。” 采用分部门的安全方法是可行的，但需要明确和可追溯的单一责任点责任线。如果每个人都负责，通常没有人会被追究责任。谁最终对索尼的安全负责？是分部门层面的高管，还是公司层面的高管？

这些类型的责任不明确的政策导致在面对灵活和快速移动的攻击者时反应迟缓且不足。每个组织都必须采取反映其信息价值和可能遇到的攻击者类型的安全姿态。

总的来说，索尼没有建立起足够规模的深度防御安全控制措施来应对已经发生的威胁。他们没有充分预见或准备可能对他们造成如此规模影响的攻击。
