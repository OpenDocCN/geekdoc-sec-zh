第十章

# 电话攻击向量

理查德·阿克罗伊德，随机风暴有限公司高级安全工程师

电话社会工程攻击可以用来收集关于目标公司的信息，甚至是欺骗用户执行导致其安全完全被突破的行动。这是一种流行的攻击向量，因为很少有被识别和抓住的风险。本章提供了一种实际的方法来规划将实现评估目标的呼叫，但更重要的是，识别目标政策和流程中的实际漏洞。

### 关键词

电话攻击；来电显示欺骗；电话系统入侵

## 介绍

人们或许会原谅地认为随着互联网的爆炸式发展，电话诈骗会消失，但实际情况并非如此。每天新闻媒体上仍然有这类案例，尽管可能不如电子邮件诈骗案件那么多。

事实是，自从互联网诞生以来，我们一直被灌输“*互联网是个邪恶的地方*”的信息，这无疑导致大多数人对上面的人更加警惕。这在某些情况下可能在一定程度上解释了为什么电话攻击仍然受到欢迎。虽然这显然没有产生预期的效果。

另一个原因可能是一个精心策划的电话攻击有多么有效。如果借口合理，电话那头的人听起来有点像人类，有些人会相信他们所说的话，无论他们是谁。

有些情况下，人们仍然会对这些电话感到惊讶。例如，银行以相当频繁的方式给他们的客户打一些极其烦人的电话是出了名的。这就是它们的方式：

| 银行 | “你好，是阿克罗伊德先生吗？—是 XYZ 银行欺诈部门打来的” |
| --- | --- |
| 我 | “请讲” |
| 银行 | “阿克罗伊德先生，我们发现您账户上出现了一些异常活动，想要核实一下是否正确” |
| 我 | “好的” |
| 银行 | “您可以告诉我您地址的第一行、您的邮政编码和您的出生日期吗？” |
| 我 | “嗯……不行” |
| 银行 | “但是如果您不提供详细信息，我们将无法为您提供任何信息……” |
| 我 | “那就这样吧” |

在确保人们受过教育不泄露敏感数据方面有什么希望？当真正的欺诈部门打来电话，甚至还隐瞒了号码，要求提供敏感信息时，还有什么希望呢？还记得银行发来的那些电子邮件“*我们绝不会通过电子邮件索取敏感信息*。”这里有什么不同？为什么通过电话是可以接受的，但通过电子邮件却不可以？攻击类型的普及程度是冒险尝试的足够理由吗？这是极不可能的，每年遭受这些诈骗的成千上万的人毫无疑问会赞同。

尽管欺诈部门一再被告知，他们索取这些信息会使情况变得更糟，并使他们的客户易受骗子攻击。但他们还没有改变！

所有那些教育宣传活动和新闻媒体上的文章突然变得毫无意义，因为应该知道得更清楚的人却不知道。这是一个悲哀的现状。

事实是，需要教导人们多疑心。人们应该被鼓励对某人的身份进行质疑，如果他们无法证明自己，就挂断电话。拒绝与他们交谈是可以的。如果真的是重要的事情，就会有进一步的沟通。你总是可以寻找已知的合法联系方式并回拨电话。

电话攻击流行的另一个原因是有很多潜在的场景和拨打电话的原因。银行的例子只是一个可以很轻松地应用于社会工程学行动的想法。

毫不拖延，让我们来看看电话攻击的世界，以及这些如何在行动中使用。

## 真实世界的例子

### 凯文·米特尼克

可能是有史以来最著名的社会工程师，正如在第一章中已经提到的那样。凯文·米特尼克的职业生涯包括一些最疯狂的电话诈骗。他在 1990 年代是“*世界上最受追捧的黑客*”。有趣的是，米特尼克声称自己编写了第一个钓鱼程序。它是一个虚假的登录模拟器，收集用户凭证！—这与第九章中的凭证收集部分形成了有趣的对比。

就电话黑客而言，米特尼克能够获取什么样的信息呢？员工编号、地址、信用卡号、电话号码、密码——应有尽有。如果你对米特尼克的事迹感兴趣，可以看看《*欺骗的艺术*》*ISBN-10: 076454280X*。即使对信息安全领域不感兴趣的人也会觉得这是一本真正迷人的读物。他的一些骗局突显了关于电话攻击的一个有趣观点。小细节可以成就大事。给多人打多次电话并收集微小的信息片段正是这个游戏的全部内容，前提是有时间！了解企业内部行话，或者不时地提及某个名字，这些都会为任何攻击增加可信度。这些细节的价值大于它们各自的总和。

### 卡取消诈骗

这是目前在英国流行的电话诈骗。它依赖于目标人群在可能未经他们允许就能提取资金的情况下感到恐慌。

基本上，这种骗局始于来自零售店的电话，一个真实的例子是伦敦的苹果商店。冒充苹果商店员工的骗子告诉受害者，有人正在商店里，试图使用看起来像是她的卡之一的卡花费大笔钱。受害者检查她的卡是否都在，发现它们都在。苹果商店员工告诉受害者，他们的卡可能已经被复制了，应该打电话给他们的银行取消卡。此时，员工说卡复制者正在从商店里跑出去，并挂断电话，但不挂断。这样即使受害者在自己那一端挂断电话，通话仍然保持活动状态。

此时，受害者试图打电话给他们的银行，但在恐慌中他们没有意识到电话没有拨号音。攻击者一直在线上。当受害者问：“*嗨，这是巴克莱银行吗？*”，攻击者回答是，并问他们如何帮助。

受害者解释了诈骗过程，而乐于助人的银行员工告诉她，根据新的安全方案，她可以一次取消所有分配给她的卡，甚至那些不属于这家特定银行的卡。此时，攻击者正在利用受害者的恐惧。受害者实在等不及解决这个问题，于是同意取消所有卡。接下来，她被要求在电话里拨入她的密码，所有这些都被攻击者记录下来。

受害者被要求确认她的完整地址，骗子告诉她，会派遣一个安全的快递员当天取走取消的卡，并确保它们被妥善处理。如果受害者表现出任何抵抗或声称她会自己剪碎卡片，攻击者会说新卡不能发放，直到旧卡被收回。这是为了确保如果这些卡被找回，不会再受到进一步的欺诈，比如身份盗窃。

攻击者给受害者一个代码，告诉他们在快递员到达时询问快递员。如果他们没有提供正确的代码，他们应该打电话给警察。显然，“快递员”是骗子团队的一部分，并向受害者提供了正确的代码。受害者交出一个装满完全激活的信用卡的信封，攻击者知道了密码。

尽管这种骗局可能无法愚弄一些人，但确实有效。这种骗局每天可以让一些犯罪分子赚取超过 5 万英镑！这些是经验丰富的骗子团队，他们日复一日地从事这项工作。他们在电话中听起来很自然，让人完全信服。利用个人的恐惧可以引发在正常情况下可能不会出现的反应。这在社会工程方面是一种有效的技术，正如第三章中所介绍的那样。

当涉及操纵时，金钱总是一个很好的动机。当涉及到所有账户被清空生活积蓄时，人们通常无法对情况进行理性应用。

有关此诈骗的更多信息可以在*BBC 新闻*网站[`www.bbc.co.uk/news/business-22513041`](http://www.bbc.co.uk/news/business-22513041)上找到。

## 环境声音

在拨打选定目标电话之前，应仔细考虑要使用的借口。他们通常会从什么样的环境打电话？一个旅行推销员可能会从行驶中的汽车或一个繁忙的呼叫中心的帮助台操作员那里打电话。通常需要模仿这些背景噪音，以确保任何诡计都是可信的。如何实现这一点？嗯，尽可能选择真实的事物吧？如果要让电话听起来像是从汽车打来的，那就从汽车打，只要确保安全和合法！

在无法获得真实事物的地方，需要有创造性的方法。这通常意味着招募周围的人参与情景。也可以意味着下载音频轨并在背景中播放。在这方面要小心，如果声音文件在通话中途结束，要准备好随机应变。例如，“*是的，这里真的很忙，所以我搬到一个安静的房间*”，希望这样会奏效。最好确保在通话之前彻底检查声音道具。

想要播放一些环境噪音，为什么不查看[`www.freesound.org`](http://www.freesound.org)。这里上传的所有声音都是根据知识共享许可提供的。有很多不同的背景音轨适合任何情景。办公室环境声音，游戏厅，汽车声音，应有尽有。

不过，再次提醒，在使用文件之前务必从头到尾检查，任何错误都可能代价高昂且令人尴尬！

## 来电显示存在的问题

来电显示是在屏幕上显示来电者的电话号码的功能。在某些系统中，如果联系人已添加到数据库中，还可以显示姓名。

这当然可以成为对抗恶意来电者的一种非常有用的防御措施，但是吗？系统中是否存在可以被社会工程师利用的弱点？使用来电显示作为认证措施是个好主意吗？

一般意见认为，单独使用来电显示作为认证方法根本不是个好主意。以下是一些原因。

## 来电显示欺骗

在世界某些地区，可以伪造短信和电话的来源。这些服务在英国并不常见，但在美国肯定是可用的。诸如“*spoofcard*”之类的服务以很小的成本提供这种功能。

在英国曾有类似的服务，比如“*Spookcall*”。然而，该网站在上线仅仅 5 天后就被关闭了。OFCOM 对提供的服务持负面态度，也有充分的理由。对于任何类似的事情都值得谨慎对待。仅仅因为某项服务或解决方案不是公开可用的，并不意味着它对恶意个人不可用。

## 电话系统的黑客攻击

我们生活在一个时代，在这个时代，大型跨国组织似乎经常遭到 compromise。组织可以分为两组：那些知道自己被黑了的和那些不知道的。好吧，这可能有点夸张，但这是一个有趣的原则。如果 RSA 或 Sony 可以被黑，那么组织是否真的认为它们不会被黑呢？即使在今天，电话系统的黑客攻击仍然很常见。这些黑客攻击的绝大多数用于骗取高昂的电话费，拨打到黑客拥有的海外号码上。这往往会在相对较短的时间内造成数以万计的英镑损失。如果是这样的话，那么使用这些黑客攻击来拨打内部号码也是可能的。这可能听起来有些牵强，但确实存在。

## 联系数据库是否更新？

如果接到来自员工的电话，如何进行验证呢？首先看来电显示，然后将号码与内部联系人匹配。更好的办法是，电话系统自动进行匹配，并在号码旁边显示员工的姓名。当来电号码无法匹配时会发生什么？如果是新员工怎么办？如果员工声称手机丢失、损坏或被盗了怎么办？政策和流程能否应对这些情况？新员工获得电话需要多长时间？如果被认为这是常见的需要花费几周时间，那么当一个未知来电联系时，为什么通话处理员会注意到任何可疑情况呢？

任何联系数据库的情况很可能一直落后于实际情况，并且每个通话处理员都会知道这一点。

## 转移来电显示

值得注意的一个有趣点是，并非所有的电话系统在呼叫转移时都会传递来电显示。在一些较旧的系统中，将呼叫转移给他人时，来电显示可能会显示转移者的信息。因此，值得尝试确认一下能够将呼叫传递给目标的总机或前台的号码。不幸的是，除非你在侦察阶段获取了有关电话系统的信息并研究了其文档，否则不可能知道实际显示了什么。让内部用户使用他们的 ID 将呼叫传递的意图是利用认证链。这就是用户的想法：“简传递了那个电话，并告诉我是鲍勃，所以肯定是鲍勃。” 你已经假设了另一个人已经对来电者进行了认证，但更有可能是他们没有！

## 如何确定你的来电显示

那么，有关确定目标是否拥有来电显示的情景呢？或者如果呼叫被转接给另一名员工，显示的是什么号码？在打入电话并被转接给某人后，试试这个：

| 我: | “嗨，我是人力资源部的鲍勃，你能帮我一个小忙吗？” |
| --- | --- |
| 他们: | “当然，我能为你做什么？” |
| 我: | “他们正在更换我的商务手机号码，因为有骚扰电话，你能告诉我你的屏幕上显示了什么吗？我想知道它是否已经更换了” |
| 他们: | “当然，是 555-444-333-222” |
| 我: | “太好了，谢谢！” |

这是一个很好的简单示例，从目标中提取出看似完全不敏感的信息。对于受害者来说，他们所读回的只是你的号码，一切都很无害，但它可以确定来电显示是否正常工作，或者在内部转接呼叫时是否显示。

## 总结一下

来电显示绝对不是完全可靠的东西。系统中至少需要建立另一个认证因素。不过，需要注意的是，不要选择人们可能多年来都自由提供的信息。那些信息无法收回。选择对每个员工都是独特的，足够私密以不成为常识，但又足够开放以便电话接线员使用的东西。

## 在电子邮件攻击的基础上构建

在电子邮件攻击向量期间收集了大量有用的信息，其中许多可以在电话攻击阶段应用。

首先，毫无疑问，会获得几个内部分机号码，这些号码可以在办公室外使用。分机号码通常由外部可用电话号码的最后三到四位数字组成。这是假设整个电话号码没有包含在签名中的情况下，而事实几乎总是如此。

谁不在办公室，以及不在多久也是知道的。这个信息单独来说就是一条无价的情报，经常被充分利用。

外出办公回复很可能包含其他同一团队内工作人员的联系方式，在他们不在时可以联系这些人。这些人可能会毫不犹豫地提供帮助。他们可能不会想要和度假期间的同事确认任何细节。

这里有一个可以利用这一情报的示例通话。本示例将建立在“外出办公回复”一节中指出的情景上，该节位于第九章中。

## 我不在时请联系萨拉

当外出办公回复带回另一个联系人和他们的电话号码时，对于任何社会工程师来说都是非常有用的。很可能这个人甚至都没有被告知他们将成为缺席员工的接收者。下一步的一个很好的方法是查看目标的 Facebook 资料，看看是否可以找到他们去了哪里的信息，这种内部信息将有助于建立对缺席员工的了解和信任。

这样的电话会怎样发展？

| 我: | “嗨，萨拉，我是来自 zxycorp 的比尔·罗布森，上周我和罗布谈过我们一直在进行的审计工作。他告诉我你是他不在时需要联系的人？” |
| --- | --- |
| 萨拉: | “嗨，比尔，是的，看起来我有幸在接下来的几周里处理罗布的工作！” |
| 我: | “我猜这对某些人来说没问题，他们飞往加勒比海，而我们其余的人则留在这里辛苦工作！不管怎样，罗布说你能帮我访问一些存放在他电脑上的文件。由于公司政策不允许通过电子邮件发送敏感审计数据，他不想这样做。” |
| 萨拉: | “是的，这些天他们不让我们发任何东西，太疯狂了。” |
| 我: | “告诉我吧，我得到处奔波收集这些信息。感觉就像又回到了过去。不管怎样，我这周任何时间都可以过来收集信息。罗布说你应该能登录他的电脑，我会带一枚加密的 USB 存储器，这样我们就可以安全地拿走数据，你这周有什么空闲时间吗？” |
| 萨拉: | “星期四下午 2 点怎么样？” |
| 我: | “好的，我会在前台帮你问问的，很高兴能和你交流。” |

到达时，顾问需要准备充分。首先，要穿得像样。这意味着提前到达并遵守公司着装规定。要知道正在寻找哪些文件，即使它们不存在，这也给场景增加了可信度。幸运的话，工程师会被留下来单独搜索文件，这时他们可以大展拳脚。至少，可能有机会在萨拉登录时偷看她的肩膀。最多的情况下，可能有机会留下一个持久的后门，以供进一步攻击。在完成后，尽量试图独自离开，因为可能还有其他目标可以实现。此时，顾问很可能已经有了访客徽章，因此可能会毫无挑战地通过。

## 你会打给谁？

选择要打电话给谁本身就是一种技能，特别是当最终需要打几个电话才能最终与他们交谈时。

在公司网站上发布的任何号码很可能是通往前台、总机甚至帮助台的通用号码。这些真的是我们想要交谈的人吗？这里有利有弊。积极的一面是，这些部门都雇佣了人，他们唯一的目的就是帮助别人。硬币的另一面是，他们很可能在以一种统一和脚本化的方式处理电话方面有很深的造诣，并且不太可能偏离标准。因此，归根结底，问题在于：必要的信息是否可以从其他地方获取？

在许多情况下，进一步研究并找到不太熟悉处理呼入电话的人并尝试转接给他们可能更有益。这样做的可能性更大，他们会想尽快摆脱打电话的人，因此更有可能泄露一些不应该泄露的东西。另外，他们不太可能接受过教育以知道电话中应该和不应该泄露什么。另一个需要注意的地方是，接听电话的人可能已经接受过培训并提供了认证外部电话的资源，而其他员工则没有。这里试图识别的脆弱性是非接听电话员工的培训不足。修复方法很简单，让所有非接听电话员工将外部电话转回总机或帮助台。

我们曾经利用过类似的情况，尽管运气极好，这也是我在进一步的工作中走上这条道路的原因。

目标是获得对一个规模较大的区域办公室的实际访问权限。

需要的是区域办事处的一个可以授权通行证并赞助访问的人的姓名和联系方式。为了避免引起警报，避免打电话给区域办事处本身。因此，逻辑的方法是联系总部的交换机。交换机的号码是在早先的侦察演习中获取的。首选选择是冒充总部站点的员工；这就是第一个电话的情况。

| Them: | “嗨，xyz 公司，我是莎拉，我能帮到您什么？” |
| --- | --- |
| Us: | “嗨，我是人力资源部的鲍勃，你能帮我解答几个问题吗？” |
| Them: | “当然，鲍勃，我能为你做点什么？” |
| Us: | “我正和几位同事一起前往利兹办公室进行培训，但我忘记提前发邮件告知安保我要来了，我知道他们对这些事情很敏感。你能告诉我需要联系谁来安排通行证吗？” |
| Them: | “对不起，鲍勃，我手头上没有那些信息” |
| Us: | “噢……我想我应该做好更充分的准备！你能给我前台的电话号码吗？” |
| Them: | “没问题，让我查一下……电话是 555.666.111” |
| Us: | “谢谢您的时间，莎拉，您知道今天利兹前台会有谁吗？” |
| Them: | “联系表上写着苏” |
| Us: | “再次感谢您，莎拉，再见” |

这是一个实际的电话，虽然经过了大幅编辑和消毒以保护无辜者。这是由一位同事在车内打的电话。在这方面有一个好点要说明，当拒绝提供一项信息时，一定要有备用方案。可能是员工不知道答案，那么你的备用方案就是“*您能找到知道答案的人吗？*”此时，他们可能会透露另一个姓名和联系电话。然后，后续的电话可以包括点名莎拉的内容：“*嗨，我刚和莎拉通话，她说你能够……*”频繁的假设是莎拉已经验证了来电者。再次强调，这种技术是在滥用认证链。

下一个电话是打给区域办事处本身，这就是非通话处理程序开发的地方。打电话时，苏正在外出办事，顶替她的人对访客的协议不是很熟悉。

| Them: | “下午好，xyz 公司利兹，我能为您效劳吗？” |
| --- | --- |
| Us: | “嗨，是苏吗？”（点名） |
| Them: | “嗨，这是凯特，很抱歉，苏现在不在，我能帮到你吗？” |
| Us: | “我相信你能够的，凯特。我们刚和雷丁办公室的莎拉交谈过，她说苏会为我们安排一些通行证，并告诉我们会议室在哪里。我们今天要进行员工意识培训” |
| Them: | “我找不到任何相关信息，今天的访客记录中也没有任何内容” |
| 我们: | “我们的一些情况可能发生了误解！对此感到抱歉。我们将在大约 15 分钟内到达，Sue 会回来吗？她将能够处理这个问题” |
| 他们: | “她至少还要几个小时才能回来” |
| 我们: | “哦，那好吧，我们到了就会找你，然后我们可以解决通行证的问题” |
| 他们: | “好的，我马上就到” |

事实上，在谈话快结束时有些犹豫不决，但是因为穿着西装，看起来很专业，她被迫处理“访客”并分发了一些通行证。他们只带了一些匆忙制作的公司徽章，放在徽章套里，这些徽章是用喷墨打印机打印的，而且有信心说服其他人它们的合法性。

有时，采取非常接近的策略可以使局面直接落在他们的脚下，以查看他们的反应。在许多情况下，反应将是恐慌的。如果已知与您打交道的人经验不足或未受过良好的培训，则应施加压力以查看结果。

在第九章中，讨论了使用电子邮件进行积极情报收集的概念，以获取后来在评估中可能对我们有所帮助的情报片段。

这个概念也完全适用于电话，尽管这略微更加危险。这主要是因为与电子邮件地址相比，电话通话增加了压力。在开始打电话之前，有必要对故事进行充分排练并充满信心。尽量避免引起怀疑，并由于缺乏准备而对进一步工作产生负面影响。

在电子邮件第九章中，讨论了发送几乎可以抛弃的电子邮件的主题——这些类型的电子邮件不会引起怀疑，每天都会被企业看到。在收集信息时，同样的原则大多会被应用到我们所做的电话中。

## 工作查询

大多数企业将定期收到职位空缺的查询，但是这种性质的电话询问可以帮助我们进行接触吗？一项看似无害的查询是否可以提供可以用于进一步攻击的信息？看一下可以获取的信息类型，就会显而易见它可以。

首先，我们可以确定谁负责组织的招聘工作。这些信息可以用来更有效地针对攻击，例如确保恶意载荷以简历的形式发送。

如果确定第三方负责招聘，这可能被用于进一步攻击中冒充他们。例如，查看企业网站上的任何职位空缺，然后打电话假装是招聘人员。那么，为社交工程团队的一名成员安排面试如何？这至少可以让顾问进入安全控制的门，进入受限区域。同样的概念也适用于内部处理招聘的组织。值得注意的是，这完全取决于分配给该任务的时间范围。在大多数情况下，这不太可能是一个快速成功的方法。

另一个角度是发现是谁负责内部部门的潜力。例如，与招聘主管谈论 IT 角色，然后请求与负责 IT 团队的人交谈，向他们询问一些关于工作的问题。这不仅可以得到另一个内部联系人，还有与内部人士建立良好关系的潜力。这种关系可以建立起来，并在以后进一步利用。

## 销售电话

销售电话对任何企业来说都会成为日常事件。这意味着可以冒充销售电话而不必担心被揭穿。更好的是，撰写一个假托词，并让销售团队打电话增加真实性！销售人员是天生的社交工程师，他们每天都在这样做，为什么不利用这一技能呢？

首先，在处理 IT 或软件业务时，拨打主要帮助台，并要求与负责 IT 相关采购的人交谈。在这一点上，已经做了一些功课，这使得顾问可以直接要求与此人交谈。试着开始谈论一份关于防病毒软件的优惠，并询问他们是否打算在短期内解决这个问题。通常听到人们直接回答“*我们使用麦克菲，许可证还有 2 年的有效期*”，但也会有人说他们已经有了，而且他们不感兴趣。然而，没有什么能阻止你追问更多信息，一个简单的“*请问你目前使用的是哪款防病毒软件？*”大多数销售人员都会尝试这样做，这样他们就可以尝试将他们的产品与内置竞争对手相提并论，所以这听起来并不突兀。在实际任务中，这些信息可以用于准备可能更有可能绕过目标防病毒软件的有效载荷。在此提供的一个实用提示是在虚拟机中安装它，然后测试各种组合，直到找到有效的方案为止。花时间做好准备总比在现场访问期间造成混乱要好。

-   那么，一个可以获取有关物理安全信息的例子呢？同样的方法在这里同样有效。打电话并询问谁负责设施管理。也许在这种情况下作为一个站点安全公司的销售人员，提供闭路电视安装、报警器维护、门禁系统和保安人员。同样，这里的目标是找出他们目前拥有什么，以及是否存在任何覆盖漏洞。再次，如果他们回答说“*抱歉，我们已经有 xyz*”，就要求提供供应商或正在使用的系统的名称。如果他们提供了目前管理建筑物的安全公司的名称，这可能在后续的冒充尝试中使用。如果交流是长期的，可能可以制作制服和徽章。

## -   调查

-   调查是那些永远不会消失的老掉牙的社会工程陈词滥调之一，但它们有效吗？想象一下接到那通电话的接收者的感受：

| -   | 询问者： | “嗨，你能帮我回答一些调查问题吗？” |
| --- | --- | --- |
| -   | 你： | “嗯，不，走开” |

-   好吧，这进展得很顺利。开玩笑的话，和大多数事情一样，关键在于问题的提出方式。问题的措辞不仅如此，假设也很重要。在上面的例子中，一个陌生人打电话询问是否愿意浪费宝贵的时间回答一些基本上毫无意义的问题。答案几乎总是不。

-   唯一让这些问题留下印象的方法是激励他们想要回答。尝试选择一个有权威的人来完成这项工作，或者一个官方职务的人，比如来自国家统计局或地方商会的人。诀窍是保持简短，可能只有四到五个问题。

-   一个很好的例子是打电话进行一项关于社交媒体在工作场所影响的调查。问题可能是这样的：

-   1. *你是社交网络网站的成员吗，比如 Twitter 或 Facebook？*

-   2. *你大约多久使用这些网站？*

-   3. *你是否使用这些网站与工作之外的同事保持联系？*

-   4. *你的雇主是否允许你在午餐时间访问社交媒体网站？*

-   5. *你认为社交媒体网站是否提高了员工的士气？*

-   一套简单的问题应该不会花费超过一分钟的时间来获取答案。已经实现的目标是找出他们的工作站是否有出站互联网访问权限，以及是否可能设置内容过滤。如果打算在交流期间发送钓鱼邮件，这些信息是有用的。

这个想法是提出一些看似无害的问题，并悄悄插入一个真正需要回答的问题。其中的诀窍是以间接的方式提问，就像第四个问题一样。你还会注意到“在午餐时间”。人们不会承认自己做了一些不应该做的事情，比如在工作时间上 Facebook，但在午餐时间呢？他们可以毫不犹豫地说是，而不会牵扯到自己。

调查在参与中当然是有一席之地的，但需要极大的耐心和坚持才能成功。

## 冒充员工

冒充其他员工绝对是完成工作的最有效方式之一。这不仅适用于信息收集，还适用于实际攻击。太少的组织在向内部员工提供信息之前进行身份验证的手段或者过程，这是社会工程师利用的。甚至有团队成员打电话给一个组织并编造一个名字。没错，一个不存在的员工通过电话获取信息。这只是强调了一个观点，即如果有足够的胆量拿起电话并听起来合法，很可能会得到积极的结果。

在“你会找谁？”部分有许多冒充员工的好例子，但还有许多可以利用的角度。

## 帮助台

那么选择冒充帮助台成员并打电话给其他内部员工帮助诊断可能并不存在的问题呢？记住，某个地方总会有人遇到电脑问题，并且他们很可能会大声抱怨。在这种情况下，通话会如何进行？

| 你： | “嗨，我是支持部门的迈克，我们在邮件服务器的日志中看到了错误，表明您在发送邮件时遇到了问题，您还在遇到问题吗？” |
| --- | --- |
| 对方： | “不，我目前没有任何问题” |
| 你： | “好的，我们可以做一些快速检查，这样我就可以在支持工单中添加一些详细信息。如果以后出现问题，这将帮助我们” |
| 对方： | “当然，你需要我做什么？” |

这通话的其余部分将取决于所需信息的类型。如果只是需要知道内部 IP 地址方案，引导他们启动命令提示符并输入 ipconfig /all 的过程。这将为您提供客户端网络 IP 地址以及通过 DNS 服务器地址获取的服务器网络。DNS 服务器通常也是域控制器，这肯定会有助于缩小现场攻击的焦点。但是，更高级的信息呢？

| 你： | “好的，我们需要再次确认您是否正确连接到域，准备好下一个命令了吗？” |
| --- | --- |
| 对方： | “尽管问吧” |
| 你： | “好的，输入 net accounts /domain” |

让受害者朗读回复应该提供域的密码策略。这些信息可以用来避免攻击外部系统时的锁定阈值。

试试让他们通过点击恶意超链接来检查他们的互联网访问情况。首选选项是凭证窃取器，以避免任何尴尬的杀毒软件警报。

## 员工编号

在社会工程中，可信度始终是关键。如果顾问有业务“需要知道”的需求，他们更有可能获得所需的信息。如果目标是让员工透露他们的员工编号，该如何做？需要是企业内部可能需要这些信息的人，那么财务部门怎么样？

| You: | “嗨，莎拉，我是财务部的吉姆，最近怎么样？” |
| --- | --- |
| Sarah: | “嗨吉姆，谢谢，你有什么事吗？” |
| You: | “莎拉，我们刚刚从负责我们工资的人那里收到了更新的支付信息，我们认为很多信息都是错误的。看起来很多员工编号与我记录的不符” |
| Sarah: | “哦糟糕，听起来不太好” |
| You: | “莎拉，这太糟糕了，看起来至少一半是错误的，包括你的，这可能意味着人们无法正确领取工资” |
| Sarah: | “哦不！” |
| You: | “我们正在尝试纠正每个人的记录，你在名单上，你能读出你的员工编号吗，以便我可以验证我们的记录是否正确？” |
| Sarah: | “当然，是 4454536346346” |
| You: | “看来你的确是正确的，我很高兴我们确认了！月底时不想让人们没有工资！” |

一旦有人认为他们可能拿不到工资，他们就会非常顺从。金钱无疑是最好的激励因素之一。这个故事之所以有效，是因为人们预期财务团队可能需要这些信息。外部组织处理工资也并不罕见。事实上，企业经常因为内部财务团队和外部工资之间的沟通不畅而受到影响。所有这些都增加了这种情景的可信度。现在唯一需要做的就是在电话中足够自在，以便进行一些能打破僵局的闲聊。一如既往，保持简单。情景越复杂，出错的可能性就越大。不要为通话中的任何失误而困扰，合法通话中也会发生，只需恢复并继续。这种情景会让财务团队的成员有点紧张，毕竟，人们可能会生气。

员工编号在许多方面都很有用。首先，它们可以用作公共门户的身份验证机制。其次，它们可以用于验证传入电话。员工编号还可以启动对人力资源的电话，然后用于获取更多情报。

## 获取关键信息和访问权限

以下是一些获取敏感信息、系统或物理场所访问权限的情景。

## 凭证和电子邮件访问

大多数组织都有某种公共面向邮件的存在，通常通过 Outlook Web Access（OWA）实现。要通过某种欺骗手段获得访问权限，首先需要确定谁可以提供所需的访问权限。毕竟，给养鱼缸的人打电话没有什么意义。

在这种情况下，有两种可用的途径；要么直接联系用户，要么联系帮助台并让他们重置密码。以下是一些可能的情景。

首先，假设我们不仅收集了大量的电子邮件地址，还枚举了子域并确定了 OWA 或类似的服务。所有这些都可以在侦察阶段中实现，如第八章中所述。

例如，只需用户名和 OWA 的 URL，就可以通过重置密码来获取密码。一个简单的电话，假装慌乱，解释说你正要参加一次重要会议，需要访问重要的电子邮件，再加上对 OWA 的几次认证失败，锁定账户，足以获得一个非常乐于助人的支持技术人员的帮助。然而，他们仍然需要一封电子邮件来验证身份。一个简单的任务！利用所有的研究，提前准备好受害者助手的姓名，对话大致如下：

“那么，如果我让简·罗杰斯给你发电子邮件，你可以重置我的密码吗？她是我的个人助理。” *支持技术人员说可以*。

不幸的是，无法访问简的电子邮件账户，欺骗也不是一个选项，而且在时间范围内没有足够的时间来建立一个足够好的假域。唯一剩下的选择是希望目标的邮件客户端不显示实际的电子邮件地址，而是显示发件人的“姓名”。使用一个标准的免费邮件账户，确保“发件人”姓名显示为简·罗杰斯。创建了一封授权电子邮件，附有联系说明和一个手机号码。此外，还添加了在侦察阶段恢复的伪造电子邮件签名。又一次致电帮助台，让技术人员知道应该有一封来自简的邮件等待他，尽管在这一点上已知道这封邮件并没有发送。定期地，进一步的电话被打出，每次都逐渐显得越来越慌乱和恼怒，每次都确保提到简·罗杰斯这个名字。坚持认为简曾说过她已经发送了这封电子邮件好几次。一段时间后，消息被发送。最终，期待已久的电话被接听。支持技术人员通过重置密码的过程引导用户登录账户。

正如先前提到的，对某人施加压力往往会迫使他们做一些他们通常不会做的事情。 “压力和解决方案”技巧在第三章中有更详细的介绍。如果电子邮件立即发送出去，任务可能仍然会成功，但第一种方法往往是最成功和更加稳定的。在整个过程中，当天大约有六次通话与支持人员交谈，到这个时候，工程师已经和支持技术员熟悉起来。导致支持技术人员似乎终于能够帮助解决问题而感到宽慰。

需要注意的是，虽然完成一项工作会带来极大的满足感，但是利用一个辛勤工作的人是不好玩的。因此，始终强调这里的问题不是电话处理方式的问题。问题在于雇主没有提供必要的工具以安全地执行这个角色。改善这种情况应该是任何合作的最终目标。

如果必要的话，这种情景是可以进行调整的。例如，可以声称 Blackberry 手机丢失、被盗或损坏无法修复，并急需访问电子邮件。在这种前提下，也可以原谅不知道如何远程访问电子邮件，因此不知道 OWA 的 URL。在这种攻击向量中，推荐的选项是选择丢失或被盗，而不是损坏。损坏意味着序列号仍然可以从设备上读取。告诉他们设备被盗意味着他们很可能会锁定账户并重置密码以避免被攻击。这也意味着受害者很可能会将他们的设备擦除。在执行此攻击之前考虑到这些都是值得注意的事情。

这些原则也都适用于远程访问 VPN 门户。事实上，在许多情况下，VPN 也可能对域进行身份验证，因此如果您已经重置了一个 VPN，那么您可能可以使用相同的凭据访问一切。如果你是远程工作，VPN 访问可能是最终目标。它将与坐在他们的物理网络上完全相同。在这一点上，测试更多地回归到传统的渗透测试。

## 物理接入

没有什么比获得对一个受到严密保护的物品的物理接入更好的了。找到允许某人轻而易举地走过安保人员、摄像头和警报的流程漏洞是一种无价的感觉。在许多情况下，这不会是完全没有提前通知就出现，因为很多工作都是先打好基础，然后通过电话进行安排。

## 物理接入零日

有一种方法已经被证明在许多项目中非常成功。通常，这种方法会在较短的项目中使用，通常持续 1 或 2 天。在这里没有太多的回旋余地，所以典型的方法是进行一天的侦察和一天的现场工作。

我们开玩笑地称这种方法为零日，因为它的成功一直如此。也许它的成功与项目持续的天数直接相关。天数越少，投资就越少，在安全方面，所以也许组织正在尝试了解可能被视为低 hanging fruit 的问题？这种方法肯定攻击了明显的途径。客户可能希望了解更大的问题，解决它们，教育，并进行重新评估。最终，将寻找更不明显的问题，这可能需要更多时间来测试。

这种情景在本书中已经有所涉及。总体思路是冒充员工并安排一个即将到访的通行证。

在侦察阶段，应该已经确定了内部员工的姓名、办公室位置以及休假的员工。所有这些情报在情景中都起作用。打电话到区域办事处冒充总部员工总是一个好主意，正如我们在“你会找谁？”一节中所介绍的。

知道哪位员工离开以及离开多久，使工程师能够在电话中进行冒充，而不必担心被发现。最好在打电话之前找出这个人在哪个办公室和部门工作。

正如前面所述，接下来就是想一个合理的理由去区域办事处并需要访问的简单事情。比如，有人在 IT 部门工作，去现场做一些维护和升级工作？这将为你在那里的理由提供充分的依据，同时也为访问网络提供了合理性。此外，顾问可能会遇到好奇的员工，所以需要做好准备。需要确认现场没有自己的 IT 人员。例如，为什么不试试“*我要离开几周，需要找人去那里升级一些交换机*”的说辞。然后告诉接待人员你什么时候到达，并让他们准备好通行证。最坏的情况是他们要求进一步的授权，这时你可以要求与他们的主管交谈，并对他们施加更大的压力。我知道我们经常提到会议室，但一旦你拿到通行证，让接待人员为你预订一个房间。这将为你提供一个可以安心工作而不太可能受到挑战的地方。这真的减轻了压力，你可以在相对安宁的环境中继续你的目标。

这可能看起来像是一个极端的机会，但它确实经常奏效。如果有一个更长的参与过程，那么无疑这种方法肯定可以更加先进，但简单也有很多可取之处。

有关适用技术的更多信息已经在第三章提供。

如果有人想要武器化基于电话的攻击并攻击主机呢？

## 武器化你的电话

我意识到我有可能在谈论渗透测试，但这些电话必须有实际可行的结果。你可能不总是在测试组织的物理安全性，但需要从外部攻击网络中的主机。我相信有很多方法可以做到这一点，但这是其中一种最喜欢的方法。

首先，需要一个来自 Hak5 的无线 Pineapple 和一个具有数据包注入功能的 WiFi 适配器的笔记本电脑。有许多支持此功能的 Atheros 芯片组的无线适配器，比如 Alfa 或 TP-Link 722n。TP-Link 的好处是它们在亚马逊上很容易买到，目前在英国的价格只超过 £8。它们基本上是送出去的！另一个重要的项目是签名批准拒绝服务无线接入点。这本身可能是一个阻碍因素，但这是一个现实的概念，即使是技术上一般的攻击者也能实施。

向量基本上是在第三章讨论的破坏和协助概念。破坏和协助，顾名思义，是指破坏某物，然后以此为借口帮助某人解决问题。甚至可以社会工程第三方来破坏某物，然后打电话声称有能力提供帮助。无论从哪个角度来看，这都是一种有效的技术。

这将避免许多技术细节，因为它们在互联网上已经广泛覆盖了无线方面的事情。

基本上，这是对无线网络执行无线去认证攻击，打乱所有连接到它的人的通信。经过几次循环这个过程后，称为目标，冒充服务台人员。告诉目标说他们部门的每个人都会在随机间隔断开网络连接，并询问他们是否注意到了任何问题。即使目标没有注意到，他们周围的人很可能已经注意到了。如果没有，继续打电话给其他号码，直到找到有人。

此时，受害者被告知已经设置了一个新的无线网络来解决问题，并指导他们连接到它的过程。当然，他们要连接的无线网络是一个恶意的 WiFi Pineapple 或类似的伪装设备。现在，所有的流量都可以被拦截，从客户端到任何目的地。

社会工程工具包中还有功能可用于构建此类攻击。配置一个 SSID，当客户端连接时，所有 DNS 流量都会被拦截，目标将被路由到恶意页面，而不是其自己的内部资源。

设置新的无线网络需要提升的权限，但我们经常看到这种情况被允许，以便笔记本用户可以连接到他们的家庭网络或在外出时在各种地点连接。如果他们无法设置新的无线网络，你可以准备好一个凭证窃取站点作为备用计划。始终要有备用计划！

## 摘要

本章介绍了电话攻击的各个方面以及它们如何在参与过程中使用。

在整个大部分章节中提供了大量的现实世界示例和脚本，希望能给未来的参与者或自我防御教育提供一些想法和灵感。无论读者身处哪一方，他们现在都应该更好地准备应对这些攻击。

接下来，涉及电话系统、来电显示和环境声音等一些实际问题，这些问题在压力下很容易被忽视，尽管在任何评估过程中它们都至关重要。

最后，研究主动信息收集，这在许多方面类似于电子邮件信息收集，获取关键信息的方式，再次深入一些实际例子，最后以武器化电话呼叫以侵犯内部系统为结尾。

第十一章涵盖了现场社会工程工作和物理安全的所有方面。
