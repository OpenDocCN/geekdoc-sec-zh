# 第十章 进入内部

为什么一个外部人员伪装成一个公司员工会这样容易？为什么他们的扮演会如此有说服力甚至有高度安全意识的人都会受骗？为什么欺骗十分了解安全程序的人会这样容易？

在你阅读这一章的故事时思考这些问题。

## 10.1 警卫的麻烦

日期/时间：10 月 17 日，星期二，凌晨 2:16

地点：Skywatcher 航空公司位于图森（Tucson，美国亚利桑那州南部城市）市郊的制造车间。

### 10.1.1 警卫的故事

在这个袅无人烟的制造车间走廊上，听着脚后跟反复敲打地板的声音，勒罗伊?格林（Leroy Greene）觉得这比整个晚上都守在警卫室的视频监控器前要好多了，在那里除了盯着屏幕之外他不能做任何事情，不能看杂志或者他的带皮边的圣经。你只能坐在那里看着显示屏上一动不动的画面。

但是在走廊里走动他至少还可以活动一下腿脚，并且还可以在走动时甩一下胳膊和肩膀，这也让他有了一点点锻炼。虽然这对于一个在全城高中冠军橄榄球队打右内边锋的人来说算不上真正的锻炼，但是他想，工作就是工作。

他转向了东南角并开始沿着走廊俯视半英里长的生产场地，然后他发现有两个人越过了直升飞机制造部分的边线，站在那里似乎在互相指点着什么。在晚上这个时候看见的陌生人，“最好检查一下，”他想。

勒罗伊从通往生产场地的楼梯一直走到那两个人后面，他们没有察觉到他的接近，直到他在旁边走了好几步。他说：“你们好，我能看看你们的安全证件吗？谢谢。”勒罗伊想使自己的语气在这个时候尽量温和些，他知道过于强硬会变得像是在威胁。

“你好，勒罗伊，”他们中的一个把他的证件上的名字读了出来，“我是汤姆?斯第尔顿(Tom Stilton),来自菲尼克斯的公司营销办公室，我在城里开会，想向我的朋友展示一下世界上最好的直升飞机是怎样制造的。”

“好的，先生，你们的证件，谢谢。” 勒罗伊说，他不禁觉得他们似乎太年轻了，那个营销员看上去才刚刚读完中学，另一个人长发披肩，看上去大概十五左右。

理过发的人想从口袋里拿出他的证件，等他把所有的口袋都找过一遍之后，勒罗伊开始觉得有些不妙，“该死，”那个人说，“一定是放在车上了，我这就去拿——只要 10 分钟，我去一趟停车场就回来。”

勒罗伊有自己的打算，“先生，你说你的名字是？”他问道。勒罗伊谨慎地写下了回答，然后要求他们和他一起去警卫室。在到第三个走廊的升降梯上，汤姆聊到他在公司才 6 个月，并希望自己没有惹任何麻烦。

安全监控室里，其他两个值夜班的警卫和勒罗伊一起盘问了那两个人。斯第尔顿给出了他的电话号码，并说他的上司是朱迪?安德伍德（Judy Underwood），然后给出了她的电话号码，这些信息都在电脑上得到了确认。勒罗伊把其他两个警卫拉到一旁讨论该怎么做，没人想把这件事情弄错，于是三个人一致认为他们最好打电话给那个人的上司，即使那意味着要在半夜把她叫醒。

勒罗伊亲自打给了安德伍德女士，解释了他是谁并询问她有没有一个叫汤姆?斯第尔顿的雇员。

她听上去似乎还是半睡半醒，“是的。”她说。

“好的，我们 2：30 的时候在生产线上发现了他，他没有身份证件。”

安德伍德女士说：“让我和他谈话。”

斯第尔顿拿起电话，说：“朱迪，真的很抱歉这些人在半夜把你叫醒，希望你不要责怪我。”

他一边听一边说：“为了新的新闻稿会议，明天上午我无论如何都要在这里。不管怎么样，你收到关于汤普森生意的电子邮件了吗？我们需要在星期一早晨和吉姆见面所以我们不能没有这个。我还要在星期二和你一起吃午餐，对吗？”

他倾听了一会儿，说了声再见并挂上了电话。

这让勒罗伊始料不及，他本来想要拿回电话让那位女士告诉他一切正常的。他想他也许应该再打电话给她，但还是改变了主意，他已经在半夜打扰了她一次，如果他再打过去，她可能会生气并向他的上司投诉。“何必自找麻烦呢？”他想。

“我是不是可以向我的朋友展示剩下的生产线了？” 斯第尔顿问勒罗伊，“你想要跟着我们吗？”

“继续吧，”勒罗伊说，“四处看看。只是下次可不要忘了带上证件，如果你想要去设备车间的话，先让警卫知道——这是规定。”

“我会记住的，勒罗伊。”斯第尔顿说，然后他们离开了。

不到十分钟，警卫室的电话响了，是安德伍德女士，她想要知道“那个家伙是谁？！”。她说她试着问一些问题，但他一直在谈论和她一起吃午餐的事，她根本不知道他到底是谁。

警卫室的人打电话让前厅和大门的警卫到停车场去，得到的回应是那两个年轻人在几分钟前离开了。

说了这个故事之后，勒罗伊总是要这样结尾说：“老天爷，我的上司就差没吃了我，还好没丢了工作。”

### 10.1.2 乔?哈珀（Joe Harper）的故事

来看看他能完成哪些事，17 岁的乔?哈珀已经有超过一年的非法潜入建筑物历史了，有时候是白天，有时候则是晚上。音乐家和鸡尾酒服务生晚上都要上班，作为他们的儿子，乔有太多自由时间了。他的故事讲述了这件事情是怎样发生的，很有启发性。

我的朋友肯尼想要当一名直升机飞行员，他问我能不能带他到 Skywatcher 工厂去看制造直升机的生产线，他知道我以前到过一些其它地方。一股肾上腺素冲动使你很想看看能不能溜进禁止进入的地方。

但是你不能大摇大摆的走进一个工厂或办公楼，必须考虑周全，做很多计划，对目标进行完整的侦查。查看公司的网页名称和标题、报告结构和电话号码，阅读剪报资料和杂志文章，精确的调查是我谨慎的标志，所以我能运用和员工一样多的信息应对任何盘问我的人。

那么从哪里开始呢？首先我在互联网上查找这家公司的位置，了解到公司的总部在菲尼克斯，好极了。然后我打电话过去请求接通营销部门：每家公司都有一个营销部门。一位女士接了电话，我说我属于蓝铅笔绘图公司，我们想知道是否有人对我们的服务感兴趣和我们应该找谁。她说应该找汤姆?斯第尔顿，我询问他的电话号码，她说他们不能透漏这些信息，但是可以对我破例。电话里响起了语音提示，他的留言说：“我是负责绘图工具的汤姆?斯第尔顿，分机 3147，请留言。”当然——他们不会公布分机号，但是这个人把它放到了他的语音信箱里。非常好，现在我有了一个名字和分机号。

另一个电话，打给同一个办公室。“你好，我在找斯第尔顿，他不在，我想问他的上司一些简单的问题。”那位上司也出去了，但是当挂上电话的时候，我知道了她的名字，并且她也恰好把分机号留在了她的语音信箱里。

我也许可以不费吹灰之力地骗过大厅的警卫，但是我查看过那个工厂，我想我记得在停车场周围有一个围墙，这意味着会有一个警卫在那里检查进入的车辆。在晚上他们也可能会记录车牌号码，所以我不得不在跳蚤市场买了一个旧的车牌。

但是首先我必须拿到门卫室的电话号码。我等了一会儿，这样如果碰到同一个接线员的话她就不会认出我的声音，然后打过去说：“我接到投诉，Ridge 路门卫室的电话有些断断续续的问题——现在还是那样吗？”她说她不知道但是可以为我转接。

“Ridge 路警卫室，我是赖安。”那个接电话的人说。我说，“你好，赖安，我是本。你这里的电话有问题吗？”他只是一个低层的警卫但我猜想他大概受过一些训练，因为他马上说，“本什么——你的姓是？”我像是没听到他的话一样继续说，“之前有人说有问题。”

我可以听到他放下电话大声说，“嘿，布鲁斯，罗杰，这个电话有问题。”然后他说，“不，我不知道有问题。”

“你们那里有几条电话线路？”

他已经忘了问我的名字。“两条。”他说。

“现在的这个是？”

“3140。”

到手了！“它们都工作正常吗？”

“好像是的。”

“好的，”我说，“听着，汤姆，如果你的电话有任何问题，可以在任何时间打电话到电信来找我们，我们会帮忙的。”

我和我的伙伴决定第二天晚上去参观工厂，下午晚些时候我打到警卫室，用那个营销员的名字说，“你好，我是负责绘图工具的汤姆?斯第尔顿，我们已经接近了最后期限，所以我叫了几个人到这里来帮忙，有一两个可能要到晚上才来，到时候你还在吗？”

他很高兴能这样说，不，晚上他不在。

我说，“好吧，留个信给轮班的人，好吗？看到两个找汤姆?斯第尔顿的人，就挥挥手让他们进来——好吗？”

好的，他说，没问题。他写下了我的名字、部门和分机号，并说他会办好的。

凌晨两点之后我们开车到了大门口，我说出了汤姆?斯第尔顿的名字，然后一个昏昏欲睡的门卫就告诉了我们进去的通道和停车地点。

当我们走进工厂时，大厅里还有另一个警卫在那里进行常规的临时签到登记。我告诉这个警卫说我有一个报告需要在早上准备好，我这位朋友想要看看车间。“他对直升机很着迷，”我说，“他大概想学怎样驾驶。”他要我的证件，我把手伸进口袋，四处找了一下，然后说我肯定是把它忘在车里了，我这就去拿。我说，“大概十分钟。”他说，“没关系，好吧，签到就是了。”

从生产线一路走下来走下来——没遇到任何阻碍，直到一个叫勒罗伊的树干挡住了我们。

在警卫室里，我没有表现出不安和受惊，当事情不妙时，我就开始说些像是我真的很激动的话，比如我真的是那个人，他们不相信我让我很生气。

他们开始讨论或许他们应该打电话给那位我说是我上司的女士，然后从电脑上查到她家里的电话，我站在那里想，“一有机会就逃跑。”但是这里有停车场大门——即使我离开了这里，他们只要把大门关上我们就出不去了。

当勒罗伊打电话给那位斯蒂尔顿的上司并把电话递给我时，那位女士向我大叫“是谁，你是谁！”，我只是继续说着，就像我们在进行一次愉快的对话，然后挂断。

要多长时间才能想起某个能在半夜给你一个公司电话号码的人？我认为我们有至少 15 分钟的时间在那位女士打电话到警卫室往他们的耳朵里塞臭虫之前离开这里。

我们以最快的速度离开了这里，但没有看上去很匆忙，当看到大门的守卫挥手让我们过去时，真的很高兴。

### 10.1.3 过程分析

值得注意的是这个故事基于一个真实的事件，入侵者的确是青少年。这次入侵是闹着玩的，他们只是想看看能不能做到，但是如果这对两个青少年而言很容易，那对于成年的小偷、商业间谍或恐怖分子就应该更容易。

三个有经验的警卫怎么会允许两个入侵者就这样离开的呢？而且是任何明眼人都会觉得非常可疑的青少年？

勒罗伊起先的怀疑是正确，他很恰当地把他们带到了警卫室，然后盘问这个自称为汤姆?斯第尔顿的家伙，核对他给出的姓名和电话号码，也很恰当地打了电话给那位主管。

但最后他还是被这个年轻人装出来的自信和愤慨给骗了，他认为这不像是一个小偷或入侵者的行为——只有真正的员工才会这样做，他大概是真的。勒罗伊应该训练使用可靠的验证方式，而不是凭感觉。

当这个年轻人把电话挂上而不是还回来让勒罗伊直接从朱迪?安德伍德那里确认他有理由这么晚了还在工厂时，为什么他没有更多的怀疑？

勒罗伊被一个很明显的花招给骗了，但是当时从他的角度来看：一个中学毕业的人，关系到工作，不能确定是不是应该在半夜再次打扰一位公司主管。如果你是他，你会再打过去吗？

当然，再打一个电话过去并不是唯一的选择，警卫们可以怎么做呢？

在打电话之前，他可以要求他们两个人拿出照片证明：他们是开车到工厂的，所以至少会有一个人有驾驶执照，那么他们最初使用的假名字就会马上暴露（一个专业人员会预备好伪造的 ID，但是这两个青少年没有这样做）。无论如何，勒罗伊都应该检查他们的身份证件并写下这些信息。如果他们都坚持说证件不在身上，勒罗伊就应该和他们一起去拿“汤姆?斯第尔顿”声称放在车上的公司 ID 证件。

米特尼克信箱

社会工程师通常有很有魄力，他们反应迅速并且表达能力相当强，也很熟练转换人们的思考过程使其合作，任何一个认为自己对这种控制免疫的人都低估了这种能力和社会工程师的破坏力。

一个优秀的社会工程师，另一方面，绝不会低估他的对手。

在打完电话以后，应该要有一个警卫陪着那两个人直到他们离开工厂，然后送他们到他们的车里并写下车牌号码。如果他的观察力足够敏锐，就会注意到车牌（攻击者从跳蚤市场买来的）的注册号无效——这样就有了足够的理由把他们留下来进行更多的调查。

## 10.2 垃圾搜寻

垃圾搜寻是指从目标的垃圾中搜寻有用的信息，你可以了解到的目标信息数量十分惊人。大部分人不会仔细去想他们在家里都扔了些什么：电话清单、信用卡声明、医疗处方瓶子、银行结单、和工作有关的材料等等等等。

在工作中，员工们必须知道从垃圾中翻找出的信息也许对他们而言是有用的。

在我的中学时代，我常常跑到本地的电话公司大楼后面翻寻垃圾——大部分时间是一个人，偶尔也会和对电话公司感兴趣的朋友一起。当你成为一个垃圾搜寻老手之后，你会学到一些诀窍，比如怎样努力避开公共厕所的袋子，必要的耐磨手套等。

垃圾搜寻并不有趣，但很有成效——公司内部电话目录、电脑手册、员工列表、怎样设定交换机的废弃资料、等等——在这里都能获得。

我计划在新手册发行的当天晚上进行搜寻，因为垃圾箱里会有很多被轻率扔掉的旧手册。在其它不固定的时间，我也去搜寻备忘录、信件、报告等，它们会提供一些珍贵而有趣的信息。

到了以后我就找一些纸箱，把它们拿出来放在一边，如果有人问我（偶尔会发生）我就说一位朋友要走了，我找些箱子帮他整理。警卫从未发觉所有的文件都被我放进箱子带回家了，有时候他叫我离开，我就到另一个电话公司中心办公室去。

术语

垃圾搜寻：从一家公司的垃圾中（通常是在外部和易受攻击的地方）找出被抛弃的可用于社会工程学攻击的信息，例如内部的电话号码或资料。

我不知道现在怎么样，但是在过去可以轻易地知道哪一个袋子里会有有用的东西，地面清洁和自助餐厅的垃圾放在巨大的袋子里，当办公室的废纸篓全部摆满一次性的白色垃圾袋时，清洁人员就一个一个地把它们拿出来捆好。

有一次，当我和一些朋友一起搜寻时，我们弄到了一些被撕碎了的纸片：有人还特意撕得很小，全部都扔进了五加仑的专用垃圾袋。我们拿着袋子到了一家本地的油炸圈饼店，把这些碎片全部倒在一张桌子上，然后开始把它们一个个地拼起来。

我们全都是问题实干家，这个巨型智力拼图很有挑战性——但能得到比小孩子更多的酬劳。完成的时候，我们一起拼出了这家公司某个关键计算机系统的全部用户名和密码列表。

垃圾搜寻值得我们去冒险和努力吗？当然值得，甚至比你想的要好，因为风险为零。这在当时是真的并且在今天也是：只要你没有犯罪，翻寻别人的垃圾是百分之百合法的。

当然，电话盗打者和黑客们并不是唯一瞄准垃圾桶的人，这个国家的警察局经常翻查垃圾，很多小型贪污案的幕后主使就是因为这些从他们的垃圾中提取的证据被判了刑。情报机构，包括我们自己，采用这种方法已经有几年了。

可能这对于詹姆士?邦德而言太卑鄙了——电影人更愿意看到他用计谋去打败坏人，而不是在垃圾堆中努力奋斗。当一些有价值的东西周围堆放着香蕉皮、咖啡渣、报纸和食品目录时，现实中的特工很少有放弃的，特别是如果搜集这些信息不会给他们带来危险的话。

### 10.2.1 现金买垃圾

大公司也玩垃圾搜寻的游戏。报社在 2000 年 6 月忙了好一阵子来报道甲骨文公司（这家公司的 CEO 拉里?埃里森恐怕是这个国家最坦率地反对微软的人了）雇用的一家侦探公司被逮了个正着的事，那些侦探想要弄到竞争性科技协会（ACT，译者注：这个协会是微软为应对反托拉斯案创立的）的垃圾，但是不想有被抓住的风险。据新闻报道，他们派的那位女士想用 60 美元现金向一位看门人买下 ACT 的那些垃圾，结果被拒绝了，她第二天晚上再回来的时候，把价钱上升到给清洁工 500 美元和给主管 200 美元，但那位清洁工拒绝了这笔意外之财并且汇报了这一情况。

领先一步的在线新闻记者迪克兰?迈古拉引用了很多资料，他在连线新闻故事中使用的标题是“甲骨文紧盯微软”，《时代》周刊紧跟甲骨文的埃里森，他们报道的标题是“偷窥的拉里”。

### 10.2.2 过程分析

基于我自己的经历和甲骨文的经历，你可能会感到奇怪：为什么人们要惹麻烦去冒险偷别人的垃圾？

答案，我认为，是因为风险为零并且好处多多。好吧，也许去贿赂看门人增加了成功的几率，但是在任何愿意变脏一点的人看来，完全没有必要去贿赂。

对于一个社会工程师而言，垃圾搜寻自有它的好处，他可以得到足够的信息来指引他对目标公司的攻击,这些信息包括备忘录、会议议程、信件和那些泄漏的姓名、部门、标题、电话号码与工程任务。垃圾桶里出产公司机构图、法人结构信息、旅行时间表等等，这些资料对内部人员而言价值不高，但是它们在攻击者看来可能是很贵重的信息。

马克?约瑟夫?爱德华兹（Mark Joseph Edwards）在他的书《Windows NT 因特网安全》中谈到“整份报告因为排版错误而被扔了，密码被写在残余的纸片上，‘当你离开的时候’的讯息上有电话号码，所有文件的文件夹还在里面，磁盘和录音带没有被清除或销毁，这些都可以帮助一名想要入侵的人。”

作者接下来问道：“你的清洁队里都有些什么人？你不允许清洁工进入计算机机房，但是别忘了那些垃圾桶。如果联邦机构认为有必要对那些有权使用他们的废纸篓和碎纸机的人进行后台检查，你或许就更应该这样做。”

米特尼克信箱

你的垃圾可能是你对手的财富。我们对那些在我们的个人生活中扔掉的东西考虑得并不多，有什么理由让我们相信人们在工作中会有不同的态度呢？这些都涉及到训练员工了解威胁（搜寻有用信息的坏人）和弱点（没有被粉碎或完全清除的敏感信息）。

## 10.3 被羞辱的上司

当哈伦?福尔蒂在星期一早晨像往常一样到郡公路局上班，并说他从家里出来得太急忘了带证件时，没有人对这件事有任何想法。那个警卫在这里工作了两年，天天看着哈伦进进出出，她给了他一个临时员工证件并要他签上名。然后他继续行动。

两天以后，灾难降临了。那个故事在整个公路局里快速传播着，有一半的人不敢相信这是真的，其余的人则不知道是哈哈大笑好还是该同情这个可怜的人。

毕竟，乔治?阿达姆松（George Adamson）是个友好而富于同情心的人，是他们曾经有过的最好的上司，这些不应该发生在他身上。当然，如果这个故事是真的的话。

星期五晚些时候，当乔治把哈伦叫到办公室里并尽可能温和地告诉他，星期一他要到卫生局的新工作上报到时，麻烦开始了。对于哈伦而言，这比被解雇更坏，他绝不能忍受这种羞辱。

那天傍晚他独自一人坐在阳台上注视着来来往往的车辆，最后他发现那个被人称作“战争游戏男孩”的大卫正骑着电动车从学校回来。他把大卫叫住，给了他一瓶特意买来的红色密码（译者注：百事可乐的一种桃红色威士忌），然后提出了一个交易：用最新的电视游戏机和六个游戏换取少量的电脑帮助和一个保守秘密的承诺。

在哈伦解释了任务之后——没有任何危险的细节——大卫同意了，他详细描述了哈伦要做的事情，买一个调制调解器，进入办公室，找到一台旁边有多余电话插口的电脑，插上调制调解器，把它放到桌子下面一个没人能看见的地方。接下来的事情有一定的危险，哈伦要坐在那台电脑上安装一个远程控制软件包并运行，在这个办公室里工作的人可能会在任何时间出现，或者某个经过这里的人会看见他在别人的办公室里。哈伦非常紧张，因为他很难读懂大卫为他写下的使用说明，但他还是办到了，并且在没有任何人注意到的情况下溜了出来。

### 10.3.1 埋下炸弹

大卫吃完晚饭后留了下来，两个人坐在哈伦的电脑面前，这个男孩花了点时间拨入那个调制调解器，获得访问权限，然后到达了乔治?阿达姆松的机器。这并不很难，乔治从没有过任何防范措施（比如更改密码），并且总是让这个或那个人为他下载或 Email 某个文件，这样一来，办公室里的每个人都知道了他的密码。稍微搜索之后大卫找到了一个名为 BudgetSlides2002.ppt 的文件，他把它下载到了哈伦的电脑上，然后哈伦让他先回家，几个小时候再来。

当大卫回来的时候，哈伦要他再次连接到公路局的电脑系统并用一个相同的文件覆盖掉之前找到的那个文件。之后哈伦给大卫看了那个电视游戏机，并许诺一切顺利的话，第二天他就可以拿到它。

### 10.3.2 吃惊的乔治

想不到预算听证会这种很无聊的事情能让这么多人感兴趣，郡参议会的办公室里挤满了记者、专业兴趣组的代表、公众成员，甚至还有两个电视新闻组。

乔治在这些会议上总是有些战战兢兢。郡参议会掌管着财政，如果他不能拿出一份有说服力的报告的话，公路局的预算就会被否决掉，然后每个人都会开始抱怨道路上的洞坑、不亮的红绿灯和危险的十字路口，并且责怪他，接下来整整一年的生活都会变得极度拮据。但是这天晚上当他被介绍时，他很有自信地站了起来。他已经为这个报告工作了六个星期，还给他的妻子、高层的同事和一些敬重的朋友试验过这个 PowerPoint 演示，每个人都认为这是他有过的最好的报告。

起先的三个 PowerPoint 图片显示得很好，换了个心情，每一个参议会的成员都专心起来，他有效地表达了自己的观点。

然后一切都突然变得不正常了，第四张图片应该是去年新扩建的公路日落时的美丽画面，却变成了一些令人难堪的东西，一张来自《阁楼》或《好色客》杂志的图片。当他匆忙点击便携式电脑的按钮进入下一张图片时，他听到下面的观众全都倒吸了一口气。

这一个更糟，简直就难以想象。

他仍然试图单击到另一张图片，但观众里的某个人拔下了放映机的插头，然后主席重重地敲下了他的槌子，压过喧闹大声宣布会议暂停。

### 10.3.3 过程分析

利用一个少年黑客的专业技术，一个不满的员工进入了他的部门主管的电脑，下载了一个重要的 PowerPoint 文件，并把一些幻灯片替换成了几张令人难堪的图片，然后把这个文件放回到那个人的电脑。

通过一个插好的调制调解器，这个年轻的黑客可以从外部拨入并连接到办公室的某台电脑。这个男孩预先安装了一个远程控制软件，只要连接到那台电脑，他就可以访问系统里的每一个文件。之前这台电脑已经被连接到了网络，他也知道了这个主管的用户名和密码，他可以轻易地访问主管的文件。

包括搜索杂志图片的时间，总共才用了几个小时，结果让一个好人的声誉受到了难以估量的损失。

米特尼克信箱

大多数被调动、解雇或被降职的员工都不是麻烦，但只要有一个就可以让公司认识到所有的防范措施都太迟了。经验和统计图表都清晰地表明了企业面临的最大威胁来自于内部人员，内部人员知道哪里有贵重信息，攻击哪里可以造成最大伤害。

## 10.4 营销员

一个舒适的秋天上午，彼得?米尔顿（Peter Milton）走进了光荣汽车零配件（一个汽车零件市场的本土零件批发商）丹佛区域办公室大厅，他在接待处等待着，那个年轻的女士正在登记一个访客，给一个打来电话的人驾驶指引，应付接连不断的人，所有这些差不多都是在同一时间。

“你是怎样学会同时处理这么多事情的？”彼得在她有空接待他的时候说，她笑了，显然很高兴。他来自达拉斯办公室的营销部，他告诉她，并说亚特兰大销售区预的迈克?塔尔伯特（Mike Talbott）要和他会谈。“今天下午我们要一起去拜访一位客户，”他解释说，“我就在大厅里等他。”

“营销，”她说这个词的时候几乎有些忧伤，彼得微笑着看着她，等待着下文，“如果我上了大学的话，我就会做营销员。”她说，“我喜欢营销这份工作。”

他再一次笑了，“凯拉，”他说，把前台上她的签名读了出来，“我们达拉斯办公室有位女秘书，她自己离开了营销部，那是三年前的事了，现在她是市场经理助理，她换了两次工作。”

凯拉似乎在幻想了，他继续说，“你会用电脑吗？”“当然。”她说。

“你觉得我把你的名字放到营销部的秘书职位上怎么样？”

她笑了，“那样我就能到达拉斯去了。”

“你会喜欢达拉斯的，”他说，“我不能保证马上就有机会，但我会尽力的。”

她想，这个衣服和领带十分整洁、头发梳得整整齐齐的好人可能会让她的工作和生活发生巨大改变。

彼得穿过大厅坐了下来，打开他的便携式电脑，然后开始完成一些工作。十或十五分钟以后，他又走回了前台。“听着，”他说，“好像迈克被什么事拖住了，这里有会议室可以让我在等待的时候坐下来写电子邮件吗？”

凯拉打电话给了负责调配会议室的人并为彼得安排了一个没有登记的会议室。这里的会议室仿照了一些硅谷公司的做法（苹果也许是第一个这样做的），用卡通人物、连锁饭店、电影明星或连环漫画英雄的名字来命名。他被告知可以去用米老鼠会议室，她先帮他登记，然后给他指出了米老鼠的方向。

他找到了那个会议室，安顿下来，把他的便携式电脑连上了以太网端口。

你看到这个场景了吗？

对——这个入侵者已经在公司的防火墙内部连入局域网了。

### 10.4.1 安东尼的故事

我猜你可能会把安东尼?莱克（Anthony Lake）称为懒惰的商人，或者是近乎“古怪”的人。

他认为他应该为自己工作，而不是为别人：他想开一个商店，这样他就可以整天都待在一个地方而不用在乡下到处跑了，他想做一些肯定能赚到钱的生意。

开什么店好呢？没过多久他就决定了，他知道修车，就零配件商店好了。

怎样才能保证成功呢？他很快就想到了答案：确定零配件批发商出售给他的商品都是他想要的成本价。

他们当然不会自动说出来，但是安东尼知道怎样骗人，他的朋友米奇知道如何入侵别人的电脑，他们一起制定了一个巧妙的计划。

那天他假扮成一个名叫彼得?米尔顿的员工，进入了光荣汽车零配件公司内部并把他的便携式电脑连上了他们的局域网，一切顺利，但还只是第一步，接下来他要做的事情并不容易，特别是之前安东尼为自己设置了一个十五分钟的极限时间——如果更久的话他认为被发现的风险太高了。

米特尼克信箱

不要让你的员工只看到封面就判定一本书的好坏——穿着整洁并不能为某个人带来更多的可信度。

在之前的电话中他伪装成他们电脑供应商的支持人员花言巧语地表演了一番，“你们公司购买了两年的技术支持，我们正在把你们加入数据库，这样当你们使用的某个软件程序有了补丁或是更新版本时我们就可以知道，我需要你告诉我你们使用哪些程序。”然后他得到一张程序列表，一位会计师朋友确定其中一个调用了 MAS90（译者注：一款财务软件）——这个程序管理着他们的厂商列表和折扣与各自的付款方式。

有了这些关键信息，他下一步用一个软件程序扫描了局域网中所有的存活主机，没花多少时间他就找到了财务部门服务器的正确位置。从他的便携式电脑的黑客工具兵器库中，他运行了一个程序并用它来扫描目标服务器上所有的授权用户。得到了这些之后，他开始尝试了一系列常用的密码，比如“空”和“password”，“Password”起作用了，没什么好吃惊的，在选择密码的时候人们总是缺乏创造力。

才过了六分钟，游戏就完成了一半，他进入了目标服务器。

又过了三分钟，他非常小心地往客户列表里添加了他的新公司、地址、电话号码和联系人，然后找到一个至关重要的条款，在上面标明所列商品以高于光荣汽车零配件成本 1%的价格卖给他。

十分钟不到，他完成了。然后他停留了足够长的时间向凯拉表示感谢，并说他仔细查看了电子邮件，了解到计划有变动，迈克?塔尔伯特已经在去客户办公室开会的路上了，他也不会忘了要把她推荐到营销部门的事。

### 10.4.2 过程分析

这个自称为彼得?米尔顿的入侵者运用了两次心理战术——一次是有计划的，另一次是临时准备的。

他穿得像是工资很高的管理人员，精心设计的衣服、领带和发型——这些细节看上去很小，但是它们能建立第一印象。我自己是无意中发现了这些的，以前我在加利福尼亚州 GTE（译者注：美国通用电器公司）当程序员时，我发现如果有一天我没有带证件，穿着整洁但随意——比如，运动衫、休闲裤与 Dockers（译者注：卡其裤经典品牌）——我就会被叫住被盘问，你的证件，你是谁，你在哪里工作？第二天我再来的时候，依然没有证件但是衣服和领带看上去非常正规，我用了一个古老的技术混入人群，和他们一起走进公司或安全入口，和他们聊天，好像我就是他们中的一员。我顺利通过了，即使警卫注意到我没有证件，他们也不会打扰我，因为我看起来像是管理人员并且还和带着证件的人在一起。

从这些经验中，我了解到应该怎样预测安全警卫的行为，像是我们中的其他人，他们会根据表面现象进行判断——社会工程师知道怎样利用这个致命弱点。

当攻击者注意到那位接待员不同寻常的努力之后，他的第二个心理战术起作用了。同时处理很多事情没有让她变得不耐烦，不仅如此，她还让每个人都觉得他们获得了她全部的注意力，他觉得这些是有上进心、想证明自己的人的标志。然后当他声称在营销部门工作时，他观察了她的反应，看他是否在她心中建立了友好的形象，他做到了。对于攻击者而言，这意味着他可以通过承诺帮她找到一份更好的工作来利用她。（当然，如果她说她想去财务部门，他就会声称自己可以在那里为她联系一份工作。）

入侵者也喜欢在这个故事里使用的另一个心理战术：用两段攻击建立信任。他首先聊到营销部的工作，然后“提到某个人”——说出另一个员工的名字——一个真实的人，顺便说一句，那的确是一个真实员工的名字。

他可以马上请求到一间会议室去，但他选择了暂时坐下来，假装在工作并等待他的同事，这样就可以避免任何可能的猜疑，因为一个入侵者是不会待在附近的。他没有待很长时间，然而，社会工程师在必要的情况下会待在犯罪现场更长时间。

米特尼克信箱

允许一个陌生人进入到可以把便携式电脑连入公司内部网络的地方，会大大增加安全风险。这对于一名员工而言非常合理，但是对于一个想要到会议室查看他（或她）的电子邮件的外部人员，除非已经确定这名访客为可信任的员工或者网络已经被分割出来，阻止未经授权的连接，这可能是危及公司文件的薄弱环节。

必须明确指出的是：从法律的角度上看，安东尼进入大厅时，他并没有犯法；当他利用一个真实员工的名字时，他也没有犯法；当他进入会议室时，他也没有犯法；当他连入公司的内部网络并搜索目标主机时，他也没有犯法。

实际上直到他侵入了计算机系统时，他才违反了法律。

## 10.5 偷窥的凯文

很多年前，当我在一个小公司工作时，我注意到当我走进和其他三个人共用的 IT 部门办公室时，有一个特殊的人（乔，我在这里这样称呼他）会迅速地把他的电脑显示器切换到另一个窗口，我马上觉得这很可疑，当同一天发生超过两次这样的事时，我确信自己将要了解到某些事，这个人到底不想让我看见什么呢？

乔的电脑是公司小型机的终端，所以我在 VAX 小型机上安装了一个控制程序，这样我就可以监视他的一举一动。这个程序类似于一个在他肩膀上面的电视摄像机，把他在电脑上看到的东西精确地展示给我。

我的桌子就在乔的旁边：我可以把显示器转过来让他看不见，但是他随时都可以走过来，然后发觉我在监视他。这不是问题：他太专注于所做的事情了。

我看到的东西让我目瞪口呆，这个坏蛋调出了我的工单数据，他在查看我的工资！那时候我在那里才几个月，我猜乔是无法容忍我的工资比他高。

几分钟后我看见他在下载菜鸟黑客自己写不出来的黑客工具，这样看来乔没什么本事，并且还没有意识到美国最有经验的黑客就坐在他的右边，我觉得这很好玩。

他已经获得了我的工资信息：要阻止他已经太晚了。此外，任何电脑可以访问 IRS（译者注：美国国税局）或社会保障总署的员工都可以看见你的工资。我当然不想让他发现我知道了他在干什么，我此时的主要目标是保持低调，一个好的社会工程师不会去到处宣传他的知识与才干。你通常想让人们低估你，不把你当成威胁。

所以我没有管他了，并且为乔认为他知道了我的一些秘密而暗自发笑。当这些都反过来时：我获得的信息会比他多得多。

我发现我在 IT 部门的三个同事全都喜欢查看这个或那个可爱秘书或（为公司里的一个女孩子）他们盯上的某位帅哥的实得工资，并且他们还喜欢找出公司里任何令他们好奇的人（包括高层管理人员）的工资和奖金。

过程分析

这个故事说明了一个很有趣的问题，维护公司电脑系统的人可以轻易地访问工资表文件，这带来的问题是：确定谁可以被信任。在某些情况下，IT 人员会在四处察看时无法避免地看到它，他们可以这样做，因为他们有特权允许他们忽略这些文件的访问控制。

一个安全措施是审核对特别敏感的文件的访问，比如工资表。当然，任何必需有特权的人都可以关闭审核或移除任何指向他们的纪录，但是每一步额外的步骤都会使不道德的员工在隐藏部分上花费更多的时间。

### 10.6 预防措施

从翻寻你的垃圾到欺骗安全警卫或接待员，社会工程师可以全面侵入你的公司内部，但是你会很高兴听到这里有一些你可以采取的预防措施。

### 10.6.1 临时通行证

所有上班时忘记带证件的员工都必须到大厅前台或警卫室办理一张临时证件，如果这一章第一个故事中的安全警卫在遇到没有携带员工证件的人时仔细地进行了处理，一切就会大不相同。

对于安全等级不高的公司或公司区域，也许并不需要强调每个人每时每刻都带着有效证件，但是对于公司中的敏感区域，这些就需要被严格地强制实行。必须培训员工去质疑没有佩戴证件的人，高级员工必须允许这些质疑，不去为难那些把他们叫住的人。

公司政策应该忠告那些一直没有佩戴证件的员工：他们所受的处罚可能是直接回家并且拿不到任何报酬，或者在他的个人档案上写上一笔。一些公司制定了一系列更严厉的处罚，包括向员工经理报告问题，然后发布正式警告。

另外，在有受保护的敏感资料的地方，公司应该制定在非商业时间访问的授权程序。一个解决方案是：让公司的安全部门或某个其它指定组管理这些请求，这个组将通过回电给主管或其它一些相当合理的方法来核实任何请求在非工作时间访问的员工的身份。

### 10.6.2 慎重处理垃圾

垃圾搜寻的故事揭示了公司的垃圾存在的潜在危险。

下面是八条与之相关的至理名言：

1．基于敏感程度对敏感资料进行分类。

2．在整个公司范围内建立敏感资料丢弃程序。

3．坚持在丢弃敏感信息时先将其粉碎，并使用一个安全的方法去除无法再剪碎的小纸片上的重要信息。碎纸机绝对不能处于低档粉碎状态，一个坚定的攻击者，加上足够的耐心，就可以把这些低档粉碎出来的纸片拼起来。只要很好的使用了交叉碎纸机，他们得到的就会是无用的纸浆。

4．将那些电脑媒体——软盘、Zip 盘、被用来存储文件的 CD 和 DVD、可移动磁盘、旧硬盘等——完全清除或使其无法使用，在它们被丢掉之前。记住，删除文件事实上并没有将其清除，它们还可以被恢复——就像 Enron 主管和其他许多人从他们的惊讶中学到的那样，把电脑媒体扔到垃圾桶里是在向当地友好的垃圾搜寻者发出邀请。（处理媒体与设备的详细指导方针见第十六章）

5．在选择清洁队成员上保持适当程度的控制，如果允许的话进行后台检查。

6．周期性地提醒员工回想他们扔到垃圾桶里的资料种类。

7．锁定垃圾搜寻者。

8．对敏感资料使用分散存储空间，与可信赖的专业资料处理公司签订合同。

### 10.6.3 对员工说再见

这一点在这几页之前就谈到了，当一名离职员工想要获得敏感信息、密码、拨入号码等等时，需要执行严格的程序。你的安全程序需要提供一个多种系统的授权纪录。也许很难阻止一个坚定的社会工程师突破你的防御网，但是不要让一个离职员工都可以轻易做到。

另一个措施很容易被忽视：当一名可以从存储器恢复备份数据的员工离开时，应当为存储器调用一个写好的策略，马上通知将她的名字从授权列表中删除。

这本书的第十六章详细讲述了这个重要主题，但是在这里列出某些适当的安全措施很有帮助，就像通过那个故事强调的那样：

按照一张完整、严格的步骤列表上的内容处理一名员工的离职，对于访问过敏感数据的员工要有特殊的规定。

关闭员工的直接访问权限——最好在其离开公司之前。

不仅恢复员工 ID 证件需要按程序进行，任何密匙或电子访问设备也同样需要。

规定在允许任何没有安全密码的员工进入之前安全警卫要查看他或她的照片 ID，在验证列表上核实姓名，确定这个人仍是这家公司的员工。

更多的步骤对于一些公司而言未免太繁琐或太昂贵了,但是却适合一些其他的公司，下面是一些更严格的安全措施：

电子 ID 证件结合入口处的扫描器，当每个员工将他的证件从扫描器上划过时，电子实时判断会得出此人为当前员工并有权进入大楼。（注意，无论如何还是必须被培训安全警卫提防蒙混过关者——一个未经认证紧跟在合法员工身后的人。）

所有员工都必须在同一组内，当某个人离开时（尤其是如果这个人被解雇了）更改他们的密码。（看上去很偏激？在通用电器公司工作的那一段时间之后很多年，我了解到当太平洋电话的警卫听到通用电器公司把我解雇了时，“到处都是笑声。”但是对于通用电器公司的信任，当他们了解到一个有名的黑客曾经为他们工作时，在解雇了我之后，他们就必须更改公司里所有人的密码！）

你不想让你的公司变得像牢房一样，但是同时你需要防范那些刚被解雇就跑来想做坏事的人。

### 10.6.4 不要忘记任何人

安全警卫要注意入门级的员工，比如并不处理公司敏感信息的接待员。我们曾经在其它地方看到过，接待员是最受攻击者青睐的目标，本章中闯入汽车零配件公司的故事则是另一个例子：一个友好的穿着很专业的人，可能并不是他所声称的来自其它区域分公司的员工。需要良好的培训接待员，如何在适当的时候礼貌地请求公司 ID，培训不只是针对主要的接待员，还包括每一个在午餐或下午茶时间零时坐在接待处的人。

对于公司外部的访客，需要查看其照片 ID 并记录信息。伪造 ID 并不很难，但至少严格的 ID 验证可以让攻击者使用电话冒充更加困难。

在一些公司，实行全程陪同访客（从大厅到会议室）的安全策略很有意义，程序应该规定陪同人员在把访客送到会面地点之前要先弄清楚这个人是员工还是非员工。为什么这很重要？因为就像我们在之前的故事中看到的那样，攻击者经常会变换角色，在大厅中表演对他们而言实在是太简单了，使接待员相信他有一个会议要参加，说，有个工程师……陪他到那个工程师的办公室……与工程师会谈之后，他才可以自由行动。

在允许一名异地员工进入之前，必须履行适当的程序，确认此人真的是公司的员工。接待员和警卫必须要了解攻击者伪造身份所使用的方法。

怎样阻止攻击者进入大楼并把便携式电脑连入公司的内部网络？拜当今的技术所赐，这的确是个挑战：会议室、培训室和其它类似的地方都不应该留下不安全的网络端口，应使用防火墙或路由器将其保护起来，但更好的做法是使用安全的方法对任何连入网络的用户进行识别。

### 10.6.5 保护 IT 部门！

忠告：在你的公司里，IT 部门的每一位员工或许都知道（或能花几分钟时间找出）你的收入、CEO 的实得工资和谁用了公司的钱去滑雪度假。

在一些公司甚至有可能出现 IT 人员或会计人员给他们自己加工资、向一个伪造的卖家付款、删除人力资源档案中消极的评价等情况。有时候只是因为担心被抓住，他们才没有那样做，直到有一天，某个贪婪或本性不诚实的人冒着风险做了所有他认为能免于责罚的事情。

这里当然也有解决方案，可以通过配置严格的访问控制来保护敏感文件，所以只要验证访问者有权打开它们。有一些操作系统的审核控制能设定保留事件的日志，比如每一个试图访问敏感文件的人（无论是否访问成功）。

如果你的公司了解了这一问题并恰当地实现了对敏感文件的访问控制与审核——你就在正确的方向上迈出了强有力的一步。