<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Symmetric Key Ciphers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Symmetric Key Ciphers</h1>
<blockquote>原文：<a href="https://cryptobook.nakov.com/symmetric-key-ciphers">https://cryptobook.nakov.com/symmetric-key-ciphers</a></blockquote><header class="max-w-3xl page-width-wide:max-w-screen-2xl mx-auto mb-6 space-y-3 page-api-block:ml-0 page-api-block:max-w-full page-no-ancestors"><div class="flex h-fit items-stretch justify-start overflow-hidden *:translate-y-0! *:shadow-none! [&amp;&gt;*:not(:first-child)]:border-l-0 [&amp;&gt;*:not(:first-child,:last-child)]:rounded-none! [&amp;&gt;*:not(:only-child):first-child]:rounded-r-none [&amp;&gt;*:not(:only-child):last-child]:rounded-l-none float-right ml-4 xl:max-2xl:page-api-block:mr-62 -mt-3 xs:mt-2"><button type="button" class="button group/button inline-flex items-center gap-2 rounded-md straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 contrast-more:border-tint-12 contrast-more:hover:border-2 contrast-more:hover:border-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:depth-flat:bg-tint-hover hover:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 py-1 px-2 bg-tint-base text-sm" aria-label="Copy page" data-state="closed"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/copy.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/copy.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon button-leading-icon size-[1em] shrink-0"/><span class="button-content truncate">Copy</span></button><button type="button" class="button group/button inline-flex items-center gap-2 rounded-md straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 contrast-more:border-tint-12 contrast-more:hover:border-2 contrast-more:hover:border-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:depth-flat:bg-tint-hover hover:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 py-1 px-1.5 group/dropdown bg-tint-base text-sm" aria-label="More" id="radix-_R_8mqav5ukqiv5ubsnpfivb_" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/chevron-down.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/chevron-down.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon button-leading-icon shrink-0 size-3 transition-transform group-data-[state=open]/button:rotate-180"/></button></div></header><div class="flex flex-col [&amp;&gt;*+*]:mt-5 whitespace-pre-wrap"><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start"><strong class="font-bold">Symmetric key ciphers</strong> (like <strong class="font-bold">AES</strong>, <strong class="font-bold">ChaCha20</strong>, <!-- --><strong class="font-bold">RC6</strong>, <!-- --><strong class="font-bold">Twofish</strong>, <!-- --><strong class="font-bold">CAST</strong> and many others) use the same key (or password) to <!-- --><strong class="font-bold">encrypt</strong> and <!-- --><strong class="font-bold">decrypt</strong> data. They are often used in combination with other algorithms into a <!-- --><strong class="font-bold">symmetric encryption schemes</strong> (like <!-- --><strong class="font-bold">ChaCha20-Poly1305</strong> and <!-- --><strong class="font-bold">AES-128-GCM</strong> and <!-- --><strong class="font-bold">AES-256-CTR-HMAC-SHA256</strong>), often with password to <!-- --><strong class="font-bold">key derivation</strong> algorithms (like <!-- --><strong class="font-bold">Scrypt</strong> and <!-- --><strong class="font-bold">Argon2</strong>). Symmetric key ciphers are <!-- --><strong class="font-bold">quantum-resistant</strong>, which means that powerful quantum computers will not be able to break their security (when big enough key lengths are used). Symmetric ciphers can encrypt data coming as blocks of fixed size (<!-- --><strong class="font-bold">block ciphers</strong>) or data coming as a sequence of bytes (<!-- --><strong class="font-bold">stream ciphers</strong>). Block ciphers can be transformed to stream ciphers by certain constructions, known as "<!-- --><strong class="font-bold">block cipher modes</strong> of operation".<!-- --></p><h2 id="symmetric-encryption-decryption" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="#symmetric-encryption-decryption"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-tight">Symmetric Encryption / Decryption</div></h2><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start"><strong class="font-bold">Symmetric encryption</strong> and decryption uses a <strong class="font-bold">secret key</strong> or passphrase (to derive the key from it). The <strong class="font-bold">secret key</strong> used to encrypt and decrypt the data is usually 128 bits or 256 bits and is called "<strong class="font-bold">encryption key</strong>". Sometimes it is given as hex or base64-encoded integer number or is derived through a <strong class="font-bold">password-to-key derivation scheme</strong>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">When the input data is encrypted, it is transformed to <strong class="font-bold">encrypted ciphertext</strong> and when the ciphertext is decrypted, it is transformed back to the original input data.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="eager" class="block" src="../Images/7b624a9886119bbb90d3f2d72027fa15.png" srcset="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=400&amp;dpr=1&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 400w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=400&amp;dpr=2&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 800w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=400&amp;dpr=3&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 1200w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=400&amp;dpr=4&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 1600w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=768&amp;dpr=1&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 768w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=768&amp;dpr=2&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 1536w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 2304w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=aa7f806a&amp;sv=2 3072w" sizes="(max-width: 640px) 400px, 768px" width="520" height="229" data-original-src="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-1d821c1ae9ad3e8c4daed9500ebca568e520874b%252Fsymmetric-key-encryption-decryption.gif%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=aa7f806a&amp;sv=2"/></div></div></div></div><h2 id="symmetric-encryption-uses-a-set-of-algorithms" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="#symmetric-encryption-uses-a-set-of-algorithms"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-tight">Symmetric Encryption Uses a Set of Algorithms</div></h2><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">It is important to know as a concept that symmetric-key encryption algorithms usually do not work standalone. They work together with other related crypto algorithms, into a <strong class="font-bold">symmetric encryption scheme</strong> / <strong class="font-bold">symmetric encryption construction</strong>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">In most encryption schemes an <strong class="font-bold">encryption</strong> is combined with password to <strong class="font-bold">key derivation</strong> algorithm and <strong class="font-bold">message authentication</strong> scheme (see <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Authenticated_encryption">authenticated encryption<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>). Typically a symmetric encryption procedure uses a sequence of steps, involving different crypto algorithms:</p><ul class="min-w-0 space-y-2 mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl page-api-block:ml-0"><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">Password-to-key derivation</strong> algorithm (like Scrypt or Argon2): to allow using a password instead of a key and to make password cracking hard and slow to be performed.</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">Block to stream cipher transformation</strong> algorithm (block cipher mode like <strong class="font-bold">CBC</strong> or <strong class="font-bold">CTR</strong>) + <strong class="font-bold">message padding</strong> algorithm like <strong class="font-bold">PKCS7</strong> (in some modes): to allow encrypting data of arbitrary size using a block cipher algorithm (like <strong class="font-bold">AES</strong>).</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">Block cipher algorithm</strong> (like <strong class="font-bold">AES</strong>): to securely encrypt data blocks of fixed length using a secret key.</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">Message authentication</strong> algorithm (like <strong class="font-bold">HMAC</strong>): to check whether after decryption the obtained result matches the original message before the encryption.</p></div></li></ul><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Later in this section we shall give <strong class="font-bold">more details and examples</strong> about how to configure and use symmetric block ciphers (like AES) along with the all above described algorithms to securely encrypt and decrypt messages of arbitrary size.</p></div>    
</body>
</html>