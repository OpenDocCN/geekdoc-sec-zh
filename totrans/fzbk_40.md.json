["```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import YouTubeVideo\nYouTubeVideo(\"Z7Z0cdwPS0U\") \n```", "```py\ndef triangle(a, b, c):\n    if a == b:\n        if b == c:\n            return 'equilateral'\n        else:\n            return 'isosceles #1'\n    else:\n        if b == c:\n            return 'isosceles #2'\n        else:\n            if a == c:\n                return 'isosceles #3'\n            else:\n                return 'scalene' \n```", "```py\ntriangle(2, 3, 4) \n```", "```py\n'scalene'\n\n```", "```py\nfrom [random](https://docs.python.org/3/library/random.html) import randrange \n```", "```py\nfor i in range(10):\n    a = randrange(1, 10)\n    b = randrange(1, 10)\n    c = randrange(1, 10)\n\n    t = triangle(a, b, c)\n    print(f\"triangle({a}, {b}, {c}) = {repr(t)}\") \n```", "```py\ntriangle(4, 1, 7) = 'scalene'\ntriangle(4, 5, 3) = 'scalene'\ntriangle(7, 2, 1) = 'scalene'\ntriangle(7, 6, 9) = 'scalene'\ntriangle(5, 5, 8) = 'isosceles #1'\ntriangle(1, 7, 1) = 'isosceles #3'\ntriangle(6, 4, 8) = 'scalene'\ntriangle(8, 9, 5) = 'scalene'\ntriangle(4, 8, 3) = 'scalene'\ntriangle(6, 1, 1) = 'isosceles #2'\n\n```", "```py\nimport [sys](https://docs.python.org/3/library/sys.html)\nimport [inspect](https://docs.python.org/3/library/inspect.html) \n```", "```py\ndef traceit(frame, event, arg):\n    function_code = frame.f_code\n    function_name = function_code.co_name\n    lineno = frame.f_lineno\n    vars = frame.f_locals\n\n    source_lines, starting_line_no = inspect.getsourcelines(frame.f_code)\n    loc = f\"{function_name}:{lineno}  {source_lines[lineno  -  starting_line_no].rstrip()}\"\n    vars = \", \".join(f\"{name} = {vars[name]}\" for name in vars)\n\n    print(f\"{loc:50} ({vars})\")\n\n    return traceit \n```", "```py\ndef triangle_traced():\n    sys.settrace(traceit)\n    triangle(2, 2, 1)\n    sys.settrace(None) \n```", "```py\ntriangle_traced() \n```", "```py\ntriangle:1 def triangle(a, b, c):                  (a = 2, b = 2, c = 1)\ntriangle:2     if a == b:                          (a = 2, b = 2, c = 1)\ntriangle:3         if b == c:                      (a = 2, b = 2, c = 1)\ntriangle:6             return 'isosceles #1'       (a = 2, b = 2, c = 1)\ntriangle:6             return 'isosceles #1'       (a = 2, b = 2, c = 1)\n\n```", "```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import rich_output \n```", "```py\nimport [ast](https://docs.python.org/3/library/ast.html) \n```", "```py\nif rich_output():\n    # Normally, this will do\n    from [showast](https://pypi.org/project/showast/) import show_ast\nelse:\n    def show_ast(tree):\n        ast.dump(tree, indent=4) \n```", "```py\ntriangle_source = inspect.getsource(triangle)\ntriangle_ast = ast.parse(triangle_source)\nshow_ast(triangle_ast) \n```", "```py\ndef collect_conditions(tree):\n    conditions = []\n\n    def traverse(node):\n        if isinstance(node, ast.If):\n            cond = ast.unparse(node.test).strip()\n            conditions.append(cond)\n\n        for child in ast.iter_child_nodes(node):\n            traverse(child)\n\n    traverse(tree)\n    return conditions \n```", "```py\ncollect_conditions(triangle_ast) \n```", "```py\n['a == b', 'b == c', 'b == c', 'a == c']\n\n```", "```py\nimport [z3](https://github.com/Z3Prover/z3#readme) \n```", "```py\na = z3.Int('a')\nb = z3.Int('b')\nc = z3.Int('c') \n```", "```py\ns = z3.Solver()\ns.add(z3.And(a > 0, b > 0, c > 0))  # Triangle edges are positive\ns.add(z3.And(a != b, b != c, a != c))  # Our condition\ns.check() \n```", "```py\nm = s.model()\nm \n```", "```py\ntriangle(m[a].as_long(), m[b].as_long(), m[c].as_long()) \n```", "```py\n'scalene'\n\n```", "```py\ndef collect_path_conditions(tree):\n    paths = []\n\n    def traverse_if_children(children, context, cond):\n        old_paths = len(paths)\n        for child in children:\n            traverse(child, context + [cond])\n        if len(paths) == old_paths:\n            paths.append(context + [cond])\n\n    def traverse(node, context):\n        if isinstance(node, ast.If):\n            cond = ast.unparse(node.test).strip()\n            not_cond = \"z3.Not(\" + cond + \")\"\n\n            traverse_if_children(node.body, context, cond)\n            traverse_if_children(node.orelse, context, not_cond)\n\n        else:\n            for child in ast.iter_child_nodes(node):\n                traverse(child, context)\n\n    traverse(tree, [])\n\n    return [\"z3.And(\" + \", \".join(path) + \")\" for path in paths] \n```", "```py\npath_conditions = collect_path_conditions(triangle_ast)\npath_conditions \n```", "```py\n['z3.And(a == b, b == c)',\n 'z3.And(a == b, z3.Not(b == c))',\n 'z3.And(z3.Not(a == b), b == c)',\n 'z3.And(z3.Not(a == b), z3.Not(b == c), a == c)',\n 'z3.And(z3.Not(a == b), z3.Not(b == c), z3.Not(a == c))']\n\n```", "```py\nfor path_condition in path_conditions:\n    s = z3.Solver()\n    s.add(a > 0, b > 0, c > 0)\n    eval(f\"s.check({path_condition})\")\n    m = s.model()\n    print(m, triangle(m[a].as_long(), m[b].as_long(), m[c].as_long())) \n```", "```py\n[a = 1, c = 1, b = 1] equilateral\n[c = 2, a = 1, b = 1] isosceles #1\n[c = 2, a = 1, b = 2] isosceles #2\n[c = 1, a = 1, b = 2] isosceles #3\n[c = 3, a = 1, b = 2] scalene\n\n```", "```py\np = ...   # insert lengthy computation here\nassert p <= 0.05 \n```", "```py\ndef typed_triangle(a: int, b: int, c: int) -> str:\n    return triangle(a, b, c) \n```", "```py\nx = 42\nx = \"a string\" \n```", "```py\np1, p2 = True, False\n\nif p1:\n    x = 42\nif p2:\n    del x\n\n# Does x exist at this point? \n```", "```py\npip install showast\npip install z3-solver\n```", "```py\n@incollection{fuzzingbook2023:AcademicPrototyping,\n    author = {Andreas Zeller and Rahul Gopinath and Marcel B{\\\"o}hme and Gordon Fraser and Christian Holler},\n    booktitle = {The Fuzzing Book},\n    title = {Academic Prototyping},\n    year = {2023},\n    publisher = {CISPA Helmholtz Center for Information Security},\n    howpublished = {\\url{https://www.fuzzingbook.org/html/AcademicPrototyping.html}},\n    note = {Retrieved 2023-01-07 13:43:14+01:00},\n    url = {https://www.fuzzingbook.org/html/AcademicPrototyping.html},\n    urldate = {2023-01-07 13:43:14+01:00}\n}\n\n```"]