- en: Reducing Failure-Inducing Inputs
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 减少导致失败的输入
- en: 原文：[http://www.fuzzingbook.org/html/Reducer.html](http://www.fuzzingbook.org/html/Reducer.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[http://www.fuzzingbook.org/html/Reducer.html](http://www.fuzzingbook.org/html/Reducer.html)
- en: By construction, fuzzers create inputs that may be hard to read. This causes
    issues during *debugging*, when a human has to analyze the exact cause of the
    failure. In this chapter, we present techniques that *automatically reduce and
    simplify failure-inducing inputs to a minimum* in order to ease debugging.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 通过构造，模糊测试器生成的输入可能难以阅读。这会在*调试*期间引起问题，当人类需要分析失败的确切原因时。在本章中，我们介绍了将导致失败的输入*自动减少并简化到最小*的技术，以简化调试过程。
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Prerequisites**'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '**先决条件**'
- en: The simple "delta debugging" technique for reduction has no specific prerequisites.
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 简单的"delta debugging"减少技术没有特定的先决条件。
- en: As reduction is typically used together with fuzzing, reading the [chapter on
    basic fuzzing](Fuzzer.html) is a good idea.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于减少通常与模糊测试一起使用，阅读关于基本模糊测试的[章节](Fuzzer.html)是个好主意。
- en: The later grammar-based techniques require knowledge on [derivation trees](GrammarFuzzer.html)
    and [parsing](Parser.html).
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 后续基于语法的技巧需要了解[推导树](GrammarFuzzer.html)和[解析](Parser.html)。
- en: Synopsis
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 概述
- en: To [use the code provided in this chapter](Importing.html), write
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要[使用本章提供的代码](Importing.html)，请编写
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: and then make use of the following features.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 然后利用以下功能。
- en: A *reducer* takes a failure-inducing input and reduces it to the minimum that
    still reproduces the failure. This chapter provides `Reducer` classes that implement
    such reducers.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 一个*减少器*接受一个导致失败的输入，并将其减少到仍然可以重现失败的最小值。本章提供了实现此类减少器的`Reducer`类。
- en: 'Here is a simple example: An arithmetic expression causes an error in the Python
    interpreter:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的例子：一个算术表达式在Python解释器中引起错误：
- en: '[PRE2]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Can we reduce this input to a minimum? To use a `Reducer`, one first has to
    build a `Runner` whose outcome is `FAIL` if the precise error occurs. We therefore
    build a `ZeroDivisionRunner` whose `run()` method will specifically return a `FAIL`
    outcome if a `ZeroDivisionError` occurs.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们能否将这个输入减少到最小？要使用`Reducer`，首先需要构建一个`Runner`，其结果在精确错误发生时为`FAIL`。因此，我们构建了一个`ZeroDivisionRunner`，其`run()`方法在发生`ZeroDivisionError`时将特别返回`FAIL`结果。
- en: '[PRE3]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If we feed this expression into a `ZeroDivisionRunner`, it will produce an outcome
    of `FAIL` as designed.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们将这个表达式输入到`ZeroDivisionRunner`中，它将产生一个`FAIL`的结果，正如设计的那样。
- en: '[PRE4]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Delta Debugging is a simple and robust reduction algorithm. We can tie a `DeltaDebuggingReducer`
    to this runner, and have it determine the substring that causes the `python` program
    to fail:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: Delta Debugging是一种简单且稳健的减少算法。我们可以将`DeltaDebuggingReducer`与这个运行器绑定，并让它确定导致`python`程序失败的子串：
- en: '[PRE5]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The input is reduced to the minimum: We get the essence of the division by
    zero.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 输入被减少到最小：我们得到了除以零的本质。
- en: '<svg width="476pt" height="364pt" viewBox="0.00 0.00 475.50 363.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 359.5)"><g
    id="node1" class="node"><title>DeltaDebuggingReducer</title> <g id="a_node1"><a
    xlink:href="#" xlink:title="class DeltaDebuggingReducer:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '<svg width="476pt" height="364pt" viewBox="0.00 0.00 475.50 363.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 359.5)"><g
    id="node1" class="node"><title>DeltaDebuggingReducer</title> <g id="a_node1"><a
    xlink:href="#" xlink:title="class DeltaDebuggingReducer:'
- en: 'Reduce inputs using delta debugging."><text text-anchor="start" x="8" y="-75.58"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">DeltaDebuggingReducer</text> <g id="a_node1_0"><a xlink:href="#"
    xlink:title="DeltaDebuggingReducer"><g id="a_node1_1"><a xlink:href="#" xlink:title="reduce(self,
    inp: str) -> str:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '使用delta debugging减少输入。"><text text-anchor="start" x="8" y="-75.58" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">DeltaDebuggingReducer</text>
    <g id="a_node1_0"><a xlink:href="#" xlink:title="DeltaDebuggingReducer"><g id="a_node1_1"><a
    xlink:href="#" xlink:title="reduce(self, inp: str) -> str:'
- en: 'Reduce input `inp` using delta debugging. Return reduced input."><text text-anchor="start"
    x="57.88" y="-53.38" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">reduce()</text></a></g></a></g></a></g></g>
    <g id="node2" class="node"><title>CachingReducer</title> <g id="a_node2"><a xlink:href="#"
    xlink:title="class CachingReducer:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '使用delta debugging减少输入`inp`。返回减少后的输入。"><text text-anchor="start" x="57.88" y="-53.38"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-style="italic" font-size="10.00">reduce()</text></a></g></a></g></a></g></g>
    <g id="node2" class="node"><title>CachingReducer</title> <g id="a_node2"><a xlink:href="#"
    xlink:title="class CachingReducer:'
- en: 'A reducer that also caches test outcomes"><text text-anchor="start" x="119.38"
    y="-216.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">CachingReducer</text> <g id="a_node2_2"><a xlink:href="#" xlink:title="CachingReducer"><g
    id="a_node2_3"><a xlink:href="#" xlink:title="reset(self):'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '一个同时缓存测试结果的减少器。"><text text-anchor="start" x="119.38" y="-216.7" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">CachingReducer</text>
    <g id="a_node2_2"><a xlink:href="#" xlink:title="CachingReducer"><g id="a_node2_3"><a
    xlink:href="#" xlink:title="reset(self):'
- en: 'Reset the test counter to zero. To be extended in subclasses."><text text-anchor="start"
    x="147.88" y="-194.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">reset()</text></a></g> <g id="a_node2_4"><a
    xlink:href="#" xlink:title="test(self, inp):'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '将测试计数器重置为零。在子类中扩展。"><text text-anchor="start" x="147.88" y="-194.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic" font-size="10.00">reset()</text></a></g>
    <g id="a_node2_4"><a xlink:href="#" xlink:title="test(self, inp):'
- en: Test with input `inp`. Return outcome.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 使用输入`inp`进行测试。返回结果。
- en: 'To be extended in subclasses."><text text-anchor="start" x="147.88" y="-181.75"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic"
    font-size="10.00">test()</text></a></g></a></g></a></g></g> <g id="edge1" class="edge"><title>DeltaDebuggingReducer->CachingReducer</title></g>
    <g id="node3" class="node"><title>Reducer</title> <g id="a_node3"><a xlink:href="#"
    xlink:title="class Reducer:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '在子类中扩展。"><text text-anchor="start" x="147.88" y="-181.75" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic" font-size="10.00">test()</text></a></g></a></g></a></g></g>
    <g id="edge1" class="edge"><title>DeltaDebuggingReducer->CachingReducer</title></g>
    <g id="node3" class="node"><title>Reducer</title> <g id="a_node3"><a xlink:href="#"
    xlink:title="class Reducer:'
- en: 'Base class for reducers."><text text-anchor="start" x="144.12" y="-338.7" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Reducer</text>
    <g id="a_node3_5"><a xlink:href="#" xlink:title="Reducer"><g id="a_node3_6"><a
    xlink:href="#" xlink:title="__init__(self, runner: Fuzzer.Runner, log_test: bool
    = False) -> None:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '减少器的基础类。"><text text-anchor="start" x="144.12" y="-338.7" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Reducer</text>
    <g id="a_node3_5"><a xlink:href="#" xlink:title="Reducer"><g id="a_node3_6"><a
    xlink:href="#" xlink:title="__init__(self, runner: Fuzzer.Runner, log_test: bool
    = False) -> None:'
- en: 'Attach reducer to the given `runner`"><text text-anchor="start" x="138.88"
    y="-316.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-size="10.00">__init__()</text></a></g> <g id="a_node3_7"><a
    xlink:href="#" xlink:title="reduce(self, inp: str) -> str:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '将减少器附加到给定的`runner`"><text text-anchor="start" x="138.88" y="-316.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-size="10.00">__init__()</text></a></g>
    <g id="a_node3_7"><a xlink:href="#" xlink:title="reduce(self, inp: str) -> str:'
- en: Reduce input `inp`. Return reduced input.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 减少输入`inp`。返回减少后的输入。
- en: 'To be defined in subclasses."><text text-anchor="start" x="138.88" y="-303.75"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-style="italic" font-size="10.00">reduce()</text></a></g> <g id="a_node3_8"><a
    xlink:href="#" xlink:title="reset(self) -> None:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '在子类中定义。"><text text-anchor="start" x="138.88" y="-303.75" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">reduce()</text></a></g> <g id="a_node3_8"><a xlink:href="#"
    xlink:title="reset(self) -> None:'
- en: 'Reset the test counter to zero. To be extended in subclasses."><text text-anchor="start"
    x="138.88" y="-291" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">reset()</text></a></g>
    <g id="a_node3_9"><a xlink:href="#" xlink:title="test(self, inp: str) -> str:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '将测试计数器重置为零。在子类中扩展。"><text text-anchor="start" x="138.88" y="-291" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">reset()</text></a></g> <g id="a_node3_9"><a xlink:href="#" xlink:title="test(self,
    inp: str) -> str:'
- en: Test with input `inp`. Return outcome.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 使用输入`inp`进行测试。返回结果。
- en: 'To be extended in subclasses."><text text-anchor="start" x="138.88" y="-278.25"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic"
    font-size="10.00">test()</text></a></g></a></g></a></g></g> <g id="edge2" class="edge"><title>CachingReducer->Reducer</title></g>
    <g id="node4" class="node"><title>GrammarReducer</title> <g id="a_node4"><a xlink:href="#"
    xlink:title="class GrammarReducer:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '在子类中定义。"><text text-anchor="start" x="138.88" y="-278.25" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic" font-size="10.00">test()</text></a></g></a></g></a></g></g>
    <g id="edge2" class="edge"><title>CachingReducer->Reducer</title></g> <g id="node4"
    class="node"><title>GrammarReducer</title> <g id="a_node4"><a xlink:href="#" xlink:title="class
    GrammarReducer:'
- en: 'Reduce inputs using grammars"><text text-anchor="start" x="201.88" y="-120.2"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">GrammarReducer</text> <g id="a_node4_10"><a xlink:href="#" xlink:title="GrammarReducer"><g
    id="a_node4_11"><a xlink:href="#" xlink:title="__init__(self, runner: Fuzzer.Runner,
    parser: Parser.Parser, *, log_test: bool = False, log_reduce: bool = False):'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '使用语法减少输入。"><text text-anchor="start" x="201.88" y="-120.2" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">GrammarReducer</text>
    <g id="a_node4_10"><a xlink:href="#" xlink:title="GrammarReducer"><g id="a_node4_11"><a
    xlink:href="#" xlink:title="__init__(self, runner: Fuzzer.Runner, parser: Parser.Parser,
    *, log_test: bool = False, log_reduce: bool = False):'
- en: Constructor.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 构造函数。
- en: '`runner` is the runner to be used.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`runner`是将要使用的运行器。'
- en: '`parser` is the parser to be used.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '`parser`是将要使用的解析器。'
- en: '`log_test` - if set, show tests and results.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '`log_test` - 如果设置，显示测试和结果。'
- en: '`log_reduce` - if set, show reduction steps."><text text-anchor="start" x="189.88"
    y="-98" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-style="italic" font-size="10.00">__init__()</text></a></g>
    <g id="a_node4_12"><a xlink:href="#" xlink:title="reduce(self, inp):'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '`log_reduce` - 如果设置，显示减少步骤。"><text text-anchor="start" x="189.88" y="-98" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node4_12"><a xlink:href="#"
    xlink:title="reduce(self, inp):'
- en: Reduce input `inp`. Return reduced input.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 减少输入`inp`。返回减少后的输入。
- en: 'To be defined in subclasses."><text text-anchor="start" x="189.88" y="-85.25"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-style="italic" font-size="10.00">reduce()</text></a></g> <g id="a_node4_13"><a
    xlink:href="#" xlink:title="alternate_reductions(self, tree: DerivationTree, symbol:
    str, depth: int = -1)"><text text-anchor="start" x="189.88" y="-71.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">alternate_reductions()</text></a></g>
    <g id="a_node4_14"><a xlink:href="#" xlink:title="parse(self, inp)"><text text-anchor="start"
    x="189.88" y="-58.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">parse()</text></a></g> <g id="a_node4_15"><a xlink:href="#"
    xlink:title="reduce_subtree(self, tree: DerivationTree, subtree: DerivationTree,
    depth: int = -1)"><text text-anchor="start" x="189.88" y="-46" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">reduce_subtree()</text></a></g>
    <g id="a_node4_16"><a xlink:href="#" xlink:title="reduce_tree(self, tree)"><text
    text-anchor="start" x="189.88" y="-33.25" font-family="''Fira Mono'', ''Source
    Code Pro'', ''Courier'', monospace" font-size="10.00">reduce_tree()</text></a></g>
    <g id="a_node4_17"><a xlink:href="#" xlink:title="subtrees_with_symbol(self, tree:
    DerivationTree, symbol: str, depth: int = -1, ignore_root: bool = True) -> List[DerivationTree]:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '在子类中定义。"><text text-anchor="start" x="189.88" y="-85.25" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">reduce()</text></a></g> <g id="a_node4_13"><a xlink:href="#"
    xlink:title="alternate_reductions(self, tree: DerivationTree, symbol: str, depth:
    int = -1)"><text text-anchor="start" x="189.88" y="-71.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">alternate_reductions()</text></a></g>
    <g id="a_node4_14"><a xlink:href="#" xlink:title="parse(self, inp)"><text text-anchor="start"
    x="189.88" y="-58.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">parse()</text></a></g> <g id="a_node4_15"><a xlink:href="#"
    xlink:title="reduce_subtree(self, tree: DerivationTree, subtree: DerivationTree,
    depth: int = -1)"><text text-anchor="start" x="189.88" y="-46" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">reduce_subtree()</text></a></g>
    <g id="a_node4_16"><a xlink:href="#" xlink:title="reduce_tree(self, tree)"><text
    text-anchor="start" x="189.88" y="-33.25" font-family="''Fira Mono'', ''Source
    Code Pro'', ''Courier'', monospace" font-size="10.00">reduce_tree()</text></a></g>
    <g id="a_node4_17"><a xlink:href="#" xlink:title="subtrees_with_symbol(self, tree:
    DerivationTree, symbol: str, depth: int = -1, ignore_root: bool = True) -> List[DerivationTree]:'
- en: Find all subtrees in `tree` whose root is `symbol`.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在`tree`中查找所有根节点为`symbol`的子树。
- en: 'If `ignore_root` is true, ignore the root note of `tree`."><text text-anchor="start"
    x="189.88" y="-20.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">subtrees_with_symbol()</text></a></g> <g id="a_node4_18"><a
    xlink:href="#" xlink:title="symbol_reductions(self, tree: DerivationTree, symbol:
    str, depth: int = -1):'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '如果`ignore_root`为真，忽略`tree`的根节点。"><text text-anchor="start" x="189.88" y="-20.5"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">subtrees_with_symbol()</text></a></g>
    <g id="a_node4_18"><a xlink:href="#" xlink:title="symbol_reductions(self, tree:
    DerivationTree, symbol: str, depth: int = -1):'
- en: Find all expansion alternatives for the given symbol"><text text-anchor="start"
    x="189.88" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace"
    font-size="10.00">symbol_reductions()</text></a></g></a></g></a></g></g> <g id="edge3"
    class="edge"><title>GrammarReducer->CachingReducer</title></g> <g id="node5" class="node"><title>Legend</title>
    <text text-anchor="start" x="348.25" y="-84.5" font-family="Patua One, Helvetica,
    sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
    <text text-anchor="start" x="348.25" y="-74.5" font-family="Patua One, Helvetica,
    sans-serif" font-size="10.00">• </text> <text text-anchor="start" x="354.25" y="-74.5"
    font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold"
    font-size="8.00">public_method()</text> <text text-anchor="start" x="348.25" y="-64.5"
    font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text> <text
    text-anchor="start" x="354.25" y="-64.5" font-family="'Fira Mono', 'Source Code
    Pro', 'Courier', monospace" font-size="8.00">private_method()</text> <text text-anchor="start"
    x="348.25" y="-54.5" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
    <text text-anchor="start" x="354.25" y="-54.5" font-family="'Fira Mono', 'Source
    Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
    <text text-anchor="start" x="348.25" y="-45.45" font-family="Helvetica,sans-Serif"
    font-size="9.00">Hover over names to see doc</text></g></g></svg>
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 找到给定符号"><text text-anchor="start" x="189.88" y="-7.75" font-family="'Fira Mono',
    'Source Code Pro', 'Courier', monospace" font-size="10.00">symbol_reductions()</text></a></g></a></g></a></g></g>
    <g id="edge3" class="edge"><title>GrammarReducer->CachingReducer</title></g> <g
    id="node5" class="node"><title>图例</title> <text text-anchor="start" x="348.25"
    y="-84.5" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00"
    fill="#b03a2e">图例</text> <text text-anchor="start" x="348.25" y="-74.5" font-family="Patua
    One, Helvetica, sans-serif" font-size="10.00">• </text> <text text-anchor="start"
    x="354.25" y="-74.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace"
    font-weight="bold" font-size="8.00">public_method()</text> <text text-anchor="start"
    x="348.25" y="-64.5" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
    <text text-anchor="start" x="354.25" y="-64.5" font-family="'Fira Mono', 'Source
    Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text> <text
    text-anchor="start" x="348.25" y="-54.5" font-family="Patua One, Helvetica, sans-serif"
    font-size="10.00">• </text> <text text-anchor="start" x="354.25" y="-54.5" font-family="'Fira
    Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
    <text text-anchor="start" x="348.25" y="-45.45" font-family="Helvetica,sans-Serif"
    font-size="9.00">将鼠标悬停在名称上以查看文档</text></g></g></svg>
- en: Why Reducing?
  id: totrans-47
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为什么缩减？
- en: At this point, we have seen a number of test generation techniques that all
    in some form produce inputs in order to trigger failures. If they are successful
    – that is, the program actually fails – we must find out why the failure occurred
    and how to fix it.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们已经看到了许多测试生成技术，它们都以某种形式产生输入以触发故障。如果它们成功了——也就是说，程序实际上失败了——我们必须找出故障发生的原因以及如何修复它。
- en: Here's an example of such a situation. We have a class `MysteryRunner` with
    a `run()` method that – given its code – can occasionally fail. But under which
    circumstances does this actually happen? We have deliberately obscured the exact
    condition in order to make this non-obvious.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个这样的例子。我们有一个名为`MysteryRunner`的类，它有一个`run()`方法，根据其代码，它偶尔会失败。但这种情况实际上在什么情况下会发生？我们故意隐藏了确切的条件，以便使其不明显。
- en: '[PRE6]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Let us fuzz the function until we find a failing input.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对函数进行模糊测试，直到找到失败的输入。
- en: '[PRE13]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Something in this input causes `MysteryRunner` to fail. But what is it?
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的输入中有些东西导致`MysteryRunner`失败。但究竟是什么？
- en: Manual Input Reduction
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 手动输入缩减
- en: 'One important step in the debugging process is *reduction* – that is, to identify
    those circumstances of a failure that are relevant for the failure to occur, and
    to *omit* (if possible) those parts that are not. As Kernighan and Pike [Kernighan
    *et al*, 1999] put it:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 调试过程中的一个重要步骤是*缩减*——也就是说，识别那些导致故障发生的相关情况，并（如果可能）省略那些不相关的部分。正如Kernighan和Pike [Kernighan
    *et al*, 1999]所说：
- en: For every circumstance of the problem, check whether it is relevant for the
    problem to occur. If it is not, remove it from the problem report or the test
    case in question.
  id: totrans-64
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 对于问题的每一个情况，检查它是否与问题发生相关。如果不相关，请将其从问题报告中或相关测试用例中移除。
- en: 'Specifically for inputs, they suggest a *divide and conquer* process:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 特别对于输入，他们建议一个*分而治之*的过程：
- en: Proceed by binary search. Throw away half the input and see if the output is
    still wrong; if not, go back to the previous state and discard the other half
    of the input.
  id: totrans-66
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 通过二分搜索进行操作。丢弃一半的输入并查看输出是否仍然错误；如果不是，返回到上一个状态并丢弃另一半的输入。
- en: 'This is something we can easily try out, using our last generated input:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们很容易尝试的事情，使用我们最后生成的输入：
- en: '[PRE16]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'For instance, we can see whether the error still occurs if we only feed in
    the first half:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们只输入前半部分，我们可以看到错误是否仍然发生：
- en: '[PRE18]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Nope – the first half alone does not suffice. Maybe the second half?
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 不行——只有前半部分是不够的。也许后半部分可以？
- en: '[PRE20]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This did not go so well either. We may still proceed by cutting away *smaller
    chunks* – say, one character after another. If our test is deterministic and easily
    repeated, it is clear that this process eventually will yield a reduced input.
    But still, it is a rather inefficient process, especially for long inputs. What
    we need is a *strategy* that effectively minimizes a failure-inducing input – a
    strategy that can be automated.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这也没有好到哪里去。我们可能仍然可以通过移除更小的块来继续进行——比如说，一个字符接一个字符。如果我们的测试是确定性的并且容易重复，那么很明显，这个过程最终将产生一个简化的输入。但是，这仍然是一个相当低效的过程，尤其是对于长输入。我们需要的是一个
    *策略*，这个策略可以有效地最小化导致失败的输入——一个可以自动化的策略。
- en: Delta Debugging
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Delta Debugging
- en: 'One strategy to effectively reduce failure-inducing inputs is *delta debugging*
    [[Zeller *et al*, 2002](https://doi.org/10.1109/32.988498)]. Delta Debugging implements
    the "binary search" strategy, as listed above, but with a twist: If neither half
    fails (also as above), it keeps on cutting away smaller and smaller chunks from
    the input, until it eliminates individual characters. Thus, after cutting away
    the first half, we cut away the first quarter, the second quarter, and so on.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 一种有效减少导致失败的输入的策略是 *delta debugging* [[Zeller *et al*, 2002](https://doi.org/10.1109/32.988498)]。Delta
    Debugging 实现了上面列出的 "二分搜索" 策略，但有一个转折：如果两个部分都没有失败（如上所述），它将继续从输入中移除越来越小的块，直到消除单个字符。因此，在移除前半部分之后，我们移除四分之一，然后是二分之一，以此类推。
- en: Let us illustrate this on our example, and see what happens if we cut away the
    first quarter.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在我们的例子中说明这一点，看看如果我们移除四分之一会发生什么。
- en: '[PRE22]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Ah! This has failed, and reduced our failing input by 25%. Let's remove another
    quarter.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 啊！这失败了，并且将我们的失败输入减少了 25%。让我们再移除一个四分之一。
- en: '[PRE24]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'This is not too surprising, as we had that one before:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不太令人惊讶，因为我们之前已经有过这样的例子：
- en: '[PRE26]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '[PRE28]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: How about removing the third quarter, then?
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，移除三分之一怎么样？
- en: '[PRE30]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[PRE31]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Ok. Let us remove the fourth quarter.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 好的。让我们移除四分之一。
- en: '[PRE32]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Yes! This has succeeded. Our input is now 50% smaller.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 是的！这成功了。我们的输入现在缩小了 50%。
- en: We have now tried to remove pieces that make up $\frac{1}{2}$ and $\frac{1}{4}$
    of the original failing string. In the next iteration, we would go and remove
    even smaller pieces – $\frac{1}{8}$, $\frac{1}{16}$ and so on. We continue until
    we are down to $\frac{1}{97}$ – that is, individual characters.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经尝试移除组成原始失败字符串 $\frac{1}{2}$ 和 $\frac{1}{4}$ 的部分。在下一轮迭代中，我们将移除更小的部分——$\frac{1}{8}$，$\frac{1}{16}$，以此类推。我们继续进行，直到我们只剩下
    $\frac{1}{97}$——即单个字符。
- en: However, this is something we happily let a computer do for us. We first introduce
    a `Reducer` class as an abstract superclass for all kinds of reducers. The `test()`
    method runs a single test (with logging, if wanted); the `reduce()` method will
    eventually reduce an input to the minimum.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这是我们可以愉快地让计算机为我们做的事情。我们首先引入一个 `Reducer` 类，作为所有类型减法器的抽象超类。`test()` 方法运行单个测试（如果需要，则进行日志记录）；`reduce()`
    方法最终将输入简化到最小。
- en: '[PRE34]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'The `CachingReducer` variant saves test results, such that we don''t have to
    run the same tests again and again:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '`CachingReducer` 变体保存测试结果，这样我们就不必反复运行相同的测试：'
- en: '[PRE35]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Here comes the *Delta Debugging* reducer. Delta Debugging implements the strategy
    sketched above: It first removes larger chunks of size $\frac{1}{2}$; if this
    does not fail, then we proceed to chunks of size $\frac{1}{4}$, then $\frac{1}{8}$
    and so on.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是 *Delta Debugging* 算法。Delta Debugging 实现了上述策略：它首先移除大小为 $\frac{1}{2}$ 的大块；如果这样做不失败，然后我们继续移除大小为
    $\frac{1}{4}$ 的小块，然后是 $\frac{1}{8}$，以此类推。
- en: Our implementation uses almost the same Python code as Zeller in [[Zeller *et
    al*, 2002](https://doi.org/10.1109/32.988498)]; the only difference is that it
    has been adapted to work on Python 3 and our `Runner` framework. The variable
    `n` (initially 2) indicates the granularity – in each step, chunks of size $\frac{1}{n}$
    are cut away. If none of the test fails (`some_complement_is_failing` is False),
    then `n` is doubled – until it reaches the length of the input.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的实现几乎与 Zeller 在 [[Zeller *et al*, 2002](https://doi.org/10.1109/32.988498)]
    中的 Python 代码相同；唯一的区别是它已经被调整以在 Python 3 和我们的 `Runner` 框架上工作。变量 `n`（最初为 2）表示粒度——在每一步中，移除大小为
    $\frac{1}{n}$ 的块。如果没有测试失败（`some_complement_is_failing` 为 False），则 `n` 被加倍——直到它达到输入的长度。
- en: '[PRE36]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'To see how the `DeltaDebuggingReducer` works, let us run it on our failing
    input. With each step, we see how the remaining input gets smaller and smaller,
    until only two characters remain:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 为了了解`DeltaDebuggingReducer`是如何工作的，让我们将其运行在我们的失败输入上。随着每一步的进行，我们看到剩余的输入如何越来越小，直到只剩下两个字符：
- en: '[PRE37]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '[PRE38]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Now we know why `MysteryRunner` fails – it suffices that the input contains
    two matching parentheses. Delta Debugging determines this in 29 steps. Its result
    is *1-minimal*, meaning that every character contained is required to produce
    the error; removing any (as seen in tests `#27` and `#29`, above) no longer makes
    the test fail. This property is guaranteed by the delta debugging algorithm, which
    in its last stage always tries to delete characters one by one.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道为什么`MysteryRunner`失败了——只要输入包含两个匹配的括号就足够了。Delta Debugging在29步中确定了这一点。其结果是*1-minimal*，这意味着包含的每个字符都是产生错误所必需的；删除任何（如上所述的测试`#27`和`#29`所示）都不会使测试失败。这个特性由delta
    debugging算法保证，在其最后阶段，它总是尝试逐个删除字符。
- en: 'A reduced test case such as the one above has many advantages:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述的简化测试用例具有许多优点：
- en: A reduced test case **reduces the *cognitive load* of the programmer**. The
    test case is shorter and focused, and thus does not burden the programmer with
    irrelevant details. A reduced input typically leads to shorter executions and
    smaller program states, both of which reduce the search space as it comes to understanding
    the bug. In our case, we have eliminated lots of irrelevant input – only the two
    characters the reduced input contains are relevant.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个简化的测试用例**减少了程序员的认知负荷**。测试用例更短且更专注，因此不会让程序员负担无关的细节。简化的输入通常会导致更短的执行时间和更小的程序状态，这两者都会在理解错误时减少搜索空间。在我们的案例中，我们消除了大量的无关输入——只有简化输入中包含的两个字符是相关的。
- en: 'A reduced test case **is easier to communicate**. All one needs here is the
    summary: `MysteryRunner fails on "()"`, which is much better than `MysteryRunner
    fails on a 4100-character input (attached)`.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个简化的测试用例**更容易沟通**。这里只需要总结：`MysteryRunner在"()"上失败`，这比`MysteryRunner在4100字符的输入（附件）上失败`要好得多。
- en: A reduced test case helps in **identifying duplicates**. If similar bugs have
    been reported already, and all of them have been reduced to the same cause (namely
    that the input contains matching parentheses), then it becomes obvious that all
    these bugs are different symptoms of the same underlying cause – and would all
    be resolved at once with one code fix.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个简化的测试用例有助于**识别重复项**。如果已经报告了类似的错误，并且它们都被简化到相同的原因（即输入包含匹配的括号），那么很明显，所有这些错误都是同一根本原因的不同症状——并且可以通过一个代码修复一次性解决。
- en: How effective is delta debugging? In the best case (when the left half or the
    right half fails), the number of tests is logarithmic proportional to the length
    $n$ of an input (i.e., $O(\log_2 n)$); this is the same complexity as binary search.
    In the worst case, though, delta debugging can require a number of tests proportional
    to $n^2$ (i.e., $O(n^2)$) – this happens in the case when we are down to character
    granularity, and we have to repeatedly tried to delete all characters, only to
    find that deleting the last character results in a failure [[Zeller *et al*, 2002](https://doi.org/10.1109/32.988498)].
    (This is a pretty pathological situation, though.)
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: Delta Debugging有多有效？在最佳情况下（当左半部分或右半部分失败时），测试的数量与输入长度$n$的对数成比例（即$O(\log_2 n)$）；这与二分搜索的复杂度相同。然而，在最坏的情况下，delta
    debugging可能需要与$n^2$成比例的测试次数（即$O(n^2)$）——这种情况发生在我们下降到字符粒度时，我们必须反复尝试删除所有字符，结果发现删除最后一个字符会导致失败
    [[Zeller *et al*, 2002](https://doi.org/10.1109/32.988498)]。（这是一个相当病态的情况，尽管如此。）
- en: In general, delta debugging is a robust algorithm that is easy to implement,
    easy to deploy, and easy to use – provided that the underlying test case is deterministic
    and runs quickly enough to warrant a number of experiments. As these are the same
    prerequisites that make fuzzing effective, delta debugging makes an excellent
    companion to fuzzing.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，delta debugging是一个易于实现、易于部署和易于使用的稳健算法——前提是底层测试用例是确定性的，并且运行速度足够快，可以保证进行多次实验。由于这些是使模糊测试有效的相同先决条件，delta
    debugging是模糊测试的一个优秀伴侣。
- en: Quiz
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测验
- en: What happens if the function under test does not fail?
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如果被测试的函数没有失败会发生什么？
- en: Indeed, `DeltaDebugger` checks if its assumptions hold. If not, an assertion
    fails.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，`DeltaDebugger`检查其假设是否成立。如果不成立，则断言失败。
- en: '[PRE40]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '[PRE42]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Grammar-Based Input Reduction
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基于语法的输入简化
- en: If the input language is syntactically complex, delta debugging may take several
    attempts at reduction, and may not be able to reduce inputs at all. In the second
    half of this chapter, we thus introduce an algorithm named *Grammar-Based Reduction*
    (or GRABR for short) that makes use of *grammars* to reduce syntactically complex
    inputs.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果输入语言在句法上很复杂，delta调试可能需要进行多次尝试来简化，甚至可能无法简化输入。因此，在本章的后半部分，我们介绍了一个名为*基于语法的简化算法*（或简称为GRABR）的算法，该算法利用*语法*来简化句法复杂的输入。
- en: Lexical Reduction vs. Syntactic Rules
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 词汇简化与句法规则
- en: Despite its general robustness, there are situations in which delta debugging
    might be inefficient or outright fail. As an example, consider some *expression
    input* such as `1 + (2 * 3)`. Delta debugging requires a number of tests to simplify
    the failure-inducing input, but it eventually returns a minimal input
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管delta调试在一般情况下很稳健，但在某些情况下它可能效率低下，甚至完全失败。作为一个例子，考虑一些*表达式输入*，例如`1 + (2 * 3)`。Delta调试需要多次测试来简化导致失败的输入，但最终它会返回一个最小输入
- en: '[PRE43]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '[PRE44]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '[PRE45]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Looking at the tests, above, though, only few of them actually represent syntactically
    valid arithmetic expressions. In a practical setting, we may want to test a program
    which actually *parses* such expressions, and which would *reject* all invalid
    inputs. We define a class `EvalMysteryRunner` which first *parses* the given input
    (according to the rules of our expression grammar), and *only* if it fits would
    it be passed to our original `MysteryRunner`. This simulates a setting in which
    we test an expression interpreter, and in which only valid inputs can trigger
    the bug.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在上面的测试中，只有少数几个实际上代表了语法上有效的算术表达式。在实际环境中，我们可能想要测试一个实际上能够*解析*此类表达式并*拒绝*所有无效输入的程序。我们定义了一个名为`EvalMysteryRunner`的类，它首先根据我们表达式语法的规则*解析*给定的输入，并且只有当它符合条件时，才会传递给我们的原始`MysteryRunner`。这模拟了测试表达式解释器的情况，在这种情况下，只有有效的输入才能触发错误。
- en: '[PRE46]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '[PRE47]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '[PRE48]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '[PRE49]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Under these circumstances, it turns out that delta debugging utterly fails.
    None of the reductions it applies yield a syntactically valid input, so the input
    as a whole remains as complex as it was before.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，结果证明delta调试完全失败。它应用的任何简化都不会产生语法上有效的输入，因此输入的整体复杂性与之前一样。
- en: '[PRE50]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '[PRE51]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '[PRE52]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: This behavior is possible if the program under test has several constraints
    regarding input validity. Delta debugging is not aware of these constraints (nor
    of the input structure in general), so it might violate these constraints again
    and again.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如果被测试的程序对输入的有效性有多个约束，这种行为是可能的。Delta调试并不了解这些约束（也不了解输入结构的一般情况），因此它可能会一次又一次地违反这些约束。
- en: A Grammar-Based Reduction Approach
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于语法的简化方法
- en: 'To reduce inputs with high syntactical complexity, we use another approach:
    Rather than reducing the input string, we reduce the *tree* representing its structure.
    The general idea is to start with a *derivation tree* coming from parsing the
    input, and then *substitute subtrees by smaller subtrees of the same type*. These
    alternate subtrees can either come'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化具有高句法复杂性的输入，我们使用另一种方法：而不是简化输入字符串，我们简化表示其结构的*树*。一般想法是，从一个*推导树*开始，这个树是通过解析输入得到的，然后*用相同类型的较小子树替换子树*。这些替代子树可以来自
- en: From the tree itself, or
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从树本身，或者
- en: By applying an alternate grammar expansion using elements from the tree.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过使用树中的元素应用替代语法扩展。
- en: 'Let us show these two strategies using an example. We start with a derivation
    tree from an arithmetic expression:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用一个例子来展示这两种策略。我们从一个算术表达式的推导树开始：
- en: '[PRE53]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '[PRE54]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: <svg width="210pt" height="575pt" viewBox="0.00 0.00 209.62 575.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 571)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="81.62"
    y="-553.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="81.62" y="-503.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="33.62"
    y="-453.2" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="81.62" y="-453.2" font-family="Times,serif" font-size="14.00">+</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="127.62" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="31.62" y="-402.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27.62" y="-352.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="20.62" y="-302.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="20.62" y="-252.2" font-family="Times,serif" font-size="14.00">1
    (49)</text></g> <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="127.62" y="-402.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge9" class="edge"><title>8->9</title></g>
    <g id="node11" class="node"><title>10</title> <text text-anchor="middle" x="127.62"
    y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g> <g
    id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="74.62" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="128.62" y="-302.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge12" class="edge"><title>10->12</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="182.62"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge24"
    class="edge"><title>10->24</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="128.62" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="79.62" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="128.62" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge18" class="edge"><title>13->18</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="174.62" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge19" class="edge"><title>13->19</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="79.62" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="79.62" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="79.62" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="174.62" y="-151.7"
    font-family="Times,serif" font-size="14.00"><factor></text></g> <g id="edge20"
    class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="174.62" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="174.62" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="174.62" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge23" class="edge"><title>22->23</title></g></g></svg>
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="210pt" height="575pt" viewBox="0.00 0.00 209.62 575.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 571)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="81.62"
    y="-553.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="81.62" y="-503.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="33.62"
    y="-453.2" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="81.62" y="-453.2" font-family="Times,serif" font-size="14.00">+</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="127.62" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="31.62" y="-402.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27.62" y="-352.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="20.62" y="-302.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="20.62" y="-252.2" font-family="Times,serif" font-size="14.00">1
    (49)</text></g> <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="127.62" y="-402.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge9" class="edge"><title>8->9</title></g>
    <g id="node11" class="node"><title>10</title> <text text-anchor="middle" x="127.62"
    y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g> <g
    id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="74.62" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="128.62" y="-302.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge12" class="edge"><title>10->12</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="182.62"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge24"
    class="edge"><title>10->24</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="128.62" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="79.62" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="128.62" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge18" class="edge"><title>13->18</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="174.62" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge19" class="edge"><title>13->19</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="79.62" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="79.62" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="79.62" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="174.62" y="-151.7"
    font-family="Times,serif" font-size="14.00"><factor></text></g> <g id="edge20"
    class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="174.62" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="174.62" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="174.62" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge23" class="edge"><title>22->23</title></g></g></svg>
- en: Simplifying by Replacing Subtrees
  id: totrans-147
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 通过替换子树进行简化
- en: 'To simplify this tree, we could replace any `<expr>` symbol up in the tree
    with some `<expr>` subtree down in the tree. For instance, we could replace the
    uppermost `<expr>` with its right `<expr>` subtree, yielding the string `(2 +
    3)`:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化这个树，我们可以用树中较低位置的某个`<expr>`子树替换树中较高位置的任何`<expr>`符号。例如，我们可以用最上面的`<expr>`替换它的右`<expr>`子树，得到字符串`(2
    + 3)`：
- en: '[PRE55]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '[PRE56]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: <svg width="157pt" height="475pt" viewBox="0.00 0.00 157.00 474.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 470.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-453.2"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="76" y="-402.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="76" y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="22" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="76" y="-302.45" font-family="Times,serif"
    font-size="14.00"><expr></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node17" class="node"><title>16</title> <text text-anchor="middle" x="130"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge16"
    class="edge"><title>2->16</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="76" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge10" class="edge"><title>5->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge11" class="edge"><title>5->11</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge12" class="edge"><title>11->12</title></g>
    <g id="node14" class="node"><title>13</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge15" class="edge"><title>14->15</title></g></g></svg>
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="157pt" height="475pt" viewBox="0.00 0.00 157.00 474.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 470.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-453.2"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="76" y="-402.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="76" y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="22" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="76" y="-302.45" font-family="Times,serif"
    font-size="14.00"><expr></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node17" class="node"><title>16</title> <text text-anchor="middle" x="130"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge16"
    class="edge"><title>2->16</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="76" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge10" class="edge"><title>5->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge11" class="edge"><title>5->11</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge12" class="edge"><title>11->12</title></g>
    <g id="node14" class="node"><title>13</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge15" class="edge"><title>14->15</title></g></g></svg>
- en: '[PRE57]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: <svg width="157pt" height="525pt" viewBox="0.00 0.00 157.00 524.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 520.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-503.45"
    font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="76" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="76" y="-402.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="76" y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="22" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="76" y="-302.45" font-family="Times,serif"
    font-size="14.00"><expr></text></g> <g id="edge5" class="edge"><title>3->5</title></g>
    <g id="node18" class="node"><title>17</title> <text text-anchor="middle" x="130"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge17"
    class="edge"><title>3->17</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="76" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge11" class="edge"><title>6->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge12" class="edge"><title>6->12</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge13" class="edge"><title>12->13</title></g>
    <g id="node15" class="node"><title>14</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge16" class="edge"><title>15->16</title></g></g></svg>
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="157pt" height="525pt" viewBox="0.00 0.00 157.00 524.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 520.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-503.45"
    font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="76" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="76" y="-402.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="76" y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="22" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="76" y="-302.45" font-family="Times,serif"
    font-size="14.00"><expr></text></g> <g id="edge5" class="edge"><title>3->5</title></g>
    <g id="node18" class="node"><title>17</title> <text text-anchor="middle" x="130"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge17"
    class="edge"><title>3->17</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="76" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge11" class="edge"><title>6->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge12" class="edge"><title>6->12</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge13" class="edge"><title>12->13</title></g>
    <g id="node15" class="node"><title>14</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge16" class="edge"><title>15->16</title></g></g></svg>
- en: '[PRE58]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '[PRE59]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Replacing one subtree by another only works as long as individual elements such
    as `<expr>` occur multiple times in our tree. In the reduced `new_derivation_tree`,
    above, we could replace further `<expr>` trees only once more.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 用一个子树替换另一个子树只有在单个元素如`<expr>`在我们的树中多次出现时才有效。在上面的简化`new_derivation_tree`中，我们只能再次替换一个`<expr>`树。
- en: Simplifying by Alternative Expansions
  id: totrans-157
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 通过替代扩展进行简化
- en: A second means to simplify this tree is to apply *alternative expansions*. That
    is, for a symbol, we check whether there is an alternative expansion with a smaller
    number of children. Then, we replace the symbol with the alternative expansion,
    filling in needed symbols from the tree.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 简化此树的第二种方法是应用 *替代展开*。也就是说，对于符号，我们检查是否存在具有较少子节点的替代展开。然后，我们用替代展开替换符号，并从树中填充所需的符号。
- en: As an example, consider the `new_derivation_tree` above. The applied expansion
    for `<term>` has been
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，考虑上面的 `new_derivation_tree`。对 `<term>` 应用的展开是
- en: '[PRE60]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Let us replace this with the alternative expansion:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用以下替代展开来替换它：
- en: '[PRE61]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '[PRE62]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: <svg width="157pt" height="274pt" viewBox="0.00 0.00 157.00 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-252.2"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge5" class="edge"><title>0->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>0->6</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node8"
    class="node"><title>7</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge7" class="edge"><title>6->7</title></g>
    <g id="node9" class="node"><title>8</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="157pt" height="274pt" viewBox="0.00 0.00 157.00 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="76" y="-252.2"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="27" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="76" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge5" class="edge"><title>0->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="122" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>0->6</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node8"
    class="node"><title>7</title> <text text-anchor="middle" x="122" y="-151.7" font-family="Times,serif"
    font-size="14.00"><factor></text></g> <g id="edge7" class="edge"><title>6->7</title></g>
    <g id="node9" class="node"><title>8</title> <text text-anchor="middle" x="122"
    y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g> <g
    id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="122" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="122" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
- en: '[PRE63]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: <svg width="62pt" height="223pt" viewBox="0.00 0.00 62.00 223.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 219.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="27" y="-201.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge4" class="edge"><title>3->4</title></g></g></svg>
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="62pt" height="223pt" viewBox="0.00 0.00 62.00 223.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 219.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="27" y="-201.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="node2" class="node"><title>1</title>
    <text text-anchor="middle" x="27" y="-151.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="27" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge4" class="edge"><title>3->4</title></g></g></svg>
- en: '[PRE64]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: <svg width="147pt" height="475pt" viewBox="0.00 0.00 146.75 474.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 470.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="69.38"
    y="-453.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="69.38" y="-402.95"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="69.38"
    y="-352.7" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="69.38" y="-302.45" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="15.38" y="-252.2" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="69.38" y="-252.2"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge5" class="edge"><title>3->5</title></g>
    <g id="node12" class="node"><title>11</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge11"
    class="edge"><title>3->11</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="69.38" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="69.38" y="-151.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="69.38" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="69.38" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="69.38" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="147pt" height="475pt" viewBox="0.00 0.00 146.75 474.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 470.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="69.38"
    y="-453.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="69.38" y="-402.95"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="69.38"
    y="-352.7" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="69.38" y="-302.45" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="15.38" y="-252.2" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6"
    class="node"><title>5</title> <text text-anchor="middle" x="69.38" y="-252.2"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge5" class="edge"><title>3->5</title></g>
    <g id="node12" class="node"><title>11</title> <text text-anchor="middle" x="123.38"
    y="-252.2" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge11"
    class="edge"><title>3->11</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="69.38" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge6" class="edge"><title>5->6</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="69.38" y="-151.7" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge7" class="edge"><title>6->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="69.38" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="69.38" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="69.38" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge10" class="edge"><title>9->10</title></g></g></svg>
- en: '[PRE65]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '[PRE66]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: If we replace derivation subtrees by (smaller) subtrees, and if we search for
    alternate expansions that again yield smaller subtrees, we can systematically
    simplify the input. This could be much faster than delta debugging, as our inputs
    would always be syntactically valid. However, we need a strategy for when to apply
    which simplification rule. This is what we develop in the remainder of this section.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们用（较小的）子树替换推导子树，并且如果我们寻找再次产生较小子树的替代展开，我们可以系统地简化输入。这可能会比 delta 调试快得多，因为我们的输入始终是语法有效的。然而，我们需要一个策略来确定何时应用哪个简化规则。这就是我们在本节剩余部分要开发的。
- en: <details id="Excursion:-A-Class-for-Reducing-with-Grammars"><summary>A Class
    for Reducing with Grammars</summary>
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: <details id="Excursion:-A-Class-for-Reducing-with-Grammars"><summary>用于语法减少的类</summary>
- en: We introduce the `GrammarReducer` class, which is again a `Reducer`. Note that
    we derive from `CachingReducer`, as the strategy will produce several duplicates.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们引入 `GrammarReducer` 类，它再次是一个 `Reducer`。请注意，我们派生自 `CachingReducer`，因为该策略会产生多个重复。
- en: '[PRE67]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: A Few Helpers
  id: totrans-175
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 一些辅助工具
- en: 'We define a number of helper functions, which we will need for our strategy.
    `tree_list_to_string()` does what the name suggest, creating a string from a list
    of derivation trees:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我们定义了一些辅助函数，我们将在我们的策略中需要它们。`tree_list_to_string()` 做名字暗示的事情，从一个推导树的列表创建一个字符串：
- en: '[PRE68]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: '[PRE69]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: '[PRE70]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '[PRE71]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: The function `possible_combinations()` takes a list of lists $[[x_1, x_2], [y_1,
    y_2], \dots]$ and creates a list of combinations $[[x_1, y_1], [x_1, y_2], [x_2,
    y_1], [x_2, y_2], \dots]$.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 函数 `possible_combinations()` 接收一个列表的列表 $[[x_1, x_2], [y_1, y_2], \dots]$ 并创建一个组合列表
    $[[x_1, y_1], [x_1, y_2], [x_2, y_1], [x_2, y_2], \dots]$.
- en: '[PRE72]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '[PRE73]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: '[PRE74]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: The functions `number_of_nodes()` and `max_height()` return the number of nodes
    and the maximum height of the given tree, respectively.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 函数 `number_of_nodes()` 和 `max_height()` 分别返回给定树的节点数和最大高度。
- en: '[PRE75]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: '[PRE76]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: '[PRE77]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: '[PRE78]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: '[PRE79]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: '[PRE80]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: Simplification Strategies
  id: totrans-192
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 简化策略
- en: Let us now implement our two simplification strategies – replacing subtrees
    and alternate expansions.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来实现我们的两种简化策略——替换子树和替代展开。
- en: Finding Subtrees
  id: totrans-194
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 寻找子树
- en: The method `subtrees_with_symbol()` returns all subtrees in the given tree which's
    root is equal to the given symbol. If `ignore_root` is set (default), then the
    root node of `tree` is not compared against. (The `depth` parameter will be discussed
    below.)
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 方法 `subtrees_with_symbol()` 返回给定树中所有根节点等于给定符号的子树。如果设置了 `ignore_root`（默认值），则不比较
    `tree` 的根节点。（下面将讨论 `depth` 参数。）
- en: '[PRE81]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'Here''s an example: These are all subtrees with `<term>` in our derivation
    tree `derivation_tree`.'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个例子：这些都是我们推导树 `derivation_tree` 中包含 `<term>` 的所有子树。
- en: '[PRE82]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: '[PRE83]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: '[PRE84]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: '[PRE85]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: '[PRE86]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: If we want to replace `<term>` subtrees to simplify the tree, these are the
    subtrees we could replace them with.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想要替换 `<term>` 子树以简化树，这些是我们可以用它们替换的子树。
- en: Alternate Expansions
  id: totrans-204
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 替代展开
- en: Our second strategy, simplifying by alternate expansions, is a bit more complex.
    We first fetch the possible expansions for the given symbol (starting with the
    ones with the fewest children). For each expansion, we fill in values for the
    symbols from the subtree (using `subtrees_with_symbols()`, above). We then pick
    the first possible combination (or *all* combinations, if the attribute `try_all_combinations`
    is set).
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二种策略，通过替代展开简化，要复杂一些。我们首先获取给定符号的可能展开（从具有最少子节点的那些开始）。对于每个展开，我们使用 `subtrees_with_symbols()`（上面）从子树中填充符号的值。然后我们选择第一个可能的组合（或者如果设置了属性
    `try_all_combinations`，则选择所有组合）。
- en: '[PRE87]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: '[PRE88]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: '[PRE89]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: '[PRE90]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'Here are *all* combinations for `<term>`:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是 `<term>` 的所有组合：
- en: '[PRE91]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: '[PRE92]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'The default, though, is simply to return the first of these:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，默认情况下，只是简单地返回这些中的第一个：
- en: '[PRE93]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: '[PRE94]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: Both Strategies Together
  id: totrans-216
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 两种策略结合
- en: Let us now merge both strategies. To replace a subtree with a given symbol,
    we first search for already existing subtrees (using `subtrees_with_symbol()`);
    then we go for alternate expansions (using `alternate_expansions()`).
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们合并两种策略。为了用给定的符号替换子树，我们首先搜索已经存在的子树（使用 `subtrees_with_symbol()`）；然后进行备选扩展（使用
    `alternate_expansions()`）。
- en: '[PRE95]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: '[PRE96]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: '[PRE97]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: '[PRE98]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: These are the possible reductions for `<expr>` nodes. Note how we first return
    subtrees (`1 + (2 * 3)`, `(2 * 3)`, `2 * 3`) before going for alternate expansions
    of `<expr>` (`1`).
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是 `<expr>` 节点的可能简化方式。注意我们首先返回子树（`1 + (2 * 3)`，`(2 * 3)`，`2 * 3`），然后再进行 `<expr>`
    的备选扩展（`1`）。
- en: '[PRE99]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: '[PRE100]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: These are the possible reductions for `<term>` nodes. Again, we first have subtrees
    of the derivation tree, followed by the alternate expansion `1 * 1`.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是 `<term>` 节点的可能简化方式。再次强调，我们首先有推导树的子树，然后是备选扩展 `1 * 1`。
- en: '[PRE101]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: '[PRE102]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: The Reduction Strategy
  id: totrans-228
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 简化策略
- en: We are now able to return a number of alternatives for each symbol in the tree.
    This is what we apply in the core function of our reduction strategy, `reduce_subtree()`.
    Starting with `subtree`, for every child, we find possible reductions. For every
    reduction, we replace the child with the reduction and test the resulting (full)
    tree. If it fails, our reduction was successful; otherwise, we put the child back
    into place and try out the next reduction. Eventually, we apply `reduce_subtree()`
    on all children, reducing these as well.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们能够为树中的每个符号返回多个备选方案。这就是我们在简化策略的核心函数 `reduce_subtree()` 中应用的内容。从 `subtree`
    开始，对于每个子节点，我们找到可能的简化。对于每个简化，我们用简化替换子节点并测试结果（完整）树。如果它失败，我们的简化是成功的；否则，我们将子节点放回原位并尝试下一个简化。最终，我们将
    `reduce_subtree()` 应用到所有子节点上，也将它们简化。
- en: '[PRE103]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'All we now need is a few drivers. The method `reduce_tree()` is the main entry
    point into `reduce_subtree()`:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在只需要几个驱动器。`reduce_tree()` 方法是进入 `reduce_subtree()` 的主要入口点：
- en: '[PRE104]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: 'The custom method `parse()` turns a given input into a derivation tree:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义方法 `parse()` 将给定输入转换为推导树：
- en: '[PRE105]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: The method `reduce()` is the one single entry point, parsing the input and then
    reducing it.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '`reduce()` 方法是唯一的入口点，解析输入然后简化它。'
- en: '[PRE106]</details>'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE106]</details>'
- en: Let us try out our `GrammarReducer` class in practice on our input `expr_input`
    and the `mystery()` function. How quickly can we reduce it?
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在实际中尝试我们的 `GrammarReducer` 类，针对输入 `expr_input` 和 `mystery()` 函数。我们能够多快将其简化？
- en: '[PRE107]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: '[PRE108]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: '[PRE109]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: '[PRE110]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: '[PRE111]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: Success! In only five steps, our `GrammarReducer` reduces the input to the minimum
    that causes the failure. Note how all tests are syntactically valid by construction,
    avoiding the `UNRESOLVED` outcomes that cause delta debugging to stall.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 成功！仅用五步，我们的 `GrammarReducer` 就将输入简化到导致失败的最小值。注意，所有测试都是通过构造语法有效的，避免了导致 delta
    调试停滞的 `UNRESOLVED` 结果。
- en: A Depth-Oriented Strategy
  id: totrans-244
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 深度优先策略
- en: Even if five steps are already good, we can still do better. If we look at the
    log above, we see that after test `#2`, where the input (tree) is reduced to `2
    * 3`, our `GrammarReducer` first tries to replace the tree with `2` and `3`, which
    are the alternate `<term>` subtrees. This may work, of course; but if there are
    many possible subtrees, our strategy will spend quite some time trying one after
    the other.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 即使五步已经很好，我们仍然可以做得更好。如果我们查看上面的日志，我们会看到在测试 `#2` 中，输入（树）简化为 `2 * 3` 后，我们的 `GrammarReducer`
    首先尝试用 `2` 和 `3` 替换树，它们是备选的 `<term>` 子树。这当然可能有效；但如果有很多可能的子树，我们的策略将花费相当多的时间逐一尝试。
- en: Delta debugging, as introduced above, follows the idea of trying to cut inputs
    approximately in half, and thus quickly proceeds towards a minimal input. By replacing
    a tree with much smaller subtrees, we *could* possibly reduce a tree significantly,
    but may need several attempts to do so. A better strategy is to only consider
    *large* subtrees first – both for the subtree replacement and for alternate expansions.
    To find such *large* subtrees, we limit the *depth* by which we search for possible
    replacements in the subtree – first, by looking at the direct descendants, later
    at lower descendants.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述，Delta 调试遵循尝试将输入大约减半的想法，因此快速向最小输入推进。通过用更小的子树替换树，我们*可能*显著简化树，但可能需要多次尝试才能做到。更好的策略是首先只考虑*大的*子树——既用于子树替换也用于备选扩展。为了找到这样的*大的*子树，我们限制在子树中搜索可能替换的*深度*——首先查看直接后代，然后查看更低的后代。
- en: 'This is the role of the `depth` parameter used in `subtrees_with_symbol()`
    and passed through the invoking functions. If set, *only* symbols at the given
    depth are returned. Here''s an example, starting again with our derivation tree
    `derivation_tree`:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 这是`subtrees_with_symbol()`中使用的`depth`参数的作用，并通过调用函数传递。如果设置，则只返回给定深度的符号。以下是一个例子，再次从我们的推导树`derivation_tree`开始：
- en: '[PRE112]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE112]'
- en: '[PRE113]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE113]'
- en: '[PRE114]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE114]'
- en: '[PRE115]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE115]'
- en: <svg width="210pt" height="575pt" viewBox="0.00 0.00 209.62 575.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 571)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="81.62"
    y="-553.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="81.62" y="-503.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="33.62"
    y="-453.2" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="81.62" y="-453.2" font-family="Times,serif" font-size="14.00">+</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="127.62" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="31.62" y="-402.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27.62" y="-352.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="20.62" y="-302.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="20.62" y="-252.2" font-family="Times,serif" font-size="14.00">1
    (49)</text></g> <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="127.62" y="-402.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge9" class="edge"><title>8->9</title></g>
    <g id="node11" class="node"><title>10</title> <text text-anchor="middle" x="127.62"
    y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g> <g
    id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="74.62" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="128.62" y="-302.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge12" class="edge"><title>10->12</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="182.62"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge24"
    class="edge"><title>10->24</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="128.62" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="79.62" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="128.62" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge18" class="edge"><title>13->18</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="174.62" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge19" class="edge"><title>13->19</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="79.62" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="79.62" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="79.62" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="174.62" y="-151.7"
    font-family="Times,serif" font-size="14.00"><factor></text></g> <g id="edge20"
    class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="174.62" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="174.62" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="174.62" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge23" class="edge"><title>22->23</title></g></g></svg>
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: <svg width="210pt" height="575pt" viewBox="0.00 0.00 209.62 575.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 571)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="81.62"
    y="-553.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="81.62" y="-503.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge1" class="edge"><title>0->1</title></g>
    <g id="node3" class="node"><title>2</title> <text text-anchor="middle" x="33.62"
    y="-453.2" font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge2"
    class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="81.62" y="-453.2" font-family="Times,serif" font-size="14.00">+</text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="127.62" y="-453.2" font-family="Times,serif" font-size="14.00"><expr></text></g>
    <g id="edge8" class="edge"><title>1->8</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="31.62" y="-402.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5" class="node"><title>4</title>
    <text text-anchor="middle" x="27.62" y="-352.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge4" class="edge"><title>3->4</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="20.62" y="-302.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node7" class="node"><title>6</title>
    <text text-anchor="middle" x="20.62" y="-252.2" font-family="Times,serif" font-size="14.00">1
    (49)</text></g> <g id="edge6" class="edge"><title>5->6</title></g> <g id="node10"
    class="node"><title>9</title> <text text-anchor="middle" x="127.62" y="-402.95"
    font-family="Times,serif" font-size="14.00"><term></text></g> <g id="edge9" class="edge"><title>8->9</title></g>
    <g id="node11" class="node"><title>10</title> <text text-anchor="middle" x="127.62"
    y="-352.7" font-family="Times,serif" font-size="14.00"><factor></text></g> <g
    id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="74.62" y="-302.45" font-family="Times,serif" font-size="14.00">(
    (40)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="128.62" y="-302.45"
    font-family="Times,serif" font-size="14.00"><expr></text></g> <g id="edge12" class="edge"><title>10->12</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="182.62"
    y="-302.45" font-family="Times,serif" font-size="14.00">) (41)</text></g> <g id="edge24"
    class="edge"><title>10->24</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="128.62" y="-252.2" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="79.62" y="-201.95" font-family="Times,serif" font-size="14.00"><factor></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="128.62" y="-201.95" font-family="Times,serif" font-size="14.00">*</text></g>
    <g id="edge18" class="edge"><title>13->18</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="174.62" y="-201.95" font-family="Times,serif" font-size="14.00"><term></text></g>
    <g id="edge19" class="edge"><title>13->19</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="79.62" y="-151.7" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="79.62" y="-101.45" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="79.62" y="-51.2" font-family="Times,serif" font-size="14.00">2
    (50)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="174.62" y="-151.7"
    font-family="Times,serif" font-size="14.00"><factor></text></g> <g id="edge20"
    class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="174.62" y="-101.45" font-family="Times,serif" font-size="14.00"><integer></text></g>
    <g id="edge21" class="edge"><title>20->21</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="174.62" y="-51.2" font-family="Times,serif" font-size="14.00"><digit></text></g>
    <g id="edge22" class="edge"><title>21->22</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="174.62" y="-0.95" font-family="Times,serif" font-size="14.00">3
    (51)</text></g> <g id="edge23" class="edge"><title>22->23</title></g></g></svg>
- en: 'At a depth of 1, there is no `<term>` symbol:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在深度为1时，没有`<term>`符号：
- en: '[PRE116]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE116]'
- en: '[PRE117]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE117]'
- en: 'At a depth of 2, we have the `<term>` subtree on the left-hand side:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在深度为2时，我们在左侧有`<term>`子树：
- en: '[PRE118]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE118]'
- en: '[PRE119]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: 'At a depth of 3, we have the `<term>` subtree on the right-hand side:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 在深度为3时，我们在右侧有`<term>`子树：
- en: '[PRE120]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE120]'
- en: '[PRE121]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE121]'
- en: 'The idea is now to start with a depth of 0, subsequently increasing it as we
    proceed:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 现在的想法是从深度0开始，随着我们的进行逐步增加：
- en: '[PRE122]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE122]'
- en: '[PRE123]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE123]'
- en: '[PRE124]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE124]'
- en: '[PRE125]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE125]'
- en: We see that a depth-oriented strategy needs even fewer steps in our setting.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到，在我们的设置中，深度优先策略甚至需要更少的步骤。
- en: Comparing Strategies
  id: totrans-268
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 比较策略
- en: 'We close by demonstrating the difference between text-based delta debugging
    and our grammar-based reduction. We build a very long expression:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过构建一个非常长的表达式来结束，以展示基于文本的delta调试和我们的基于语法的减少之间的差异：
- en: '[PRE126]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE126]'
- en: '[PRE127]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE127]'
- en: '[PRE128]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE128]'
- en: 'With grammars, we need only a handful of tests to find the failure-inducing
    input:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 使用语法，我们只需要进行少量测试就能找到导致失败的输入：
- en: '[PRE129]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: '[PRE130]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: '[PRE131]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: '[PRE132]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: '[PRE133]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: '[PRE134]'
  id: totrans-279
  prefs: []
  type: TYPE_PRE
  zh: '[PRE134]'
- en: '[PRE135]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: Delta debugging, in contrast, requires orders of magnitude more tests (and consequently,
    time). Again, the reduction is not closely as perfect as it is with the grammar-based
    reducer.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 与此相反，delta调试需要数量级更多的测试（以及相应的时间）。再次强调，减少的效果并不像基于语法的减少器那样完美。
- en: '[PRE136]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: '[PRE137]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE137]'
- en: '[PRE138]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: '[PRE139]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: '[PRE140]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE140]'
- en: '[PRE141]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: We see that if an input is syntactically complex, using a grammar to reduce
    inputs is the best way to go.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到，如果一个输入在语法上复杂，使用语法来减少输入是最佳选择。
- en: Lessons Learned
  id: totrans-289
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 经验教训
- en: Reducing failure-inducing inputs to a minimum is helpful for testing and debugging.
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将导致失败的输入减少到最小有助于测试和调试。
- en: '*Delta debugging* is a simple and robust algorithm to easily reduce test cases.'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Delta调试*是一个简单且健壮的算法，可以轻松减少测试用例。'
- en: For syntactically complex inputs, *grammar-based reduction* is much faster and
    yields better results.
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于语法复杂的输入，*基于语法的减少*要快得多，并且结果更好。
- en: Next Steps
  id: totrans-293
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下一步
- en: Our next chapter focuses on [Web GUI Fuzzing](WebFuzzer.html), another domain
    where generating and reducing test cases is central.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 我们下一章将重点介绍[Web GUI Fuzzing](WebFuzzer.html)，这是另一个生成和减少测试用例至关重要的领域。
- en: Background
  id: totrans-295
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 背景
- en: The "lexical" delta debugging algorithm discussed here stems from [[Zeller *et
    al*, 2002](https://doi.org/10.1109/32.988498)]; actually, this is the exact Python
    implementation as used by Zeller in 2002\. The idea of systematically reducing
    inputs has been discovered a number of times, although not as automatic and generic
    as delta debugging. [[Slutz *et al*, 1998](https://www.microsoft.com/en-us/research/publication/massive-stochastic-testing-of-sql/)],
    for instance, discusses systematic reduction of SQL statements for SQL databases;
    the general process as manual work is well described by [Kernighan *et al*, 1999].
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 这里讨论的“词法”delta调试算法源于[[Zeller 等人，2002](https://doi.org/10.1109/32.988498)]；实际上，这正是Zeller在2002年所使用的Python实现。系统地减少输入的想法已经被发现多次，尽管不如delta调试那样自动和通用。[Slutz
    等人，1998](https://www.microsoft.com/en-us/research/publication/massive-stochastic-testing-of-sql/)，例如，讨论了SQL数据库中SQL语句的系统化减少；这个过程作为人工工作被[
    Kernighan 等人，1999](https://www.cs.princeton.edu/courses/archive/s99/cos217/lectures/lecture10.pdf)很好地描述了。
- en: The deficits of delta debugging as it comes to syntactically complex inputs
    were first discussed in *compiler testing*, and *reducing tree inputs* rather
    than string inputs was quickly discovered as an alternative. *Hierarchical Delta
    Debugging* (*HDD*) [[Misherghi *et al*, 2006](https://doi.org/10.1145/1134285.1134307)]
    applies delta debugging on subtrees of a parse tree, systematically reducing a
    parse tree to a minimum. *Generalized Tree Reduction* [[Herfert *et al*, 2017](http://dl.acm.org/citation.cfm?id=3155562.3155669)]
    generalizes this idea to apply arbitrary *patterns* such as replacing a term by
    a compatible term in a subtree, as `subtrees_with_symbol()` does. Using *grammars*
    to reduce inputs was first implemented in the *Perses* tool [[Sun *et al*, 2018](https://doi.org/10.1145/3180155.3180236)];
    our algorithm implements very similar strategies. Searching for alternate expansions
    (as `alternate_reductions()`) is a contribution of the present chapter.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 关于 delta debugging 在处理语法复杂输入时的不足，最初是在 *编译器测试* 中讨论的，并且很快发现 *减少树输入* 而不是字符串输入是一个替代方案。*分层
    delta debugging* (*HDD*) [[Misherghi 等人，2006](https://doi.org/10.1145/1134285.1134307)]
    在解析树的子树上应用 delta debugging，系统地减少解析树到最小。*广义树减少* [[Herfert 等人，2017](http://dl.acm.org/citation.cfm?id=3155562.3155669)]
    将这一想法推广到应用任意 *模式*，例如在子树中将一个项替换为兼容项，就像 `subtrees_with_symbol()` 所做的那样。使用 *语法* 来减少输入最初是在
    *Perses* 工具 [[Sun 等人，2018](https://doi.org/10.1145/3180155.3180236)] 中实现的；我们的算法实现了非常相似的战略。寻找替代扩展（如
    `alternate_reductions()`）是本章的一个贡献。
- en: 'While applying delta debugging to code lines does a decent job, *syntactic*
    and especially *language-specific* approaches can do a much better job for the
    programming language at hand:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然将 delta debugging 应用于代码行可以做得相当不错，但 *语法* 和特别是 *语言特定* 的方法可以为当前编程语言做更好的工作：
- en: '*C-Reduce* [[Regehr *et al*, 2012](https://doi.org/10.1145/2254064.2254104)]
    is a reducer specifically targeting the reduction of programming languages. Besides
    reductions in the style of delta debugging or tree transformations, C-Reduce comes
    with more than 30 source-to-source transformations that replace aggregates by
    scalars, remove function parameters at a definition and all call sites, change
    functions to return `void` and deleting all `return` statements, and many more.
    While specifically instantiated for the C language (and used for testing C compilers),
    these principles extend to arbitrary programming languages following an ALGOL-like
    syntax.'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*C-Reduce* [[Regehr 等人，2012](https://doi.org/10.1145/2254064.2254104)] 是一个专门针对编程语言减少的减少器。除了
    delta debugging 或树变换风格的减少外，C-Reduce 还提供了超过 30 种源到源转换，这些转换将聚合替换为标量，删除定义和所有调用位置上的函数参数，将函数更改为返回
    `void` 并删除所有 `return` 语句，等等。虽然这些原则专门针对 C 语言（并用于测试 C 编译器），但它们适用于遵循 ALGOL 类语法的任意编程语言。'
- en: Kalhauge and Palsberg [[Kalhauge *et al*, 2019](https://doi.org/10.1145/3338906.3338956)]
    introduce *binary reduction of dependency graphs*, a general solution for reducing
    arbitrary inputs with dependencies. Their *J-Reduce* tool specifically targets
    Java programs, and again is much faster than delta debugging and achieves a higher
    reduction rate.
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kalhauge 和 Palsberg [[Kalhauge 等人，2019](https://doi.org/10.1145/3338906.3338956)]
    介绍了 *依赖图二进制减少*，这是一个减少任意具有依赖关系的输入的通用解决方案。他们的 *J-Reduce* 工具专门针对 Java 程序，并且比 delta
    debugging 快得多，并且达到了更高的减少率。
- en: Reducing inputs also works well in the context of *property-based testing*;
    that is, generating data structures for individual functions, which can then be
    reduced ("shrunk") upon failure. The [Hypothesis](https://hypothesis.works) fuzzer
    has a number of type-specific shrinking strategies; this [blog article](https://hypothesis.works/articles/integrated-shrinking/)
    discusses some of its features.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 减少输入在 *基于属性的测试* 的上下文中也效果良好；也就是说，为单个函数生成数据结构，然后可以在失败时对其进行减少（“缩小”）。[Hypothesis](https://hypothesis.works)
    fuzzer 有许多特定类型的缩小策略；这篇[博客文章](https://hypothesis.works/articles/integrated-shrinking/)讨论了其一些特性。
- en: The chapter on ["Reducing Failure-Inducing Inputs" in the Debugging Book](https://www.debuggingbook.org/html/DeltaDebugger.html)
    has an alternate implementation `DeltaDebugger` of delta debugging that is even
    easier to deploy; here, one simply writes
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 在调试书籍中关于 ["减少故障诱导输入" 的章节](https://www.debuggingbook.org/html/DeltaDebugger.html)
    提供了一个更易于部署的 delta debugging 的替代实现 `DeltaDebugger`；在这里，只需简单地
- en: '[PRE142]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: to reduce the input in `args` for a failing (exception-throwing) function `fun()`.
    The chapter also discusses further usage examples, including reducing *code* to
    a minimum.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 减少 `args` 中用于失败（抛出异常）的函数 `fun()` 的输入。该章节还讨论了进一步的用法示例，包括将 *代码* 简化到最小。
- en: This [blog post](https://www.drmaciver.com/2019/01/notes-on-test-case-reduction/)
    by David McIver contains lots of insights on how to apply reduction in practice,
    in particular multiple runs with different abstraction levels.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: David McIver 的这篇 [博客文章](https://www.drmaciver.com/2019/01/notes-on-test-case-reduction/)
    包含了大量关于如何在实践中应用缩减的见解，特别是不同抽象级别的多次运行。
- en: Exercises
  id: totrans-306
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习
- en: How to best reduce inputs is still an underdeveloped field of research, with
    lots of opportunities.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 最佳缩减输入的方法仍然是一个研究不充分的研究领域，有很多机会。
- en: 'Exercise 1: Mutation-Based Fuzzing with Reduction'
  id: totrans-308
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 1：基于变异的模糊测试与缩减
- en: When fuzzing with a population, it can be useful to occasionally *reduce* the
    length of each element, such that future descendants are shorter, too, which typically
    speeds up their testing.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用种群进行模糊测试时，偶尔*缩减*每个元素的长度可能很有用，这样未来的后代也会更短，这通常可以加快它们的测试速度。
- en: Consider the `MutationFuzzer` class from [the chapter on mutation-based fuzzing](MutationFuzzer.html).
    Extend it such that whenever a new input is added to the population, it is first
    reduced using delta debugging.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑 [基于变异的模糊测试章节](MutationFuzzer.html) 中的 `MutationFuzzer` 类。扩展它，以便每当向种群添加新输入时，它首先使用
    delta 调试进行缩减。
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    进行练习并查看解决方案。'
- en: 'Exercise 2: Reduction by Production'
  id: totrans-312
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 2：通过生产进行缩减
- en: Grammar-based input reduction, as sketched above, might be a good algorithm,
    but is by no means the only alternative. One interesting question is whether "reduction"
    should only be limited to elements already present, or whether one would be allowed
    to also create *new* elements. These would not be present in the original input,
    yet still allow producing a much smaller input that would still reproduce the
    original failure.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述的基于语法的输入缩减可能是一个好的算法，但绝不是唯一的替代方案。一个有趣的问题是“缩减”是否应该仅限于已经存在的元素，或者是否允许创建*新*元素。这些元素可能不在原始输入中，但仍然可以生成一个更小的输入，从而仍然能够重现原始的失败。
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    进行练习并查看解决方案。'
- en: 'As an example, consider the following grammar:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，考虑以下语法：
- en: '[PRE143]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: Assume the input `100.99` fails. We might be able to reduce it to a minimum
    of, say, `1.9`. However, we cannot reduce it to an `<integer>` or to `<not-a-number>`,
    as these symbols do not occur in the original input. By allowing to *create* alternatives
    for these symbols, we could also test inputs such as `1` or `NaN` and further
    generalize the class of inputs for which the program fails.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 假设输入 `100.99` 失败。我们可能能够将其缩减到最小值，例如 `1.9`。然而，我们不能将其缩减到 `<integer>` 或 `<not-a-number>`，因为这些符号在原始输入中不存在。通过允许为这些符号创建*替代*，我们也可以测试如
    `1` 或 `NaN` 这样的输入，并进一步泛化程序失败输入的类别。
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    进行练习并查看解决方案。'
- en: Create a class `GenerativeGrammarReducer` as subclass of `GrammarReducer`; extend
    the method `reduce_subtree()` accordingly.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个 `GenerativeGrammarReducer` 类，作为 `GrammarReducer` 的子类；相应地扩展 `reduce_subtree()`
    方法。
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    进行练习并查看解决方案。'
- en: 'Exercise 3: The Big Reduction Shoot-Out'
  id: totrans-321
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习 3：大规模缩减竞赛
- en: 'Create a *benchmark* for the grammars already defined earlier, consisting of:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 为之前定义的语法创建一个*基准*，包括：
- en: A set of *inputs*, produced from these very grammars using `GrammarFuzzer` and
    derivatives;
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一组*输入*，使用 `GrammarFuzzer` 和其衍生工具从这些语法生成；
- en: 'A set of *tests* which check for the occurrence of individual symbols as well
    as pairs and triples of these symbols:'
  id: totrans-324
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一组*测试*，用于检查单个符号以及这些符号的成对和三重组合的出现：
- en: Tests should be *unresolved* if the input is not syntactically valid;
  id: totrans-325
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果输入不是语法有效的，测试应该*未解决*；
- en: Tests should *fail* if the symbols (or pairs or triples thereof) occur;
  id: totrans-326
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果符号（或其成对或三重组合）出现，测试应该*失败*；
- en: Tests should *pass* in all other cases.
  id: totrans-327
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在所有其他情况下，测试应该*通过*。
- en: Compare delta debugging and grammar-based debugging on the benchmark. Implement
    HDD [[Misherghi *et al*, 2006](https://doi.org/10.1145/1134285.1134307)] and *Generalized
    Tree Reduction* [[Herfert *et al*, 2017](http://dl.acm.org/citation.cfm?id=3155562.3155669)]
    and add them to your comparison. Which approach performs best, and under which
    circumstances?
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 在基准测试中比较 delta 调试和基于语法的调试。实现 HDD [[Misherghi 等人，2006](https://doi.org/10.1145/1134285.1134307)]
    和 *广义树缩减* [[Herfert 等人，2017](http://dl.acm.org/citation.cfm?id=3155562.3155669)]
    并将它们添加到比较中。哪种方法表现最好，以及在什么情况下？
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: '[使用笔记本](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/Reducer.ipynb#Exercises)
    来完成练习并查看解决方案。'
- en: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)
    The content of this project is licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike
    4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).
    The source code that is part of the content, as well as the source code used to
    format and display that content is licensed under the [MIT License](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license).
    [Last change: 2023-11-11 18:18:06+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/Reducer.ipynb)
    • [Cite](#citation) • [Imprint](https://cispa.de/en/impressum)'
  id: totrans-330
  prefs: []
  type: TYPE_IMG
  zh: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)
    本项目的内容受[Creative Commons Attribution-NonCommercial-ShareAlike 4.0 国际许可协议](https://creativecommons.org/licenses/by-nc-sa/4.0/)许可。作为内容一部分的源代码，以及用于格式化和显示该内容的源代码，受[MIT
    许可协议](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license)许可。
    [最后修改：2023-11-11 18:18:06+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/Reducer.ipynb)
    • [引用](#citation) • [版权信息](https://cispa.de/en/impressum)'
- en: How to Cite this Work
  id: totrans-331
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何引用本作品
- en: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler: "[Reducing Failure-Inducing Inputs](https://www.fuzzingbook.org/html/Reducer.html)".
    In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler, "[The Fuzzing Book](https://www.fuzzingbook.org/)", [https://www.fuzzingbook.org/html/Reducer.html](https://www.fuzzingbook.org/html/Reducer.html).
    Retrieved 2023-11-11 18:18:06+01:00.'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, 和 Christian Holler:
    "[减少故障诱导输入](https://www.fuzzingbook.org/html/Reducer.html)". 在 Andreas Zeller,
    Rahul Gopinath, Marcel Böhme, Gordon Fraser, 和 Christian Holler, "[模糊测试书](https://www.fuzzingbook.org/)",
    [https://www.fuzzingbook.org/html/Reducer.html](https://www.fuzzingbook.org/html/Reducer.html).
    Retrieved 2023-11-11 18:18:06+01:00.'
- en: '[PRE144]'
  id: totrans-333
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
