<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Greybox Fuzzing with Grammars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Greybox Fuzzing with Grammars</h1>
<blockquote>原文：<a href="http://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html">http://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html</a></blockquote>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In this chapter, we introduce important extensions to our syntactic fuzzing techniques, all leveraging <em>syntactic</em> parts of <em>existing inputs</em>.</p>
<ol>
<li><p>We show how to leverage <em>dictionaries</em> of input fragments during fuzzing. The idea is to integrate such dictionaries into a <em>mutator</em>, which would then inject these fragments (typically keywords and other items of importance) into population.</p>
</li>
<li><p>We show how to combine <a href="Parser.html">parsing</a> and <a href="GrammarFuzzer.html">fuzzing</a> with grammars.  This allows <em>mutating</em> existing inputs while preserving syntactical correctness, and to <em>reuse</em> fragments from existing inputs while generating new ones.  The combination of language-based parsing and generating, as demonstrated in this chapter, has been highly successful in practice: The <em>LangFuzz</em> fuzzer for JavaScript has found more than 2,600 bugs in JavaScript interpreters this way.</p>
</li>
<li><p>In the previous chapters, we have used grammars in a <em>black-box</em> manner – that is, we have used them to generate inputs regardless of the program being tested.  In this chapter, we introduce mutational <em>greybox fuzzing with grammars</em>: Techniques that make use of <em>feedback from the program under test</em> to guide test generations towards specific goals.  As in <a href="GreyboxFuzzer.html">lexical greybox fuzzing</a>, this feedback is mostly <em>coverage</em>, allowing us to direct grammar-based testing towards uncovered code parts. This part is inspired by the <em>AFLSmart</em> fuzzer, which combines parsing and mutational fuzzing.</p>
</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">'hSGzcjUj7Vs'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>We build on several concepts from <a href="GreyboxFuzzer.html">the chapter on greybox fuzzing (without grammars)</a>.</li>
<li>As the title suggests, you should know how to fuzz with grammars <a href="Grammars.html">from the chapter on grammars</a>.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis</h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="GreyboxGrammarFuzzer.html" class="import" target="_blank">fuzzingbook.GreyboxGrammarFuzzer</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter introduces advanced methods for language-based grey-box fuzzing inspired by the <em>LangFuzz</em> and <em>AFLSmart</em> fuzzers.</p>
<h3 id="Fuzzing-with-Dictionaries">Fuzzing with Dictionaries</h3><p>Rather than mutating strings randomly, the <code>DictMutator</code> class allows inserting tokens from a dictionary, thus increasing fuzzer performance. The dictionary comes as a list of strings, out of which random elements are picked and inserted - in addition to the given mutations such as deleting or inserting individual bytes.</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">dict_mutator</span> <span class="o">=</span> <span class="n">DictMutator</span><span class="p">([</span><span class="s2">"&lt;a&gt;"</span><span class="p">,</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">,</span> <span class="s2">"&lt;a/&gt;"</span><span class="p">,</span> <span class="s2">"='a'"</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">seeds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">dict_mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">seeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&gt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">ht7ml</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">hgad</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&lt;</span><span class="n">a</span><span class="o">/&gt;&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">+&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">qhead</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">=</span><span class="s1">'a'</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">Wormd</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">Wyorld</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;&lt;/</span><span class="n">a</span><span class="o">&gt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</pre></div>
<p>This <code>DictMutator</code> can be used as an argument to <code>GreyboxFuzzer</code>:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dict_fuzzer</span> <span class="o">=</span> <span class="n">GreyboxFuzzer</span><span class="p">(</span><span class="n">seeds</span><span class="p">,</span> <span class="n">dict_mutator</span><span class="p">,</span> <span class="n">PowerSchedule</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dict_fuzzer_outcome</span> <span class="o">=</span> <span class="n">dict_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
<p>

<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="306pt" height="152pt" viewbox="0.00 0.00 305.62 152.25" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 148.25)">
<g id="a_graph0"><a xlink:title="DictMutator class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-148.25 301.62,-148.25 301.62,4 -4,4"/>
</a>
</g>
<!-- DictMutator -->
<g id="node1" class="node">
<title>DictMutator</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class DictMutator:&#10;Mutate strings using keywords from a dictionary">
<polygon fill="none" stroke="black" points="0,-0.5 0,-60 160,-60 160,-0.5 0,-0.5"/>
<text text-anchor="start" x="42.12" y="-43.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">DictMutator</text>
<polyline fill="none" stroke="black" points="0,-34 160,-34"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="DictMutator">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, dictionary: List[str]) -&gt; None:&#10;Constructor. `dictionary` is the list of keywords to use.">
<text text-anchor="start" x="8" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="insert_from_dictionary(self, s: str) -&gt; str:&#10;Returns s with a keyword from the dictionary inserted">
<text text-anchor="start" x="8" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">insert_from_dictionary()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Mutator -->
<g id="node2" class="node">
<title>Mutator</title>
<g id="a_node2"><a xlink:href="GreyboxFuzzer.html" xlink:title="class Mutator:&#10;Mutate strings">
<polygon fill="none" stroke="black" points="42,-97 42,-143.75 118,-143.75 118,-97 42,-97"/>
<text text-anchor="start" x="54.12" y="-127.45" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
<polyline fill="none" stroke="black" points="42,-117.75 118,-117.75"/>
<g id="a_node2_3"><a xlink:href="#" xlink:title="Mutator">
<g id="a_node2_4"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="50" y="-105.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- DictMutator&#45;&gt;Mutator -->
<g id="edge1" class="edge">
<title>DictMutator-&gt;Mutator</title>
<path fill="none" stroke="black" d="M80,-60.11C80,-68.16 80,-76.98 80,-85.3"/>
<polygon fill="none" stroke="black" points="76.5,-85.09 80,-95.09 83.5,-85.09 76.5,-85.09"/>
</g>
<!-- Legend -->
<g id="node3" class="node">
<title>Legend</title>
<text text-anchor="start" x="178.38" y="-46.25" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text text-anchor="start" x="178.38" y="-36.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="184.38" y="-36.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="178.38" y="-26.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="184.38" y="-26.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="178.38" y="-16.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="184.38" y="-16.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="178.38" y="-7.2" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
<h3 id="Fuzzing-with-Input-Fragments">Fuzzing with Input Fragments</h3><p>The <code>LangFuzzer</code> class introduces a <em>language-aware</em> fuzzer that can recombine fragments from existing inputs – inspired by the highly effective <code>LangFuzz</code> fuzzer. At its core is a <code>FragmentMutator</code> class that that takes a <a href="Parser.html"><em>parser</em></a> as argument:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mutator</span> <span class="o">=</span> <span class="n">FragmentMutator</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</pre></div>
<p>The fuzzer itself is initialized with a list of seeds, the above <code>FragmentMutator</code>, and a power schedule:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">seeds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">lang_fuzzer</span> <span class="o">=</span> <span class="n">LangFuzzer</span><span class="p">(</span><span class="n">seeds</span><span class="p">,</span> <span class="n">mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">lang_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>

<span class="ne">Exception</span> <span class="n">ignored</span> <span class="ow">in</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">IPythonKernel</span><span class="o">.</span><span class="n">_clean_thread_parent_frames</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">ipykernel</span><span class="o">.</span><span class="n">ipkernel</span><span class="o">.</span><span class="n">IPythonKernel</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x103912720</span><span class="o">&gt;&gt;</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_clean_thread_parent_frames</span>
    <span class="k">def</span> <span class="nf">_clean_thread_parent_frames</span><span class="p">(</span>

  <span class="n">File</span> <span class="s2">"Timeout.ipynb"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">43</span><span class="p">,</span> <span class="ow">in</span> <span class="n">timeout_handler</span>
    <span class="p">}</span>

<span class="ne">TimeoutError</span><span class="p">:</span> 

<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">WorldHello</span><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>

<span class="ne">Exception</span> <span class="n">ignored</span> <span class="ow">in</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">IPythonKernel</span><span class="o">.</span><span class="n">_clean_thread_parent_frames</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">ipykernel</span><span class="o">.</span><span class="n">ipkernel</span><span class="o">.</span><span class="n">IPythonKernel</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x103912720</span><span class="o">&gt;&gt;</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_clean_thread_parent_frames</span>
    <span class="k">def</span> <span class="nf">_clean_thread_parent_frames</span><span class="p">(</span>

  <span class="n">File</span> <span class="s2">"Timeout.ipynb"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">43</span><span class="p">,</span> <span class="ow">in</span> <span class="n">timeout_handler</span>
    <span class="p">}</span>

<span class="ne">TimeoutError</span><span class="p">:</span> 

<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Hello</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">title</span><span class="o">&gt;&lt;</span><span class="n">head</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;/</span><span class="n">title</span><span class="o">&gt;&lt;/</span><span class="n">head</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="n">World</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;</span><span class="n">br</span><span class="o">/&gt;&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</pre></div>
<p>

<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="462pt" height="389pt" viewbox="0.00 0.00 461.88 389.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 385)">
<g id="a_graph0"><a xlink:title="LangFuzzer class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-385 457.88,-385 457.88,4 -4,4"/>
</a>
</g>
<!-- LangFuzzer -->
<g id="node1" class="node">
<title>LangFuzzer</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class LangFuzzer:&#10;Blackbox fuzzer mutating input fragments. Roughly based on `LangFuzz`.">
<polygon fill="none" stroke="black" points="26.25,-57.88 26.25,-104.62 150.25,-104.62 150.25,-57.88 26.25,-57.88"/>
<text text-anchor="start" x="52.62" y="-88.33" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">LangFuzzer</text>
<polyline fill="none" stroke="black" points="26.25,-78.62 150.25,-78.62"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="LangFuzzer">
<g id="a_node1_1"><a xlink:href="#" xlink:title="create_candidate(self) -&gt; GreyboxFuzzer.Seed:&#10;Returns an input generated by fuzzing a seed in the population">
<text text-anchor="start" x="34.25" y="-66.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">create_candidate()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- AdvancedMutationFuzzer -->
<g id="node2" class="node">
<title>AdvancedMutationFuzzer</title>
<g id="a_node2"><a xlink:href="GreyboxFuzzer.html" xlink:title="class AdvancedMutationFuzzer:&#10;Base class for mutation-based fuzzing.">
<polygon fill="none" stroke="black" points="0,-199 0,-258.5 176.5,-258.5 176.5,-199 0,-199"/>
<text text-anchor="start" x="8" y="-242.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">AdvancedMutationFuzzer</text>
<polyline fill="none" stroke="black" points="0,-232.5 176.5,-232.5"/>
<g id="a_node2_2"><a xlink:href="#" xlink:title="AdvancedMutationFuzzer">
<g id="a_node2_3"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self, seeds: List[str], mutator: GreyboxFuzzer.Mutator, schedule: GreyboxFuzzer.PowerSchedule) -&gt; None:&#10;Constructor.&#10;`seeds` - a list of (input) strings to mutate.&#10;`mutator` - the mutator to apply.&#10;`schedule` - the power schedule to apply.">
<text text-anchor="start" x="58.25" y="-220" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node2_4"><a xlink:href="GreyboxFuzzer.html" xlink:title="fuzz(self) -&gt; str:&#10;Returns first each seed once and then generates new inputs">
<text text-anchor="start" x="58.25" y="-207.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- LangFuzzer&#45;&gt;AdvancedMutationFuzzer -->
<g id="edge1" class="edge">
<title>LangFuzzer-&gt;AdvancedMutationFuzzer</title>
<path fill="none" stroke="black" d="M88.25,-104.98C88.25,-126.99 88.25,-160.81 88.25,-187.39"/>
<polygon fill="none" stroke="black" points="84.75,-187.14 88.25,-197.14 91.75,-187.14 84.75,-187.14"/>
</g>
<!-- Fuzzer -->
<g id="node3" class="node">
<title>Fuzzer</title>
<g id="a_node3"><a xlink:href="Fuzzer.html" xlink:title="class Fuzzer:&#10;Base class for fuzzers.">
<polygon fill="none" stroke="black" points="50.25,-295.5 50.25,-380.5 126.25,-380.5 126.25,-295.5 50.25,-295.5"/>
<text text-anchor="start" x="67.62" y="-364.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Fuzzer</text>
<polyline fill="none" stroke="black" points="50.25,-354.5 126.25,-354.5"/>
<g id="a_node3_5"><a xlink:href="#" xlink:title="Fuzzer">
<g id="a_node3_6"><a xlink:href="Fuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="58.25" y="-342" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node3_7"><a xlink:href="Fuzzer.html" xlink:title="fuzz(self) -&gt; str:&#10;Return fuzz input">
<text text-anchor="start" x="58.25" y="-329.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
<g id="a_node3_8"><a xlink:href="Fuzzer.html" xlink:title="run(self, runner: Fuzzer.Runner = &lt;Fuzzer.Runner object&gt;) -&gt; Tuple[subprocess.CompletedProcess, str]:&#10;Run `runner` with fuzz input">
<text text-anchor="start" x="58.25" y="-316.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">run()</text>
</a>
</g>
<g id="a_node3_9"><a xlink:href="Fuzzer.html" xlink:title="runs(self, runner: Fuzzer.Runner = &lt;Fuzzer.PrintRunner object&gt;, trials: int = 10) -&gt; List[Tuple[subprocess.CompletedProcess, str]]:&#10;Run `runner` with fuzz input, `trials` times">
<text text-anchor="start" x="58.25" y="-303.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">runs()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- AdvancedMutationFuzzer&#45;&gt;Fuzzer -->
<g id="edge2" class="edge">
<title>AdvancedMutationFuzzer-&gt;Fuzzer</title>
<path fill="none" stroke="black" d="M88.25,-258.77C88.25,-266.54 88.25,-275.18 88.25,-283.81"/>
<polygon fill="none" stroke="black" points="84.75,-283.55 88.25,-293.55 91.75,-283.55 84.75,-283.55"/>
</g>
<!-- FragmentMutator -->
<g id="node4" class="node">
<title>FragmentMutator</title>
<g id="a_node4"><a xlink:href="#" xlink:title="class FragmentMutator:&#10;Mutate inputs with input fragments from a pool">
<polygon fill="none" stroke="black" points="168.25,-0.5 168.25,-162 316.25,-162 316.25,-0.5 168.25,-0.5"/>
<text text-anchor="start" x="186.38" y="-145.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">FragmentMutator</text>
<polyline fill="none" stroke="black" points="168.25,-136 316.25,-136"/>
<g id="a_node4_10"><a xlink:href="#" xlink:title="FragmentMutator">
<g id="a_node4_11"><a xlink:href="#" xlink:title="__init__(self, parser):&#10;Initialize mutators">
<text text-anchor="start" x="176.25" y="-123.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node4_12"><a xlink:href="#" xlink:title="add_to_fragment_pool(self, seed: SeedWithStructure) -&gt; None:&#10;Adds all fragments of a seed to the fragment pool">
<text text-anchor="start" x="176.25" y="-110.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">add_to_fragment_pool()</text>
</a>
</g>
<g id="a_node4_13"><a xlink:href="#" xlink:title="add_fragment(self, fragment: DerivationTree) -&gt; None:&#10;Recursively adds fragments to the fragment pool">
<text text-anchor="start" x="176.25" y="-97" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">add_fragment()</text>
</a>
</g>
<g id="a_node4_14"><a xlink:href="#" xlink:title="count_nodes(self, fragment: DerivationTree) -&gt; int:&#10;Returns the number of nodes in the fragment">
<text text-anchor="start" x="176.25" y="-84.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">count_nodes()</text>
</a>
</g>
<g id="a_node4_15"><a xlink:href="#" xlink:title="delete_fragment(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Delete a random fragment">
<text text-anchor="start" x="176.25" y="-71.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">delete_fragment()</text>
</a>
</g>
<g id="a_node4_16"><a xlink:href="#" xlink:title="is_excluded(self, symbol: str) -&gt; bool:&#10;Returns true if a fragment starting with a specific&#10;symbol and all its decendents can be excluded">
<text text-anchor="start" x="176.25" y="-58.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">is_excluded()</text>
</a>
</g>
<g id="a_node4_17"><a xlink:href="#" xlink:title="mutate(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Implement structure-aware mutation. Memoize seeds.">
<text text-anchor="start" x="176.25" y="-47" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">mutate()</text>
</a>
</g>
<g id="a_node4_18"><a xlink:href="#" xlink:title="recursive_delete(self, fragment: DerivationTree) -&gt; DerivationTree:&#10;Recursively finds the fragment to delete">
<text text-anchor="start" x="176.25" y="-33.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">recursive_delete()</text>
</a>
</g>
<g id="a_node4_19"><a xlink:href="#" xlink:title="recursive_swap(self, fragment: DerivationTree) -&gt; DerivationTree:&#10;Recursively finds the fragment to swap.">
<text text-anchor="start" x="176.25" y="-20.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">recursive_swap()</text>
</a>
</g>
<g id="a_node4_20"><a xlink:href="#" xlink:title="swap_fragment(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Substitutes a random fragment with another with the same symbol">
<text text-anchor="start" x="176.25" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">swap_fragment()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Mutator -->
<g id="node5" class="node">
<title>Mutator</title>
<g id="a_node5"><a xlink:href="GreyboxFuzzer.html" xlink:title="class Mutator:&#10;Mutate strings">
<polygon fill="none" stroke="black" points="204.25,-205.38 204.25,-252.12 280.25,-252.12 280.25,-205.38 204.25,-205.38"/>
<text text-anchor="start" x="216.38" y="-235.82" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
<polyline fill="none" stroke="black" points="204.25,-226.12 280.25,-226.12"/>
<g id="a_node5_21"><a xlink:href="#" xlink:title="Mutator">
<g id="a_node5_22"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="212.25" y="-213.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- FragmentMutator&#45;&gt;Mutator -->
<g id="edge3" class="edge">
<title>FragmentMutator-&gt;Mutator</title>
<path fill="none" stroke="black" d="M242.25,-162.24C242.25,-173.29 242.25,-184.11 242.25,-193.68"/>
<polygon fill="none" stroke="black" points="238.75,-193.53 242.25,-203.53 245.75,-193.53 238.75,-193.53"/>
</g>
<!-- Legend -->
<g id="node6" class="node">
<title>Legend</title>
<text text-anchor="start" x="334.62" y="-97.25" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text text-anchor="start" x="334.62" y="-87.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="340.62" y="-87.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="334.62" y="-77.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="340.62" y="-77.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="334.62" y="-67.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="340.62" y="-67.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="334.62" y="-58.2" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
<h3 id="Fuzzing-with-Input-Regions">Fuzzing with Input Regions</h3><p>The <code>GreyboxGrammarFuzzer</code> class uses two mutators:</p>
<ul>
<li>a <em>tree mutator</em> (a <code>RegionMutator</code> object) that can parse existing strings to identify <em>regions</em> in that string to be swapped or deleted.</li>
<li>a <em>byte mutator</em> to apply bit- and character-level mutations.</li>
</ul>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">tree_mutator</span> <span class="o">=</span> <span class="n">RegionMutator</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">byte_mutator</span> <span class="o">=</span> <span class="n">Mutator</span><span class="p">()</span>
</pre></div>
<p>The <em>schedule</em> for the <code>GreyboxGrammarFuzzer</code> class can be a regular <code>PowerSchedule</code> object. However, a more sophisticated schedule is provided by <code>AFLSmartSchedule</code>, which assigns more <a href="GreyboxFuzzer.html#Power-Schedules">energy</a> to seeds that have a higher degree of validity.</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">schedule</span> <span class="o">=</span> <span class="n">AFLSmartSchedule</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</pre></div>
<p>The <code>GreyboxGrammarFuzzer</code> constructor takes a set of seeds as well as the two mutators and the schedule:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">aflsmart_fuzzer</span> <span class="o">=</span> <span class="n">GreyboxGrammarFuzzer</span><span class="p">(</span><span class="n">seeds</span><span class="p">,</span> <span class="n">byte_mutator</span><span class="p">,</span> <span class="n">tree_mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>
</pre></div>
<p>As it relies on code coverage, it is typically combined with a <code>FunctionCoverageRunner</code>:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">aflsmart_outcome</span> <span class="o">=</span> <span class="n">aflsmart_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
<p>

<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="638pt" height="511pt" viewbox="0.00 0.00 637.88 511.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 507)">
<g id="a_graph0"><a xlink:title="GreyboxGrammarFuzzer class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-507 633.88,-507 633.88,4 -4,4"/>
</a>
</g>
<!-- GreyboxGrammarFuzzer -->
<g id="node1" class="node">
<title>GreyboxGrammarFuzzer</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class GreyboxGrammarFuzzer:&#10;Greybox fuzzer using grammars.">
<polygon fill="none" stroke="black" points="4.5,-13.25 4.5,-72.75 172,-72.75 172,-13.25 4.5,-13.25"/>
<text text-anchor="start" x="12.5" y="-56.45" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">GreyboxGrammarFuzzer</text>
<polyline fill="none" stroke="black" points="4.5,-46.75 172,-46.75"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="GreyboxGrammarFuzzer">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, seeds: List[str], byte_mutator: GreyboxFuzzer.Mutator, tree_mutator: FragmentMutator, schedule: GreyboxFuzzer.PowerSchedule) -&gt; None:&#10;Constructor.&#10;`seeds` - set of inputs to mutate.&#10;`byte_mutator` - a byte-level mutator.&#10;`tree_mutator` = a tree-level mutator.&#10;`schedule` - a power schedule.">
<text text-anchor="start" x="34.25" y="-34.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="create_candidate(self) -&gt; str:&#10;Returns an input generated by structural mutation&#10;of a seed in the population">
<text text-anchor="start" x="34.25" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">create_candidate()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- GreyboxFuzzer -->
<g id="node2" class="node">
<title>GreyboxFuzzer</title>
<g id="a_node2"><a xlink:href="GreyboxFuzzer.html" xlink:title="class GreyboxFuzzer:&#10;Coverage-guided mutational fuzzing.">
<polygon fill="none" stroke="black" points="33.75,-179.88 33.75,-226.62 142.75,-226.62 142.75,-179.88 33.75,-179.88"/>
<text text-anchor="start" x="41.75" y="-210.32" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">GreyboxFuzzer</text>
<polyline fill="none" stroke="black" points="33.75,-200.62 142.75,-200.62"/>
<g id="a_node2_3"><a xlink:href="#" xlink:title="GreyboxFuzzer">
<g id="a_node2_4"><a xlink:href="GreyboxFuzzer.html" xlink:title="run(self, runner: MutationFuzzer.FunctionCoverageRunner) -&gt; Tuple[Any, str]:&#10;Run function(inp) while tracking coverage.&#10;If we reach new coverage,&#10;add inp to population and its coverage to population_coverage">
<text text-anchor="start" x="73.25" y="-188.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- GreyboxGrammarFuzzer&#45;&gt;GreyboxFuzzer -->
<g id="edge1" class="edge">
<title>GreyboxGrammarFuzzer-&gt;GreyboxFuzzer</title>
<path fill="none" stroke="black" d="M88.25,-73.03C88.25,-99.88 88.25,-139.82 88.25,-168.18"/>
<polygon fill="none" stroke="black" points="84.75,-168.04 88.25,-178.04 91.75,-168.04 84.75,-168.04"/>
</g>
<!-- AdvancedMutationFuzzer -->
<g id="node3" class="node">
<title>AdvancedMutationFuzzer</title>
<g id="a_node3"><a xlink:href="GreyboxFuzzer.html" xlink:title="class AdvancedMutationFuzzer:&#10;Base class for mutation-based fuzzing.">
<polygon fill="none" stroke="black" points="0,-321 0,-380.5 176.5,-380.5 176.5,-321 0,-321"/>
<text text-anchor="start" x="8" y="-364.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">AdvancedMutationFuzzer</text>
<polyline fill="none" stroke="black" points="0,-354.5 176.5,-354.5"/>
<g id="a_node3_5"><a xlink:href="#" xlink:title="AdvancedMutationFuzzer">
<g id="a_node3_6"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self, seeds: List[str], mutator: GreyboxFuzzer.Mutator, schedule: GreyboxFuzzer.PowerSchedule) -&gt; None:&#10;Constructor.&#10;`seeds` - a list of (input) strings to mutate.&#10;`mutator` - the mutator to apply.&#10;`schedule` - the power schedule to apply.">
<text text-anchor="start" x="58.25" y="-342" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node3_7"><a xlink:href="GreyboxFuzzer.html" xlink:title="fuzz(self) -&gt; str:&#10;Returns first each seed once and then generates new inputs">
<text text-anchor="start" x="58.25" y="-329.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- GreyboxFuzzer&#45;&gt;AdvancedMutationFuzzer -->
<g id="edge2" class="edge">
<title>GreyboxFuzzer-&gt;AdvancedMutationFuzzer</title>
<path fill="none" stroke="black" d="M88.25,-226.98C88.25,-248.99 88.25,-282.81 88.25,-309.39"/>
<polygon fill="none" stroke="black" points="84.75,-309.14 88.25,-319.14 91.75,-309.14 84.75,-309.14"/>
</g>
<!-- Fuzzer -->
<g id="node4" class="node">
<title>Fuzzer</title>
<g id="a_node4"><a xlink:href="Fuzzer.html" xlink:title="class Fuzzer:&#10;Base class for fuzzers.">
<polygon fill="none" stroke="black" points="50.25,-417.5 50.25,-502.5 126.25,-502.5 126.25,-417.5 50.25,-417.5"/>
<text text-anchor="start" x="67.62" y="-486.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Fuzzer</text>
<polyline fill="none" stroke="black" points="50.25,-476.5 126.25,-476.5"/>
<g id="a_node4_8"><a xlink:href="#" xlink:title="Fuzzer">
<g id="a_node4_9"><a xlink:href="Fuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="58.25" y="-464" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node4_10"><a xlink:href="Fuzzer.html" xlink:title="fuzz(self) -&gt; str:&#10;Return fuzz input">
<text text-anchor="start" x="58.25" y="-451.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
<g id="a_node4_11"><a xlink:href="Fuzzer.html" xlink:title="run(self, runner: Fuzzer.Runner = &lt;Fuzzer.Runner object&gt;) -&gt; Tuple[subprocess.CompletedProcess, str]:&#10;Run `runner` with fuzz input">
<text text-anchor="start" x="58.25" y="-438.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
<g id="a_node4_12"><a xlink:href="Fuzzer.html" xlink:title="runs(self, runner: Fuzzer.Runner = &lt;Fuzzer.PrintRunner object&gt;, trials: int = 10) -&gt; List[Tuple[subprocess.CompletedProcess, str]]:&#10;Run `runner` with fuzz input, `trials` times">
<text text-anchor="start" x="58.25" y="-425.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">runs()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- AdvancedMutationFuzzer&#45;&gt;Fuzzer -->
<g id="edge3" class="edge">
<title>AdvancedMutationFuzzer-&gt;Fuzzer</title>
<path fill="none" stroke="black" d="M88.25,-380.77C88.25,-388.54 88.25,-397.18 88.25,-405.81"/>
<polygon fill="none" stroke="black" points="84.75,-405.55 88.25,-415.55 91.75,-405.55 84.75,-405.55"/>
</g>
<!-- AFLSmartSchedule -->
<g id="node5" class="node">
<title>AFLSmartSchedule</title>
<g id="a_node5"><a xlink:href="#" xlink:title="class AFLSmartSchedule:&#10;Define how fuzzing time should be distributed across the population.">
<polygon fill="none" stroke="black" points="190.25,-0.5 190.25,-85.5 326.25,-85.5 326.25,-0.5 190.25,-0.5"/>
<text text-anchor="start" x="200.5" y="-69.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">AFLSmartSchedule</text>
<polyline fill="none" stroke="black" points="190.25,-59.5 326.25,-59.5"/>
<g id="a_node5_13"><a xlink:href="#" xlink:title="AFLSmartSchedule">
<g id="a_node5_14"><a xlink:href="#" xlink:title="__init__(self, parser: Parser.EarleyParser, exponent: float = 1.0):&#10;Constructor">
<text text-anchor="start" x="198.25" y="-47" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node5_15"><a xlink:href="#" xlink:title="assignEnergy(self, population: Sequence[GreyboxFuzzer.Seed]):&#10;Assign exponential energy proportional to degree of validity">
<text text-anchor="start" x="198.25" y="-34.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">assignEnergy()</text>
</a>
</g>
<g id="a_node5_16"><a xlink:href="#" xlink:title="degree_of_validity(self, seed: GreyboxFuzzer.Seed) -&gt; float:&#10;Returns the proportion of a seed that is parsable">
<text text-anchor="start" x="198.25" y="-20.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">degree_of_validity()</text>
</a>
</g>
<g id="a_node5_17"><a xlink:href="#" xlink:title="parsable(self, seed: GreyboxFuzzer.Seed) -&gt; str:&#10;Returns the substring that is parsable">
<text text-anchor="start" x="198.25" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">parsable()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- PowerSchedule -->
<g id="node6" class="node">
<title>PowerSchedule</title>
<g id="a_node6"><a xlink:href="GreyboxFuzzer.html" xlink:title="class PowerSchedule:&#10;Define how fuzzing time should be distributed across the population.">
<polygon fill="none" stroke="black" points="203.38,-179.88 203.38,-226.62 313.12,-226.62 313.12,-179.88 203.38,-179.88"/>
<text text-anchor="start" x="211.38" y="-210.32" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">PowerSchedule</text>
<polyline fill="none" stroke="black" points="203.38,-200.62 313.12,-200.62"/>
<g id="a_node6_18"><a xlink:href="#" xlink:title="PowerSchedule">
<g id="a_node6_19"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="228.25" y="-188.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- AFLSmartSchedule&#45;&gt;PowerSchedule -->
<g id="edge4" class="edge">
<title>AFLSmartSchedule-&gt;PowerSchedule</title>
<path fill="none" stroke="black" d="M258.25,-85.99C258.25,-111.69 258.25,-144.13 258.25,-168.22"/>
<polygon fill="none" stroke="black" points="254.75,-168.12 258.25,-178.12 261.75,-168.12 254.75,-168.12"/>
</g>
<!-- RegionMutator -->
<g id="node7" class="node">
<title>RegionMutator</title>
<g id="a_node7"><a xlink:href="#" xlink:title="class RegionMutator:&#10;Mutate inputs with input fragments from a pool">
<polygon fill="none" stroke="black" points="344.25,-6.88 344.25,-79.12 492.25,-79.12 492.25,-6.88 344.25,-6.88"/>
<text text-anchor="start" x="371" y="-62.83" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">RegionMutator</text>
<polyline fill="none" stroke="black" points="344.25,-53.12 492.25,-53.12"/>
<g id="a_node7_20"><a xlink:href="#" xlink:title="RegionMutator">
<g id="a_node7_21"><a xlink:href="#" xlink:title="add_to_fragment_pool(self, seed: SeedWithRegions) -&gt; None:&#10;Mark fragments and regions in a seed file">
<text text-anchor="start" x="352.25" y="-40.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">add_to_fragment_pool()</text>
</a>
</g>
<g id="a_node7_22"><a xlink:href="#" xlink:title="delete_fragment(self, seed: SeedWithRegions) -&gt; SeedWithRegions:&#10;Deletes a random region">
<text text-anchor="start" x="352.25" y="-27.88" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">delete_fragment()</text>
</a>
</g>
<g id="a_node7_23"><a xlink:href="#" xlink:title="swap_fragment(self, seed: SeedWithRegions) -&gt; SeedWithRegions:&#10;Chooses a random region and swaps it with a fragment&#10;that starts with the same symbol">
<text text-anchor="start" x="352.25" y="-15.12" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">swap_fragment()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- FragmentMutator -->
<g id="node8" class="node">
<title>FragmentMutator</title>
<g id="a_node8"><a xlink:href="#" xlink:title="class FragmentMutator:&#10;Mutate inputs with input fragments from a pool">
<polygon fill="none" stroke="black" points="344.25,-122.5 344.25,-284 492.25,-284 492.25,-122.5 344.25,-122.5"/>
<text text-anchor="start" x="362.38" y="-267.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">FragmentMutator</text>
<polyline fill="none" stroke="black" points="344.25,-258 492.25,-258"/>
<g id="a_node8_24"><a xlink:href="#" xlink:title="FragmentMutator">
<g id="a_node8_25"><a xlink:href="#" xlink:title="__init__(self, parser):&#10;Initialize mutators">
<text text-anchor="start" x="352.25" y="-245.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node8_26"><a xlink:href="#" xlink:title="add_to_fragment_pool(self, seed: SeedWithStructure) -&gt; None:&#10;Adds all fragments of a seed to the fragment pool">
<text text-anchor="start" x="352.25" y="-232.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">add_to_fragment_pool()</text>
</a>
</g>
<g id="a_node8_27"><a xlink:href="#" xlink:title="add_fragment(self, fragment: DerivationTree) -&gt; None:&#10;Recursively adds fragments to the fragment pool">
<text text-anchor="start" x="352.25" y="-219" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">add_fragment()</text>
</a>
</g>
<g id="a_node8_28"><a xlink:href="#" xlink:title="count_nodes(self, fragment: DerivationTree) -&gt; int:&#10;Returns the number of nodes in the fragment">
<text text-anchor="start" x="352.25" y="-206.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">count_nodes()</text>
</a>
</g>
<g id="a_node8_29"><a xlink:href="#" xlink:title="delete_fragment(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Delete a random fragment">
<text text-anchor="start" x="352.25" y="-194.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">delete_fragment()</text>
</a>
</g>
<g id="a_node8_30"><a xlink:href="#" xlink:title="is_excluded(self, symbol: str) -&gt; bool:&#10;Returns true if a fragment starting with a specific&#10;symbol and all its decendents can be excluded">
<text text-anchor="start" x="352.25" y="-180.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">is_excluded()</text>
</a>
</g>
<g id="a_node8_31"><a xlink:href="#" xlink:title="mutate(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Implement structure-aware mutation. Memoize seeds.">
<text text-anchor="start" x="352.25" y="-169" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">mutate()</text>
</a>
</g>
<g id="a_node8_32"><a xlink:href="#" xlink:title="recursive_delete(self, fragment: DerivationTree) -&gt; DerivationTree:&#10;Recursively finds the fragment to delete">
<text text-anchor="start" x="352.25" y="-155.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">recursive_delete()</text>
</a>
</g>
<g id="a_node8_33"><a xlink:href="#" xlink:title="recursive_swap(self, fragment: DerivationTree) -&gt; DerivationTree:&#10;Recursively finds the fragment to swap.">
<text text-anchor="start" x="352.25" y="-142.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">recursive_swap()</text>
</a>
</g>
<g id="a_node8_34"><a xlink:href="#" xlink:title="swap_fragment(self, seed: SeedWithStructure) -&gt; SeedWithStructure:&#10;Substitutes a random fragment with another with the same symbol">
<text text-anchor="start" x="352.25" y="-130.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">swap_fragment()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- RegionMutator&#45;&gt;FragmentMutator -->
<g id="edge5" class="edge">
<title>RegionMutator-&gt;FragmentMutator</title>
<path fill="none" stroke="black" d="M418.25,-79.51C418.25,-89.08 418.25,-99.89 418.25,-111.02"/>
<polygon fill="none" stroke="black" points="414.75,-110.72 418.25,-120.72 421.75,-110.72 414.75,-110.72"/>
</g>
<!-- Mutator -->
<g id="node9" class="node">
<title>Mutator</title>
<g id="a_node9"><a xlink:href="GreyboxFuzzer.html" xlink:title="class Mutator:&#10;Mutate strings">
<polygon fill="none" stroke="black" points="380.25,-327.38 380.25,-374.12 456.25,-374.12 456.25,-327.38 380.25,-327.38"/>
<text text-anchor="start" x="392.38" y="-357.82" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
<polyline fill="none" stroke="black" points="380.25,-348.12 456.25,-348.12"/>
<g id="a_node9_35"><a xlink:href="#" xlink:title="Mutator">
<g id="a_node9_36"><a xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -&gt; None:&#10;Constructor">
<text text-anchor="start" x="388.25" y="-335.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- FragmentMutator&#45;&gt;Mutator -->
<g id="edge6" class="edge">
<title>FragmentMutator-&gt;Mutator</title>
<path fill="none" stroke="black" d="M418.25,-284.24C418.25,-295.29 418.25,-306.11 418.25,-315.68"/>
<polygon fill="none" stroke="black" points="414.75,-315.53 418.25,-325.53 421.75,-315.53 414.75,-315.53"/>
</g>
<!-- Legend -->
<g id="node10" class="node">
<title>Legend</title>
<text text-anchor="start" x="510.62" y="-59" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text text-anchor="start" x="510.62" y="-49" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="516.62" y="-49" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="510.62" y="-39" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="516.62" y="-39" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="510.62" y="-29" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="516.62" y="-29" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="510.62" y="-19.95" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background</h2><p>First, we <a href="GreyboxFuzzer.html#Ingredients-for-Greybox-Fuzzing">recall</a> a few basic ingredients for mutational fuzzers.</p>
<ul>
<li><strong>Seed</strong>. A <em>seed</em> is an input that is used by the fuzzer to generate new inputs by applying a sequence of mutations.</li>
<li><strong>Mutator</strong>. A <em>mutator</em> implements a set of mutation operators that applied to an input produce a slightly modified input.</li>
<li><strong>PowerSchedule</strong>. A <em>power schedule</em> assigns <em>energy</em> to a seed. A seed with higher energy is fuzzed more often throughout the fuzzing campaign.</li>
<li><strong>AdvancedMutationFuzzer</strong>. Our <em>mutational blackbox fuzzer</em> generates inputs by mutating seeds in an initial population of inputs.</li>
<li><strong>GreyboxFuzzer</strong>. Our <em>greybox fuzzer</em> dynamically adds inputs to the population of seeds that increased coverage.</li>
<li><strong>FunctionCoverageRunner</strong>. Our <em>function coverage runner</em> collects coverage information for the execution of a given Python function.</li>
</ul>
<p>Let's try to get a feeling for these concepts.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils.setup</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">cast</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Fuzzer.html" class="import" target="_blank">Fuzzer</a></span> <span class="kn">import</span> <span class="n">Fuzzer</span>
<span class="kn">from</span> <span class="nn"><a href="GreyboxFuzzer.html" class="import" target="_blank">GreyboxFuzzer</a></span> <span class="kn">import</span> <span class="n">Mutator</span><span class="p">,</span> <span class="n">Seed</span><span class="p">,</span> <span class="n">PowerSchedule</span>
<span class="kn">from</span> <span class="nn"><a href="GreyboxFuzzer.html" class="import" target="_blank">GreyboxFuzzer</a></span> <span class="kn">import</span> <span class="n">AdvancedMutationFuzzer</span><span class="p">,</span> <span class="n">GreyboxFuzzer</span>
<span class="kn">from</span> <span class="nn"><a href="MutationFuzzer.html" class="import" target="_blank">MutationFuzzer</a></span> <span class="kn">import</span> <span class="n">FunctionCoverageRunner</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The following command applies a mutation to the input "Hello World".</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">Mutator</span><span class="p">()</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="s2">"Hello World"</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'Lello World'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The default power schedule assigns energy uniformly across all seeds. Let's check whether this works.</p>
<p>We choose 10k times from a population of three seeds.  As we see in the <code>hits</code> counter, each seed is chosen about a third of the time.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="n">Seed</span><span class="p">(</span><span class="s2">"A"</span><span class="p">),</span> <span class="n">Seed</span><span class="p">(</span><span class="s2">"B"</span><span class="p">),</span> <span class="n">Seed</span><span class="p">(</span><span class="s2">"C"</span><span class="p">)]</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>
<span class="n">hits</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"A"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"B"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">"C"</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">schedule</span><span class="o">.</span><span class="n">choose</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
    <span class="n">hits</span><span class="p">[</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">hits</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{'A': 3387, 'B': 3255, 'C': 3358}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Before explaining the function coverage runner, lets import Python's HTML parser as example...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/html.parser.html" class="import" target="_blank">html.parser</a></span> <span class="kn">import</span> <span class="n">HTMLParser</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and create a <em>wrapper function</em> that passes each input into a new parser object.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">my_parser</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">HTMLParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>FunctionCoverageRunner</code> constructor takes a Python <code>function</code> to execute. The function <code>run()</code> takes an input, passes it on to the Python <code>function</code>, and collects the coverage information for this execution. The function <code>coverage()</code> returns a list of tuples <code>(function name, line number)</code> for each statement that has been covered in the Python <code>function</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"Hello World"</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">coverage</span><span class="p">()</span>

<span class="nb">list</span><span class="p">(</span><span class="n">cov</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Print 5 statements covered in HTMLParser</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[('my_parser', 3),
 ('goahead', 163),
 ('updatepos', 47),
 ('goahead', 245),
 ('reset', 100)]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our greybox fuzzer takes a seed population, mutator, and power schedule. Let's generate 5000 fuzz inputs starting with an "empty" seed corpus.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/time.html" class="import" target="_blank">time</a></span>
<span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/random.html" class="import" target="_blank">random</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">n</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">seed_input</span> <span class="o">=</span> <span class="s2">" "</span>  <span class="c1"># empty seed</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GreyboxFuzzer</span><span class="p">([</span><span class="n">seed_input</span><span class="p">],</span> <span class="n">Mutator</span><span class="p">(),</span> <span class="n">PowerSchedule</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="s2">"It took the fuzzer </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took the fuzzer 0.98 seconds to generate and execute 5000 inputs.'
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="s2">"During this fuzzing campaign, we covered </span><span class="si">%d</span><span class="s2"> statements."</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">coverage</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'During this fuzzing campaign, we covered 79 statements.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Fuzzing-with-Dictionaries">Fuzzing with Dictionaries</h2><p>To fuzz our HTML parser, it may be useful to inform a mutational fuzzer about important keywords in the input – that is, important HTML keywords. The general idea is to have a <em>dictionary</em> of pre-defined useful inputs that could then be inserted as such when mutating an input.</p>
<p>This concept is illustrated in the following diagram. When mutating an input, we may insert given keywords from the dictionary (in red).</p>
<p><img src="../Images/ad252841dae610b22e63883e278cef44.png" data-original-src="http://www.fuzzingbook.org/html/PICS/GreyboxGrammarFuzzer-Dict.gif"/></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To implement this concept, we extend our mutator to consider keywords from a dictionary.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DictMutator</span><span class="p">(</span><span class="n">Mutator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Mutate strings using keywords from a dictionary"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Constructor. `dictionary` is the list of keywords to use."""</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span> <span class="o">=</span> <span class="n">dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_from_dictionary</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">insert_from_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns s with a keyword from the dictionary inserted"""</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="n">random_keyword</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictionary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span> <span class="o">+</span> <span class="n">random_keyword</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's try to add a few HTML tags and attributes and see whether the coverage with <code>DictMutator</code> increases.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">dict_mutator</span> <span class="o">=</span> <span class="n">DictMutator</span><span class="p">([</span><span class="s2">"&lt;a&gt;"</span><span class="p">,</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">,</span> <span class="s2">"&lt;a/&gt;"</span><span class="p">,</span> <span class="s2">"='a'"</span><span class="p">])</span>
<span class="n">dict_fuzzer</span> <span class="o">=</span> <span class="n">GreyboxFuzzer</span><span class="p">([</span><span class="n">seed_input</span><span class="p">],</span> <span class="n">dict_mutator</span><span class="p">,</span> <span class="n">PowerSchedule</span><span class="p">())</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">dict_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="s2">"It took the fuzzer </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took the fuzzer 2.78 seconds to generate and execute 5000 inputs.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Clearly, it takes longer. In our experience, this means more code is covered:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="s2">"During this fuzzing campaign, we covered </span><span class="si">%d</span><span class="s2"> statements."</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">coverage</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'During this fuzzing campaign, we covered 108 statements.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How do the fuzzers compare in terms of coverage over time?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Coverage.html" class="import" target="_blank">Coverage</a></span> <span class="kn">import</span> <span class="n">population_coverage</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://matplotlib.org/" class="import" target="_blank">matplotlib.pyplot</a></span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">_</span><span class="p">,</span> <span class="n">dict_cov</span> <span class="o">=</span> <span class="n">population_coverage</span><span class="p">(</span><span class="n">dict_fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">my_parser</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">fuzz_cov</span> <span class="o">=</span> <span class="n">population_coverage</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">my_parser</span><span class="p">)</span>
<span class="n">line_dict</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dict_cov</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"With Dictionary"</span><span class="p">)</span>
<span class="n">line_fuzz</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fuzz_cov</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Without Dictionary"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">line_dict</span><span class="p">,</span> <span class="n">line_fuzz</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Coverage over time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'# of inputs'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'lines covered'</span><span class="p">);</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_png output_subarea ">
<img src="../Images/b31dd1aa89f79cfc111fcb057d119f40.png"/>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><!-- \todo{Andreas: Section on mining keywords using parser-directed fuzzing or AUTOGRAM?} -->

<p><strong><em>Summary.</em></strong> Informing the fuzzer about important keywords already goes a long way towards achieving lots of coverage quickly.</p>
<p><strong><em>Try it.</em></strong> Open this chapter as Jupyter notebook and add other HTML-related keywords to the dictionary in order to see whether the difference in coverage actually increases (given the same budget of 5k generated test inputs).</p>
<p><strong><em>Read up.</em></strong> Michał Zalewski, author of AFL, wrote several great blog posts on <a href="https://lcamtuf.blogspot.com/2015/01/afl-fuzz-making-up-grammar-with.html">making up grammars with a dictionary in hand</a> and <a href="https://lcamtuf.blogspot.com/2014/11/pulling-jpegs-out-of-thin-air.html">pulling JPEGs out of thin air</a>!</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Fuzzing-with-Input-Fragments">Fuzzing with Input Fragments</h2><p>While dictionaries are helpful to inject important keywords into seed inputs, they do not allow maintaining the structural integrity of the generated inputs. Instead, we need to make the fuzzer aware of the <em>input structure</em>. We can do this using <a href="Grammars.html">grammars</a>. Our first approach</p>
<ol>
<li><a href="Parser.html">parses</a> the seed inputs, </li>
<li>disassembles them into input fragments, and </li>
<li>generates new files by reassembling these fragments according to the rules of the grammar.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This combination of <em>parsing</em> and <em>fuzzing</em> can be very powerful. For instance, we can <em>swap</em> existing substructures in an input:</p>
<p><img src="../Images/c2b3b4ed6d48adf859784a3e11c18825.png" data-original-src="http://www.fuzzingbook.org/html/PICS/GreyboxGrammarFuzzer-Swap.gif"/></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can also <em>replace</em> existing substructures by newly generated ones:</p>
<p><img src="../Images/b68a0364c6313714fd0ef7c77e86977a.png" data-original-src="http://www.fuzzingbook.org/html/PICS/GreyboxGrammarFuzzer-Gen.gif"/></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>All these operations take place on <a href="GrammarFuzzer.html">derivation trees</a>, which can be parsed from and produced into strings at any time.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Parsing-and-Recombining-JavaScript,-or-How-to-Make-50,000-USD-in-Four-Weeks">Parsing and Recombining JavaScript, or How to Make 50,000 USD in Four Weeks</h3><p>In "Fuzzing with Code Fragments" [<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf">Holler <em>et al</em>, 2012</a>], Holler, Herzig, and Zeller apply these steps to fuzz a JavaScript interpreter.  They use a JavaScript grammar to</p>
<ol>
<li><em>parse</em> (valid) JavaScript inputs into parse trees,</li>
<li><em>disassemble</em> them into fragments (subtrees),</li>
<li><em>recombine</em> these fragments into valid JavaScript programs again, and</li>
<li><em>feed</em> these programs into a JavaScript interpreter for execution.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As in most fuzzing scenarios, the aim is to cause the JavaScript interpreter to crash.  Here is an example of LangFuzz-generated JavaScript code (from [<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf">Holler <em>et al</em>, 2012</a>]) that caused a crash in the Mozilla JavaScript interpreter:</p>
<div class="highlight"><pre><span/><span class="kd">var</span><span class="w"> </span><span class="nx">haystack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">re_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"^foo"</span><span class="p">;</span>
<span class="nx">haystack</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">"x"</span><span class="p">;</span>
<span class="nx">re_text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">"(x)"</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="nx">re_text</span><span class="p">);</span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">haystack</span><span class="p">);</span>
<span class="nb">RegExp</span><span class="p">.</span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">();</span>
<span class="nx">print</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From a crash of the JavaScript interpreter, it is frequently possible to construct an <em>exploit</em> that will not only crash the interpreter, but instead have it execute code under the attacker's control.  Therefore, such crashes are serious flaws, which is why you get a bug bounty if you report them.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In the first four weeks of running his <em>LangFuzz</em> tool, Christian Holler, first author of that paper, netted <em>more than USD 50,000 in bug bounties</em>.  To date, LangFuzz has found more than 2,600 bugs in the JavaScript browsers of Mozilla Firefox, Google Chrome, and Microsoft Edge.  If you use any of these browsers (say, on your Android phone), the combination of parsing and fuzzing has contributed significantly in making your browsing session secure.</p>
<p>(Note that these are the same Holler and Zeller who are co-authors of this book.  If you ever wondered why we devote a couple of chapters on grammar-based fuzzing, that's because we have had some great experience with it.)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Parsing-and-Recombining-HTML">Parsing and Recombining HTML</h3><p>In this book, let us stay with HTML input for a while.  To generate valid HTML inputs for our Python <code>HTMLParser</code>, we should first define a simple grammar. It allows defining HTML tags with attributes. Our context-free grammar does not require that opening and closing tags must match. However, we will see that such context-sensitive features can be maintained in the derived input fragments, and thus in the generated inputs.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/string.html" class="import" target="_blank">string</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Grammars.html" class="import" target="_blank">Grammars</a></span> <span class="kn">import</span> <span class="n">is_valid_grammar</span><span class="p">,</span> <span class="n">srange</span><span class="p">,</span> <span class="n">Grammar</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">XML_TOKENS</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"&lt;id&gt;"</span><span class="p">,</span> <span class="s2">"&lt;text&gt;"</span><span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">XML_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"&lt;start&gt;"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"&lt;xml-tree&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;xml-tree&gt;"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"&lt;text&gt;"</span><span class="p">,</span>
                   <span class="s2">"&lt;xml-open-tag&gt;&lt;xml-tree&gt;&lt;xml-close-tag&gt;"</span><span class="p">,</span>
                   <span class="s2">"&lt;xml-openclose-tag&gt;"</span><span class="p">,</span>
                   <span class="s2">"&lt;xml-tree&gt;&lt;xml-tree&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;xml-open-tag&gt;"</span><span class="p">:</span>      <span class="p">[</span><span class="s2">"&lt;&lt;id&gt;&gt;"</span><span class="p">,</span> <span class="s2">"&lt;&lt;id&gt; &lt;xml-attribute&gt;&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;xml-openclose-tag&gt;"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"&lt;&lt;id&gt;/&gt;"</span><span class="p">,</span> <span class="s2">"&lt;&lt;id&gt; &lt;xml-attribute&gt;/&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;xml-close-tag&gt;"</span><span class="p">:</span>     <span class="p">[</span><span class="s2">"&lt;/&lt;id&gt;&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;xml-attribute&gt;"</span><span class="p">:</span>     <span class="p">[</span><span class="s2">"&lt;id&gt;=&lt;id&gt;"</span><span class="p">,</span> <span class="s2">"&lt;xml-attribute&gt; &lt;xml-attribute&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;id&gt;"</span><span class="p">:</span>                <span class="p">[</span><span class="s2">"&lt;letter&gt;"</span><span class="p">,</span> <span class="s2">"&lt;id&gt;&lt;letter&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;text&gt;"</span><span class="p">:</span>              <span class="p">[</span><span class="s2">"&lt;text&gt;&lt;letter_space&gt;"</span><span class="p">,</span> <span class="s2">"&lt;letter_space&gt;"</span><span class="p">],</span>
    <span class="s2">"&lt;letter&gt;"</span><span class="p">:</span>            <span class="n">srange</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span>
                                  <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"'"</span> <span class="o">+</span> <span class="s2">"."</span><span class="p">),</span>
    <span class="s2">"&lt;letter_space&gt;"</span><span class="p">:</span>      <span class="n">srange</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span>
                                  <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"'"</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In order to parse an input into a derivation tree, we use the <a href="Parser.html#Parsing-Context-Free-Grammars">Earley parser</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Parser.html" class="import" target="_blank">Parser</a></span> <span class="kn">import</span> <span class="n">EarleyParser</span><span class="p">,</span> <span class="n">Parser</span>
<span class="kn">from</span> <span class="nn"><a href="GrammarFuzzer.html" class="import" target="_blank">GrammarFuzzer</a></span> <span class="kn">import</span> <span class="n">display_tree</span><span class="p">,</span> <span class="n">DerivationTree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's run the parser on a simple HTML input and display all possible parse trees. A <em>parse tree</em> represents the input structure according to the given grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html" class="import" target="_blank">IPython.display</a></span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">parser</span> <span class="o">=</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">)</span>

<span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">"&lt;html&gt;Text&lt;/html&gt;"</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="337pt" height="223pt" viewbox="0.00 0.00 336.50 223.25" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 219.25)">
<polygon fill="white" stroke="none" points="-4,4 -4,-219.25 332.5,-219.25 332.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="167.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="167.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M167.25,-201.21C167.25,-194.99 167.25,-184.9 167.25,-176.14"/>
<polygon fill="black" stroke="black" points="170.75,-176.35 167.25,-166.35 163.75,-176.35 170.75,-176.35"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="70.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M154.96,-150.76C139.29,-142.97 111.91,-129.35 92.52,-119.7"/>
<polygon fill="black" stroke="black" points="94.3,-116.68 83.79,-115.36 91.19,-122.95 94.3,-116.68"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="167.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M167.25,-150.96C167.25,-144.74 167.25,-134.65 167.25,-125.89"/>
<polygon fill="black" stroke="black" points="170.75,-126.1 167.25,-116.1 163.75,-126.1 170.75,-126.1"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="262.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>1-&gt;10</title>
<path fill="none" stroke="black" d="M179.28,-150.76C194.56,-143.01 221.2,-129.47 240.18,-119.84"/>
<polygon fill="black" stroke="black" points="241.64,-123.02 248.97,-115.37 238.47,-116.78 241.64,-123.02"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M63.75,-100.71C55.96,-93.62 42.66,-81.51 32.28,-72.06"/>
<polygon fill="black" stroke="black" points="34.67,-69.5 24.92,-65.36 29.96,-74.68 34.67,-69.5"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M69.76,-100.71C69.24,-94.49 68.41,-84.4 67.68,-75.64"/>
<polygon fill="black" stroke="black" points="71.18,-75.52 66.87,-65.85 64.21,-76.1 71.18,-75.52"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-51.2" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M75.77,-100.71C82.25,-93.76 93.21,-82 101.95,-72.64"/>
<polygon fill="black" stroke="black" points="104.39,-75.15 108.65,-65.45 99.27,-70.37 104.39,-75.15"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-0.95" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-50.46C66.25,-44.24 66.25,-34.15 66.25,-25.39"/>
<polygon fill="black" stroke="black" points="69.75,-25.6 66.25,-15.6 62.75,-25.6 69.75,-25.6"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="169.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M167.5,-100.71C167.75,-94.49 168.17,-84.4 168.53,-75.64"/>
<polygon fill="black" stroke="black" points="172.02,-75.99 168.94,-65.85 165.03,-75.7 172.02,-75.99"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="169.25" y="-0.95" font-family="Times,serif" font-size="14.00">Text</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M169.25,-50.46C169.25,-44.24 169.25,-34.15 169.25,-25.39"/>
<polygon fill="black" stroke="black" points="172.75,-25.6 169.25,-15.6 165.75,-25.6 172.75,-25.6"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="224.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M257.59,-100.71C252.23,-93.91 243.24,-82.49 235.95,-73.23"/>
<polygon fill="black" stroke="black" points="238.82,-71.22 229.88,-65.53 233.32,-75.55 238.82,-71.22"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="262.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>10-&gt;12</title>
<path fill="none" stroke="black" d="M262.25,-100.71C262.25,-94.49 262.25,-84.4 262.25,-75.64"/>
<polygon fill="black" stroke="black" points="265.75,-75.85 262.25,-65.85 258.75,-75.85 265.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="311.25" y="-51.2" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 10&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>10-&gt;14</title>
<path fill="none" stroke="black" d="M268.26,-100.71C275.39,-93.69 287.5,-81.76 297.06,-72.35"/>
<polygon fill="black" stroke="black" points="299.44,-74.91 304.11,-65.4 294.53,-69.92 299.44,-74.91"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="262.25" y="-0.95" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M262.25,-50.46C262.25,-44.24 262.25,-34.15 262.25,-25.39"/>
<polygon fill="black" stroke="black" points="265.75,-25.6 262.25,-15.6 258.75,-25.6 265.75,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="432pt" height="274pt" viewbox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-269.5 427.5,-269.5 427.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-201.01C170.83,-193.15 140.79,-179.34 119.77,-169.68"/>
<polygon fill="black" stroke="black" points="121.36,-166.56 110.82,-165.57 118.44,-172.92 121.36,-166.56"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-201.21C201.25,-194.99 201.25,-184.9 201.25,-176.14"/>
<polygon fill="black" stroke="black" points="204.75,-176.35 201.25,-166.35 197.75,-176.35 204.75,-176.35"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>1-&gt;14</title>
<path fill="none" stroke="black" d="M218.6,-201.01C241.76,-192.86 283.05,-178.32 310.54,-168.63"/>
<polygon fill="black" stroke="black" points="311.34,-172.06 319.61,-165.44 309.02,-165.46 311.34,-172.06"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-150.76C73.9,-143.22 52.62,-130.23 36.95,-120.66"/>
<polygon fill="black" stroke="black" points="38.82,-117.7 28.47,-115.48 35.18,-123.67 38.82,-117.7"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-150.96C88.43,-144.3 81.55,-133.23 75.85,-124.07"/>
<polygon fill="black" stroke="black" points="79.01,-122.52 70.76,-115.88 73.07,-126.22 79.01,-122.52"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-150.96C101.09,-144.59 105.19,-134.18 108.69,-125.28"/>
<polygon fill="black" stroke="black" points="111.94,-126.59 112.35,-116 105.43,-124.02 111.94,-126.59"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-100.71C66.25,-94.49 66.25,-84.4 66.25,-75.64"/>
<polygon fill="black" stroke="black" points="69.75,-75.85 66.25,-65.85 62.75,-75.85 69.75,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-150.96C196.41,-144.59 192.31,-134.18 188.81,-125.28"/>
<polygon fill="black" stroke="black" points="192.07,-124.02 185.15,-116 185.56,-126.59 192.07,-124.02"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-150.76C218.56,-143.4 234.71,-130.84 246.92,-121.34"/>
<polygon fill="black" stroke="black" points="248.72,-124.37 254.46,-115.46 244.42,-118.84 248.72,-124.37"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M182.25,-100.71C182.25,-94.49 182.25,-84.4 182.25,-75.64"/>
<polygon fill="black" stroke="black" points="185.75,-75.85 182.25,-65.85 178.75,-75.85 185.75,-75.85"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M182.25,-50.46C182.25,-44.24 182.25,-34.15 182.25,-25.39"/>
<polygon fill="black" stroke="black" points="185.75,-25.6 182.25,-15.6 178.75,-25.6 185.75,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="263.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M263.25,-100.71C263.25,-94.49 263.25,-84.4 263.25,-75.64"/>
<polygon fill="black" stroke="black" points="266.75,-75.85 263.25,-65.85 259.75,-75.85 266.75,-75.85"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="263.25" y="-0.95" font-family="Times,serif" font-size="14.00">ext</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M263.25,-50.46C263.25,-44.24 263.25,-34.15 263.25,-25.39"/>
<polygon fill="black" stroke="black" points="266.75,-25.6 263.25,-15.6 259.75,-25.6 266.75,-25.6"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="319.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M335.92,-150.96C333.41,-144.59 329.31,-134.18 325.81,-125.28"/>
<polygon fill="black" stroke="black" points="329.07,-124.02 322.15,-116 322.56,-126.59 329.07,-124.02"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 14&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>14-&gt;16</title>
<path fill="none" stroke="black" d="M340.58,-150.96C343.09,-144.59 347.19,-134.18 350.69,-125.28"/>
<polygon fill="black" stroke="black" points="353.94,-126.59 354.35,-116 347.43,-124.02 353.94,-126.59"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 14&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>14-&gt;18</title>
<path fill="none" stroke="black" d="M346.86,-150.76C357.34,-143.33 375.3,-130.59 388.73,-121.06"/>
<polygon fill="black" stroke="black" points="390.56,-124.05 396.69,-115.41 386.51,-118.34 390.56,-124.05"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M357.25,-100.71C357.25,-94.49 357.25,-84.4 357.25,-75.64"/>
<polygon fill="black" stroke="black" points="360.75,-75.85 357.25,-65.85 353.75,-75.85 360.75,-75.85"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="432pt" height="274pt" viewbox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-269.5 427.5,-269.5 427.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-201.01C170.83,-193.15 140.79,-179.34 119.77,-169.68"/>
<polygon fill="black" stroke="black" points="121.36,-166.56 110.82,-165.57 118.44,-172.92 121.36,-166.56"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-201.21C201.25,-194.99 201.25,-184.9 201.25,-176.14"/>
<polygon fill="black" stroke="black" points="204.75,-176.35 201.25,-166.35 197.75,-176.35 204.75,-176.35"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>1-&gt;14</title>
<path fill="none" stroke="black" d="M218.6,-201.01C241.76,-192.86 283.05,-178.32 310.54,-168.63"/>
<polygon fill="black" stroke="black" points="311.34,-172.06 319.61,-165.44 309.02,-165.46 311.34,-172.06"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-150.76C73.9,-143.22 52.62,-130.23 36.95,-120.66"/>
<polygon fill="black" stroke="black" points="38.82,-117.7 28.47,-115.48 35.18,-123.67 38.82,-117.7"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-150.96C88.43,-144.3 81.55,-133.23 75.85,-124.07"/>
<polygon fill="black" stroke="black" points="79.01,-122.52 70.76,-115.88 73.07,-126.22 79.01,-122.52"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-150.96C101.09,-144.59 105.19,-134.18 108.69,-125.28"/>
<polygon fill="black" stroke="black" points="111.94,-126.59 112.35,-116 105.43,-124.02 111.94,-126.59"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-100.71C66.25,-94.49 66.25,-84.4 66.25,-75.64"/>
<polygon fill="black" stroke="black" points="69.75,-75.85 66.25,-65.85 62.75,-75.85 69.75,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-150.96C196.41,-144.59 192.31,-134.18 188.81,-125.28"/>
<polygon fill="black" stroke="black" points="192.07,-124.02 185.15,-116 185.56,-126.59 192.07,-124.02"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-150.76C218.56,-143.4 234.71,-130.84 246.92,-121.34"/>
<polygon fill="black" stroke="black" points="248.72,-124.37 254.46,-115.46 244.42,-118.84 248.72,-124.37"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M182.25,-100.71C182.25,-94.49 182.25,-84.4 182.25,-75.64"/>
<polygon fill="black" stroke="black" points="185.75,-75.85 182.25,-65.85 178.75,-75.85 185.75,-75.85"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">Te</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M182.25,-50.46C182.25,-44.24 182.25,-34.15 182.25,-25.39"/>
<polygon fill="black" stroke="black" points="185.75,-25.6 182.25,-15.6 178.75,-25.6 185.75,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="263.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M263.25,-100.71C263.25,-94.49 263.25,-84.4 263.25,-75.64"/>
<polygon fill="black" stroke="black" points="266.75,-75.85 263.25,-65.85 259.75,-75.85 266.75,-75.85"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="263.25" y="-0.95" font-family="Times,serif" font-size="14.00">xt</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M263.25,-50.46C263.25,-44.24 263.25,-34.15 263.25,-25.39"/>
<polygon fill="black" stroke="black" points="266.75,-25.6 263.25,-15.6 259.75,-25.6 266.75,-25.6"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="319.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M335.92,-150.96C333.41,-144.59 329.31,-134.18 325.81,-125.28"/>
<polygon fill="black" stroke="black" points="329.07,-124.02 322.15,-116 322.56,-126.59 329.07,-124.02"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 14&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>14-&gt;16</title>
<path fill="none" stroke="black" d="M340.58,-150.96C343.09,-144.59 347.19,-134.18 350.69,-125.28"/>
<polygon fill="black" stroke="black" points="353.94,-126.59 354.35,-116 347.43,-124.02 353.94,-126.59"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 14&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>14-&gt;18</title>
<path fill="none" stroke="black" d="M346.86,-150.76C357.34,-143.33 375.3,-130.59 388.73,-121.06"/>
<polygon fill="black" stroke="black" points="390.56,-124.05 396.69,-115.41 386.51,-118.34 390.56,-124.05"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M357.25,-100.71C357.25,-94.49 357.25,-84.4 357.25,-75.64"/>
<polygon fill="black" stroke="black" points="360.75,-75.85 357.25,-65.85 353.75,-75.85 360.75,-75.85"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="439pt" height="324pt" viewbox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 434.5,-319.75 434.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="206.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="206.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M206.25,-301.71C206.25,-295.49 206.25,-285.4 206.25,-276.64"/>
<polygon fill="black" stroke="black" points="209.75,-276.85 206.25,-266.85 202.75,-276.85 209.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M192.45,-251.26C174.59,-243.36 143.2,-229.46 121.37,-219.8"/>
<polygon fill="black" stroke="black" points="122.89,-216.65 112.33,-215.8 120.05,-223.05 122.89,-216.65"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M206.25,-251.46C206.25,-245.24 206.25,-235.15 206.25,-226.39"/>
<polygon fill="black" stroke="black" points="209.75,-226.6 206.25,-216.6 202.75,-226.6 209.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M223.85,-251.26C247.35,-243.11 289.24,-228.57 317.14,-218.88"/>
<polygon fill="black" stroke="black" points="318.06,-222.27 326.36,-215.68 315.76,-215.66 318.06,-222.27"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M87.12,-201.01C74.49,-193.4 52.65,-180.23 36.74,-170.63"/>
<polygon fill="black" stroke="black" points="38.97,-167.89 28.6,-165.72 35.35,-173.88 38.97,-167.89"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M93.45,-201.21C89.17,-194.55 82.06,-183.48 76.17,-174.32"/>
<polygon fill="black" stroke="black" points="79.25,-172.63 70.9,-166.11 73.36,-176.42 79.25,-172.63"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M99.46,-201.21C101.83,-194.84 105.72,-184.43 109.04,-175.53"/>
<polygon fill="black" stroke="black" points="112.28,-176.85 112.5,-166.26 105.72,-174.4 112.28,-176.85"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M65.76,-150.96C65.24,-144.74 64.41,-134.65 63.68,-125.89"/>
<polygon fill="black" stroke="black" points="67.18,-125.77 62.87,-116.1 60.21,-126.35 67.18,-125.77"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M204.17,-201.21C201.92,-194.84 198.25,-184.43 195.12,-175.53"/>
<polygon fill="black" stroke="black" points="198.48,-174.54 191.85,-166.27 191.88,-176.86 198.48,-174.54"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>7-&gt;15</title>
<path fill="none" stroke="black" d="M214.36,-201.01C224.12,-193.65 240.79,-181.09 253.39,-171.59"/>
<polygon fill="black" stroke="black" points="255.32,-174.51 261.2,-165.7 251.11,-168.92 255.32,-174.51"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.02,-150.76C171.1,-143.4 154.17,-130.84 141.38,-121.34"/>
<polygon fill="black" stroke="black" points="143.54,-118.59 133.43,-115.44 139.37,-124.21 143.54,-118.59"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8-&gt;12</title>
<path fill="none" stroke="black" d="M191.21,-150.96C193.32,-144.59 196.78,-134.18 199.73,-125.28"/>
<polygon fill="black" stroke="black" points="202.97,-126.62 202.8,-116.03 196.33,-124.42 202.97,-126.62"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M124.25,-100.71C124.25,-94.49 124.25,-84.4 124.25,-75.64"/>
<polygon fill="black" stroke="black" points="127.75,-75.85 124.25,-65.85 120.75,-75.85 127.75,-75.85"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M124.25,-50.46C124.25,-44.24 124.25,-34.15 124.25,-25.39"/>
<polygon fill="black" stroke="black" points="127.75,-25.6 124.25,-15.6 120.75,-25.6 127.75,-25.6"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M205.25,-100.71C205.25,-94.49 205.25,-84.4 205.25,-75.64"/>
<polygon fill="black" stroke="black" points="208.75,-75.85 205.25,-65.85 201.75,-75.85 208.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="205.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M205.25,-50.46C205.25,-44.24 205.25,-34.15 205.25,-25.39"/>
<polygon fill="black" stroke="black" points="208.75,-25.6 205.25,-15.6 201.75,-25.6 208.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M270.62,-150.96C271,-144.74 271.63,-134.65 272.18,-125.89"/>
<polygon fill="black" stroke="black" points="275.66,-126.3 272.79,-116.1 268.67,-125.86 275.66,-126.3"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="273.25" y="-51.2" font-family="Times,serif" font-size="14.00">xt</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M273.25,-100.71C273.25,-94.49 273.25,-84.4 273.25,-75.64"/>
<polygon fill="black" stroke="black" points="276.75,-75.85 273.25,-65.85 269.75,-75.85 276.75,-75.85"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="326.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M342.92,-201.21C340.41,-194.84 336.31,-184.43 332.81,-175.53"/>
<polygon fill="black" stroke="black" points="336.07,-174.27 329.15,-166.25 329.56,-176.84 336.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M347.58,-201.21C350.09,-194.84 354.19,-184.43 357.69,-175.53"/>
<polygon fill="black" stroke="black" points="360.94,-176.84 361.35,-166.25 354.43,-174.27 360.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M353.86,-201.01C364.34,-193.58 382.3,-180.84 395.73,-171.31"/>
<polygon fill="black" stroke="black" points="397.56,-174.3 403.69,-165.66 393.51,-168.59 397.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="364.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M364.25,-150.96C364.25,-144.74 364.25,-134.65 364.25,-125.89"/>
<polygon fill="black" stroke="black" points="367.75,-126.1 364.25,-116.1 360.75,-126.1 367.75,-126.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="432pt" height="274pt" viewbox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-269.5 427.5,-269.5 427.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-201.01C170.83,-193.15 140.79,-179.34 119.77,-169.68"/>
<polygon fill="black" stroke="black" points="121.36,-166.56 110.82,-165.57 118.44,-172.92 121.36,-166.56"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-201.21C201.25,-194.99 201.25,-184.9 201.25,-176.14"/>
<polygon fill="black" stroke="black" points="204.75,-176.35 201.25,-166.35 197.75,-176.35 204.75,-176.35"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>1-&gt;14</title>
<path fill="none" stroke="black" d="M218.6,-201.01C241.76,-192.86 283.05,-178.32 310.54,-168.63"/>
<polygon fill="black" stroke="black" points="311.34,-172.06 319.61,-165.44 309.02,-165.46 311.34,-172.06"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-150.76C73.9,-143.22 52.62,-130.23 36.95,-120.66"/>
<polygon fill="black" stroke="black" points="38.82,-117.7 28.47,-115.48 35.18,-123.67 38.82,-117.7"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-150.96C88.43,-144.3 81.55,-133.23 75.85,-124.07"/>
<polygon fill="black" stroke="black" points="79.01,-122.52 70.76,-115.88 73.07,-126.22 79.01,-122.52"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-150.96C101.09,-144.59 105.19,-134.18 108.69,-125.28"/>
<polygon fill="black" stroke="black" points="111.94,-126.59 112.35,-116 105.43,-124.02 111.94,-126.59"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-100.71C66.25,-94.49 66.25,-84.4 66.25,-75.64"/>
<polygon fill="black" stroke="black" points="69.75,-75.85 66.25,-65.85 62.75,-75.85 69.75,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-150.96C196.41,-144.59 192.31,-134.18 188.81,-125.28"/>
<polygon fill="black" stroke="black" points="192.07,-124.02 185.15,-116 185.56,-126.59 192.07,-124.02"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-150.76C218.56,-143.4 234.71,-130.84 246.92,-121.34"/>
<polygon fill="black" stroke="black" points="248.72,-124.37 254.46,-115.46 244.42,-118.84 248.72,-124.37"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M182.25,-100.71C182.25,-94.49 182.25,-84.4 182.25,-75.64"/>
<polygon fill="black" stroke="black" points="185.75,-75.85 182.25,-65.85 178.75,-75.85 185.75,-75.85"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">Tex</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M182.25,-50.46C182.25,-44.24 182.25,-34.15 182.25,-25.39"/>
<polygon fill="black" stroke="black" points="185.75,-25.6 182.25,-15.6 178.75,-25.6 185.75,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="263.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M263.25,-100.71C263.25,-94.49 263.25,-84.4 263.25,-75.64"/>
<polygon fill="black" stroke="black" points="266.75,-75.85 263.25,-65.85 259.75,-75.85 266.75,-75.85"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="263.25" y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M263.25,-50.46C263.25,-44.24 263.25,-34.15 263.25,-25.39"/>
<polygon fill="black" stroke="black" points="266.75,-25.6 263.25,-15.6 259.75,-25.6 266.75,-25.6"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="319.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M335.92,-150.96C333.41,-144.59 329.31,-134.18 325.81,-125.28"/>
<polygon fill="black" stroke="black" points="329.07,-124.02 322.15,-116 322.56,-126.59 329.07,-124.02"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 14&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>14-&gt;16</title>
<path fill="none" stroke="black" d="M340.58,-150.96C343.09,-144.59 347.19,-134.18 350.69,-125.28"/>
<polygon fill="black" stroke="black" points="353.94,-126.59 354.35,-116 347.43,-124.02 353.94,-126.59"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 14&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>14-&gt;18</title>
<path fill="none" stroke="black" d="M346.86,-150.76C357.34,-143.33 375.3,-130.59 388.73,-121.06"/>
<polygon fill="black" stroke="black" points="390.56,-124.05 396.69,-115.41 386.51,-118.34 390.56,-124.05"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M357.25,-100.71C357.25,-94.49 357.25,-84.4 357.25,-75.64"/>
<polygon fill="black" stroke="black" points="360.75,-75.85 357.25,-65.85 353.75,-75.85 360.75,-75.85"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="439pt" height="324pt" viewbox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 434.5,-319.75 434.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="206.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="206.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M206.25,-301.71C206.25,-295.49 206.25,-285.4 206.25,-276.64"/>
<polygon fill="black" stroke="black" points="209.75,-276.85 206.25,-266.85 202.75,-276.85 209.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M192.45,-251.26C174.59,-243.36 143.2,-229.46 121.37,-219.8"/>
<polygon fill="black" stroke="black" points="122.89,-216.65 112.33,-215.8 120.05,-223.05 122.89,-216.65"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M206.25,-251.46C206.25,-245.24 206.25,-235.15 206.25,-226.39"/>
<polygon fill="black" stroke="black" points="209.75,-226.6 206.25,-216.6 202.75,-226.6 209.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M223.85,-251.26C247.35,-243.11 289.24,-228.57 317.14,-218.88"/>
<polygon fill="black" stroke="black" points="318.06,-222.27 326.36,-215.68 315.76,-215.66 318.06,-222.27"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M87.12,-201.01C74.49,-193.4 52.65,-180.23 36.74,-170.63"/>
<polygon fill="black" stroke="black" points="38.97,-167.89 28.6,-165.72 35.35,-173.88 38.97,-167.89"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M93.45,-201.21C89.17,-194.55 82.06,-183.48 76.17,-174.32"/>
<polygon fill="black" stroke="black" points="79.25,-172.63 70.9,-166.11 73.36,-176.42 79.25,-172.63"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M99.46,-201.21C101.83,-194.84 105.72,-184.43 109.04,-175.53"/>
<polygon fill="black" stroke="black" points="112.28,-176.85 112.5,-166.26 105.72,-174.4 112.28,-176.85"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M65.76,-150.96C65.24,-144.74 64.41,-134.65 63.68,-125.89"/>
<polygon fill="black" stroke="black" points="67.18,-125.77 62.87,-116.1 60.21,-126.35 67.18,-125.77"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M204.17,-201.21C201.92,-194.84 198.25,-184.43 195.12,-175.53"/>
<polygon fill="black" stroke="black" points="198.48,-174.54 191.85,-166.27 191.88,-176.86 198.48,-174.54"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>7-&gt;15</title>
<path fill="none" stroke="black" d="M214.36,-201.01C224.12,-193.65 240.79,-181.09 253.39,-171.59"/>
<polygon fill="black" stroke="black" points="255.32,-174.51 261.2,-165.7 251.11,-168.92 255.32,-174.51"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.02,-150.76C171.1,-143.4 154.17,-130.84 141.38,-121.34"/>
<polygon fill="black" stroke="black" points="143.54,-118.59 133.43,-115.44 139.37,-124.21 143.54,-118.59"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8-&gt;12</title>
<path fill="none" stroke="black" d="M191.21,-150.96C193.32,-144.59 196.78,-134.18 199.73,-125.28"/>
<polygon fill="black" stroke="black" points="202.97,-126.62 202.8,-116.03 196.33,-124.42 202.97,-126.62"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M124.25,-100.71C124.25,-94.49 124.25,-84.4 124.25,-75.64"/>
<polygon fill="black" stroke="black" points="127.75,-75.85 124.25,-65.85 120.75,-75.85 127.75,-75.85"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M124.25,-50.46C124.25,-44.24 124.25,-34.15 124.25,-25.39"/>
<polygon fill="black" stroke="black" points="127.75,-25.6 124.25,-15.6 120.75,-25.6 127.75,-25.6"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M205.25,-100.71C205.25,-94.49 205.25,-84.4 205.25,-75.64"/>
<polygon fill="black" stroke="black" points="208.75,-75.85 205.25,-65.85 201.75,-75.85 208.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="205.25" y="-0.95" font-family="Times,serif" font-size="14.00">ex</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M205.25,-50.46C205.25,-44.24 205.25,-34.15 205.25,-25.39"/>
<polygon fill="black" stroke="black" points="208.75,-25.6 205.25,-15.6 201.75,-25.6 208.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M270.62,-150.96C271,-144.74 271.63,-134.65 272.18,-125.89"/>
<polygon fill="black" stroke="black" points="275.66,-126.3 272.79,-116.1 268.67,-125.86 275.66,-126.3"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="273.25" y="-51.2" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M273.25,-100.71C273.25,-94.49 273.25,-84.4 273.25,-75.64"/>
<polygon fill="black" stroke="black" points="276.75,-75.85 273.25,-65.85 269.75,-75.85 276.75,-75.85"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="326.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M342.92,-201.21C340.41,-194.84 336.31,-184.43 332.81,-175.53"/>
<polygon fill="black" stroke="black" points="336.07,-174.27 329.15,-166.25 329.56,-176.84 336.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M347.58,-201.21C350.09,-194.84 354.19,-184.43 357.69,-175.53"/>
<polygon fill="black" stroke="black" points="360.94,-176.84 361.35,-166.25 354.43,-174.27 360.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M353.86,-201.01C364.34,-193.58 382.3,-180.84 395.73,-171.31"/>
<polygon fill="black" stroke="black" points="397.56,-174.3 403.69,-165.66 393.51,-168.59 397.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="364.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M364.25,-150.96C364.25,-144.74 364.25,-134.65 364.25,-125.89"/>
<polygon fill="black" stroke="black" points="367.75,-126.1 364.25,-116.1 360.75,-126.1 367.75,-126.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="439pt" height="324pt" viewbox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 434.5,-319.75 434.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="206.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="206.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M206.25,-301.71C206.25,-295.49 206.25,-285.4 206.25,-276.64"/>
<polygon fill="black" stroke="black" points="209.75,-276.85 206.25,-266.85 202.75,-276.85 209.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M192.45,-251.26C174.59,-243.36 143.2,-229.46 121.37,-219.8"/>
<polygon fill="black" stroke="black" points="122.89,-216.65 112.33,-215.8 120.05,-223.05 122.89,-216.65"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M206.25,-251.46C206.25,-245.24 206.25,-235.15 206.25,-226.39"/>
<polygon fill="black" stroke="black" points="209.75,-226.6 206.25,-216.6 202.75,-226.6 209.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M223.85,-251.26C247.35,-243.11 289.24,-228.57 317.14,-218.88"/>
<polygon fill="black" stroke="black" points="318.06,-222.27 326.36,-215.68 315.76,-215.66 318.06,-222.27"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M87.12,-201.01C74.49,-193.4 52.65,-180.23 36.74,-170.63"/>
<polygon fill="black" stroke="black" points="38.97,-167.89 28.6,-165.72 35.35,-173.88 38.97,-167.89"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M93.45,-201.21C89.17,-194.55 82.06,-183.48 76.17,-174.32"/>
<polygon fill="black" stroke="black" points="79.25,-172.63 70.9,-166.11 73.36,-176.42 79.25,-172.63"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M99.46,-201.21C101.83,-194.84 105.72,-184.43 109.04,-175.53"/>
<polygon fill="black" stroke="black" points="112.28,-176.85 112.5,-166.26 105.72,-174.4 112.28,-176.85"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M65.76,-150.96C65.24,-144.74 64.41,-134.65 63.68,-125.89"/>
<polygon fill="black" stroke="black" points="67.18,-125.77 62.87,-116.1 60.21,-126.35 67.18,-125.77"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M204.17,-201.21C201.92,-194.84 198.25,-184.43 195.12,-175.53"/>
<polygon fill="black" stroke="black" points="198.48,-174.54 191.85,-166.27 191.88,-176.86 198.48,-174.54"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>7-&gt;15</title>
<path fill="none" stroke="black" d="M214.36,-201.01C224.12,-193.65 240.79,-181.09 253.39,-171.59"/>
<polygon fill="black" stroke="black" points="255.32,-174.51 261.2,-165.7 251.11,-168.92 255.32,-174.51"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.02,-150.76C171.1,-143.4 154.17,-130.84 141.38,-121.34"/>
<polygon fill="black" stroke="black" points="143.54,-118.59 133.43,-115.44 139.37,-124.21 143.54,-118.59"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8-&gt;12</title>
<path fill="none" stroke="black" d="M191.21,-150.96C193.32,-144.59 196.78,-134.18 199.73,-125.28"/>
<polygon fill="black" stroke="black" points="202.97,-126.62 202.8,-116.03 196.33,-124.42 202.97,-126.62"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M124.25,-100.71C124.25,-94.49 124.25,-84.4 124.25,-75.64"/>
<polygon fill="black" stroke="black" points="127.75,-75.85 124.25,-65.85 120.75,-75.85 127.75,-75.85"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">Te</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M124.25,-50.46C124.25,-44.24 124.25,-34.15 124.25,-25.39"/>
<polygon fill="black" stroke="black" points="127.75,-25.6 124.25,-15.6 120.75,-25.6 127.75,-25.6"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M205.25,-100.71C205.25,-94.49 205.25,-84.4 205.25,-75.64"/>
<polygon fill="black" stroke="black" points="208.75,-75.85 205.25,-65.85 201.75,-75.85 208.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="205.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M205.25,-50.46C205.25,-44.24 205.25,-34.15 205.25,-25.39"/>
<polygon fill="black" stroke="black" points="208.75,-25.6 205.25,-15.6 201.75,-25.6 208.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M270.62,-150.96C271,-144.74 271.63,-134.65 272.18,-125.89"/>
<polygon fill="black" stroke="black" points="275.66,-126.3 272.79,-116.1 268.67,-125.86 275.66,-126.3"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="273.25" y="-51.2" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M273.25,-100.71C273.25,-94.49 273.25,-84.4 273.25,-75.64"/>
<polygon fill="black" stroke="black" points="276.75,-75.85 273.25,-65.85 269.75,-75.85 276.75,-75.85"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="326.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M342.92,-201.21C340.41,-194.84 336.31,-184.43 332.81,-175.53"/>
<polygon fill="black" stroke="black" points="336.07,-174.27 329.15,-166.25 329.56,-176.84 336.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M347.58,-201.21C350.09,-194.84 354.19,-184.43 357.69,-175.53"/>
<polygon fill="black" stroke="black" points="360.94,-176.84 361.35,-166.25 354.43,-174.27 360.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M353.86,-201.01C364.34,-193.58 382.3,-180.84 395.73,-171.31"/>
<polygon fill="black" stroke="black" points="397.56,-174.3 403.69,-165.66 393.51,-168.59 397.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="364.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M364.25,-150.96C364.25,-144.74 364.25,-134.65 364.25,-125.89"/>
<polygon fill="black" stroke="black" points="367.75,-126.1 364.25,-116.1 360.75,-126.1 367.75,-126.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="439pt" height="374pt" viewbox="0.00 0.00 438.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)">
<polygon fill="white" stroke="none" points="-4,4 -4,-370 434.5,-370 434.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="206.25" y="-352.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="206.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M206.25,-351.96C206.25,-345.74 206.25,-335.65 206.25,-326.89"/>
<polygon fill="black" stroke="black" points="209.75,-327.1 206.25,-317.1 202.75,-327.1 209.75,-327.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="97.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M192.45,-301.51C174.59,-293.61 143.2,-279.71 121.37,-270.05"/>
<polygon fill="black" stroke="black" points="122.89,-266.9 112.33,-266.05 120.05,-273.3 122.89,-266.9"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="206.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M206.25,-301.71C206.25,-295.49 206.25,-285.4 206.25,-276.64"/>
<polygon fill="black" stroke="black" points="209.75,-276.85 206.25,-266.85 202.75,-276.85 209.75,-276.85"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="345.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>1-&gt;22</title>
<path fill="none" stroke="black" d="M223.85,-301.51C247.35,-293.36 289.24,-278.82 317.14,-269.13"/>
<polygon fill="black" stroke="black" points="318.06,-272.52 326.36,-265.93 315.76,-265.91 318.06,-272.52"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M87.12,-251.26C74.49,-243.65 52.65,-230.48 36.74,-220.88"/>
<polygon fill="black" stroke="black" points="38.97,-218.14 28.6,-215.97 35.35,-224.13 38.97,-218.14"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M93.45,-251.46C89.17,-244.8 82.06,-233.73 76.17,-224.57"/>
<polygon fill="black" stroke="black" points="79.25,-222.88 70.9,-216.36 73.36,-226.67 79.25,-222.88"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M99.46,-251.46C101.83,-245.09 105.72,-234.68 109.04,-225.78"/>
<polygon fill="black" stroke="black" points="112.28,-227.1 112.5,-216.51 105.72,-224.65 112.28,-227.1"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="62.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M65.76,-201.21C65.24,-194.99 64.41,-184.9 63.68,-176.14"/>
<polygon fill="black" stroke="black" points="67.18,-176.02 62.87,-166.35 60.21,-176.6 67.18,-176.02"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="189.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M204.17,-251.46C201.92,-245.09 198.25,-234.68 195.12,-225.78"/>
<polygon fill="black" stroke="black" points="198.48,-224.79 191.85,-216.52 191.88,-227.11 198.48,-224.79"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="270.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>7-&gt;19</title>
<path fill="none" stroke="black" d="M214.36,-251.26C224.12,-243.9 240.79,-231.34 253.39,-221.84"/>
<polygon fill="black" stroke="black" points="255.32,-224.76 261.2,-215.95 251.11,-219.17 255.32,-224.76"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="124.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.02,-201.01C171.1,-193.65 154.17,-181.09 141.38,-171.59"/>
<polygon fill="black" stroke="black" points="143.54,-168.84 133.43,-165.69 139.37,-174.46 143.54,-168.84"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="205.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>8-&gt;16</title>
<path fill="none" stroke="black" d="M191.21,-201.21C193.32,-194.84 196.78,-184.43 199.73,-175.53"/>
<polygon fill="black" stroke="black" points="202.97,-176.87 202.8,-166.28 196.33,-174.67 202.97,-176.87"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="50.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M114.88,-150.76C103.36,-143.25 83.55,-130.34 68.89,-120.78"/>
<polygon fill="black" stroke="black" points="70.87,-117.89 60.58,-115.36 67.05,-123.76 70.87,-117.89"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="131.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 9&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>9-&gt;13</title>
<path fill="none" stroke="black" d="M125.11,-150.96C126.01,-144.74 127.47,-134.65 128.75,-125.89"/>
<polygon fill="black" stroke="black" points="132.2,-126.49 130.17,-116.09 125.27,-125.48 132.2,-126.49"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="50.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M50.25,-100.71C50.25,-94.49 50.25,-84.4 50.25,-75.64"/>
<polygon fill="black" stroke="black" points="53.75,-75.85 50.25,-65.85 46.75,-75.85 53.75,-75.85"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="50.25" y="-0.95" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M50.25,-50.46C50.25,-44.24 50.25,-34.15 50.25,-25.39"/>
<polygon fill="black" stroke="black" points="53.75,-25.6 50.25,-15.6 46.75,-25.6 53.75,-25.6"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="131.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M131.25,-100.71C131.25,-94.49 131.25,-84.4 131.25,-75.64"/>
<polygon fill="black" stroke="black" points="134.75,-75.85 131.25,-65.85 127.75,-75.85 134.75,-75.85"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="131.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M131.25,-50.46C131.25,-44.24 131.25,-34.15 131.25,-25.39"/>
<polygon fill="black" stroke="black" points="134.75,-25.6 131.25,-15.6 127.75,-25.6 134.75,-25.6"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M205.25,-150.96C205.25,-144.74 205.25,-134.65 205.25,-125.89"/>
<polygon fill="black" stroke="black" points="208.75,-126.1 205.25,-116.1 201.75,-126.1 208.75,-126.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17-&gt;18</title>
<path fill="none" stroke="black" d="M205.25,-100.71C205.25,-94.49 205.25,-84.4 205.25,-75.64"/>
<polygon fill="black" stroke="black" points="208.75,-75.85 205.25,-65.85 201.75,-75.85 208.75,-75.85"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="273.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M270.62,-201.21C271,-194.99 271.63,-184.9 272.18,-176.14"/>
<polygon fill="black" stroke="black" points="275.66,-176.55 272.79,-166.35 268.67,-176.11 275.66,-176.55"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M273.25,-150.96C273.25,-144.74 273.25,-134.65 273.25,-125.89"/>
<polygon fill="black" stroke="black" points="276.75,-126.1 273.25,-116.1 269.75,-126.1 276.75,-126.1"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="326.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M342.92,-251.46C340.41,-245.09 336.31,-234.68 332.81,-225.78"/>
<polygon fill="black" stroke="black" points="336.07,-224.52 329.15,-216.5 329.56,-227.09 336.07,-224.52"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="364.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22-&gt;24</title>
<path fill="none" stroke="black" d="M347.58,-251.46C350.09,-245.09 354.19,-234.68 357.69,-225.78"/>
<polygon fill="black" stroke="black" points="360.94,-227.09 361.35,-216.5 354.43,-224.52 360.94,-227.09"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="413.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22-&gt;26</title>
<path fill="none" stroke="black" d="M353.86,-251.26C364.34,-243.83 382.3,-231.09 395.73,-221.56"/>
<polygon fill="black" stroke="black" points="397.56,-224.55 403.69,-215.91 393.51,-218.84 397.56,-224.55"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M364.25,-201.21C364.25,-194.99 364.25,-184.9 364.25,-176.14"/>
<polygon fill="black" stroke="black" points="367.75,-176.35 364.25,-166.35 360.75,-176.35 367.75,-176.35"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="445pt" height="374pt" viewbox="0.00 0.00 444.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)">
<polygon fill="white" stroke="none" points="-4,4 -4,-370 440.5,-370 440.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="211.25" y="-352.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="211.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M211.25,-351.96C211.25,-345.74 211.25,-335.65 211.25,-326.89"/>
<polygon fill="black" stroke="black" points="214.75,-327.1 211.25,-317.1 207.75,-327.1 214.75,-327.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="99.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M197.07,-301.51C178.64,-293.57 146.17,-279.59 123.72,-269.92"/>
<polygon fill="black" stroke="black" points="125.28,-266.78 114.71,-266.04 122.51,-273.21 125.28,-266.78"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="211.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M211.25,-301.71C211.25,-295.49 211.25,-285.4 211.25,-276.64"/>
<polygon fill="black" stroke="black" points="214.75,-276.85 211.25,-266.85 207.75,-276.85 214.75,-276.85"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="351.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>1-&gt;22</title>
<path fill="none" stroke="black" d="M228.98,-301.51C252.65,-293.36 294.84,-278.82 322.94,-269.13"/>
<polygon fill="black" stroke="black" points="323.92,-272.5 332.23,-265.93 321.64,-265.88 323.92,-272.5"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M88.86,-251.26C75.93,-243.65 53.54,-230.48 37.23,-220.88"/>
<polygon fill="black" stroke="black" points="39.25,-218.01 28.86,-215.95 35.7,-224.04 39.25,-218.01"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M95.2,-251.46C90.65,-244.8 83.08,-233.73 76.81,-224.57"/>
<polygon fill="black" stroke="black" points="79.72,-222.62 71.18,-216.34 73.94,-226.57 79.72,-222.62"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M101.21,-251.46C103.32,-245.09 106.78,-234.68 109.73,-225.78"/>
<polygon fill="black" stroke="black" points="112.97,-227.12 112.8,-216.53 106.33,-224.92 112.97,-227.12"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="58.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M65.27,-201.21C64.24,-194.99 62.57,-184.9 61.11,-176.14"/>
<polygon fill="black" stroke="black" points="64.58,-175.63 59.49,-166.33 57.67,-176.77 64.58,-175.63"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="195.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M209.29,-251.46C207.18,-245.09 203.72,-234.68 200.77,-225.78"/>
<polygon fill="black" stroke="black" points="204.17,-224.92 197.7,-216.53 197.53,-227.12 204.17,-224.92"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="276.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>7-&gt;19</title>
<path fill="none" stroke="black" d="M219.48,-251.26C229.4,-243.9 246.33,-231.34 259.12,-221.84"/>
<polygon fill="black" stroke="black" points="261.13,-224.71 267.07,-215.94 256.96,-219.09 261.13,-224.71"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="120.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M185.75,-201.01C173.97,-193.43 153.61,-180.33 138.71,-170.75"/>
<polygon fill="black" stroke="black" points="141.01,-168.07 130.71,-165.6 137.23,-173.96 141.01,-168.07"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8-&gt;12</title>
<path fill="none" stroke="black" d="M195.99,-201.21C196.76,-194.99 198.01,-184.9 199.1,-176.14"/>
<polygon fill="black" stroke="black" points="202.56,-176.7 200.32,-166.34 195.61,-175.83 202.56,-176.7"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="100.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M117.8,-150.96C115.13,-144.52 110.74,-133.94 107.03,-124.97"/>
<polygon fill="black" stroke="black" points="110.36,-123.89 103.3,-115.99 103.9,-126.57 110.36,-123.89"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="100.25" y="-51.2" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M100.25,-100.71C100.25,-94.49 100.25,-84.4 100.25,-75.64"/>
<polygon fill="black" stroke="black" points="103.75,-75.85 100.25,-65.85 96.75,-75.85 103.75,-75.85"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="168.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M197.2,-150.96C192.65,-144.3 185.08,-133.23 178.81,-124.07"/>
<polygon fill="black" stroke="black" points="181.72,-122.12 173.18,-115.84 175.94,-126.07 181.72,-122.12"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="249.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 12&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>12-&gt;16</title>
<path fill="none" stroke="black" d="M207.14,-150.96C214.12,-143.94 225.99,-132.01 235.35,-122.6"/>
<polygon fill="black" stroke="black" points="237.68,-125.22 242.25,-115.66 232.71,-120.28 237.68,-125.22"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="168.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M168.25,-100.71C168.25,-94.49 168.25,-84.4 168.25,-75.64"/>
<polygon fill="black" stroke="black" points="171.75,-75.85 168.25,-65.85 164.75,-75.85 171.75,-75.85"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="168.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M168.25,-50.46C168.25,-44.24 168.25,-34.15 168.25,-25.39"/>
<polygon fill="black" stroke="black" points="171.75,-25.6 168.25,-15.6 164.75,-25.6 171.75,-25.6"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="249.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M249.25,-100.71C249.25,-94.49 249.25,-84.4 249.25,-75.64"/>
<polygon fill="black" stroke="black" points="252.75,-75.85 249.25,-65.85 245.75,-75.85 252.75,-75.85"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="249.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17-&gt;18</title>
<path fill="none" stroke="black" d="M249.25,-50.46C249.25,-44.24 249.25,-34.15 249.25,-25.39"/>
<polygon fill="black" stroke="black" points="252.75,-25.6 249.25,-15.6 245.75,-25.6 252.75,-25.6"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="298.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M278.95,-201.21C281.88,-194.77 286.71,-184.19 290.8,-175.22"/>
<polygon fill="black" stroke="black" points="293.94,-176.77 294.9,-166.22 287.57,-173.86 293.94,-176.77"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="317.25" y="-101.45" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M300.58,-150.96C303.09,-144.59 307.19,-134.18 310.69,-125.28"/>
<polygon fill="black" stroke="black" points="313.94,-126.59 314.35,-116 307.43,-124.02 313.94,-126.59"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="332.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M348.92,-251.46C346.41,-245.09 342.31,-234.68 338.81,-225.78"/>
<polygon fill="black" stroke="black" points="342.07,-224.52 335.15,-216.5 335.56,-227.09 342.07,-224.52"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="370.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22-&gt;24</title>
<path fill="none" stroke="black" d="M353.58,-251.46C356.09,-245.09 360.19,-234.68 363.69,-225.78"/>
<polygon fill="black" stroke="black" points="366.94,-227.09 367.35,-216.5 360.43,-224.52 366.94,-227.09"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="419.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22-&gt;26</title>
<path fill="none" stroke="black" d="M359.86,-251.26C370.34,-243.83 388.3,-231.09 401.73,-221.56"/>
<polygon fill="black" stroke="black" points="403.56,-224.55 409.69,-215.91 399.51,-218.84 403.56,-224.55"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="370.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M370.25,-201.21C370.25,-194.99 370.25,-184.9 370.25,-176.14"/>
<polygon fill="black" stroke="black" points="373.75,-176.35 370.25,-166.35 366.75,-176.35 373.75,-176.35"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="450pt" height="324pt" viewbox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 445.5,-319.75 445.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-301.71C201.25,-295.49 201.25,-285.4 201.25,-276.64"/>
<polygon fill="black" stroke="black" points="204.75,-276.85 201.25,-266.85 197.75,-276.85 204.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-251.26C170.83,-243.4 140.79,-229.59 119.77,-219.93"/>
<polygon fill="black" stroke="black" points="121.36,-216.81 110.82,-215.82 118.44,-223.17 121.36,-216.81"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M220.88,-251.26C247.43,-243 295.05,-228.18 326.14,-218.5"/>
<polygon fill="black" stroke="black" points="326.83,-221.95 335.33,-215.64 324.75,-215.27 326.83,-221.95"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-201.01C73.9,-193.47 52.62,-180.48 36.95,-170.91"/>
<polygon fill="black" stroke="black" points="38.82,-167.95 28.47,-165.73 35.18,-173.92 38.82,-167.95"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-201.21C88.43,-194.55 81.55,-183.48 75.85,-174.32"/>
<polygon fill="black" stroke="black" points="79.01,-172.77 70.76,-166.13 73.07,-176.47 79.01,-172.77"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-201.21C101.09,-194.84 105.19,-184.43 108.69,-175.53"/>
<polygon fill="black" stroke="black" points="111.94,-176.84 112.35,-166.25 105.43,-174.27 111.94,-176.84"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-150.96C66.25,-144.74 66.25,-134.65 66.25,-125.89"/>
<polygon fill="black" stroke="black" points="69.75,-126.1 66.25,-116.1 62.75,-126.1 69.75,-126.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-201.21C196.41,-194.84 192.31,-184.43 188.81,-175.53"/>
<polygon fill="black" stroke="black" points="192.07,-174.27 185.15,-166.25 185.56,-176.84 192.07,-174.27"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-201.01C218.56,-193.65 234.71,-181.09 246.92,-171.59"/>
<polygon fill="black" stroke="black" points="248.72,-174.62 254.46,-165.71 244.42,-169.09 248.72,-174.62"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.15,-150.96C179.99,-144.74 178.1,-134.65 176.47,-125.89"/>
<polygon fill="black" stroke="black" points="179.91,-125.27 174.64,-116.08 173.03,-126.55 179.91,-125.27"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M173.25,-100.71C173.25,-94.49 173.25,-84.4 173.25,-75.64"/>
<polygon fill="black" stroke="black" points="176.75,-75.85 173.25,-65.85 169.75,-75.85 176.75,-75.85"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M260.55,-150.96C257.62,-144.52 252.79,-133.94 248.7,-124.97"/>
<polygon fill="black" stroke="black" points="251.93,-123.61 244.6,-115.97 245.56,-126.52 251.93,-123.61"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>11-&gt;15</title>
<path fill="none" stroke="black" d="M270.48,-150.96C279.33,-143.72 294.56,-131.27 306.22,-121.73"/>
<polygon fill="black" stroke="black" points="308.26,-124.59 313.78,-115.55 303.83,-119.17 308.26,-124.59"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M241.25,-100.71C241.25,-94.49 241.25,-84.4 241.25,-75.64"/>
<polygon fill="black" stroke="black" points="244.75,-75.85 241.25,-65.85 237.75,-75.85 244.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M241.25,-50.46C241.25,-44.24 241.25,-34.15 241.25,-25.39"/>
<polygon fill="black" stroke="black" points="244.75,-25.6 241.25,-15.6 237.75,-25.6 244.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="322.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M322.25,-100.71C322.25,-94.49 322.25,-84.4 322.25,-75.64"/>
<polygon fill="black" stroke="black" points="325.75,-75.85 322.25,-65.85 318.75,-75.85 325.75,-75.85"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="322.25" y="-0.95" font-family="Times,serif" font-size="14.00">xt</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M322.25,-50.46C322.25,-44.24 322.25,-34.15 322.25,-25.39"/>
<polygon fill="black" stroke="black" points="325.75,-25.6 322.25,-15.6 318.75,-25.6 325.75,-25.6"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="337.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M353.92,-201.21C351.41,-194.84 347.31,-184.43 343.81,-175.53"/>
<polygon fill="black" stroke="black" points="347.07,-174.27 340.15,-166.25 340.56,-176.84 347.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="375.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M358.58,-201.21C361.09,-194.84 365.19,-184.43 368.69,-175.53"/>
<polygon fill="black" stroke="black" points="371.94,-176.84 372.35,-166.25 365.43,-174.27 371.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M364.86,-201.01C375.34,-193.58 393.3,-180.84 406.73,-171.31"/>
<polygon fill="black" stroke="black" points="408.56,-174.3 414.69,-165.66 404.51,-168.59 408.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="384.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M376.35,-150.96C377.51,-144.74 379.4,-134.65 381.03,-125.89"/>
<polygon fill="black" stroke="black" points="384.47,-126.55 382.86,-116.08 377.59,-125.27 384.47,-126.55"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="450pt" height="324pt" viewbox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 445.5,-319.75 445.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-301.71C201.25,-295.49 201.25,-285.4 201.25,-276.64"/>
<polygon fill="black" stroke="black" points="204.75,-276.85 201.25,-266.85 197.75,-276.85 204.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-251.26C170.83,-243.4 140.79,-229.59 119.77,-219.93"/>
<polygon fill="black" stroke="black" points="121.36,-216.81 110.82,-215.82 118.44,-223.17 121.36,-216.81"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M220.88,-251.26C247.43,-243 295.05,-228.18 326.14,-218.5"/>
<polygon fill="black" stroke="black" points="326.83,-221.95 335.33,-215.64 324.75,-215.27 326.83,-221.95"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-201.01C73.9,-193.47 52.62,-180.48 36.95,-170.91"/>
<polygon fill="black" stroke="black" points="38.82,-167.95 28.47,-165.73 35.18,-173.92 38.82,-167.95"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-201.21C88.43,-194.55 81.55,-183.48 75.85,-174.32"/>
<polygon fill="black" stroke="black" points="79.01,-172.77 70.76,-166.13 73.07,-176.47 79.01,-172.77"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-201.21C101.09,-194.84 105.19,-184.43 108.69,-175.53"/>
<polygon fill="black" stroke="black" points="111.94,-176.84 112.35,-166.25 105.43,-174.27 111.94,-176.84"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-150.96C66.25,-144.74 66.25,-134.65 66.25,-125.89"/>
<polygon fill="black" stroke="black" points="69.75,-126.1 66.25,-116.1 62.75,-126.1 69.75,-126.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-201.21C196.41,-194.84 192.31,-184.43 188.81,-175.53"/>
<polygon fill="black" stroke="black" points="192.07,-174.27 185.15,-166.25 185.56,-176.84 192.07,-174.27"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-201.01C218.56,-193.65 234.71,-181.09 246.92,-171.59"/>
<polygon fill="black" stroke="black" points="248.72,-174.62 254.46,-165.71 244.42,-169.09 248.72,-174.62"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.15,-150.96C179.99,-144.74 178.1,-134.65 176.47,-125.89"/>
<polygon fill="black" stroke="black" points="179.91,-125.27 174.64,-116.08 173.03,-126.55 179.91,-125.27"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M173.25,-100.71C173.25,-94.49 173.25,-84.4 173.25,-75.64"/>
<polygon fill="black" stroke="black" points="176.75,-75.85 173.25,-65.85 169.75,-75.85 176.75,-75.85"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M260.55,-150.96C257.62,-144.52 252.79,-133.94 248.7,-124.97"/>
<polygon fill="black" stroke="black" points="251.93,-123.61 244.6,-115.97 245.56,-126.52 251.93,-123.61"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>11-&gt;15</title>
<path fill="none" stroke="black" d="M270.48,-150.96C279.33,-143.72 294.56,-131.27 306.22,-121.73"/>
<polygon fill="black" stroke="black" points="308.26,-124.59 313.78,-115.55 303.83,-119.17 308.26,-124.59"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M241.25,-100.71C241.25,-94.49 241.25,-84.4 241.25,-75.64"/>
<polygon fill="black" stroke="black" points="244.75,-75.85 241.25,-65.85 237.75,-75.85 244.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">ex</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M241.25,-50.46C241.25,-44.24 241.25,-34.15 241.25,-25.39"/>
<polygon fill="black" stroke="black" points="244.75,-25.6 241.25,-15.6 237.75,-25.6 244.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="322.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M322.25,-100.71C322.25,-94.49 322.25,-84.4 322.25,-75.64"/>
<polygon fill="black" stroke="black" points="325.75,-75.85 322.25,-65.85 318.75,-75.85 325.75,-75.85"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="322.25" y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M322.25,-50.46C322.25,-44.24 322.25,-34.15 322.25,-25.39"/>
<polygon fill="black" stroke="black" points="325.75,-25.6 322.25,-15.6 318.75,-25.6 325.75,-25.6"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="337.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M353.92,-201.21C351.41,-194.84 347.31,-184.43 343.81,-175.53"/>
<polygon fill="black" stroke="black" points="347.07,-174.27 340.15,-166.25 340.56,-176.84 347.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="375.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M358.58,-201.21C361.09,-194.84 365.19,-184.43 368.69,-175.53"/>
<polygon fill="black" stroke="black" points="371.94,-176.84 372.35,-166.25 365.43,-174.27 371.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M364.86,-201.01C375.34,-193.58 393.3,-180.84 406.73,-171.31"/>
<polygon fill="black" stroke="black" points="408.56,-174.3 414.69,-165.66 404.51,-168.59 408.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="384.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M376.35,-150.96C377.51,-144.74 379.4,-134.65 381.03,-125.89"/>
<polygon fill="black" stroke="black" points="384.47,-126.55 382.86,-116.08 377.59,-125.27 384.47,-126.55"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="456pt" height="374pt" viewbox="0.00 0.00 455.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)">
<polygon fill="white" stroke="none" points="-4,4 -4,-370 451.5,-370 451.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-352.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-351.96C201.25,-345.74 201.25,-335.65 201.25,-326.89"/>
<polygon fill="black" stroke="black" points="204.75,-327.1 201.25,-317.1 197.75,-327.1 204.75,-327.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-301.51C170.83,-293.65 140.79,-279.84 119.77,-270.18"/>
<polygon fill="black" stroke="black" points="121.36,-267.06 110.82,-266.07 118.44,-273.42 121.36,-267.06"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-301.71C201.25,-295.49 201.25,-285.4 201.25,-276.64"/>
<polygon fill="black" stroke="black" points="204.75,-276.85 201.25,-266.85 197.75,-276.85 204.75,-276.85"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="362.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>1-&gt;22</title>
<path fill="none" stroke="black" d="M221.64,-301.51C249.34,-293.21 299.11,-278.3 331.4,-268.62"/>
<polygon fill="black" stroke="black" points="332,-272.09 340.57,-265.87 329.99,-265.39 332,-272.09"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-251.26C73.9,-243.72 52.62,-230.73 36.95,-221.16"/>
<polygon fill="black" stroke="black" points="38.82,-218.2 28.47,-215.98 35.18,-224.17 38.82,-218.2"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-251.46C88.43,-244.8 81.55,-233.73 75.85,-224.57"/>
<polygon fill="black" stroke="black" points="79.01,-223.02 70.76,-216.38 73.07,-226.72 79.01,-223.02"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-251.46C101.09,-245.09 105.19,-234.68 108.69,-225.78"/>
<polygon fill="black" stroke="black" points="111.94,-227.09 112.35,-216.5 105.43,-224.52 111.94,-227.09"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-201.21C66.25,-194.99 66.25,-184.9 66.25,-176.14"/>
<polygon fill="black" stroke="black" points="69.75,-176.35 66.25,-166.35 62.75,-176.35 69.75,-176.35"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-251.46C196.41,-245.09 192.31,-234.68 188.81,-225.78"/>
<polygon fill="black" stroke="black" points="192.07,-224.52 185.15,-216.5 185.56,-227.09 192.07,-224.52"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-251.26C218.56,-243.9 234.71,-231.34 246.92,-221.84"/>
<polygon fill="black" stroke="black" points="248.72,-224.87 254.46,-215.96 244.42,-219.34 248.72,-224.87"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="167.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M180.41,-201.21C178.45,-194.91 175.27,-184.67 172.52,-175.83"/>
<polygon fill="black" stroke="black" points="175.86,-174.8 169.55,-166.29 169.18,-176.87 175.86,-174.8"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="141.25" y="-101.45" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M164.06,-150.96C160.55,-144.45 154.76,-133.71 149.9,-124.67"/>
<polygon fill="black" stroke="black" points="153.01,-123.07 145.18,-115.92 146.84,-126.39 153.01,-123.07"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="250.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M261.66,-201.21C259.96,-194.91 257.2,-184.67 254.82,-175.83"/>
<polygon fill="black" stroke="black" points="258.23,-175.05 252.25,-166.3 251.47,-176.87 258.23,-175.05"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="331.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>11-&gt;19</title>
<path fill="none" stroke="black" d="M271.86,-201.01C282.34,-193.58 300.3,-180.84 313.73,-171.31"/>
<polygon fill="black" stroke="black" points="315.56,-174.3 321.69,-165.66 311.51,-168.59 315.56,-174.3"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="208.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M245.1,-150.96C239.12,-144.09 229.03,-132.5 220.92,-123.18"/>
<polygon fill="black" stroke="black" points="223.64,-120.98 214.44,-115.73 218.36,-125.57 223.64,-120.98"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="289.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 12&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>12-&gt;16</title>
<path fill="none" stroke="black" d="M255.03,-150.96C260.53,-144.16 269.76,-132.74 277.24,-123.48"/>
<polygon fill="black" stroke="black" points="279.91,-125.74 283.48,-115.77 274.47,-121.34 279.91,-125.74"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="208.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M208.25,-100.71C208.25,-94.49 208.25,-84.4 208.25,-75.64"/>
<polygon fill="black" stroke="black" points="211.75,-75.85 208.25,-65.85 204.75,-75.85 211.75,-75.85"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="208.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M208.25,-50.46C208.25,-44.24 208.25,-34.15 208.25,-25.39"/>
<polygon fill="black" stroke="black" points="211.75,-25.6 208.25,-15.6 204.75,-25.6 211.75,-25.6"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="289.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M289.25,-100.71C289.25,-94.49 289.25,-84.4 289.25,-75.64"/>
<polygon fill="black" stroke="black" points="292.75,-75.85 289.25,-65.85 285.75,-75.85 292.75,-75.85"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="289.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17-&gt;18</title>
<path fill="none" stroke="black" d="M289.25,-50.46C289.25,-44.24 289.25,-34.15 289.25,-25.39"/>
<polygon fill="black" stroke="black" points="292.75,-25.6 289.25,-15.6 285.75,-25.6 292.75,-25.6"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M334.44,-150.96C337.95,-144.45 343.74,-133.71 348.6,-124.67"/>
<polygon fill="black" stroke="black" points="351.66,-126.39 353.32,-115.92 345.49,-123.07 351.66,-126.39"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M357.25,-100.71C357.25,-94.49 357.25,-84.4 357.25,-75.64"/>
<polygon fill="black" stroke="black" points="360.75,-75.85 357.25,-65.85 353.75,-75.85 360.75,-75.85"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="343.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M359.92,-251.46C357.41,-245.09 353.31,-234.68 349.81,-225.78"/>
<polygon fill="black" stroke="black" points="353.07,-224.52 346.15,-216.5 346.56,-227.09 353.07,-224.52"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="381.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22-&gt;24</title>
<path fill="none" stroke="black" d="M364.58,-251.46C367.09,-245.09 371.19,-234.68 374.69,-225.78"/>
<polygon fill="black" stroke="black" points="377.94,-227.09 378.35,-216.5 371.43,-224.52 377.94,-227.09"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="430.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22-&gt;26</title>
<path fill="none" stroke="black" d="M370.86,-251.26C381.34,-243.83 399.3,-231.09 412.73,-221.56"/>
<polygon fill="black" stroke="black" points="414.56,-224.55 420.69,-215.91 410.51,-218.84 414.56,-224.55"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="393.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M382.72,-201.21C384.29,-194.91 386.84,-184.67 389.03,-175.83"/>
<polygon fill="black" stroke="black" points="392.38,-176.86 391.4,-166.31 385.59,-175.17 392.38,-176.86"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="450pt" height="374pt" viewbox="0.00 0.00 449.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)">
<polygon fill="white" stroke="none" points="-4,4 -4,-370 445.5,-370 445.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-352.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-351.96C201.25,-345.74 201.25,-335.65 201.25,-326.89"/>
<polygon fill="black" stroke="black" points="204.75,-327.1 201.25,-317.1 197.75,-327.1 204.75,-327.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-301.51C170.83,-293.65 140.79,-279.84 119.77,-270.18"/>
<polygon fill="black" stroke="black" points="121.36,-267.06 110.82,-266.07 118.44,-273.42 121.36,-267.06"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-301.71C201.25,-295.49 201.25,-285.4 201.25,-276.64"/>
<polygon fill="black" stroke="black" points="204.75,-276.85 201.25,-266.85 197.75,-276.85 204.75,-276.85"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="356.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>1-&gt;22</title>
<path fill="none" stroke="black" d="M220.88,-301.51C247.43,-293.25 295.05,-278.43 326.14,-268.75"/>
<polygon fill="black" stroke="black" points="326.83,-272.2 335.33,-265.89 324.75,-265.52 326.83,-272.2"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-251.26C73.9,-243.72 52.62,-230.73 36.95,-221.16"/>
<polygon fill="black" stroke="black" points="38.82,-218.2 28.47,-215.98 35.18,-224.17 38.82,-218.2"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-251.46C88.43,-244.8 81.55,-233.73 75.85,-224.57"/>
<polygon fill="black" stroke="black" points="79.01,-223.02 70.76,-216.38 73.07,-226.72 79.01,-223.02"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-251.46C101.09,-245.09 105.19,-234.68 108.69,-225.78"/>
<polygon fill="black" stroke="black" points="111.94,-227.09 112.35,-216.5 105.43,-224.52 111.94,-227.09"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-201.21C66.25,-194.99 66.25,-184.9 66.25,-176.14"/>
<polygon fill="black" stroke="black" points="69.75,-176.35 66.25,-166.35 62.75,-176.35 69.75,-176.35"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-251.46C196.41,-245.09 192.31,-234.68 188.81,-225.78"/>
<polygon fill="black" stroke="black" points="192.07,-224.52 185.15,-216.5 185.56,-227.09 192.07,-224.52"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-251.26C218.56,-243.9 234.71,-231.34 246.92,-221.84"/>
<polygon fill="black" stroke="black" points="248.72,-224.87 254.46,-215.96 244.42,-219.34 248.72,-224.87"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="173.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.15,-201.21C179.99,-194.99 178.1,-184.9 176.47,-176.14"/>
<polygon fill="black" stroke="black" points="179.91,-175.52 174.64,-166.33 173.03,-176.8 179.91,-175.52"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M173.25,-150.96C173.25,-144.74 173.25,-134.65 173.25,-125.89"/>
<polygon fill="black" stroke="black" points="176.75,-126.1 173.25,-116.1 169.75,-126.1 176.75,-126.1"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="241.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M260.55,-201.21C257.62,-194.77 252.79,-184.19 248.7,-175.22"/>
<polygon fill="black" stroke="black" points="251.93,-173.86 244.6,-166.22 245.56,-176.77 251.93,-173.86"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="322.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>11-&gt;15</title>
<path fill="none" stroke="black" d="M270.48,-201.21C279.33,-193.97 294.56,-181.52 306.22,-171.98"/>
<polygon fill="black" stroke="black" points="308.26,-174.84 313.78,-165.8 303.83,-169.42 308.26,-174.84"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M241.25,-150.96C241.25,-144.74 241.25,-134.65 241.25,-125.89"/>
<polygon fill="black" stroke="black" points="244.75,-126.1 241.25,-116.1 237.75,-126.1 244.75,-126.1"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M241.25,-100.71C241.25,-94.49 241.25,-84.4 241.25,-75.64"/>
<polygon fill="black" stroke="black" points="244.75,-75.85 241.25,-65.85 237.75,-75.85 244.75,-75.85"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="315.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M321.39,-150.96C320.49,-144.74 319.03,-134.65 317.75,-125.89"/>
<polygon fill="black" stroke="black" points="321.23,-125.48 316.33,-116.09 314.3,-126.49 321.23,-125.48"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="396.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 15&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>15-&gt;19</title>
<path fill="none" stroke="black" d="M331.62,-150.76C343.14,-143.25 362.95,-130.34 377.61,-120.78"/>
<polygon fill="black" stroke="black" points="379.45,-123.76 385.92,-115.36 375.63,-117.89 379.45,-123.76"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="315.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M315.25,-100.71C315.25,-94.49 315.25,-84.4 315.25,-75.64"/>
<polygon fill="black" stroke="black" points="318.75,-75.85 315.25,-65.85 311.75,-75.85 318.75,-75.85"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="315.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17-&gt;18</title>
<path fill="none" stroke="black" d="M315.25,-50.46C315.25,-44.24 315.25,-34.15 315.25,-25.39"/>
<polygon fill="black" stroke="black" points="318.75,-25.6 315.25,-15.6 311.75,-25.6 318.75,-25.6"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="396.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M396.25,-100.71C396.25,-94.49 396.25,-84.4 396.25,-75.64"/>
<polygon fill="black" stroke="black" points="399.75,-75.85 396.25,-65.85 392.75,-75.85 399.75,-75.85"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="396.25" y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M396.25,-50.46C396.25,-44.24 396.25,-34.15 396.25,-25.39"/>
<polygon fill="black" stroke="black" points="399.75,-25.6 396.25,-15.6 392.75,-25.6 399.75,-25.6"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="337.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M353.92,-251.46C351.41,-245.09 347.31,-234.68 343.81,-225.78"/>
<polygon fill="black" stroke="black" points="347.07,-224.52 340.15,-216.5 340.56,-227.09 347.07,-224.52"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="375.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22-&gt;24</title>
<path fill="none" stroke="black" d="M358.58,-251.46C361.09,-245.09 365.19,-234.68 368.69,-225.78"/>
<polygon fill="black" stroke="black" points="371.94,-227.09 372.35,-216.5 365.43,-224.52 371.94,-227.09"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="424.25" y="-201.95" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22-&gt;26</title>
<path fill="none" stroke="black" d="M364.86,-251.26C375.34,-243.83 393.3,-231.09 406.73,-221.56"/>
<polygon fill="black" stroke="black" points="408.56,-224.55 414.69,-215.91 404.51,-218.84 408.56,-224.55"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="384.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M376.35,-201.21C377.51,-194.99 379.4,-184.9 381.03,-176.14"/>
<polygon fill="black" stroke="black" points="384.47,-176.8 382.86,-166.33 377.59,-175.52 384.47,-176.8"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="450pt" height="324pt" viewbox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 445.5,-319.75 445.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="201.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M201.25,-301.71C201.25,-295.49 201.25,-285.4 201.25,-276.64"/>
<polygon fill="black" stroke="black" points="204.75,-276.85 201.25,-266.85 197.75,-276.85 204.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M187.95,-251.26C170.83,-243.4 140.79,-229.59 119.77,-219.93"/>
<polygon fill="black" stroke="black" points="121.36,-216.81 110.82,-215.82 118.44,-223.17 121.36,-216.81"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M201.25,-251.46C201.25,-245.24 201.25,-235.15 201.25,-226.39"/>
<polygon fill="black" stroke="black" points="204.75,-226.6 201.25,-216.6 197.75,-226.6 204.75,-226.6"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>1-&gt;18</title>
<path fill="none" stroke="black" d="M220.88,-251.26C247.43,-243 295.05,-228.18 326.14,-218.5"/>
<polygon fill="black" stroke="black" points="326.83,-221.95 335.33,-215.64 324.75,-215.27 326.83,-221.95"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M86.24,-201.01C73.9,-193.47 52.62,-180.48 36.95,-170.91"/>
<polygon fill="black" stroke="black" points="38.82,-167.95 28.47,-165.73 35.18,-173.92 38.82,-167.95"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M92.57,-201.21C88.43,-194.55 81.55,-183.48 75.85,-174.32"/>
<polygon fill="black" stroke="black" points="79.01,-172.77 70.76,-166.13 73.07,-176.47 79.01,-172.77"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M98.58,-201.21C101.09,-194.84 105.19,-184.43 108.69,-175.53"/>
<polygon fill="black" stroke="black" points="111.94,-176.84 112.35,-166.25 105.43,-174.27 111.94,-176.84"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M66.25,-150.96C66.25,-144.74 66.25,-134.65 66.25,-125.89"/>
<polygon fill="black" stroke="black" points="69.75,-126.1 66.25,-116.1 62.75,-126.1 69.75,-126.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M198.92,-201.21C196.41,-194.84 192.31,-184.43 188.81,-175.53"/>
<polygon fill="black" stroke="black" points="192.07,-174.27 185.15,-166.25 185.56,-176.84 192.07,-174.27"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7-&gt;11</title>
<path fill="none" stroke="black" d="M209.1,-201.01C218.56,-193.65 234.71,-181.09 246.92,-171.59"/>
<polygon fill="black" stroke="black" points="248.72,-174.62 254.46,-165.71 244.42,-169.09 248.72,-174.62"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M181.15,-150.96C179.99,-144.74 178.1,-134.65 176.47,-125.89"/>
<polygon fill="black" stroke="black" points="179.91,-125.27 174.64,-116.08 173.03,-126.55 179.91,-125.27"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">Te</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M173.25,-100.71C173.25,-94.49 173.25,-84.4 173.25,-75.64"/>
<polygon fill="black" stroke="black" points="176.75,-75.85 173.25,-65.85 169.75,-75.85 176.75,-75.85"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M260.55,-150.96C257.62,-144.52 252.79,-133.94 248.7,-124.97"/>
<polygon fill="black" stroke="black" points="251.93,-123.61 244.6,-115.97 245.56,-126.52 251.93,-123.61"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 11&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>11-&gt;15</title>
<path fill="none" stroke="black" d="M270.48,-150.96C279.33,-143.72 294.56,-131.27 306.22,-121.73"/>
<polygon fill="black" stroke="black" points="308.26,-124.59 313.78,-115.55 303.83,-119.17 308.26,-124.59"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M241.25,-100.71C241.25,-94.49 241.25,-84.4 241.25,-75.64"/>
<polygon fill="black" stroke="black" points="244.75,-75.85 241.25,-65.85 237.75,-75.85 244.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M241.25,-50.46C241.25,-44.24 241.25,-34.15 241.25,-25.39"/>
<polygon fill="black" stroke="black" points="244.75,-25.6 241.25,-15.6 237.75,-25.6 244.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="322.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M322.25,-100.71C322.25,-94.49 322.25,-84.4 322.25,-75.64"/>
<polygon fill="black" stroke="black" points="325.75,-75.85 322.25,-65.85 318.75,-75.85 325.75,-75.85"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="322.25" y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M322.25,-50.46C322.25,-44.24 322.25,-34.15 322.25,-25.39"/>
<polygon fill="black" stroke="black" points="325.75,-25.6 322.25,-15.6 318.75,-25.6 325.75,-25.6"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="337.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18-&gt;19</title>
<path fill="none" stroke="black" d="M353.92,-201.21C351.41,-194.84 347.31,-184.43 343.81,-175.53"/>
<polygon fill="black" stroke="black" points="347.07,-174.27 340.15,-166.25 340.56,-176.84 347.07,-174.27"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="375.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 18&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>18-&gt;20</title>
<path fill="none" stroke="black" d="M358.58,-201.21C361.09,-194.84 365.19,-184.43 368.69,-175.53"/>
<polygon fill="black" stroke="black" points="371.94,-176.84 372.35,-166.25 365.43,-174.27 371.94,-176.84"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18-&gt;22</title>
<path fill="none" stroke="black" d="M364.86,-201.01C375.34,-193.58 393.3,-180.84 406.73,-171.31"/>
<polygon fill="black" stroke="black" points="408.56,-174.3 414.69,-165.66 404.51,-168.59 408.56,-174.3"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="384.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M376.35,-150.96C377.51,-144.74 379.4,-134.65 381.03,-125.89"/>
<polygon fill="black" stroke="black" points="384.47,-126.55 382.86,-116.08 377.59,-125.27 384.47,-126.55"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="469pt" height="324pt" viewbox="0.00 0.00 468.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 464.5,-319.75 464.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="211.25" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="211.25" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M211.25,-301.71C211.25,-295.49 211.25,-285.4 211.25,-276.64"/>
<polygon fill="black" stroke="black" points="214.75,-276.85 211.25,-266.85 207.75,-276.85 214.75,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="99.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-open-tag&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M197.07,-251.26C178.64,-243.32 146.17,-229.34 123.72,-219.67"/>
<polygon fill="black" stroke="black" points="125.28,-216.53 114.71,-215.79 122.51,-222.96 125.28,-216.53"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="211.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M211.25,-251.46C211.25,-245.24 211.25,-235.15 211.25,-226.39"/>
<polygon fill="black" stroke="black" points="214.75,-226.6 211.25,-216.6 207.75,-226.6 214.75,-226.6"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="375.25" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;xml-close-tag&gt;</text>
</g>
<!-- 1&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>1-&gt;22</title>
<path fill="none" stroke="black" d="M232.02,-251.26C260.24,-242.96 310.94,-228.05 343.82,-218.37"/>
<polygon fill="black" stroke="black" points="344.59,-221.79 353.2,-215.61 342.61,-215.08 344.59,-221.79"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt; (60)</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M88.86,-201.01C75.93,-193.4 53.54,-180.23 37.23,-170.63"/>
<polygon fill="black" stroke="black" points="39.25,-167.76 28.86,-165.7 35.7,-173.79 39.25,-167.76"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2-&gt;4</title>
<path fill="none" stroke="black" d="M95.2,-201.21C90.65,-194.55 83.08,-183.48 76.81,-174.32"/>
<polygon fill="black" stroke="black" points="79.72,-172.37 71.18,-166.09 73.94,-176.32 79.72,-172.37"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="115.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M101.21,-201.21C103.32,-194.84 106.78,-184.43 109.73,-175.53"/>
<polygon fill="black" stroke="black" points="112.97,-176.87 112.8,-166.28 106.33,-174.67 112.97,-176.87"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="52.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M64.53,-150.96C62.71,-144.66 59.73,-134.42 57.17,-125.58"/>
<polygon fill="black" stroke="black" points="60.55,-124.67 54.4,-116.04 53.83,-126.62 60.55,-124.67"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="195.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M209.29,-201.21C207.18,-194.84 203.72,-184.43 200.77,-175.53"/>
<polygon fill="black" stroke="black" points="204.17,-174.67 197.7,-166.28 197.53,-176.87 204.17,-174.67"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="276.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 7&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>7-&gt;15</title>
<path fill="none" stroke="black" d="M219.48,-201.01C229.4,-193.65 246.33,-181.09 259.12,-171.59"/>
<polygon fill="black" stroke="black" points="261.13,-174.46 267.07,-165.69 256.96,-168.84 261.13,-174.46"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="114.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M184.99,-150.76C172.21,-143.15 150.09,-129.98 133.98,-120.38"/>
<polygon fill="black" stroke="black" points="136.11,-117.57 125.73,-115.46 132.53,-123.59 136.11,-117.57"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="195.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8-&gt;12</title>
<path fill="none" stroke="black" d="M195.25,-150.96C195.25,-144.74 195.25,-134.65 195.25,-125.89"/>
<polygon fill="black" stroke="black" points="198.75,-126.1 195.25,-116.1 191.75,-126.1 198.75,-126.1"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="114.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M114.25,-100.71C114.25,-94.49 114.25,-84.4 114.25,-75.64"/>
<polygon fill="black" stroke="black" points="117.75,-75.85 114.25,-65.85 110.75,-75.85 117.75,-75.85"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="114.25" y="-0.95" font-family="Times,serif" font-size="14.00">T (84)</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M114.25,-50.46C114.25,-44.24 114.25,-34.15 114.25,-25.39"/>
<polygon fill="black" stroke="black" points="117.75,-25.6 114.25,-15.6 110.75,-25.6 117.75,-25.6"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="195.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M195.25,-100.71C195.25,-94.49 195.25,-84.4 195.25,-75.64"/>
<polygon fill="black" stroke="black" points="198.75,-75.85 195.25,-65.85 191.75,-75.85 198.75,-75.85"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="195.25" y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13-&gt;14</title>
<path fill="none" stroke="black" d="M195.25,-50.46C195.25,-44.24 195.25,-34.15 195.25,-25.39"/>
<polygon fill="black" stroke="black" points="198.75,-25.6 195.25,-15.6 191.75,-25.6 198.75,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="276.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M276.25,-150.96C276.25,-144.74 276.25,-134.65 276.25,-125.89"/>
<polygon fill="black" stroke="black" points="279.75,-126.1 276.25,-116.1 272.75,-126.1 279.75,-126.1"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;xml-tree&gt;</text>
</g>
<!-- 15&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>15-&gt;19</title>
<path fill="none" stroke="black" d="M286.51,-150.76C299.29,-143.15 321.41,-129.98 337.52,-120.38"/>
<polygon fill="black" stroke="black" points="338.97,-123.59 345.77,-115.46 335.39,-117.57 338.97,-123.59"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="276.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M276.25,-100.71C276.25,-94.49 276.25,-84.4 276.25,-75.64"/>
<polygon fill="black" stroke="black" points="279.75,-75.85 276.25,-65.85 272.75,-75.85 279.75,-75.85"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="276.25" y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17-&gt;18</title>
<path fill="none" stroke="black" d="M276.25,-50.46C276.25,-44.24 276.25,-34.15 276.25,-25.39"/>
<polygon fill="black" stroke="black" points="279.75,-25.6 276.25,-15.6 272.75,-25.6 279.75,-25.6"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;text&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M357.25,-100.71C357.25,-94.49 357.25,-84.4 357.25,-75.64"/>
<polygon fill="black" stroke="black" points="360.75,-75.85 357.25,-65.85 353.75,-75.85 360.75,-75.85"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="357.25" y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M357.25,-50.46C357.25,-44.24 357.25,-34.15 357.25,-25.39"/>
<polygon fill="black" stroke="black" points="360.75,-25.6 357.25,-15.6 353.75,-25.6 360.75,-25.6"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="356.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;/</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M372.92,-201.21C370.41,-194.84 366.31,-184.43 362.81,-175.53"/>
<polygon fill="black" stroke="black" points="366.07,-174.27 359.15,-166.25 359.56,-176.84 366.07,-174.27"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="394.25" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22-&gt;24</title>
<path fill="none" stroke="black" d="M377.58,-201.21C380.09,-194.84 384.19,-184.43 387.69,-175.53"/>
<polygon fill="black" stroke="black" points="390.94,-176.84 391.35,-166.25 384.43,-174.27 390.94,-176.84"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="443.25" y="-151.7" font-family="Times,serif" font-size="14.00">&gt; (62)</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22-&gt;26</title>
<path fill="none" stroke="black" d="M383.86,-201.01C394.34,-193.58 412.3,-180.84 425.73,-171.31"/>
<polygon fill="black" stroke="black" points="427.56,-174.3 433.69,-165.66 423.51,-168.59 427.56,-174.3"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="419.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M397.32,-150.96C400.69,-144.45 406.26,-133.71 410.94,-124.67"/>
<polygon fill="black" stroke="black" points="413.97,-126.42 415.46,-115.93 407.75,-123.2 413.97,-126.42"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As we can see, the input starts with an opening tag, contains some text, and ends with a closing tag. Excellent. This is a structure that we can work with.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Building-the-Fragment-Pool">Building the Fragment Pool</h3><p>We are now ready to implement our first input-structure-aware mutator. Let's initialize the mutator with the dictionary <code>fragments</code> representing the empty fragment pool. It contains a key for each symbol in the grammar (and the empty set as value).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">Mutator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Mutate inputs with input fragments from a pool"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">EarleyParser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Initialize empty fragment pool and add parser"""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]]</span> <span class="o">=</span> \
            <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">cgrammar</span><span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>FragmentMutator</code> adds fragments recursively. A <em>fragment</em> is a subtree in the parse tree and consists of the symbol of the current node and child nodes (i.e., descendant fragments). We can exclude fragments starting with symbols that are tokens, terminals, or not part of the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Parser.html" class="import" target="_blank">Parser</a></span> <span class="kn">import</span> <span class="n">terminals</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fragment</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Recursively adds fragments to the fragment pool"""</span>
        <span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span> <span class="o">=</span> <span class="n">fragment</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">symbol</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">subfragment</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_fragment</span><span class="p">(</span><span class="n">subfragment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_excluded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns true if a fragment starting with a specific</span>
<span class="sd">           symbol and all its decendents can be excluded"""</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">grammar</span><span class="p">()</span> <span class="ow">or</span>
                <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">tokens</span> <span class="ow">or</span>
                <span class="n">symbol</span> <span class="ow">in</span> <span class="n">terminals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">grammar</span><span class="p">()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Parsing can take a long time, particularly if there is too much ambiguity during the parsing. In order to maintain the efficiency of mutational fuzzing, we will limit the parsing time to 200ms.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Timeout.html" class="import" target="_blank">Timeout</a></span> <span class="kn">import</span> <span class="n">Timeout</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The function <code>add_to_fragment_pool()</code> parses a seed (no longer than 200ms) and adds all its fragments to the fragment pool. If the parsing of the <code>seed</code> was successful, the attribute <code>seed.has_structure</code> is set to <code>True</code>. Otherwise, it is set to <code>False</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">SeedWithStructure</span><span class="p">(</span><span class="n">Seed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Seeds augmented with structure info"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;empty&gt;"</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_to_fragment_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Adds all fragments of a seed to the fragment pool"""</span>
        <span class="k">try</span><span class="p">:</span>  <span class="c1"># only allow quick parsing of 200ms max</span>
            <span class="k">with</span> <span class="n">Timeout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">):</span>
                <span class="n">seed</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_fragment</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">TimeoutError</span><span class="p">):</span>
            <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's see how <code>FragmentMutator</code> fills the fragment pool for a simple HTML seed input. We initialize mutator with the <code>EarleyParser</code> which itself is initialized with our <code>XML_GRAMMAR</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="GrammarFuzzer.html" class="import" target="_blank">GrammarFuzzer</a></span> <span class="kn">import</span> <span class="n">tree_to_string</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">valid_seed</span> <span class="o">=</span> <span class="n">SeedWithStructure</span><span class="p">(</span>
    <span class="s2">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="p">)</span>
<span class="n">fragment_mutator</span> <span class="o">=</span> <span class="n">FragmentMutator</span><span class="p">(</span><span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
<span class="n">fragment_mutator</span><span class="o">.</span><span class="n">add_to_fragment_pool</span><span class="p">(</span><span class="n">valid_seed</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fragment_mutator</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fragment_mutator</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"|-</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">tree_to_string</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;start&gt;
|-&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;
&lt;xml-tree&gt;
|-&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;
|-&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;
|-&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;
|-&lt;title&gt;Hello&lt;/title&gt;
|-Hello
|-&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;
|-World&lt;br/&gt;
|-World
|-&lt;br/&gt;
&lt;xml-open-tag&gt;
|-&lt;html&gt;
|-&lt;head&gt;
|-&lt;title&gt;
|-&lt;body&gt;
&lt;xml-openclose-tag&gt;
|-&lt;br/&gt;
&lt;xml-close-tag&gt;
|-&lt;/title&gt;
|-&lt;/head&gt;
|-&lt;/body&gt;
|-&lt;/html&gt;
&lt;xml-attribute&gt;
&lt;id&gt;
&lt;text&gt;
&lt;letter&gt;
&lt;letter_space&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For many symbols in the grammar, we have collected a number of fragments. There are several open and closing tags and several interesting fragments starting with the <code>xml-tree</code> symbol.</p>
<p><strong><em>Summary</em></strong>. For each interesting symbol in the grammar, the <code>FragmentMutator</code> has a set of fragments. These fragments are extracted by first parsing the inputs to be mutated.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Fragment-Based-Mutation">Fragment-Based Mutation</h3><p>We can use the fragments in the fragment pool to generate new inputs. Every seed that is being mutated is disassembled into fragments, and memoized – i.e., disassembled only the first time around.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">EarleyParser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Initialize mutators"""</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seen_seeds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SeedWithStructure</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeedWithStructure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Implement structure-aware mutation. Memoize seeds."""</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seen_seeds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seen_seeds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_fragment_pool</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our first structural mutation operator is <code>swap_fragments()</code>, which choses a random fragment in the given seed and substitutes it with a random fragment from the pool. We make sure that both fragments start with the same symbol. For instance, we may swap a closing tag in the seed HTML by another closing tag from the fragment pool.</p>
<p>In order to choose a random fragment, the mutator counts all fragments (<code>n_count</code>) below the root fragment associated with the start-symbol.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">count_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fragment</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns the number of nodes in the fragment"""</span>
        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">fragment</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">symbol</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">assert</span> <span class="n">children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_nodes</span><span class="p">,</span> <span class="n">children</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In order to swap the chosen fragment – identified using the "global" variable <code>self.to_swap</code> – the seed's parse tree is traversed recursively.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">recursive_swap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fragment</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Recursively finds the fragment to swap."""</span>
        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">fragment</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">symbol</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">to_swap</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_swap</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">symbol</span><span class="p">]))</span>

        <span class="k">assert</span> <span class="n">children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_swap</span><span class="p">,</span> <span class="n">children</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our structural mutator chooses a random number between 2 (i.e., excluding the <code>start</code> symbol) and the total number of fragments (<code>n_count</code>) and uses the recursive swapping to generate the new fragment. The new fragment is serialized as string and returned as new seed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">EarleyParser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutators</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">swap_fragment</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">swap_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeedWithStructure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Substitutes a random fragment with another with the same symbol"""</span>
        <span class="k">if</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span><span class="p">:</span>
            <span class="n">n_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_nodes</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_swap</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">)</span>
            <span class="n">new_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_swap</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>

            <span class="n">new_seed</span> <span class="o">=</span> <span class="n">SeedWithStructure</span><span class="p">(</span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">new_structure</span><span class="p">))</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">new_structure</span>
            <span class="k">return</span> <span class="n">new_seed</span>

        <span class="k">return</span> <span class="n">seed</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">valid_seed</span> <span class="o">=</span> <span class="n">SeedWithStructure</span><span class="p">(</span>
    <span class="s2">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="p">)</span>
<span class="n">lf_mutator</span> <span class="o">=</span> <span class="n">FragmentMutator</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valid_seed</span><span class="p">)</span>
<span class="n">lf_mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">valid_seed</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;title&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;&lt;body&gt;World&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As we can see, one fragment has been substituted by another.</p>
<p>We can use a similar recursive traversal to <em>remove</em> a random fragment.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">recursive_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fragment</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Recursively finds the fragment to delete"""</span>
        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">fragment</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">symbol</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="p">[]</span>

        <span class="k">assert</span> <span class="n">children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_delete</span><span class="p">,</span> <span class="n">children</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We should also define the corresponding structural deletion operator, as well.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">FragmentMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_fragment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeedWithStructure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Delete a random fragment"""</span>
        <span class="k">if</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span><span class="p">:</span>
            <span class="n">n_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_nodes</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_delete</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">)</span>
            <span class="n">new_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_delete</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>

            <span class="n">new_seed</span> <span class="o">=</span> <span class="n">SeedWithStructure</span><span class="p">(</span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">new_structure</span><span class="p">))</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">new_structure</span>
            <span class="c1"># do not return an empty new_seed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">new_seed</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">seed</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">new_seed</span>

        <span class="k">return</span> <span class="n">seed</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. We now have all ingredients for structure-aware fuzzing. Our mutator disassembles all seeds into fragments, which are then added to the fragment pool. Our mutator swaps random fragments in a given seed with fragments of the same type. And our mutator deletes random fragments in a given seed. This allows maintaining a high degree of validity for the generated inputs w.r.t. the given grammar.</p>
<p><strong><em>Try it</em></strong>. Try adding other structural mutation operators. How would an <em>add-operator</em> know the position in a given seed file, where it is okay to add a fragment starting with a certain symbol?</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Fragment-Based-Fuzzing">Fragment-Based Fuzzing</h3><p>We can now define an input-structure aware fuzzer as pioneered in LangFuzz. To implement LangFuzz, we modify our <a href="GreyboxFuzzer.html#Blackbox-Mutation-based-Fuzzer">blackbox mutational fuzzer</a> to stack up to four structural mutations.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">LangFuzzer</span><span class="p">(</span><span class="n">AdvancedMutationFuzzer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Blackbox fuzzer mutating input fragments. Roughly based on `LangFuzz`."""</span>

    <span class="k">def</span> <span class="nf">create_candidate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Seed</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns an input generated by fuzzing a seed in the population"""</span>
        <span class="n">candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">choose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
        <span class="n">trials</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
            <span class="n">candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Okay, let's take our first input-structure aware fuzzer for a spin. Being careful, we set n=300 for now.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">n</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">mutator</span> <span class="o">=</span> <span class="n">FragmentMutator</span><span class="p">(</span><span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>

<span class="n">lang_fuzzer</span> <span class="o">=</span> <span class="n">LangFuzzer</span><span class="p">([</span><span class="n">valid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lang_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="s2">"It took LangFuzzer </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took LangFuzzer 94.94 seconds to generate and execute 300 inputs.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We observe that structural mutation is <em>sooo very slow</em>. This is despite our time budget of 200ms for parsing. In contrast, our blackbox fuzzer alone can generate about 10k inputs per second!</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">mutator</span> <span class="o">=</span> <span class="n">Mutator</span><span class="p">()</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>

<span class="n">blackFuzzer</span> <span class="o">=</span> <span class="n">AdvancedMutationFuzzer</span><span class="p">([</span><span class="n">valid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">blackFuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="s2">"It took a blackbox fuzzer </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took a blackbox fuzzer 0.10 seconds to generate and execute 300 inputs.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed, our blackbox fuzzer is done in the blink of an eye.</p>
<p><strong><em>Try it</em></strong>. We can deal with this overhead using <a href="https://arxiv.org/abs/1811.09447">deferred parsing</a>. Instead of wasting time in the beginning of the fuzzing campaign when a byte-level mutator would make efficient progress, deferred parsing suggests to invest time in structural mutation only later in the fuzzing campaign when it becomes viable.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">blackbox_coverage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">coverage</span><span class="p">())</span>
<span class="s2">"During this fuzzing campaign, the blackbox fuzzer covered </span><span class="si">%d</span><span class="s2"> statements."</span> <span class="o">%</span> <span class="n">blackbox_coverage</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'During this fuzzing campaign, the blackbox fuzzer covered 94 statements.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's print some stats for our fuzzing campaigns. Since we'll need to print stats more often later, we should wrap this into a function. In order to measure coverage, we import the <a href="Coverage.html#Coverage-of-Basic-Fuzzing">population_coverage</a> function. It takes a set of inputs and a Python function, executes the inputs on that function and collects coverage information. Specifically, it returns a tuple <code>(all_coverage, cumulative_coverage)</code> where <code>all_coverage</code> is the set of statements covered by all inputs, and <code>cumulative_coverage</code> is the number of statements covered as the number of executed inputs increases. We are just interested in the latter to plot coverage over time.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Coverage.html" class="import" target="_blank">Coverage</a></span> <span class="kn">import</span> <span class="n">population_coverage</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">print_stats</span><span class="p">(</span><span class="n">fuzzer</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">Parser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">coverage</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">population_coverage</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">my_parser</span><span class="p">)</span>

    <span class="n">has_structure</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>
        <span class="c1"># reuse memoized information</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="s2">"has_structure"</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span><span class="p">:</span> 
                <span class="n">has_structure</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">seed</span> <span class="o">=</span> <span class="n">Seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">Timeout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">):</span>
                    <span class="nb">next</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
                <span class="n">has_structure</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">TimeoutError</span><span class="p">):</span>
                <span class="k">pass</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"From the </span><span class="si">%d</span><span class="s2"> generated inputs, </span><span class="si">%d</span><span class="s2"> (</span><span class="si">%0.2f%%</span><span class="s2">) can be parsed.</span><span class="se">\n</span><span class="s2">"</span>
          <span class="s2">"In total, </span><span class="si">%d</span><span class="s2"> statements are covered."</span> <span class="o">%</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">),</span>
            <span class="n">has_structure</span><span class="p">,</span>
            <span class="mi">100</span> <span class="o">*</span> <span class="n">has_structure</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">inputs</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">coverage</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For LangFuzzer, let's see how many of the inputs generated by LangFuzz are valid (i.e., parsable) and how many statements were covered.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">print_stats</span><span class="p">(</span><span class="n">lang_fuzzer</span><span class="p">,</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From the 300 generated inputs, 172 (57.33%) can be parsed.
In total, 93 statements are covered.
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>What are the stats for the mutational fuzzer that uses only byte-level mutation (and no grammars)?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">print_stats</span><span class="p">(</span><span class="n">blackFuzzer</span><span class="p">,</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From the 300 generated inputs, 34 (11.33%) can be parsed.
In total, 167 statements are covered.
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. Our fragment-level blackbox fuzzer (LangFuzzer) generates <em>more valid inputs</em> but achieves <em>less code coverage</em> than a fuzzer with our byte-level fuzzer. So, there is some value in generating inputs that do not stick to the provided grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Integration-with-Greybox-Fuzzing">Integration with Greybox Fuzzing</h3><p>In the following we integrate fragment-level blackbox fuzzing (LangFuzz-style) with <a href="GreyboxFuzzer.html#Greybox-Mutation-based-Fuzzer">byte-level greybox fuzzing</a> (AFL-style). The additional coverage-feedback might allow us to increase code coverage more quickly.</p>
<p>A <a href="GreyboxFuzzer.html#Greybox-Mutation-based-Fuzzer">greybox fuzzer</a> adds to the seed population all generated inputs which increase code coverage. Inputs are generated in two stages, stacking up to four structural mutations and up to 32 byte-level mutations.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GreyboxGrammarFuzzer</span><span class="p">(</span><span class="n">GreyboxFuzzer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Greybox fuzzer using grammars."""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seeds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">byte_mutator</span><span class="p">:</span> <span class="n">Mutator</span><span class="p">,</span> <span class="n">tree_mutator</span><span class="p">:</span> <span class="n">FragmentMutator</span><span class="p">,</span>
                 <span class="n">schedule</span><span class="p">:</span> <span class="n">PowerSchedule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Constructor.</span>
<span class="sd">        `seeds` - set of inputs to mutate.</span>
<span class="sd">        `byte_mutator` - a byte-level mutator.</span>
<span class="sd">        `tree_mutator` = a tree-level mutator.</span>
<span class="sd">        `schedule` - a power schedule.</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seeds</span><span class="p">,</span> <span class="n">byte_mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree_mutator</span> <span class="o">=</span> <span class="n">tree_mutator</span>

    <span class="k">def</span> <span class="nf">create_candidate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns an input generated by structural mutation </span>
<span class="sd">           of a seed in the population"""</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">SeedWithStructure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">choose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">))</span>

        <span class="c1"># Structural mutation</span>
        <span class="n">trials</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Byte-level mutation</span>
        <span class="n">candidate</span> <span class="o">=</span> <span class="n">seed</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="n">trials</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="ow">or</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dumb_trials</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dumb_trials</span><span class="p">):</span>
                <span class="n">candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's run our integrated fuzzer with the <a href="GreyboxFuzzer.html#Mutator-and-Seed">standard byte-level mutator</a> and our <a href="#Fragment-based-Mutation">fragment-based structural mutator</a> that was introduced above.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">byte_mutator</span> <span class="o">=</span> <span class="n">Mutator</span><span class="p">()</span>
<span class="n">tree_mutator</span> <span class="o">=</span> <span class="n">FragmentMutator</span><span class="p">(</span><span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>

<span class="n">gg_fuzzer</span> <span class="o">=</span> <span class="n">GreyboxGrammarFuzzer</span><span class="p">([</span><span class="n">valid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">byte_mutator</span><span class="p">,</span> <span class="n">tree_mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">gg_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="s2">"It took the greybox grammar fuzzer </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took the greybox grammar fuzzer 0.69 seconds to generate and execute 300 inputs.'
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">print_stats</span><span class="p">(</span><span class="n">gg_fuzzer</span><span class="p">,</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From the 300 generated inputs, 2 (0.67%) can be parsed.
In total, 171 statements are covered.
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. Our structural greybox fuzzer</p>
<ul>
<li>runs faster than the fragment-based LangFuzzer,</li>
<li>achieves more coverage than both the fragment-based LangFuzzer and the vanilla blackbox mutational fuzzer, and</li>
<li>generates fewer valid inputs than even the vanilla blackbox mutational fuzzer.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Fuzzing-with-Input-Regions">Fuzzing with Input Regions</h2><p>In the previous section, we have seen that most inputs that are added as seeds are <em>invalid</em> w.r.t. our given grammar. Yet, in order to apply our fragment-based mutators, we need it to parse the seed successfully. Otherwise, the entire fragment-based approach becomes useless.  The question arises: <em>How can we derive structure from (invalid) seeds that cannot be parsed successfully?</em></p>
<p>To this end, we introduce the idea of <em>region-based mutation</em>, first explored with the <a href="https://github.com/aflsmart/aflsmart">AFLSmart</a> structural greybox fuzzer [<a href="https://arxiv.org/abs/1811.09447">Van-Thuan Pham <em>et al</em>, 2018</a>]. AFLSmart implements byte-level, fragment-based, and region-based mutation as well as validity-based power schedules. We define <em>region-based mutators</em>, where a <em>region</em> is a consecutive sequence of bytes in the input that can be associated with a symbol in the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The basic idea of fuzzing with input regions is shown in the following diagram. After <em>parsing</em> an input (into a derivation tree), we can identify <em>regions</em> associated with specific subtrees of the derivation tree. These regions can then be deleted or swapped.</p>
<p><img src="../Images/43bec249ff48a249e214712d4f6d6f64.png" data-original-src="http://www.fuzzingbook.org/html/PICS/GreyboxGrammarFuzzer-Regions.gif"/></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such regions can also be determined even if the input is incomplete or invalid, allowing for robust parsing.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Determining-Symbol-Regions">Determining Symbol Regions</h3><p>How can we obtain regions for a given input? The function <code>chart_parse()</code> of the <a href="Parser.html#The-Parsing-Algorithm">Earley parser</a> produces a <em>parse table</em> for a string. For each letter in the string, this table gives the potential symbol and a <em>region</em> of neighboring letters that might belong to the same symbol.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">invalid_seed</span> <span class="o">=</span> <span class="n">Seed</span><span class="p">(</span><span class="s2">"&lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;&gt;/body&gt;&lt;/html&gt;"</span><span class="p">)</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">invalid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">parser</span><span class="o">.</span><span class="n">start_symbol</span><span class="p">())</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"---"</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>None chart[0]

---
&lt; chart[1]

---
h chart[2]
&lt;letter&gt;:= h |(1,2)
&lt;id&gt;:= &lt;letter&gt; |(1,2)
---
t chart[3]
&lt;letter&gt;:= t |(2,3)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(1,3)
---
m chart[4]
&lt;letter&gt;:= m |(3,4)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(1,4)
---
l chart[5]
&lt;letter&gt;:= l |(4,5)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(1,5)
---
&gt; chart[6]
&lt;xml-open-tag&gt;:= &lt; &lt;id&gt; &gt; |(0,6)
---
&lt; chart[7]

---
b chart[8]
&lt;letter&gt;:= b |(7,8)
&lt;id&gt;:= &lt;letter&gt; |(7,8)
---
o chart[9]
&lt;letter&gt;:= o |(8,9)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(7,9)
---
d chart[10]
&lt;letter&gt;:= d |(9,10)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(7,10)
---
y chart[11]
&lt;letter&gt;:= y |(10,11)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(7,11)
---
&gt; chart[12]
&lt;xml-open-tag&gt;:= &lt; &lt;id&gt; &gt; |(6,12)
---
&lt; chart[13]

---
i chart[14]
&lt;letter&gt;:= i |(13,14)
&lt;id&gt;:= &lt;letter&gt; |(13,14)
---
&gt; chart[15]
&lt;xml-open-tag&gt;:= &lt; &lt;id&gt; &gt; |(12,15)
---
W chart[16]
&lt;letter_space&gt;:= W |(15,16)
&lt;text&gt;:= &lt;letter_space&gt; |(15,16)
&lt;xml-tree&gt;:= &lt;text&gt; |(15,16)
---
o chart[17]
&lt;letter_space&gt;:= o |(16,17)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(15,17)
&lt;text&gt;:= &lt;letter_space&gt; |(16,17)
&lt;xml-tree&gt;:= &lt;text&gt; |(15,17)
&lt;xml-tree&gt;:= &lt;text&gt; |(16,17)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(15,17)
---
r chart[18]
&lt;letter_space&gt;:= r |(17,18)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(15,18)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(16,18)
&lt;text&gt;:= &lt;letter_space&gt; |(17,18)
&lt;xml-tree&gt;:= &lt;text&gt; |(15,18)
&lt;xml-tree&gt;:= &lt;text&gt; |(16,18)
&lt;xml-tree&gt;:= &lt;text&gt; |(17,18)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(15,18)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(16,18)
---
l chart[19]
&lt;letter_space&gt;:= l |(18,19)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(15,19)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(16,19)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(17,19)
&lt;text&gt;:= &lt;letter_space&gt; |(18,19)
&lt;xml-tree&gt;:= &lt;text&gt; |(15,19)
&lt;xml-tree&gt;:= &lt;text&gt; |(16,19)
&lt;xml-tree&gt;:= &lt;text&gt; |(17,19)
&lt;xml-tree&gt;:= &lt;text&gt; |(18,19)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(15,19)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(16,19)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(17,19)
---
d chart[20]
&lt;letter_space&gt;:= d |(19,20)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(15,20)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(16,20)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(17,20)
&lt;text&gt;:= &lt;text&gt; &lt;letter_space&gt; |(18,20)
&lt;text&gt;:= &lt;letter_space&gt; |(19,20)
&lt;xml-tree&gt;:= &lt;text&gt; |(15,20)
&lt;xml-tree&gt;:= &lt;text&gt; |(16,20)
&lt;xml-tree&gt;:= &lt;text&gt; |(17,20)
&lt;xml-tree&gt;:= &lt;text&gt; |(18,20)
&lt;xml-tree&gt;:= &lt;text&gt; |(19,20)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(15,20)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(16,20)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(17,20)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(18,20)
---
&lt; chart[21]

---
/ chart[22]

---
i chart[23]
&lt;letter&gt;:= i |(22,23)
&lt;id&gt;:= &lt;letter&gt; |(22,23)
---
&gt; chart[24]
&lt;xml-close-tag&gt;:= &lt; / &lt;id&gt; &gt; |(20,24)
&lt;xml-tree&gt;:= &lt;xml-open-tag&gt; &lt;xml-tree&gt; &lt;xml-close-tag&gt; |(12,24)
---
&lt; chart[25]

---
b chart[26]
&lt;letter&gt;:= b |(25,26)
&lt;id&gt;:= &lt;letter&gt; |(25,26)
---
r chart[27]
&lt;letter&gt;:= r |(26,27)
&lt;id&gt;:= &lt;id&gt; &lt;letter&gt; |(25,27)
---
/ chart[28]

---
&gt; chart[29]
&lt;xml-openclose-tag&gt;:= &lt; &lt;id&gt; / &gt; |(24,29)
&lt;xml-tree&gt;:= &lt;xml-openclose-tag&gt; |(24,29)
&lt;xml-tree&gt;:= &lt;xml-tree&gt; &lt;xml-tree&gt; |(12,29)
---
&gt; chart[30]

---
/ chart[31]

---
b chart[32]

---
o chart[33]

---
d chart[34]

---
y chart[35]

---
&gt; chart[36]

---
&lt; chart[37]

---
/ chart[38]

---
h chart[39]

---
t chart[40]

---
m chart[41]

---
l chart[42]

---
&gt; chart[43]

---
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The number of columns in this table that are associated with potential symbols correspond to the number of letters that could be parsed successfully. In other words, we can use this table to compute the longest parsable substring.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">states</span><span class="p">]</span>
<span class="n">parsable</span> <span class="o">=</span> <span class="n">invalid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"'</span><span class="si">%s</span><span class="s2">'"</span> <span class="o">%</span> <span class="n">invalid_seed</span><span class="p">)</span>
<span class="n">parsable</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>'&lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;&gt;/body&gt;&lt;/html&gt;'
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'&lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From this, we can compute the <em>degree of validity</em> for an input.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">validity</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsable</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">invalid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="s2">"</span><span class="si">%0.1f%%</span><span class="s2"> of the string can be parsed successfully."</span> <span class="o">%</span> <span class="n">validity</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'67.4% of the string can be parsed successfully.'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. Unlike input fragments, input regions can be derived even if the parser fails to generate the entire parse tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Region-Based-Mutation">Region-Based Mutation</h3><p>To fuzz invalid seeds, the region-based mutator associates symbols from the grammar with regions (i.e., indexed substrings) in the seed. The <a href="#Building-the-Fragment-Pool">overridden</a> method <code>add_to_fragment_pool()</code> first tries to mine the fragments from the seed. If this fails, the region mutator uses <a href="Parser.html#The-Parsing-Algorithm">Earley parser</a> to derive the parse table. For each column (i.e., letter), it extracts the symbols and corresponding regions. This allows the mutator to store the set of regions with each symbol.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">SeedWithRegions</span><span class="p">(</span><span class="n">SeedWithStructure</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Seeds augmented with structure info"""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Set</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">RegionMutator</span><span class="p">(</span><span class="n">FragmentMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_to_fragment_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithRegions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Mark fragments and regions in a seed file"""</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_fragment_pool</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">Timeout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">):</span>
                    <span class="n">seed</span><span class="o">.</span><span class="n">regions</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">cgrammar</span><span class="p">}</span>
                    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">start_symbol</span><span class="p">()):</span>
                        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">column</span><span class="o">.</span><span class="n">states</span><span class="p">:</span>
                            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_excluded</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span>
                                    <span class="n">state</span><span class="o">.</span><span class="n">e_col</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">s_col</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span>
                                    <span class="n">state</span><span class="o">.</span><span class="n">finished</span><span class="p">()):</span>
                                <span class="n">seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">state</span><span class="o">.</span><span class="n">s_col</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                                              <span class="n">state</span><span class="o">.</span><span class="n">e_col</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
                <span class="n">seed</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                <span class="n">seed</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">seed</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is how these regions look like for our invalid seed. A region consists of a start and end index in the seed string.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">invalid_seed</span> <span class="o">=</span> <span class="n">SeedWithRegions</span><span class="p">(</span><span class="s2">"&lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;&gt;/body&gt;&lt;/html&gt;"</span><span class="p">)</span>
<span class="n">mutator</span> <span class="o">=</span> <span class="n">RegionMutator</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="n">mutator</span><span class="o">.</span><span class="n">add_to_fragment_pool</span><span class="p">(</span><span class="n">invalid_seed</span><span class="p">)</span>
<span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">invalid_seed</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">invalid_seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"|-(</span><span class="si">%d</span><span class="s2">,</span><span class="si">%d</span><span class="s2">) : </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">invalid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;start&gt;
&lt;xml-tree&gt;
|-(16,20) : orld
|-(12,24) : &lt;i&gt;World&lt;/i&gt;
|-(17,20) : rld
|-(18,20) : ld
|-(16,19) : orl
|-(15,17) : Wo
|-(12,29) : &lt;i&gt;World&lt;/i&gt;&lt;br/&gt;
|-(17,19) : rl
|-(15,20) : World
|-(24,29) : &lt;br/&gt;
|-(15,19) : Worl
|-(16,18) : or
|-(15,18) : Wor
&lt;xml-open-tag&gt;
|-(6,12) : &lt;body&gt;
|-(12,15) : &lt;i&gt;
|-(0,6) : &lt;html&gt;
&lt;xml-openclose-tag&gt;
|-(24,29) : &lt;br/&gt;
&lt;xml-close-tag&gt;
|-(20,24) : &lt;/i&gt;
&lt;xml-attribute&gt;
&lt;id&gt;
&lt;text&gt;
&lt;letter&gt;
&lt;letter_space&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now that we know which regions in the seed belong to which symbol, we can define region-based swap and delete operators.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">RegionMutator</span><span class="p">(</span><span class="n">RegionMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">swap_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithRegions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeedWithRegions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Chooses a random region and swaps it with a fragment</span>
<span class="sd">           that starts with the same symbol"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="ow">and</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_regions</span><span class="p">:</span>
            <span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">seed</span><span class="o">.</span><span class="n">regions</span>
                       <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">r</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span>
                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">r</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">seed</span>

            <span class="n">key</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">regions</span><span class="p">))</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
            <span class="n">swap_structure</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">swap_string</span> <span class="o">=</span> <span class="n">tree_to_string</span><span class="p">(</span><span class="n">swap_structure</span><span class="p">)</span>
            <span class="n">new_seed</span> <span class="o">=</span> <span class="n">SeedWithRegions</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">swap_string</span> <span class="o">+</span> <span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">e</span><span class="p">:])</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">new_seed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">swap_fragment</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">RegionMutator</span><span class="p">(</span><span class="n">RegionMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">delete_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">SeedWithRegions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeedWithRegions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Deletes a random region"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="ow">and</span> <span class="n">seed</span><span class="o">.</span><span class="n">has_regions</span><span class="p">:</span>
            <span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">seed</span><span class="o">.</span><span class="n">regions</span>
                       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">r</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">seed</span>

            <span class="n">key</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">regions</span><span class="p">))</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>

            <span class="n">new_seed</span> <span class="o">=</span> <span class="n">SeedWithRegions</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">e</span><span class="p">:])</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_structure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">new_seed</span><span class="o">.</span><span class="n">has_regions</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">new_seed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">delete_fragment</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's try our new region-based mutator. We add a simple, valid seed to the fragment pool and attempt to mutate the invalid seed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">simple_seed</span> <span class="o">=</span> <span class="n">SeedWithRegions</span><span class="p">(</span><span class="s2">"&lt;b&gt;Text&lt;/b&gt;"</span><span class="p">)</span>
<span class="n">mutator</span> <span class="o">=</span> <span class="n">RegionMutator</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="n">mutator</span><span class="o">.</span><span class="n">add_to_fragment_pool</span><span class="p">(</span><span class="n">simple_seed</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">invalid_seed</span><span class="p">)</span>
<span class="n">mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">invalid_seed</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;&gt;/body&gt;&lt;/html&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;html&gt;&lt;body&gt;&gt;/body&gt;&lt;/html&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. We can use the Earley parser to generate a parse table and assign regions in the input to symbols in the grammar. Our region mutators can substitute these regions with fragments from the fragment pool that start with the same symbol, or delete these regions entirely.</p>
<p><strong><em>Try it</em></strong>. Implement a region pool (similar to the fragment pool) and a <code>swap_region()</code> mutator.
You can execute your own code by opening this chapter as Jupyter notebook.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Integration-with-Greybox-Fuzzing">Integration with Greybox Fuzzing</h3><p>Let's try our shiny new region mutator by integrating it with our <a href="#Integration-with-Greybox-Fuzzing">structure-aware greybox fuzzer</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">byte_mutator</span> <span class="o">=</span> <span class="n">Mutator</span><span class="p">()</span>
<span class="n">tree_mutator</span> <span class="o">=</span> <span class="n">RegionMutator</span><span class="p">(</span><span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">PowerSchedule</span><span class="p">()</span>

<span class="n">regionFuzzer</span> <span class="o">=</span> <span class="n">GreyboxGrammarFuzzer</span><span class="p">([</span><span class="n">valid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">byte_mutator</span><span class="p">,</span> <span class="n">tree_mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">regionFuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="sd">"""</span>
<span class="sd">It took the structural greybox fuzzer with region mutator</span>
<span class="sd">%0.2f seconds to generate and execute %d inputs.</span>
<span class="sd">"""</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'\nIt took the structural greybox fuzzer with region mutator\n6.83 seconds to generate and execute 300 inputs.\n'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can see that the structural greybox fuzzer with region-based mutator is slower than the <a href="#Fragment-based-Fuzzing">fragment-based mutator alone</a>. This is because region-based structural mutation is applicable for <em>all seeds</em>. In contrast, fragment-based mutators were applicable only for tiny number of parsable seeds. Otherwise, only (very efficient) byte-level mutators were applied.</p>
<p>Let's also print the average degree of validity for the seeds in the population.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">print_more_stats</span><span class="p">(</span><span class="n">fuzzer</span><span class="p">:</span> <span class="n">GreyboxGrammarFuzzer</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">EarleyParser</span><span class="p">):</span>
    <span class="n">print_stats</span><span class="p">(</span><span class="n">fuzzer</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span>
    <span class="n">validity</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">fuzzer</span><span class="o">.</span><span class="n">population</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">:</span> <span class="k">continue</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">parser</span><span class="o">.</span><span class="n">start_symbol</span><span class="p">())</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">states</span><span class="p">]</span>
        <span class="n">parsable</span> <span class="o">=</span> <span class="n">invalid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">validity</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsable</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"On average, </span><span class="si">%0.1f%%</span><span class="s2"> of a seed in the population can be successfully parsed."</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">validity</span> <span class="o">/</span> <span class="n">total</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">print_more_stats</span><span class="p">(</span><span class="n">regionFuzzer</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From the 300 generated inputs, 11 (3.67%) can be parsed.
In total, 168 statements are covered.
On average, 18.2% of a seed in the population can be successfully parsed.
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. Compared to fragment-based mutation, a greybox fuzzer with region-based mutation achieves <em>higher coverage</em> but generates a <em>smaller number of valid inputs</em>. The higher coverage is explained by leveraging at least <em>some</em> structure for seeds that cannot be parsed successfully.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Focusing-on-Valid-Seeds">Focusing on Valid Seeds</h3><p>In the previous section, we have a problem: The low (degree of) validity.  To address this problem, a <em>validity-based power schedule</em> assigns more <a href="GreyboxFuzzer.html#Power-Schedules">energy</a> to seeds that have a higher degree of validity.  In other words, the fuzzer <em>spends more time fuzzing seeds that are more valid</em>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/math.html" class="import" target="_blank">math</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AFLSmartSchedule</span><span class="p">(</span><span class="n">PowerSchedule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">EarleyParser</span><span class="p">,</span> <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exponent</span> <span class="o">=</span> <span class="n">exponent</span>

    <span class="k">def</span> <span class="nf">parsable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Seed</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns the substring that is parsable"""</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">chart_parse</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">start_symbol</span><span class="p">())</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">states</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">degree_of_validity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Seed</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Returns the proportion of a seed that is parsable"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="s1">'validity'</span><span class="p">):</span>
            <span class="n">seed</span><span class="o">.</span><span class="n">validity</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsable</span><span class="p">(</span><span class="n">seed</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">seed</span><span class="o">.</span><span class="n">validity</span>

    <span class="k">def</span> <span class="nf">assignEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Seed</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">"""Assign exponential energy proportional to degree of validity"""</span>
        <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
            <span class="n">seed</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">degree_of_validity</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">exponent</span>
                           <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's play with the degree of validity by passing in a valid seed ...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">smart_schedule</span> <span class="o">=</span> <span class="n">AFLSmartSchedule</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">%11s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="s2">"Entire seed"</span><span class="p">,</span> <span class="n">simple_seed</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">%11s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="s2">"Parsable"</span><span class="p">,</span> <span class="n">smart_schedule</span><span class="o">.</span><span class="n">parsable</span><span class="p">(</span><span class="n">simple_seed</span><span class="p">)))</span>

<span class="s2">"Degree of validity: </span><span class="si">%0.2f%%</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">smart_schedule</span><span class="o">.</span><span class="n">degree_of_validity</span><span class="p">(</span><span class="n">simple_seed</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Entire seed: &lt;b&gt;Text&lt;/b&gt;
   Parsable: &lt;b&gt;Text&lt;/b&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'Degree of validity: 100.00%'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and an invalid seed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">%11s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="s2">"Entire seed"</span><span class="p">,</span> <span class="n">invalid_seed</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">%11s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="s2">"Parsable"</span><span class="p">,</span> <span class="n">smart_schedule</span><span class="o">.</span><span class="n">parsable</span><span class="p">(</span><span class="n">invalid_seed</span><span class="p">)))</span>

<span class="s2">"Degree of validity: </span><span class="si">%0.2f%%</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">smart_schedule</span><span class="o">.</span><span class="n">degree_of_validity</span><span class="p">(</span><span class="n">invalid_seed</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Entire seed: &lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;&gt;/body&gt;&lt;/html&gt;
   Parsable: &lt;html&gt;&lt;body&gt;&lt;i&gt;World&lt;/i&gt;&lt;br/&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'Degree of validity: 67.44%'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Excellent. We can compute the degree of validity as the proportion of the string that can be parsed.</p>
<p>Let's plug the validity-based power schedule into the structure-aware greybox fuzzer.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">runner</span> <span class="o">=</span> <span class="n">FunctionCoverageRunner</span><span class="p">(</span><span class="n">my_parser</span><span class="p">)</span>
<span class="n">byte_mutator</span> <span class="o">=</span> <span class="n">Mutator</span><span class="p">()</span>
<span class="n">tree_mutator</span> <span class="o">=</span> <span class="n">RegionMutator</span><span class="p">(</span><span class="n">EarleyParser</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> <span class="n">tokens</span><span class="o">=</span><span class="n">XML_TOKENS</span><span class="p">))</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">AFLSmartSchedule</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>

<span class="n">aflsmart_fuzzer</span> <span class="o">=</span> <span class="n">GreyboxGrammarFuzzer</span><span class="p">([</span><span class="n">valid_seed</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">byte_mutator</span><span class="p">,</span> 
                                       <span class="n">tree_mutator</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">aflsmart_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="s2">"It took AFLSmart </span><span class="si">%0.2f</span><span class="s2"> seconds to generate and execute </span><span class="si">%d</span><span class="s2"> inputs."</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x103912720&gt;&gt;
Traceback (most recent call last):
  File "/Users/zeller/.local/lib/python3.12/site-packages/ipykernel/ipkernel.py", line 775, in _clean_thread_parent_frames
    def _clean_thread_parent_frames(

  File "Timeout.ipynb", line 43, in timeout_handler
    }

TimeoutError: 
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>'It took AFLSmart 26.16 seconds to generate and execute 300 inputs.'
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">print_more_stats</span><span class="p">(</span><span class="n">aflsmart_fuzzer</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>From the 300 generated inputs, 9 (3.00%) can be parsed.
In total, 159 statements are covered.
On average, 22.6% of a seed in the population can be successfully parsed.
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong><em>Summary</em></strong>. Indeed, by spending more time fuzzing seeds with a higher degree of validity, we also generate inputs with a higher degree of validity. More inputs are entirely valid w.r.t. the given grammar.</p>
<p><strong><em>Read up</em></strong>. Learn more about region-based fuzzing, deferred parsing, and validity-based schedules in the original AFLSmart paper: "<a href="https://arxiv.org/abs/1811.09447">Smart Greybox Fuzzing</a>" by Pham and co-authors. Download and improve AFLSmart: <a href="https://github.com/aflsmart/aflsmart">https://github.com/aflsmart/aflsmart</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Mining-Seeds">Mining Seeds</h2><p>By now, it should have become clear that the <em>choice of seeds</em> can very much influence the success of fuzzing.  One aspect is <em>variability</em> – our seeds should cover as many different features as possible in order to increase coverage.  Another aspect, however, is the <em>likelihood of a seed to induce errors</em> – that is, if a seed was involved in causing a failure before, then a mutation of this very seed may be likely to induce failures again.  This is because fixes for past failures typically are successful in letting the concrete failure no longer occur, but sometimes may fail to capture all conditions under which a failure may occur.  Hence, even if the original failure is fixed, the likelihood of an error in the <em>surroundings</em> of the original failure-inducing input is still higher.  It thus pays off to use as seeds <em>inputs that are known to have caused failures before</em>.</p>
<p>To put things in context, Holler's <em>LangFuzz</em> fuzzer used as seeds JavaScript inputs from CVE reports.  These were published as failure-inducing inputs at a time when the error already had been fixed; thus they could do no harm anymore.  Yet, by using such inputs as seeds, LangFuzz would create plenty of mutations and recombinations of all their features, many of which would (and do) find errors again and again.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned</h2><ul>
<li><p>A <strong>dictionary</strong> is useful to inject important keywords into the generated inputs.</p>
</li>
<li><p><strong>Fragment-based mutation</strong> first disassembles seeds into fragments, and reassembles these fragments to generate new inputs. A <em>fragment</em> is a subtree in the seed's parse tree. However, fragment-based mutation requires that the seeds can be parsed successfully, which may not be true for seeds discovered by a coverage-based greybox fuzzer.</p>
</li>
<li><p><strong>Region-based mutation</strong> marks regions in the input as belonging to a certain symbol in the grammar. For instance, it may identify a substring '&lt;/a&gt;' as closing tag. These regions can then be deleted or substituted by fragments or regions belonging to the same symbol. Unlike fragment-based mutation, region-based mutation is applicable to <em>all</em> seeds - even those that can be parsed only partially. However, the degree of validity is still quite low for the generated inputs.</p>
</li>
<li><p>A <strong>validity-based power schedule</strong> invests more energy into seeds with a higher degree of validity. The inputs that are generated also have a higher degree of validity.</p>
</li>
<li><p><strong>Mining seeds</strong> from repositories of previous failure-inducing inputs results in input fragments associated with past failures, raising the likelihood to find more failures in the vicinity.</p>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background</h2><p>This chapter builds on the following two works:</p>
<ul>
<li><p>The <em>LangFuzz</em> fuzzer [<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf">Holler <em>et al</em>, 2012</a>] is an efficient (and effective!) grammar-based fuzzer for (mostly) JavaScript.  It uses the grammar for parsing seeds and recombining their inputs with generated parts and found 2,600 bugs in JavaScript interpreters to date.</p>
</li>
<li><p>Smart greybox fuzzing (<a href="https://github.com/aflsmart/aflsmart">AFLSmart</a>) brings together coverage-based fuzzing and grammar-based (structural) fuzzing, as described in [<a href="https://arxiv.org/abs/1811.09447">Van-Thuan Pham <em>et al</em>, 2018</a>].  The resulting AFLSMART tool has discovered 42 zero-day vulnerabilities in widely-used, well-tested tools and libraries; so far 17 CVEs were assigned.</p>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Recent fuzzing work also brings together grammar-based fuzzing and coverage.</p>
<ul>
<li><p><em>Superion</em> [<a href="https://2019.icse-conferences.org/event/icse-2019-technical-papers-superion-grammar-aware-greybox-fuzzing">Junjie Wang <em>et al</em>, 2019</a>] is equivalent to our section "Integration with Greybox Fuzzing", as above – that is, a combination of LangFuzz and Greybox Fuzzing, but no AFL-style byte-level mutation.  Superion can improve the code coverage (i.e., 16.7% and 8.8% in line and function coverage) and bug-finding capability over AFL and jsfunfuzz.  According to the authors, they found 30 new bugs, among which they discovered 21 new vulnerabilities with 16 CVEs assigned and 3.2K USD bug bounty rewards received.</p>
</li>
<li><p><em>Nautilus</em> [<a href="https://www.ndss-symposium.org/ndss-paper/nautilus-fishing-for-deep-bugs-with-grammars/">Cornelius Aschermann <em>et al</em>, 2019</a>] also combines grammar-based fuzzing with coverage feedback.  It maintains the parse tree for all seeds and generated inputs. To allow AFL-style byte-level mutations, it "collapses" subtrees back to byte-level representations.  This has the advantage of not having to re-parse generated seeds; however, over time, Nautilus degenerates to structure-unaware greybox fuzzing because it does not re-parse collapsed subtrees to reconstitute input structure for later seeds where most of the parse tree is collapsed.  Nautilus identified bugs in mruby, PHP, ChakraCore, and in Lua; reporting these bugs was awarded with a sum of 2600 USD and 6 CVEs were assigned.</p>
</li>
<li><p><a href="https://uds-se.github.io/FormatFuzzer/">FormatFuzzer</a> is a framework for high-efficiency, high-quality generation and parsing of binary inputs. It takes a binary template that describes the format of a binary input and generates an executable that produces and parses the given binary format. From a binary template for GIF, for instance, FormatFuzzer produces a GIF generator - also known as GIF fuzzer. Generators produced by FormatFuzzer are highly efficient, producing thousands of valid test inputs per second. FormatFuzzer operates in black-box settings, but can also integrate with AFL to produce valid inputs that also aim for maximum coverage.</p>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps</h2><p>This chapter closes our discussion of syntactic fuzzing techniques.</p>
<ul>
<li>In the <a href="Reducer.html">next chapter</a>, we discuss how to <em>reduce failure-inducing inputs</em> after a failure, keeping only those portions of the input that are necessary for reproducing the failure.</li>
<li>The <a href="04_Semantical_Fuzzing.html">next part</a> will go from syntactical to <em>semantical</em> fuzzing, considering code semantics for targeted test generation.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises</h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-The-Big-Greybox-Fuzzer-Shoot-Out">Exercise 1: The Big Greybox Fuzzer Shoot-Out</h3><p>Use our implementations of greybox techniques and evaluate them on a benchmark.  Which technique (and which sub-technique) has which impact and why?  Also take into account the specific approaches of Superion [<a href="https://2019.icse-conferences.org/event/icse-2019-technical-papers-superion-grammar-aware-greybox-fuzzing">Junjie Wang <em>et al</em>, 2019</a>] and Nautilus [<a href="https://www.ndss-symposium.org/ndss-paper/nautilus-fishing-for-deep-bugs-with-grammars/">Cornelius Aschermann <em>et al</em>, 2019</a>], possibly even on the benchmarks used by these approaches.</p>

    
<p/><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GreyboxGrammarFuzzer.ipynb#Exercises" target="_blank">Use the notebook</a> to work on the exercises and see solutions.</div>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="../Images/2f3faa36146c6fb38bbab67add09aa5f.png" alt="Creative Commons License" data-original-src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/>
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/fuzzingbook/commits/master/notebooks/GreyboxGrammarFuzzer.ipynb" target="_blank)">Last change: 2024-01-21 13:07:50+01:00</a> • 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> •
<a href="https://cispa.de/en/impressum" target="_blank">Imprint</a>
</p>



<div id="citation" class="citation" style="display: none;">
<a name="citation"/>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler: "<a href="https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html">Greybox Fuzzing with Grammars</a>".  In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler, "<a href="https://www.fuzzingbook.org/">The Fuzzing Book</a>", <a href="https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html">https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html</a>.  Retrieved 2024-01-21 13:07:50+01:00.
</p>
<pre>
@incollection{fuzzingbook2024:GreyboxGrammarFuzzer,
    author = {Andreas Zeller and Rahul Gopinath and Marcel B{\"o}hme and Gordon Fraser and Christian Holler},
    booktitle = {The Fuzzing Book},
    title = {Greybox Fuzzing with Grammars},
    year = {2024},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html}},
    note = {Retrieved 2024-01-21 13:07:50+01:00},
    url = {https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html},
    urldate = {2024-01-21 13:07:50+01:00}
}
</pre>
</div>

          
</body>
</html>