<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Secure Random Generators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Secure Random Generators</h1>
<blockquote>原文：<a href="https://cryptobook.nakov.com/secure-random-generators">https://cryptobook.nakov.com/secure-random-generators</a></blockquote><header class="max-w-3xl page-width-wide:max-w-screen-2xl mx-auto mb-6 space-y-3 page-api-block:ml-0 page-api-block:max-w-full page-no-ancestors"><div class="flex h-fit items-stretch justify-start overflow-hidden *:translate-y-0! *:shadow-none! [&amp;&gt;*:not(:first-child)]:border-l-0 [&amp;&gt;*:not(:first-child,:last-child)]:rounded-none! [&amp;&gt;*:not(:only-child):first-child]:rounded-r-none [&amp;&gt;*:not(:only-child):last-child]:rounded-l-none float-right ml-4 xl:max-2xl:page-api-block:mr-62 -mt-3 xs:mt-2"><button type="button" class="button group/button inline-flex items-center gap-2 rounded-md straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 contrast-more:border-tint-12 contrast-more:hover:border-2 contrast-more:hover:border-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:depth-flat:bg-tint-hover hover:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 py-1 px-2 bg-tint-base text-sm" aria-label="Copy page" data-state="closed"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/copy.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/copy.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon button-leading-icon size-[1em] shrink-0"/><span class="button-content truncate">Copy</span></button><button type="button" class="button group/button inline-flex items-center gap-2 rounded-md straight-corners:rounded-none circular-corners:rounded-3xl border border-tint hover:border-tint-hover disabled:border-tint depth-subtle:shadow-xs hover:depth-subtle:shadow-md focus-visible:depth-subtle:shadow-md active:depth-subtle:shadow-xs shadow-tint/6 dark:shadow-tint-1 contrast-more:border-tint-12 contrast-more:hover:border-2 contrast-more:hover:border-tint-12 hover:depth-subtle:-translate-y-px focus-visible:depth-subtle:-translate-y-px data-[state=open]:depth-subtle:-translate-y-px active:depth-subtle:translate-y-0 transition-all grow-0 shrink-0 truncate max-w-full disabled:cursor-not-allowed disabled:translate-y-0! disabled:shadow-none! depth-flat:bg-transparent text-tint hover:bg-tint-hover hover:depth-flat:bg-tint-hover hover:text-tint contrast-more:bg-tint-subtle disabled:bg-transparent disabled:text-tint/8 py-1 px-1.5 group/dropdown bg-tint-base text-sm" aria-label="More" id="radix-_R_8mqav5ukqiv5ubsnpfivb_" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/chevron-down.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/chevron-down.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon button-leading-icon shrink-0 size-3 transition-transform group-data-[state=open]/button:rotate-180"/></button></div></header><div class="flex flex-col [&amp;&gt;*+*]:mt-5 whitespace-pre-wrap"><h2 id="secure-random-number-generators-prng-and-csprng" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="#secure-random-number-generators-prng-and-csprng"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-tight">Secure Random Number Generators, PRNG and CSPRNG</div></h2><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">In cryptography the <strong class="font-bold">randomness</strong> (entropy) plays very important role. In many algorithms, we need <strong class="font-bold">random (i.e. unpredictable) numbers</strong>. If these numbers are not unpredictable, the algorithms will be compromised.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">For example, assume we need a <strong class="font-bold">secret key</strong>, that will protect our financial assets. This secret key should be <strong class="font-bold">randomly generated</strong> in a way that nobody else should be able to generate or have the same key. If we generate the key from a <strong class="font-bold">secure random generator</strong>, the it will be <strong class="font-bold">unpredictable</strong> and the system will be secure. Therefore "secure random" means simply "<strong class="font-bold">unpredictable random</strong>".</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Let's discuss in bigger detail the <strong class="font-bold">random numbers</strong> in computer science and their role in <strong class="font-bold">cryptography</strong>, as well as pseudo-random numbers generators (<strong class="font-bold">PRNG</strong>), secure pseudo-random generators (<strong class="font-bold">CSPRNG</strong>) and some guidelines about how developers should generate and use random numbers in their code.</p><h2 id="random-generators" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="#random-generators"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-tight">Random Generators</div></h2><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">In computer science <strong class="font-bold">random numbers</strong> usually come from a <strong class="font-bold">pseudo-random number generators</strong> (PRNG), initialized by some unpredictable initial randomness (<strong class="font-bold">entropy</strong>). In cryptography secure PRNGs are used, known as <strong class="font-bold">CSPRNG</strong>, which typically combined entropy with PRNG and other techniques to make the generated randomness <strong class="font-bold">unpredictable</strong>.</p><h3 id="pseudo-random-number-generators-prng" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#pseudo-random-number-generators-prng"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Pseudo-Random Number Generators (PRNG)</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">A pseudorandom number generator (<strong class="font-bold">PRNG</strong>) is used to stretch a small amount of <strong class="font-bold">initial randomness</strong>
into a large amount of <strong class="font-bold">pseudorandomness</strong>, typically for use in cryptosystems. Note than <strong class="font-bold">PRNGs</strong> are not cryptographically secure and are different from <strong class="font-bold">CSPRNGs</strong>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start"><strong class="font-bold">PRNGs</strong> are functions that start from some <strong class="font-bold">initial entropy</strong> (seed) and calculate the next random number by some calculation which is unpredictable without knowing the seed. Such calculations are called <strong class="font-bold">pseudo-random functions</strong>.</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="eager" class="block" src="../Images/83ab05f0542fe6b1dcf148792500c486.png" srcset="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=400&amp;dpr=1&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 400w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=400&amp;dpr=2&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 800w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=400&amp;dpr=3&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 1200w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=400&amp;dpr=4&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 1600w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=768&amp;dpr=1&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 768w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=768&amp;dpr=2&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 1536w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 2304w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=1fb966cc&amp;sv=2 3072w" sizes="(max-width: 640px) 400px, 768px" width="820" height="102" data-original-src="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6c9f51a3b575622e47fb7cc4b35f76968e5508ff%252Fpseudo-random-function.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=1fb966cc&amp;sv=2"/></div></div></div></div><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Pseudo-random functions (which are not secure for cryptography) usually use an internal <strong class="font-bold">state</strong>. At the start, the state is initialized by an <strong class="font-bold">initial seed</strong>. When the <strong class="font-bold">next random number</strong> is generated, it is calculated from the internal state (using some computation or formula), then the internal <strong class="font-bold">state</strong> of the pseudo-random function is changed (using some computation or formula). When the <strong class="font-bold">next random number</strong> is generated, it is again calculated based on the internal <strong class="font-bold">state</strong> of the function and this state is again changed and so on.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">This process in its simplest form can be implemented as follows:</p><!--$?--><template id="B:2"/><!--/$--><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Of course, the <strong class="font-bold">HMAC</strong> function can be changed by some <strong class="font-bold">cryptographic hash</strong> function or another mathematical transformation like the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Mersenne_Twister"><strong class="font-bold">Mersenne Twister</strong><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a> (which is not cryptographically secure), but the main idea stays the same: pseudo-random generators have internal <strong class="font-bold">state</strong>, initialized with some <strong class="font-bold">initial randomness</strong> and over the time <strong class="font-bold">change</strong> their internal state and <strong class="font-bold">generate pseudo-random numbers</strong>, based on the current state.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Good random number generators should be <strong class="font-bold">fast</strong> and should generate <strong class="font-bold">statistical randomness</strong> (see the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Diehard_tests">Diehard tests<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>), i.e. all numbers should have the same chance to be generated over the time. This is not sufficient cryptography, so CSPRNG have higher requirements.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">The above idea to generate random pseudo-numbers based on <strong class="font-bold">HMAC(key + counter)</strong>, with some complications, is known as the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://www.cs.cmu.edu/~kqy/resources/thesis.pdf"><strong class="font-bold">HMAC_DRGB algorithm</strong><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>, described in the security standard <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-90a.pdf">NIST 800-90A<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>.</p><h3 id="initial-entropy-seed" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#initial-entropy-seed"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Initial Entropy (Seed)</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">To be secure, a <strong class="font-bold">PRNG</strong> (which is statistically random) should start by a <strong class="font-bold">truly random initial seed</strong>, which is absolutely <strong class="font-bold">unpredictable</strong>. If the seed is predictable, it will generate predictable sequence of random numbers and the entire random generation process will be <strong class="font-bold">insecure</strong>. That's why having unpredictable randomness at the start (secure seed) is very important.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">How to initialize the pseudo-random generator in a secure way? The answer is simple: <strong class="font-bold">collect randomness (entropy)</strong>.</p><h3 id="entropy" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#entropy"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Entropy</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">In computer science "<strong class="font-bold">entropy</strong>" means <strong class="font-bold">unpredictable randomness</strong>, and is usually measured in bits. For example, if you move your computer's mouse, it will generate some hard-to-predict events, like the start location and the end location of the mouse cursor. If we assume that the mouse has changed its position in the range of [0...255] pixels, the entropy collected from this mouse movement should be about 8 bits (because 2^8 = 255). Another example: if the user is asked to think of a number in the range [0...1000], this number will hold about 9-10 bits of entropy (because 2^10 = 1024). To collect 256 bits of entropy (e.g. to securely generate a 256-bit integer), you will need to take into account a sequence of several such events (like mouse movements and keyboard interracions from the user).</p><h3 id="collecting-entropy" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#collecting-entropy"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Collecting Entropy</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Entropy can be collected from many <strong class="font-bold">hard-to-predict events</strong> in the computer: keyboard clicks, mouse moves, network activity, camera activity, microphone activity and others, combined with the time at which they occur. This collection of initial randomness is usually performed internally by the <strong class="font-bold">operating system</strong> (OS), which provides standard <strong class="font-bold">API</strong> to access it (e.g. reading from the <code class="py-px px-1.5 min-w-6.5 justify-center items-center ring-1 ring-inset ring-tint bg-tint rounded-sm text-[.875em] leading-[calc(max(1.20em,1.25rem))]">/dev/random</code> file in Linux). In desktop system, laptop or mobile phone entropy is easy to collect, while on some limited hardware devices (such as simple microcontrollers) entropy is hard or impossible to be collected.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Application software can <strong class="font-bold">collect entropy explicitly</strong>, by asking the user to move the mouse, type something at the keyboard, say something at the microphone or move in front of the camera for a while. A great example of this is the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://www.bitaddress.org"><strong class="font-bold">bitaddress.org</strong><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a> wallet app, which combines mouse moves with keyboard events to collect entropy:</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="../Images/43a37b389a0982f1917b781403f56083.png" srcset="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=400&amp;dpr=1&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 400w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=400&amp;dpr=2&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 800w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=400&amp;dpr=3&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 1200w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=400&amp;dpr=4&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 1600w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=768&amp;dpr=1&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 768w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=768&amp;dpr=2&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 1536w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 2304w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2 3072w" sizes="(max-width: 640px) 400px, 768px" width="1544" height="892" data-original-src="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-6e85654924ba8a4a0d1fb41386398f7187e98e98%252Fbitaddress-entropy.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=7e1da1a2&amp;sv=2"/></div></div></div></div><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Once enough entropy is collected, it is used to initialize the random generator.</p><h3 id="insecure-randomness" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#insecure-randomness"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Insecure Randomness</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Insecure / compromised randomness can compromise cryptography. A good example to learn from is the story of the stolen Bitcoins, due to <strong class="font-bold">broken random generator in Android</strong>: <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://goo.gl/PFE1kr">https://goo.gl/PFE1kr<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>. That's why developers should care about randomness, when they use cryptography and ensure their <strong class="font-bold">random generators are secure</strong>.</p><h3 id="insecure-randomness-examples" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#insecure-randomness-examples"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Insecure Randomness - Examples</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">As example how easy it is to <strong class="font-bold">compromise the random number security in Python</strong> (in its old versions), we shall give this code example:</p><!--$?--><template id="B:3"/><!--/$--><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Run the above code example: <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://repl.it/@nakov/Random-in-Python">https://repl.it/@nakov/Random-in-Python<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">The above code is assumed to generate a random number, but this number may be <strong class="font-bold">predictable</strong>. This is because the <code class="py-px px-1.5 min-w-6.5 justify-center items-center ring-1 ring-inset ring-tint bg-tint rounded-sm text-[.875em] leading-[calc(max(1.20em,1.25rem))]">random</code> library in Python (in its old versions) initializes the random generator <strong class="font-bold">seed</strong> by the <strong class="font-bold">current time</strong>. Thus, if you know the current time at the machine generating the random number (obviously you know this roughly), you will be able to predict the random seed and to predict the random numbers generated.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">To better illustrate this, look at this more explicit example which generates two random 50-digit integers:</p><!--$?--><template id="B:4"/><!--/$--><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Run the above code example: <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://repl.it/@nakov/Random-with-seed-in-Python">https://repl.it/@nakov/Random-with-seed-in-Python<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">The above code will print <strong class="font-bold">two equal numbers</strong>, both depending on the current time. It is obvious that the same time in the initial seed causes the same (predictable) pseudo-random numbers to be generated in the output. This is a sample output of the above code:</p><!--$?--><template id="B:5"/><!--/$--><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">If you run this code through a <strong class="font-bold">debugger</strong> or in a slow environment, the produced numbers may be <strong class="font-bold">different</strong>, due to <strong class="font-bold">time change</strong> between the two random generation executions. Typically the Python interpreter at the <strong class="font-bold">interactive console</strong> produces two <strong class="font-bold">different numbers</strong>. To obtain the result, similar to the above, first save the code in a script file (e.g. <code class="py-px px-1.5 min-w-6.5 justify-center items-center ring-1 ring-inset ring-tint bg-tint rounded-sm text-[.875em] leading-[calc(max(1.20em,1.25rem))]">insecure-rnd.py</code>) and then execute the Python script file:</p><div class="mx-auto page-width-wide:mx-0 decoration-primary/6 max-w-3xl print:break-inside-avoid page-width-wide:max-w-full page-api-block:ml-0 flex w-full justify-center"><div class="flex flex-row gap-3"><div class="relative overflow-hidden"><div class="relative overflow-hidden after:block after:absolute after:-inset-0 after:pointer-events-none w-fit"><img data-testid="zoom-image" alt="" style="max-width:100%;height:auto" loading="lazy" class="block" src="../Images/fa14489f7e1f7c7e15b1c7d4f63831d8.png" srcset="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=400&amp;dpr=1&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 400w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=400&amp;dpr=2&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 800w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=400&amp;dpr=3&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 1200w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=400&amp;dpr=4&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 1600w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=768&amp;dpr=1&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 768w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=768&amp;dpr=2&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 1536w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=768&amp;dpr=3&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 2304w, https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=fad43ef3&amp;sv=2 3072w" sizes="(max-width: 640px) 400px, 768px" width="717" height="455" data-original-src="https://cryptobook.nakov.com/~gitbook/image?url=https%3A%2F%2F795243796-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-LhlOQMrG9bRiqWpegM0%252Fuploads%252Fgit-blob-19e84a26f60dfd1c0710d088e8d18458c7aa3762%252Finsecure-rnd-python-demo.png%3Falt%3Dmedia&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=fad43ef3&amp;sv=2"/></div></div></div></div><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Basically, when the initial random seed is initialized with a predictable number like the current time, crackers can <strong class="font-bold">try all possibilities within the range of +/- 5 seconds</strong> and find the exact initial seed and then compromise the security.</p><h2 id="randomness-and-cryptography" class="text-xl @xs:text-2xl @lg:text-3xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[1em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-tight" aria-label="Direct link to heading" href="#randomness-and-cryptography"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-tight">Randomness and Cryptography</div></h2><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Remember that <strong class="font-bold">cryptography cannot work without unpredictable randomness</strong>! If your random generator is compromised, it will generate predictable numbers and crackers will be able to decrypt your communication, reveal your private keys, tamper your digital signatures, etc. As a developer, you should always care how random numbers are generated in the cryptographic libraries you use.</p><h3 id="csprng-cryptography-secure-random-number-generators" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#csprng-cryptography-secure-random-number-generators"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">CSPRNG (Cryptography Secure Random Number Generators)</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">By definition <strong class="font-bold">CSPRNG</strong> (Cryptography Secure Random Number Generators) are a pseudo-random number generators (PRNG) with properties that make them <strong class="font-bold">suitable for use in cryptography</strong>. There are two major requirements for a PRNG to be a CSPRNG:</p><ul class="min-w-0 space-y-2 mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl page-api-block:ml-0"><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start">Satisfy the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Next-bit_test"><strong class="font-bold">next-bit test</strong><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>: if someone knows all <strong class="font-bold">k</strong> bits from the start of the PRNG, he would be unable to predict the bit <strong class="font-bold">k+1</strong> using reasonable computing resources.</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start">Withstand the <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://www.owasp.org/index.php/PRNG_state_compromise_extension_attack"><strong class="font-bold">state compromise extensions</strong><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>: if an attacker guesses the internal state of the PRNG or it is revealed somehow, the attacker should be unable to reconstruct all previous random numbers prior to the revelation.</p></div></li></ul><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">The <strong class="font-bold">entropy</strong> in the operating system is usually of <strong class="font-bold">limited amount</strong> and waiting for more entropy is slow and unpractical. Most cryptographic applications use <strong class="font-bold">CSPRNG</strong>, which "stretch" the available entropy from the operating system into <strong class="font-bold">more bits</strong>, required for cryptographic purposes and comply to the above CSPRNG requirements.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Many design have been proposed to construct CSPRNG algorithms:</p><ul class="min-w-0 space-y-2 mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl page-api-block:ml-0"><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">CSPRNG</strong> based on secure <strong class="font-bold">block ciphers</strong> in counter mode, on <strong class="font-bold">stream ciphers</strong> or on secure <strong class="font-bold">secure hash functions</strong>.</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">CSPRNG</strong> based on number theory, relying on the difficulty of the integer factorization problem (IFP), the discrete logarithm problem (DLP) or the elliptic-curve discrete logarithm problem (ECDLP).</p></div></li><li class="leading-normal flex items-start"><div class="text-base leading-normal mr-1 flex min-h-lh min-w-6 items-center justify-center text-tint"><div class="before:font-var before:content-(--pseudoBefore--content)" style="--pseudoBefore--content:'•';--font-family:Arial;font-size:min(1.5em, 24px);line-height:1"/></div><div class="flex min-w-0 flex-1 flex-col space-y-2"><p class="page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid min-h-lh [h2]:pt-0 [h3]:pt-0 [h4]:pt-0 mx-0 text-start self-start"><strong class="font-bold">CSPRNG</strong> based on special design for cryptographic secure randomness, such as <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Yarrow_algorithm">Yarrow algorithm<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a> and <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://en.wikipedia.org/wiki/Fortuna_%28PRNG%29">Fortuna<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>, which were used in MacOS and and FreeBSD.</p></div></li></ul><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Most <strong class="font-bold">CSPRNG</strong> use a combination of <strong class="font-bold">entropy</strong> from the operating system and high-quality <strong class="font-bold">PRNG</strong> generator and they often "<strong class="font-bold">reseed</strong>", which means that when new entropy comes from the OS (e.g. from user input, system interruptions, disk I/O or hardware random generators), the underlying PRNG changes its internal state based on the new entropy bits coming. This constant reseeding over the time makes the CSPRNG really hard to predict and analyse.</p><h3 id="conclusion-use-secure-random-generator" class="text-lg @xs:text-xl @lg:text-2xl font-semibold heading flex items-baseline scroll-mt-(--content-scroll-margin) text-start self-start relative group/hash mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 column-first-of-type:pt-0 pt-[0.75em]"><div class="relative hash grid grid-area-1-1 h-[1em] border-0 opacity-0 site-background rounded group-hover/hash:opacity-[0] group-focus/hash:opacity-[0] md:group-hover/hash:opacity-[1] md:group-focus/hash:opacity-[1] -ml-6 pr-2 [.flip-heading-hash_&amp;]:order-last [.flip-heading-hash_&amp;]:ml-1 [.flip-heading-hash_&amp;]:pl-2"><a class="inline-flex h-full items-start leading-snug" aria-label="Direct link to heading" href="#conclusion-use-secure-random-generator"><svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/hashtag.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon self-center transition-colors text-transparent group-hover/hash:text-tint-subtle contrast-more:group-hover/hash:text-tint-strong size-4"/></a></div><div class="flex-1 z-1 justify-self-start max-w-full break-words text-start self-start leading-snug">Conclusion: Use Secure Random Generator</div></h3><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Always use <strong class="font-bold">cryptographically secure random generator libraries</strong>, like the <code class="py-px px-1.5 min-w-6.5 justify-center items-center ring-1 ring-inset ring-tint bg-tint rounded-sm text-[.875em] leading-[calc(max(1.20em,1.25rem))]">java.security.SecureRandom</code> in Java and the <code class="py-px px-1.5 min-w-6.5 justify-center items-center ring-1 ring-inset ring-tint bg-tint rounded-sm text-[.875em] leading-[calc(max(1.20em,1.25rem))]">secrets</code> library in Python:</p><!--$?--><template id="B:6"/><!--/$--><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">Run the above code example: <a class="underline decoration-[max(0.07em,1px)] underline-offset-2 links-accent:underline-offset-4 links-default:decoration-primary/6 links-default:text-primary-subtle hover:links-default:text-primary-strong contrast-more:links-default:text-primary contrast-more:hover:links-default:text-primary-strong links-accent:decoration-primary-subtle hover:links-accent:decoration-[3px] hover:links-accent:[text-decoration-skip-ink:none] transition-all duration-100" data-state="closed" href="https://repl.it/@nakov/Secrets-in-Python">https://repl.it/@nakov/Secrets-in-Python<svg style="mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);-webkit-mask-image:url(https://ka-p.fontawesome.com/releases/v6.6.0/svgs/regular/arrow-up-right.svg?v=2&amp;token=a463935e93);mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center;-webkit-mask-position:center;background-color:currentColor" class="gb-icon ml-0.5 inline size-3 links-accent:text-tint-subtle"/></a>.</p><p class="mx-auto page-width-wide:mx-0 w-full decoration-primary/6 max-w-3xl print:break-inside-avoid page-api-block:ml-0 text-start self-start">The above code does not depend on the current time and basically generates an <strong class="font-bold">unpredictable random number</strong>, based on the entropy collected by the operating system.</p></div>    
</body>
</html>