["```py\nfrom [bookutils](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) import YouTubeVideo\nYouTubeVideo(\"ddM1oL2LYDI\") \n```", "```py\n>>> from [fuzzingbook.GrammarMiner](GrammarMiner.html) import <identifier> \n```", "```py\n>>> url_parse('https://www.fuzzingbook.org/')\n>>> URLS\n['http://user:pass@www.google.com:80/?q=path#ref',\n 'https://www.cispa.saarland:80/',\n 'http://www.fuzzingbook.org/#News'] \n```", "```py\n>>> grammar = recover_grammar(url_parse, URLS, files=['urllib/parse.py'])\n>>> grammar\n{'<start>': ['<urlsplit@452:url>'],\n '<urlsplit@452:url>': ['<urlparse@396:scheme>:<_splitnetloc@413:url>'],\n '<urlparse@396:scheme>': ['http', 'https'],\n '<_splitnetloc@413:url>': ['//<urlparse@396:netloc>/',\n  '//<urlparse@396:netloc><urlsplit@494:url>'],\n '<urlparse@396:netloc>': ['www.cispa.saarland:80',\n  'www.fuzzingbook.org',\n  'user:pass@www.google.com:80'],\n '<urlsplit@494:url>': ['<urlsplit@502:url>#<urlparse@396:fragment>',\n  '/#<urlparse@396:fragment>'],\n '<urlsplit@502:url>': ['/?<urlparse@396:query>'],\n '<urlparse@396:query>': ['q=path'],\n '<urlparse@396:fragment>': ['News', 'ref']} \n```", "```py\n>>> syntax_diagram(grammar)\nstart \n```", "```py\nurlsplit@452:url\n```", "```py\nurlparse@396:scheme\n```", "```py\n_splitnetloc@413:url\n```", "```py\nurlparse@396:netloc\n```", "```py\nurlsplit@494:url\n```", "```py\nurlsplit@502:url\n```", "```py\nurlparse@396:query\n```", "```py\nurlparse@396:fragment\n```", "```py\n>>> from [GrammarCoverageFuzzer](GrammarCoverageFuzzer.html) import GrammarCoverageFuzzer\n>>> fuzzer = GrammarCoverageFuzzer(grammar)\n>>> [fuzzer.fuzz() for i in range(5)]\n['https://www.cispa.saarland:80/#ref',\n 'http://www.fuzzingbook.org/',\n 'http://user:pass@www.google.com:80/?q=path#News',\n 'https://www.fuzzingbook.org/?q=path#ref',\n 'http://www.cispa.saarland:80/#News'] \n```", "```py\nimport [bookutils.setup](https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils) \n```", "```py\nfrom [typing](https://docs.python.org/3/library/typing.html) import List, Tuple, Callable, Any\nfrom [collections.abc](https://docs.python.org/3/library/collections.abc.html) import Iterable \n```", "```py\nfrom [Parser](Parser.html) import process_inventory, process_vehicle, process_car, process_van, lr_graph  # minor dependency \n```", "```py\nINVENTORY = \"\"\"\\\n1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture\\\n\"\"\" \n```", "```py\nprint(process_inventory(INVENTORY)) \n```", "```py\nWe have a Ford E350 van from 1997 vintage.\nIt is an old but reliable model!\nWe have a Mercury Cougar car from 2000 vintage.\nIt is an old but reliable model!\nWe have a Chevy Venture car from 1999 vintage.\nIt is an old but reliable model!\n\n```", "```py\nVEHICLES = INVENTORY.split('\\n') \n```", "```py\nINVENTORY_METHODS = {\n    'process_inventory',\n    'process_vehicle',\n    'process_van',\n    'process_car'} \n```", "```py\nfrom [Coverage](Coverage.html) import Coverage \n```", "```py\nimport [inspect](https://docs.python.org/3/library/inspect.html) \n```", "```py\nclass Tracer(Coverage):\n    def traceit(self, frame, event, arg):\n        method_name = inspect.getframeinfo(frame).function\n        if method_name not in INVENTORY_METHODS:\n            return\n        file_name = inspect.getframeinfo(frame).filename\n\n        param_names = inspect.getargvalues(frame).args\n        lineno = inspect.getframeinfo(frame).lineno\n        local_vars = inspect.getargvalues(frame).locals\n        print(event, file_name, lineno, method_name, param_names, local_vars)\n        return self.traceit \n```", "```py\nwith Tracer() as tracer:\n    process_vehicle(VEHICLES[0]) \n```", "```py\ncall Parser.ipynb 29 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350'}\nline Parser.ipynb 30 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350'}\nline Parser.ipynb 31 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}\nline Parser.ipynb 32 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}\ncall Parser.ipynb 40 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline Parser.ipynb 40 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline Parser.ipynb 41 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline Parser.ipynb 42 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.']}\nline Parser.ipynb 43 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.'], 'iyear': 1997}\nline Parser.ipynb 46 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.'], 'iyear': 1997}\nline Parser.ipynb 47 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.', 'It is an old but reliable model!'], 'iyear': 1997}\nreturn Parser.ipynb 47 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.', 'It is an old but reliable model!'], 'iyear': 1997}\nreturn Parser.ipynb 32 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}\n\n```", "```py\nclass Context:\n    def __init__(self, frame, track_caller=True):\n        self.method = inspect.getframeinfo(frame).function\n        self.parameter_names = inspect.getargvalues(frame).args\n        self.file_name = inspect.getframeinfo(frame).filename\n        self.line_no = inspect.getframeinfo(frame).lineno\n\n    def _t(self):\n        return (self.file_name, self.line_no, self.method,\n                ','.join(self.parameter_names))\n\n    def __repr__(self):\n        return \"%s:%d:%s(%s)\" % self._t() \n```", "```py\nclass Context(Context):\n    def extract_vars(self, frame):\n        return inspect.getargvalues(frame).locals\n\n    def parameters(self, all_vars):\n        return {k: v for k, v in all_vars.items() if k in self.parameter_names}\n\n    def qualified(self, all_vars):\n        return {\"%s:%s\" % (self.method, k): v for k, v in all_vars.items()} \n```", "```py\ndef log_event(event, var):\n    print({'call': '->', 'return': '<-'}.get(event, '  '), var) \n```", "```py\nclass Tracer(Tracer):\n    def traceit(self, frame, event, arg):\n        log_event(event, Context(frame))\n        return self.traceit \n```", "```py\nwith Tracer() as tracer:\n    process_vehicle(VEHICLES[0]) \n```", "```py\n-> Parser.ipynb:29:process_vehicle(vehicle)\n   Parser.ipynb:30:process_vehicle(vehicle)\n   Parser.ipynb:31:process_vehicle(vehicle)\n   Parser.ipynb:32:process_vehicle(vehicle)\n-> Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:41:process_van(year,company,model)\n   Parser.ipynb:42:process_van(year,company,model)\n   Parser.ipynb:43:process_van(year,company,model)\n   Parser.ipynb:46:process_van(year,company,model)\n   Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:32:process_vehicle(vehicle)\n-> Coverage.ipynb:102:__exit__(self,exc_type,exc_value,tb)\n   Coverage.ipynb:105:__exit__(self,exc_type,exc_value,tb)\n\n```", "```py\nclass Tracer(Tracer):\n    def __init__(self, my_input, **kwargs):\n        self.options(kwargs)\n        self.my_input, self.trace = my_input, [] \n```", "```py\nclass Tracer(Tracer):\n    def options(self, kwargs):\n        self.files = kwargs.get('files', [])\n        self.methods = kwargs.get('methods', [])\n        self.log = log_event if kwargs.get('log') else lambda _evt, _var: None \n```", "```py\nclass Tracer(Tracer):\n    def tracing_context(self, cxt, event, arg):\n        fres = not self.files or any(\n            cxt.file_name.endswith(f) for f in self.files)\n        mres = not self.methods or any(cxt.method == m for m in self.methods)\n        return fres and mres \n```", "```py\nclass Tracer(Tracer):\n    def tracing_var(self, k, v):\n        return isinstance(v, str) \n```", "```py\nclass Tracer(Tracer):\n    def on_event(self, event, arg, cxt, my_vars):\n        self.trace.append((event, arg, cxt, my_vars))\n\n    def create_context(self, frame):\n        return Context(frame)\n\n    def traceit(self, frame, event, arg):\n        cxt = self.create_context(frame)\n        if not self.tracing_context(cxt, event, arg):\n            return self.traceit\n        self.log(event, cxt)\n\n        my_vars = {\n            k: v\n            for k, v in cxt.extract_vars(frame).items()\n            if self.tracing_var(k, v)\n        }\n        self.on_event(event, arg, cxt, my_vars)\n        return self.traceit \n```", "```py\nwith Tracer(VEHICLES[0], methods=INVENTORY_METHODS, log=True) as tracer:\n    process_vehicle(VEHICLES[0]) \n```", "```py\n-> Parser.ipynb:29:process_vehicle(vehicle)\n   Parser.ipynb:30:process_vehicle(vehicle)\n   Parser.ipynb:31:process_vehicle(vehicle)\n   Parser.ipynb:32:process_vehicle(vehicle)\n-> Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:41:process_van(year,company,model)\n   Parser.ipynb:42:process_van(year,company,model)\n   Parser.ipynb:43:process_van(year,company,model)\n   Parser.ipynb:46:process_van(year,company,model)\n   Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:32:process_vehicle(vehicle)\n\n```", "```py\nfor t in tracer.trace:\n    print(t[0], t[2].method, dict(t[3])) \n```", "```py\ncall process_vehicle {'vehicle': '1997,van,Ford,E350'}\nline process_vehicle {'vehicle': '1997,van,Ford,E350'}\nline process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}\nline process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}\ncall process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nline process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nreturn process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}\nreturn process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}\n\n```", "```py\nwith Tracer(VEHICLES[0], methods=INVENTORY_METHODS, log=True) as tracer:\n    process_vehicle(tracer.my_input) \n```", "```py\n-> Parser.ipynb:29:process_vehicle(vehicle)\n   Parser.ipynb:30:process_vehicle(vehicle)\n   Parser.ipynb:31:process_vehicle(vehicle)\n   Parser.ipynb:32:process_vehicle(vehicle)\n-> Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:40:process_van(year,company,model)\n   Parser.ipynb:41:process_van(year,company,model)\n   Parser.ipynb:42:process_van(year,company,model)\n   Parser.ipynb:43:process_van(year,company,model)\n   Parser.ipynb:46:process_van(year,company,model)\n   Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:47:process_van(year,company,model)\n<- Parser.ipynb:32:process_vehicle(vehicle)\n\n```", "```py\nclass DefineTracker:\n    def __init__(self, my_input, trace, **kwargs):\n        self.options(kwargs)\n        self.my_input = my_input\n        self.trace = trace\n        self.my_assignments = {}\n        self.process() \n```", "```py\nFRAGMENT_LEN = 3 \n```", "```py\nclass DefineTracker(DefineTracker):\n    def options(self, kwargs):\n        self.log = log_event if kwargs.get('log') else lambda _evt, _var: None\n        self.fragment_len = kwargs.get('fragment_len', FRAGMENT_LEN) \n```", "```py\nclass DefineTracker(DefineTracker):\n    def is_input_fragment(self, var, value):\n        return len(value) >= self.fragment_len and value in self.my_input \n```", "```py\nclass DefineTracker(DefineTracker):\n    def fragments(self, variables):\n        return {k: v for k, v in variables.items(\n        ) if self.is_input_fragment(k, v)} \n```", "```py\nclass DefineTracker(DefineTracker):\n    def track_event(self, event, arg, cxt, my_vars):\n        self.log(event, (cxt.method, my_vars))\n        self.my_assignments.update(self.fragments(my_vars))\n\n    def process(self):\n        for event, arg, cxt, my_vars in self.trace:\n            self.track_event(event, arg, cxt, my_vars) \n```", "```py\ntracker = DefineTracker(tracer.my_input, tracer.trace, fragment_len=5)\nfor k, v in tracker.my_assignments.items():\n    print(k, '=', repr(v)) \n```", "```py\nvehicle = '1997,van,Ford,E350'\n\n```", "```py\ntracker = DefineTracker(tracer.my_input, tracer.trace)\nfor k, v in tracker.my_assignments.items():\n    print(k, '=', repr(v)) \n```", "```py\nvehicle = '1997,van,Ford,E350'\nyear = '1997'\nkind = 'van'\ncompany = 'Ford'\nmodel = 'E350'\n\n```", "```py\nclass DefineTracker(DefineTracker):\n    def assignments(self):\n        return self.my_assignments.items() \n```", "```py\nfrom [Grammars](Grammars.html) import START_SYMBOL, syntax_diagram, \\\n    is_nonterminal, Grammar \n```", "```py\nfrom [GrammarFuzzer](GrammarFuzzer.html) import GrammarFuzzer, display_tree, \\\n    DerivationTree \n```", "```py\n\"1997,van,Ford,E350\" \n```", "```py\nderivation_tree: DerivationTree = (START_SYMBOL, [(\"1997,van,Ford,E350\", [])]) \n```", "```py\ndisplay_tree(derivation_tree) \n```", "```py\nvehicle = \"1997,van,Ford,E350\" \n```", "```py\nderivation_tree: DerivationTree = (START_SYMBOL, \n                                   [('<vehicle>', [(\"1997,van,Ford,E350\", [])],\n                                                   [])]) \n```", "```py\ndisplay_tree(derivation_tree) \n```", "```py\nyear = '1997' \n```", "```py\nderivation_tree: DerivationTree = (START_SYMBOL, \n                                   [('<vehicle>', [('<year>', [('1997', [])]),\n                                                   (\",van,Ford,E350\", [])], [])]) \n```", "```py\ndisplay_tree(derivation_tree) \n```", "```py\ncompany = 'Ford' \n```", "```py\nderivation_tree: DerivationTree = (START_SYMBOL, \n                                   [('<vehicle>', [('<year>', [('1997', [])]),\n                                                   (\",van,\", []),\n                                                   ('<company>', [('Ford', [])]),\n                                                   (\",E350\", [])], [])]) \n```", "```py\ndisplay_tree(derivation_tree) \n```", "```py\nkind = 'van' \n```", "```py\nmodel = 'E350' \n```", "```py\nderivation_tree: DerivationTree = (START_SYMBOL, \n                                   [('<vehicle>', [('<year>', [('1997', [])]),\n                                                   (\",\", []),\n                                                   (\"<kind>\", [('van', [])]),\n                                                   (\",\", []),\n                                                   ('<company>', [('Ford', [])]),\n                                                   (\",\", []),\n                                                   (\"<model>\", [('E350', [])])\n                                                   ], [])]) \n```", "```py\ndisplay_tree(derivation_tree) \n```", "```py\nclass TreeMiner:\n    def __init__(self, my_input, my_assignments, **kwargs):\n        self.options(kwargs)\n        self.my_input = my_input\n        self.my_assignments = my_assignments\n        self.tree = self.get_derivation_tree()\n\n    def options(self, kwargs):\n        self.log = log_call if kwargs.get('log') else lambda _i, _v: None\n\n    def get_derivation_tree(self):\n        return (START_SYMBOL, []) \n```", "```py\ndef log_call(indent, var):\n    print('\\t' * indent, var) \n```", "```py\ndef to_nonterminal(var):\n    return \"<\" + var.lower() + \">\" \n```", "```py\nclass TreeMiner(TreeMiner):\n    def string_part_of_value(self, part, value):\n        return (part in value) \n```", "```py\nclass TreeMiner(TreeMiner):\n    def partition(self, part, value):\n        return value.partition(part) \n```", "```py\nclass TreeMiner(TreeMiner):\n    def partition_by_part(self, pair, value):\n        k, part = pair\n        prefix_k_suffix = [\n                    (k, [[part, []]]) if i == 1 else (e, [])\n                    for i, e in enumerate(self.partition(part, value))\n                    if e]\n        return prefix_k_suffix \n```", "```py\nclass TreeMiner(TreeMiner):\n    def insert_into_tree(self, my_tree, pair):\n        var, values = my_tree\n        k, v = pair\n        self.log(1, \"- Node: %s\\t\\t? (%s:%s)\" % (var, k, repr(v)))\n        applied = False\n        for i, value_ in enumerate(values):\n            value, arr = value_\n            self.log(2, \"-> [%d] %s\" % (i, repr(value)))\n            if is_nonterminal(value):\n                applied = self.insert_into_tree(value_, pair)\n                if applied:\n                    break\n            elif self.string_part_of_value(v, value):\n                prefix_k_suffix = self.partition_by_part(pair, value)\n                del values[i]\n                for j, rep in enumerate(prefix_k_suffix):\n                    values.insert(j + i, rep)\n                applied = True\n\n                self.log(2, \" > %s\" % (repr([i[0] for i in prefix_k_suffix])))\n                break\n            else:\n                continue\n        return applied \n```", "```py\ntree: DerivationTree = (START_SYMBOL, [(\"1997,van,Ford,E350\", [])])\nm = TreeMiner('', {}, log=True) \n```", "```py\ndisplay_tree(tree) \n```", "```py\nv = m.insert_into_tree(tree, ('<vehicle>', \"1997,van,Ford,E350\")) \n```", "```py\n\t - Node: <start>\t\t? (<vehicle>:'1997,van,Ford,E350')\n\t\t -> [0] '1997,van,Ford,E350'\n\t\t  > ['<vehicle>']\n\n```", "```py\ndisplay_tree(tree) \n```", "```py\nv = m.insert_into_tree(tree, ('<model>', 'E350')) \n```", "```py\n\t - Node: <start>\t\t? (<model>:'E350')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<model>:'E350')\n\t\t -> [0] '1997,van,Ford,E350'\n\t\t  > ['1997,van,Ford,', '<model>']\n\n```", "```py\ndisplay_tree((tree)) \n```", "```py\nv = m.insert_into_tree(tree, ('<company>', 'Ford')) \n```", "```py\n\t - Node: <start>\t\t? (<company>:'Ford')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<company>:'Ford')\n\t\t -> [0] '1997,van,Ford,'\n\t\t  > ['1997,van,', '<company>', ',']\n\n```", "```py\ndisplay_tree(tree) \n```", "```py\nv = m.insert_into_tree(tree, ('<kind>', 'van')) \n```", "```py\n\t - Node: <start>\t\t? (<kind>:'van')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<kind>:'van')\n\t\t -> [0] '1997,van,'\n\t\t  > ['1997,', '<kind>', ',']\n\n```", "```py\ndisplay_tree(tree) \n```", "```py\nv = m.insert_into_tree(tree, ('<year>', '1997')) \n```", "```py\n\t - Node: <start>\t\t? (<year>:'1997')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<year>:'1997')\n\t\t -> [0] '1997,'\n\t\t  > ['<year>', ',']\n\n```", "```py\ndisplay_tree(tree) \n```", "```py\nclass TreeMiner(TreeMiner):\n    def nt_var(self, var):\n        return var if is_nonterminal(var) else to_nonterminal(var) \n```", "```py\nclass TreeMiner(TreeMiner):\n    def apply_new_definition(self, tree, var, value):\n        nt_var = self.nt_var(var)\n        return self.insert_into_tree(tree, (nt_var, value)) \n```", "```py\nclass TreeMiner(TreeMiner):\n    def get_derivation_tree(self):\n        tree = (START_SYMBOL, [(self.my_input, [])])\n\n        for var, value in self.my_assignments:\n            self.log(0, \"%s=%s\" % (var, repr(value)))\n            self.apply_new_definition(tree, var, value)\n        return tree \n```", "```py\nwith Tracer(VEHICLES[0]) as tracer:\n    process_vehicle(tracer.my_input)\nassignments = DefineTracker(tracer.my_input, tracer.trace).assignments()\ndt = TreeMiner(tracer.my_input, assignments, log=True)\ndt.tree \n```", "```py\n vehicle='1997,van,Ford,E350'\n\t - Node: <start>\t\t? (<vehicle>:'1997,van,Ford,E350')\n\t\t -> [0] '1997,van,Ford,E350'\n\t\t  > ['<vehicle>']\n year='1997'\n\t - Node: <start>\t\t? (<year>:'1997')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<year>:'1997')\n\t\t -> [0] '1997,van,Ford,E350'\n\t\t  > ['<year>', ',van,Ford,E350']\n kind='van'\n\t - Node: <start>\t\t? (<kind>:'van')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<kind>:'van')\n\t\t -> [0] '<year>'\n\t - Node: <year>\t\t? (<kind>:'van')\n\t\t -> [0] '1997'\n\t\t -> [1] ',van,Ford,E350'\n\t\t  > [',', '<kind>', ',Ford,E350']\n company='Ford'\n\t - Node: <start>\t\t? (<company>:'Ford')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<company>:'Ford')\n\t\t -> [0] '<year>'\n\t - Node: <year>\t\t? (<company>:'Ford')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind>'\n\t - Node: <kind>\t\t? (<company>:'Ford')\n\t\t -> [0] 'van'\n\t\t -> [3] ',Ford,E350'\n\t\t  > [',', '<company>', ',E350']\n model='E350'\n\t - Node: <start>\t\t? (<model>:'E350')\n\t\t -> [0] '<vehicle>'\n\t - Node: <vehicle>\t\t? (<model>:'E350')\n\t\t -> [0] '<year>'\n\t - Node: <year>\t\t? (<model>:'E350')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind>'\n\t - Node: <kind>\t\t? (<model>:'E350')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company>'\n\t - Node: <company>\t\t? (<model>:'E350')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ',E350'\n\t\t  > [',', '<model>']\n\n```", "```py\n('<start>',\n [('<vehicle>',\n   [('<year>', [['1997', []]]),\n    (',', []),\n    ('<kind>', [['van', []]]),\n    (',', []),\n    ('<company>', [['Ford', []]]),\n    (',', []),\n    ('<model>', [['E350', []]])])])\n\n```", "```py\ndisplay_tree(TreeMiner(tracer.my_input, assignments).tree) \n```", "```py\ntrees = []\nfor vehicle in VEHICLES:\n    print(vehicle)\n    with Tracer(vehicle) as tracer:\n        process_vehicle(tracer.my_input)\n    assignments = DefineTracker(tracer.my_input, tracer.trace).assignments()\n    trees.append((tracer.my_input, assignments))\n    for var, val in assignments:\n        print(var + \" = \" + repr(val))\n    print() \n```", "```py\n1997,van,Ford,E350\nvehicle = '1997,van,Ford,E350'\nyear = '1997'\nkind = 'van'\ncompany = 'Ford'\nmodel = 'E350'\n\n2000,car,Mercury,Cougar\nvehicle = '2000,car,Mercury,Cougar'\nyear = '2000'\nkind = 'car'\ncompany = 'Mercury'\nmodel = 'Cougar'\n\n1999,car,Chevy,Venture\nvehicle = '1999,car,Chevy,Venture'\nyear = '1999'\nkind = 'car'\ncompany = 'Chevy'\nmodel = 'Venture'\n\n```", "```py\ncsv_dt = []\nfor inputstr, assignments in trees:\n    print(inputstr)\n    dt = TreeMiner(inputstr, assignments)\n    csv_dt.append(dt)\n    display_tree(dt.tree) \n```", "```py\n1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture\n\n```", "```py\nclass GrammarMiner:\n    def __init__(self):\n        self.grammar = {} \n```", "```py\nclass GrammarMiner(GrammarMiner):\n    def tree_to_grammar(self, tree):\n        node, children = tree\n        one_alt = [ck for ck, gc in children]\n        hsh = {node: [one_alt] if one_alt else []}\n        for child in children:\n            if not is_nonterminal(child[0]):\n                continue\n            chsh = self.tree_to_grammar(child)\n            for k in chsh:\n                if k not in hsh:\n                    hsh[k] = chsh[k]\n                else:\n                    hsh[k].extend(chsh[k])\n        return hsh \n```", "```py\ngm = GrammarMiner()\ngm.tree_to_grammar(csv_dt[0].tree) \n```", "```py\n{'<start>': [['<vehicle>']],\n '<vehicle>': [['<year>', ',', '<kind>', ',', '<company>', ',', '<model>']],\n '<year>': [['1997']],\n '<kind>': [['van']],\n '<company>': [['Ford']],\n '<model>': [['E350']]}\n\n```", "```py\ndef readable(grammar):\n    def readable_rule(rule):\n        return ''.join(rule)\n\n    return {k: list(set(readable_rule(a) for a in grammar[k]))\n            for k in grammar} \n```", "```py\nsyntax_diagram(readable(gm.tree_to_grammar(csv_dt[0].tree))) \n```", "```py\nstart\n\n```", "```py\nvehicle\n\n```", "```py\nyear\n\n```", "```py\nkind\n\n```", "```py\ncompany\n\n```", "```py\nmodel\n\n```", "```py\nimport [itertools](https://docs.python.org/3/library/itertools.html) \n```", "```py\nclass GrammarMiner(GrammarMiner):\n    def add_tree(self, t):\n        t_grammar = self.tree_to_grammar(t.tree)\n        self.grammar = {\n            key: self.grammar.get(key, []) + t_grammar.get(key, [])\n            for key in itertools.chain(self.grammar.keys(), t_grammar.keys())\n        } \n```", "```py\ninventory_grammar_miner = GrammarMiner()\nfor dt in csv_dt:\n    inventory_grammar_miner.add_tree(dt) \n```", "```py\nsyntax_diagram(readable(inventory_grammar_miner.grammar)) \n```", "```py\nstart\n\n```", "```py\nvehicle\n\n```", "```py\nyear\n\n```", "```py\nkind\n\n```", "```py\ncompany\n\n```", "```py\nmodel\n\n```", "```py\nclass GrammarMiner(GrammarMiner):\n    def update_grammar(self, inputstr, trace):\n        at = self.create_tracker(inputstr, trace)\n        dt = self.create_tree_miner(inputstr, at.assignments())\n        self.add_tree(dt)\n        return self.grammar\n\n    def create_tracker(self, *args):\n        return DefineTracker(*args)\n\n    def create_tree_miner(self, *args):\n        return TreeMiner(*args) \n```", "```py\ndef recover_grammar(fn: Callable, inputs: Iterable[str], \n                    **kwargs: Any) -> Grammar:\n    miner = GrammarMiner()\n\n    for inputstr in inputs:\n        with Tracer(inputstr, **kwargs) as tracer:\n            fn(tracer.my_input)\n        miner.update_grammar(tracer.my_input, tracer.trace)\n\n    return readable(miner.grammar) \n```", "```py\ninventory_grammar = recover_grammar(process_vehicle, VEHICLES) \n```", "```py\ninventory_grammar \n```", "```py\n{'<start>': ['<vehicle>'],\n '<vehicle>': ['<year>,<kind>,<company>,<model>'],\n '<year>': ['1999', '2000', '1997'],\n '<kind>': ['car', 'van'],\n '<company>': ['Mercury', 'Chevy', 'Ford'],\n '<model>': ['E350', 'Cougar', 'Venture']}\n\n```", "```py\nURLS = [\n    'http://user:pass@www.google.com:80/?q=path#ref',\n    'https://www.cispa.saarland:80/',\n    'http://www.fuzzingbook.org/#News',\n] \n```", "```py\nfrom [urllib.parse](https://docs.python.org/3/library/urllib.parse.html) import urlparse, clear_cache \n```", "```py\ndef url_parse(url):\n    clear_cache()\n    urlparse(url) \n```", "```py\ntrees = []\nfor url in URLS:\n    print(url)\n    with Tracer(url) as tracer:\n        url_parse(tracer.my_input)\n    assignments = DefineTracker(tracer.my_input, tracer.trace).assignments()\n    trees.append((tracer.my_input, assignments))\n    for var, val in assignments:\n        print(var + \" = \" + repr(val))\n    print()\n\nurl_dt = []\nfor inputstr, assignments in trees:\n    print(inputstr)\n    dt = TreeMiner(inputstr, assignments)\n    url_dt.append(dt)\n    display_tree(dt.tree) \n```", "```py\nhttp://user:pass@www.google.com:80/?q=path#ref\nurl = 'http://user:pass@www.google.com:80/?q=path#ref'\nscheme = 'http'\nnetloc = 'user:pass@www.google.com:80'\nfragment = 'ref'\nquery = 'q=path'\n\nhttps://www.cispa.saarland:80/\nurl = 'https://www.cispa.saarland:80/'\nscheme = 'https'\nnetloc = 'www.cispa.saarland:80'\n\nhttp://www.fuzzingbook.org/#News\nurl = 'http://www.fuzzingbook.org/#News'\nscheme = 'http'\nnetloc = 'www.fuzzingbook.org'\nfragment = 'News'\n\nhttp://user:pass@www.google.com:80/?q=path#ref\nhttps://www.cispa.saarland:80/\nhttp://www.fuzzingbook.org/#News\n\n```", "```py\nurl_grammar = recover_grammar(url_parse, URLS, files=['urllib/parse.py']) \n```", "```py\nsyntax_diagram(url_grammar) \n```", "```py\nstart\n\n```", "```py\nurl\n\n```", "```py\nscheme\n\n```", "```py\nnetloc\n\n```", "```py\nquery\n\n```", "```py\nfragment\n\n```", "```py\nf = GrammarFuzzer(inventory_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\n1997,car,Mercury,E350\n2000,car,Chevy,Cougar\n1997,van,Mercury,Venture\n1999,car,Ford,Venture\n2000,car,Mercury,E350\n2000,car,Mercury,Cougar\n1997,car,Chevy,E350\n1997,car,Chevy,E350\n1997,car,Mercury,Cougar\n1999,car,Chevy,E350\n\n```", "```py\nf = GrammarFuzzer(url_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\nhttps://user:pass@www.google.com:80/\nhttp://www.cispa.saarland:80/?q=path#News\nhttps://user:pass@www.google.com:80/\nhttps://user:pass@www.google.com:80/#ref\nhttp://user:pass@www.google.com:80/\nhttp://user:pass@www.google.com:80/#ref\nhttp://user:pass@www.google.com:80/?q=path#News\nhttp://www.fuzzingbook.org/?q=path#News\nhttp://www.fuzzingbook.org/?q=path#ref\nhttp://www.cispa.saarland:80/\n\n```", "```py\nURLS_X = URLS + ['ftp://freebsd.org/releases/5.8'] \n```", "```py\nurl_grammar = recover_grammar(url_parse, URLS_X, files=['urllib/parse.py']) \n```", "```py\nsyntax_diagram(url_grammar) \n```", "```py\nstart\n\n```", "```py\nurl\n\n```", "```py\nscheme\n\n```", "```py\nnetloc\n\n```", "```py\nquery\n\n```", "```py\nfragment\n\n```", "```py\nclear_cache()\nwith Tracer(URLS_X[0]) as tracer:\n    urlparse(tracer.my_input)\nfor i, t in enumerate(tracer.trace):\n    if t[0] in {'call', 'line'} and 'parse.py' in str(t[2]) and t[3]:\n        print(i, t[2]._t()[1], t[3:]) \n```", "```py\n0 374 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n1 394 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n5 129 ({'arg': ''},)\n6 126 ({'arg': ''},)\n7 131 ({'arg': ''},)\n8 132 ({'arg': ''},)\n10 395 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n11 452 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n12 474 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n16 129 ({'arg': ''},)\n17 126 ({'arg': ''},)\n18 131 ({'arg': ''},)\n19 132 ({'arg': ''},)\n21 477 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n22 478 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n23 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n24 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\t'},)\n25 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\t'},)\n26 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\t'},)\n27 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\r'},)\n28 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\r'},)\n29 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\r'},)\n30 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n'},)\n31 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n'},)\n32 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n'},)\n33 484 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n'},)\n34 485 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n'},)\n35 486 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': ''},)\n36 487 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': ''},)\n37 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': ''},)\n38 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'h'},)\n39 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'h'},)\n40 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)\n41 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)\n42 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)\n43 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)\n44 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)\n45 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)\n46 492 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)\n47 493 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)\n48 494 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)\n49 413 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)\n50 414 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)\n51 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)\n52 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)\n53 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)\n54 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)\n55 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)\n56 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)\n57 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)\n58 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)\n59 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)\n60 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)\n61 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)\n62 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)\n63 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)\n64 419 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)\n66 495 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)\n67 496 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)\n68 498 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)\n69 501 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)\n70 502 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)\n71 503 ({'url': '/?q=path', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': 'ref', 'c': 'p'},)\n72 504 ({'url': '/?q=path', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': 'ref', 'c': 'p'},)\n73 505 ({'url': '/', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)\n74 421 ({'netloc': 'user:pass@www.google.com:80'},)\n75 422 ({'netloc': 'user:pass@www.google.com:80'},)\n76 423 ({'netloc': 'user:pass@www.google.com:80'},)\n78 506 ({'url': '/', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)\n82 507 ({'url': '/', 'scheme': 'http', 'b': '\\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)\n87 396 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)\n88 397 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref'},)\n89 400 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref'},)\n90 401 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'params': ''},)\n94 402 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'params': ''},)\n\n```", "```py\ndef C(cp_1):\n    c_2 = cp_1 + '@2'\n    c_3 = c_2 + '@3'\n    return c_3 \n```", "```py\ndef B(bp_7):\n    b_8 = bp_7 + '@8'\n    return C(b_8) \n```", "```py\ndef A(ap_12):\n    a_13 = ap_12 + '@13'\n    a_14 = B(a_13) + '@14'\n    a_14 = a_14 + '@15'\n    a_13 = a_14 + '@16'\n    a_14 = B(a_13) + '@17'\n    a_14 = B(a_13) + '@18' \n```", "```py\nwith Tracer('____') as tracer:\n    A(tracer.my_input)\n\nfor t in tracer.trace:\n    print(t[0], \"%d:%s\" % (t[2].line_no, t[2].method), t[3]) \n```", "```py\ncall 1:A {'ap_12': '____'}\nline 2:A {'ap_12': '____'}\nline 3:A {'ap_12': '____', 'a_13': '____@13'}\ncall 1:B {'bp_7': '____@13'}\nline 2:B {'bp_7': '____@13'}\nline 3:B {'bp_7': '____@13', 'b_8': '____@13@8'}\ncall 1:C {'cp_1': '____@13@8'}\nline 2:C {'cp_1': '____@13@8'}\nline 3:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2'}\nline 4:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2', 'c_3': '____@13@8@2@3'}\nreturn 4:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2', 'c_3': '____@13@8@2@3'}\nreturn 3:B {'bp_7': '____@13', 'b_8': '____@13@8'}\nline 4:A {'ap_12': '____', 'a_13': '____@13', 'a_14': '____@13@8@2@3@14'}\nline 5:A {'ap_12': '____', 'a_13': '____@13', 'a_14': '____@13@8@2@3@14@15'}\nline 6:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15'}\ncall 1:B {'bp_7': '____@13@8@2@3@14@15@16'}\nline 2:B {'bp_7': '____@13@8@2@3@14@15@16'}\nline 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}\ncall 1:C {'cp_1': '____@13@8@2@3@14@15@16@8'}\nline 2:C {'cp_1': '____@13@8@2@3@14@15@16@8'}\nline 3:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2'}\nline 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}\nreturn 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}\nreturn 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}\nline 7:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15@16@8@2@3@17'}\ncall 1:B {'bp_7': '____@13@8@2@3@14@15@16'}\nline 2:B {'bp_7': '____@13@8@2@3@14@15@16'}\nline 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}\ncall 1:C {'cp_1': '____@13@8@2@3@14@15@16@8'}\nline 2:C {'cp_1': '____@13@8@2@3@14@15@16@8'}\nline 3:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2'}\nline 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}\nreturn 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}\nreturn 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}\nreturn 7:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15@16@8@2@3@18'}\ncall 102:__exit__ {}\nline 105:__exit__ {}\n\n```", "```py\nclass CallStack:\n    def __init__(self, **kwargs):\n        self.options(kwargs)\n        self.method_id = (START_SYMBOL, 0)\n        self.method_register = 0\n        self.mstack = [self.method_id]\n\n    def enter(self, method):\n        self.method_register += 1\n        self.method_id = (method, self.method_register)\n        self.log('call', \"%s%s\" % (self.indent(), str(self)))\n        self.mstack.append(self.method_id)\n\n    def leave(self):\n        self.mstack.pop()\n        self.log('return', \"%s%s\" % (self.indent(), str(self)))\n        self.method_id = self.mstack[-1] \n```", "```py\nclass CallStack(CallStack):\n    def options(self, kwargs):\n        self.log = log_event if kwargs.get('log') else lambda _evt, _var: None\n\n    def indent(self):\n        return len(self.mstack) * \"\\t\"\n\n    def at(self, n):\n        return self.mstack[n]\n\n    def __len__(self):\n        return len(mstack) - 1\n\n    def __str__(self):\n        return \"%s:%d\" % self.method_id\n\n    def __repr__(self):\n        return repr(self.method_id) \n```", "```py\ndef display_stack(istack):\n    def stack_to_tree(stack):\n        current, *rest = stack\n        if not rest:\n            return (repr(current), [])\n        return (repr(current), [stack_to_tree(rest)])\n    display_tree(stack_to_tree(istack.mstack), graph_attr=lr_graph) \n```", "```py\ncs = CallStack()\ndisplay_stack(cs)\ncs \n```", "```py\n('<start>', 0)\n\n```", "```py\ncs.enter('hello')\ndisplay_stack(cs)\ncs \n```", "```py\n('hello', 1)\n\n```", "```py\ncs.enter('world')\ndisplay_stack(cs)\ncs \n```", "```py\n('world', 2)\n\n```", "```py\ncs.leave()\ndisplay_stack(cs)\ncs \n```", "```py\n('hello', 1)\n\n```", "```py\ncs.enter('world')\ndisplay_stack(cs)\ncs \n```", "```py\n('world', 3)\n\n```", "```py\ncs.leave()\ndisplay_stack(cs)\ncs \n```", "```py\n('hello', 1)\n\n```", "```py\nclass Vars:\n    def __init__(self, original):\n        self.defs = {}\n        self.my_input = original \n```", "```py\nclass Vars(Vars):\n    def _set_kv(self, k, v):\n        self.defs[k] = v\n\n    def __setitem__(self, k, v):\n        self._set_kv(k, v)\n\n    def update(self, v):\n        for k, v in v.items():\n            self._set_kv(k, v) \n```", "```py\nv = Vars('')\nv.defs \n```", "```py\n{}\n\n```", "```py\nv['x'] = 'X'\nv.defs \n```", "```py\n{'x': 'X'}\n\n```", "```py\nv.update({'x': 'x', 'y': 'y'})\nv.defs \n```", "```py\n{'x': 'x', 'y': 'y'}\n\n```", "```py\nclass AssignmentVars(Vars):\n    def __init__(self, original):\n        super().__init__(original)\n        self.accessed_seq_var = {}\n        self.var_def_lines = {}\n        self.current_event = None\n        self.new_vars = set()\n        self.method_init() \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def method_init(self):\n        self.call_stack = CallStack()\n        self.event_locations = {self.call_stack.method_id: []} \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def update(self, v):\n        for k, v in v.items():\n            self._set_kv(k, v)\n        self.var_location_register(self.new_vars)\n        self.new_vars = set() \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def var_name(self, var):\n        return (var, self.accessed_seq_var[var]) \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def var_access(self, var):\n        if var not in self.accessed_seq_var:\n            self.accessed_seq_var[var] = 0\n        return self.var_name(var) \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def var_assign(self, var):\n        self.accessed_seq_var[var] += 1\n        self.new_vars.add(self.var_name(var))\n        return self.var_name(var) \n```", "```py\nsav = AssignmentVars('')\nsav.defs \n```", "```py\n{}\n\n```", "```py\nsav.var_access('v1') \n```", "```py\n('v1', 0)\n\n```", "```py\nsav.var_assign('v1') \n```", "```py\n('v1', 1)\n\n```", "```py\nsav.var_assign('v1') \n```", "```py\n('v1', 2)\n\n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def _set_kv(self, var, val):\n        s_var = self.var_access(var)\n        if s_var in self.defs and self.defs[s_var] == val:\n            return\n        self.defs[self.var_assign(var)] = val \n```", "```py\nsav = AssignmentVars('')\nsav['x'] = 'X'\nsav.defs \n```", "```py\n{('x', 1): 'X'}\n\n```", "```py\nsav['x'] = 'X'\nsav.defs \n```", "```py\n{('x', 1): 'X'}\n\n```", "```py\nsav['x'] = 'Y'\nsav.defs \n```", "```py\n{('x', 1): 'X', ('x', 2): 'Y'}\n\n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def method_enter(self, cxt, my_vars):\n        self.current_event = 'call'\n        self.call_stack.enter(cxt.method)\n        self.event_locations[self.call_stack.method_id] = []\n        self.register_event(cxt)\n        self.update(my_vars)\n\n    def method_exit(self, cxt, my_vars):\n        self.current_event = 'return'\n        self.register_event(cxt)\n        self.update(my_vars)\n        self.call_stack.leave()\n\n    def method_statement(self, cxt, my_vars):\n        self.current_event = 'line'\n        self.register_event(cxt)\n        self.update(my_vars) \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def register_event(self, cxt):\n        self.event_locations[self.call_stack.method_id].append(cxt.line_no) \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def var_location_register(self, my_vars):\n        def loc(mid):\n            if self.current_event == 'call':\n                return self.event_locations[mid][-1]\n            elif self.current_event == 'line':\n                return self.event_locations[mid][-2]\n            elif self.current_event == 'return':\n                return self.event_locations[mid][-2]\n            else:\n                assert False\n\n        my_loc = loc(self.call_stack.method_id)\n        for var in my_vars:\n            self.var_def_lines[var] = my_loc \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def defined_vars(self, formatted=True):\n        def fmt(k):\n            v = (k[0], self.var_def_lines[k])\n            return \"%s@%s\" % v if formatted else v\n\n        return [(fmt(k), v) for k, v in self.defs.items()] \n```", "```py\nclass AssignmentVars(AssignmentVars):\n    def seq_vars(self, formatted=True):\n        def fmt(k):\n            v = (k[0], self.var_def_lines[k], k[1])\n            return \"%s@%s:%s\" % v if formatted else v\n\n        return {fmt(k): v for k, v in self.defs.items()} \n```", "```py\nclass AssignmentTracker(DefineTracker):\n    def __init__(self, my_input, trace, **kwargs):\n        self.options(kwargs)\n        self.my_input = my_input\n\n        self.my_assignments = self.create_assignments(my_input)\n\n        self.trace = trace\n        self.process()\n\n    def create_assignments(self, *args):\n        return AssignmentVars(*args) \n```", "```py\nclass AssignmentTracker(AssignmentTracker):\n    def options(self, kwargs):\n        self.track_return = kwargs.get('track_return', False)\n        super().options(kwargs) \n```", "```py\nclass AssignmentTracker(AssignmentTracker):\n    def on_call(self, arg, cxt, my_vars):\n        my_vars = cxt.parameters(my_vars)\n        self.my_assignments.method_enter(cxt, self.fragments(my_vars))\n\n    def on_line(self, arg, cxt, my_vars):\n        self.my_assignments.method_statement(cxt, self.fragments(my_vars))\n\n    def on_return(self, arg, cxt, my_vars):\n        self.on_line(arg, cxt, my_vars)\n        my_vars = {'<-%s' % cxt.method: arg} if self.track_return else {}\n        self.my_assignments.method_exit(cxt, my_vars)\n\n    def on_exception(self, arg, cxt, my_vara):\n        return\n\n    def track_event(self, event, arg, cxt, my_vars):\n        self.current_event = event\n        dispatch = {\n            'call': self.on_call,\n            'return': self.on_return,\n            'line': self.on_line,\n            'exception': self.on_exception\n        }\n        dispatch[event](arg, cxt, my_vars) \n```", "```py\ndef C(cp_1):\n    c_2 = cp_1\n    c_3 = c_2\n    return c_3 \n```", "```py\ndef B(bp_7):\n    b_8 = bp_7\n    return C(b_8) \n```", "```py\ndef A(ap_12):\n    a_13 = ap_12\n    a_14 = B(a_13)\n    a_14 = a_14\n    a_13 = a_14\n    a_14 = B(a_13)\n    a_14 = B(a_14)[3:] \n```", "```py\nwith Tracer('---xxx') as tracer:\n    A(tracer.my_input)\ntracker = AssignmentTracker(tracer.my_input, tracer.trace, log=True)\nfor k, v in tracker.my_assignments.seq_vars().items():\n    print(k, '=', repr(v))\nprint()\nfor k, v in tracker.my_assignments.defined_vars(formatted=True):\n    print(k, '=', repr(v)) \n```", "```py\nap_12@1:1 = '---xxx'\na_13@2:1 = '---xxx'\nbp_7@1:1 = '---xxx'\nb_8@2:1 = '---xxx'\ncp_1@1:1 = '---xxx'\nc_2@2:1 = '---xxx'\nc_3@3:1 = '---xxx'\na_14@3:1 = '---xxx'\na_14@7:2 = 'xxx'\n\nap_12@1 = '---xxx'\na_13@2 = '---xxx'\nbp_7@1 = '---xxx'\nb_8@2 = '---xxx'\ncp_1@1 = '---xxx'\nc_2@2 = '---xxx'\nc_3@3 = '---xxx'\na_14@3 = '---xxx'\na_14@7 = 'xxx'\n\n```", "```py\ntraces = []\nfor inputstr in URLS_X:\n    clear_cache()\n    with Tracer(inputstr, files=['urllib/parse.py']) as tracer:\n        urlparse(tracer.my_input)\n    traces.append((tracer.my_input, tracer.trace))\n\n    tracker = AssignmentTracker(tracer.my_input, tracer.trace, log=True)\n    for k, v in tracker.my_assignments.defined_vars():\n        print(k, '=', repr(v))\n    print() \n```", "```py\nurl@374 = 'http://user:pass@www.google.com:80/?q=path#ref'\nurl@492 = '//user:pass@www.google.com:80/?q=path#ref'\nscheme@492 = 'http'\nurl@494 = '/?q=path#ref'\nnetloc@494 = 'user:pass@www.google.com:80'\nurl@502 = '/?q=path'\nfragment@502 = 'ref'\nquery@504 = 'q=path'\nurl@395 = 'http://user:pass@www.google.com:80/?q=path#ref'\n\nurl@374 = 'https://www.cispa.saarland:80/'\nurl@492 = '//www.cispa.saarland:80/'\nscheme@492 = 'https'\nnetloc@494 = 'www.cispa.saarland:80'\nurl@395 = 'https://www.cispa.saarland:80/'\n\nurl@374 = 'http://www.fuzzingbook.org/#News'\nurl@492 = '//www.fuzzingbook.org/#News'\nscheme@492 = 'http'\nurl@494 = '/#News'\nnetloc@494 = 'www.fuzzingbook.org'\nfragment@502 = 'News'\nurl@395 = 'http://www.fuzzingbook.org/#News'\n\nurl@374 = 'ftp://freebsd.org/releases/5.8'\nurl@492 = '//freebsd.org/releases/5.8'\nscheme@492 = 'ftp'\nurl@494 = '/releases/5.8'\nnetloc@494 = 'freebsd.org'\nurl@395 = 'ftp://freebsd.org/releases/5.8'\nurl@396 = '/releases/5.8'\n\n```", "```py\nclass TreeMiner(TreeMiner):\n    def get_derivation_tree(self):\n        tree = (START_SYMBOL, [(self.my_input, [])])\n        for var, value in self.my_assignments:\n            self.log(0, \"%s=%s\" % (var, repr(value)))\n            self.apply_new_definition(tree, var, value)\n        return tree \n```", "```py\nclear_cache()\nwith Tracer(URLS_X[0], files=['urllib/parse.py']) as tracer:\n    urlparse(tracer.my_input)\nsm = AssignmentTracker(tracer.my_input, tracer.trace)\ndt = TreeMiner(tracer.my_input, sm.my_assignments.defined_vars())\ndisplay_tree(dt.tree) \n```", "```py\nclear_cache()\nwith Tracer(URLS_X[-1], files=['urllib/parse.py']) as tracer:\n    urlparse(tracer.my_input)\nsm = AssignmentTracker(tracer.my_input, tracer.trace)\ndt = TreeMiner(tracer.my_input, sm.my_assignments.defined_vars())\ndisplay_tree(dt.tree) \n```", "```py\nclass GrammarMiner(GrammarMiner):\n    def update_grammar(self, inputstr, trace):\n        at = self.create_tracker(inputstr, trace)\n        dt = self.create_tree_miner(inputstr, at.my_assignments.defined_vars())\n        self.add_tree(dt)\n        return self.grammar\n\n    def create_tracker(self, *args):\n        return AssignmentTracker(*args)\n\n    def create_tree_miner(self, *args):\n        return TreeMiner(*args) \n```", "```py\nurl_grammar = recover_grammar(url_parse, URLS_X, files=['urllib/parse.py']) \n```", "```py\nsyntax_diagram(url_grammar) \n```", "```py\nstart\n\n```", "```py\nurl@374\n\n```", "```py\nscheme@492\n\n```", "```py\nurl@492\n\n```", "```py\nnetloc@494\n\n```", "```py\nurl@494\n\n```", "```py\nurl@502\n\n```", "```py\nquery@504\n\n```", "```py\nfragment@502\n\n```", "```py\nurl@396\n\n```", "```py\nf = GrammarFuzzer(url_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\nhttp://freebsd.org/\nftp://freebsd.org/releases/5.8\nhttp://www.cispa.saarland:80/\nftp://freebsd.org/releases/5.8\nhttps://user:pass@www.google.com:80/releases/5.8\nhttps://freebsd.org/\nftp://www.cispa.saarland:80/?q=path#News\nhttp://www.fuzzingbook.org/\nhttps://www.cispa.saarland:80/\nftp://user:pass@www.google.com:80/\n\n```", "```py\ninventory_grammar = recover_grammar(process_vehicle, VEHICLES) \n```", "```py\nsyntax_diagram(inventory_grammar) \n```", "```py\nstart\n\n```", "```py\nvehicle@29\n\n```", "```py\nyear@30\n\n```", "```py\nkind@30\n\n```", "```py\ncompany@30\n\n```", "```py\nmodel@30\n\n```", "```py\nf = GrammarFuzzer(inventory_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\n1997,van,Chevy,E350\n1999,van,Mercury,E350\n2000,van,Chevy,Venture\n2000,van,Ford,E350\n1997,van,Mercury,Cougar\n1997,car,Ford,E350\n1997,car,Mercury,Venture\n1997,car,Mercury,E350\n2000,van,Mercury,Cougar\n1997,car,Chevy,Venture\n\n```", "```py\nwith Tracer(INVENTORY) as tracer:\n    process_inventory(tracer.my_input)\nsm = AssignmentTracker(tracer.my_input, tracer.trace)\ndt = TreeMiner(tracer.my_input, sm.my_assignments.defined_vars())\ndisplay_tree(dt.tree, graph_attr=lr_graph) \n```", "```py\ndt = TreeMiner(tracer.my_input, sm.my_assignments.defined_vars(), log=True) \n```", "```py\n inventory@22='1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture'\n\t - Node: <start>\t\t? (<inventory@22>:'1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture')\n\t\t -> [0] '1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture'\n\t\t  > ['<inventory@22>']\n vehicle@24='1997,van,Ford,E350'\n\t - Node: <start>\t\t? (<vehicle@24>:'1997,van,Ford,E350')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<vehicle@24>:'1997,van,Ford,E350')\n\t\t -> [0] '1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture'\n\t\t  > ['<vehicle@24>', '\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture']\n year@30='1997'\n\t - Node: <start>\t\t? (<year@30>:'1997')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<year@30>:'1997')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'1997')\n\t\t -> [0] '1997,van,Ford,E350'\n\t\t  > ['<year@30>', ',van,Ford,E350']\n kind@30='van'\n\t - Node: <start>\t\t? (<kind@30>:'van')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<kind@30>:'van')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<kind@30>:'van')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<kind@30>:'van')\n\t\t -> [0] '1997'\n\t\t -> [1] ',van,Ford,E350'\n\t\t  > [',', '<kind@30>', ',Ford,E350']\n company@30='Ford'\n\t - Node: <start>\t\t? (<company@30>:'Ford')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<company@30>:'Ford')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Ford')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Ford')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<company@30>:'Ford')\n\t\t -> [0] 'van'\n\t\t -> [3] ',Ford,E350'\n\t\t  > [',', '<company@30>', ',E350']\n model@30='E350'\n\t - Node: <start>\t\t? (<model@30>:'E350')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<model@30>:'E350')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'E350')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'E350')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<model@30>:'E350')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'E350')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ',E350'\n\t\t  > [',', '<model@30>']\n vehicle@24='2000,car,Mercury,Cougar'\n\t - Node: <start>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<vehicle@24>:'2000,car,Mercury,Cougar')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture'\n\t\t  > ['\\n', '<vehicle@24>', '\\n1999,car,Chevy,Venture']\n year@30='2000'\n\t - Node: <start>\t\t? (<year@30>:'2000')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<year@30>:'2000')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'2000')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<year@30>:'2000')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<year@30>:'2000')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<year@30>:'2000')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<year@30>:'2000')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'2000')\n\t\t -> [0] '2000,car,Mercury,Cougar'\n\t\t  > ['<year@30>', ',car,Mercury,Cougar']\n kind@30='car'\n\t - Node: <start>\t\t? (<kind@30>:'car')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<kind@30>:'car')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<kind@30>:'car')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<kind@30>:'car')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<kind@30>:'car')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<kind@30>:'car')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<kind@30>:'car')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<kind@30>:'car')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<kind@30>:'car')\n\t\t -> [0] '2000'\n\t\t -> [1] ',car,Mercury,Cougar'\n\t\t  > [',', '<kind@30>', ',Mercury,Cougar']\n company@30='Mercury'\n\t - Node: <start>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<company@30>:'Mercury')\n\t\t -> [0] 'car'\n\t\t -> [3] ',Mercury,Cougar'\n\t\t  > [',', '<company@30>', ',Cougar']\n model@30='Cougar'\n\t - Node: <start>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] 'car'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'Cougar')\n\t\t -> [0] 'Mercury'\n\t\t -> [5] ',Cougar'\n\t\t  > [',', '<model@30>']\n vehicle@24='1999,car,Chevy,Venture'\n\t - Node: <start>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'car'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'Mercury'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<vehicle@24>:'1999,car,Chevy,Venture')\n\t\t -> [0] 'Cougar'\n\t\t -> [3] '\\n1999,car,Chevy,Venture'\n\t\t  > ['\\n', '<vehicle@24>']\n year@30='1999'\n\t - Node: <start>\t\t? (<year@30>:'1999')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<year@30>:'1999')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'1999')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'1999')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'car'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'Mercury'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<year@30>:'1999')\n\t\t -> [0] 'Cougar'\n\t\t -> [3] '\\n'\n\t\t -> [4] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<year@30>:'1999')\n\t\t -> [0] '1999,car,Chevy,Venture'\n\t\t  > ['<year@30>', ',car,Chevy,Venture']\n company@30='Chevy'\n\t - Node: <start>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'car'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'Mercury'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] 'Cougar'\n\t\t -> [3] '\\n'\n\t\t -> [4] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<company@30>:'Chevy')\n\t\t -> [0] '1999'\n\t\t -> [1] ',car,Chevy,Venture'\n\t\t  > [',car,', '<company@30>', ',Venture']\n model@30='Venture'\n\t - Node: <start>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '<inventory@22>'\n\t - Node: <inventory@22>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '1997'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'van'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'Ford'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'E350'\n\t\t -> [1] '\\n'\n\t\t -> [2] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '2000'\n\t\t -> [1] ','\n\t\t -> [2] '<kind@30>'\n\t - Node: <kind@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'car'\n\t\t -> [3] ','\n\t\t -> [4] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'Mercury'\n\t\t -> [5] ','\n\t\t -> [6] '<model@30>'\n\t - Node: <model@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'Cougar'\n\t\t -> [3] '\\n'\n\t\t -> [4] '<vehicle@24>'\n\t - Node: <vehicle@24>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '<year@30>'\n\t - Node: <year@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] '1999'\n\t\t -> [1] ',car,'\n\t\t -> [2] '<company@30>'\n\t - Node: <company@30>\t\t? (<model@30>:'Venture')\n\t\t -> [0] 'Chevy'\n\t\t -> [3] ',Venture'\n\t\t  > [',', '<model@30>']\n\n```", "```py\nclass InputStack(CallStack):\n    def __init__(self, i, fragment_len=FRAGMENT_LEN):\n        self.inputs = [{START_SYMBOL: i}]\n        self.fragment_len = fragment_len\n        super().__init__() \n```", "```py\nclass InputStack(InputStack):\n    def in_current_record(self, val):\n        return any(val in var for var in self.inputs[-1].values()) \n```", "```py\nmy_istack = InputStack('hello my world') \n```", "```py\nmy_istack.in_current_record('hello') \n```", "```py\nTrue\n\n```", "```py\nmy_istack.in_current_record('bye') \n```", "```py\nFalse\n\n```", "```py\nmy_istack.inputs.append({'greeting': 'hello', 'location': 'world'}) \n```", "```py\nmy_istack.in_current_record('hello') \n```", "```py\nTrue\n\n```", "```py\nmy_istack.in_current_record('my') \n```", "```py\nFalse\n\n```", "```py\nclass InputStack(InputStack):\n    def ignored(self, val):\n        return not (isinstance(val, str) and len(val) >= self.fragment_len) \n```", "```py\nmy_istack = InputStack('hello world')\nmy_istack.ignored(1) \n```", "```py\nTrue\n\n```", "```py\nmy_istack.ignored('a') \n```", "```py\nTrue\n\n```", "```py\nmy_istack.ignored('help') \n```", "```py\nFalse\n\n```", "```py\nclass InputStack(InputStack):\n    def in_scope(self, k, val):\n        if self.ignored(val):\n            return False\n        return self.in_current_record(val) \n```", "```py\nclass InputStack(InputStack):\n    def enter(self, method, inputs):\n        my_inputs = {k: v for k, v in inputs.items() if self.in_scope(k, v)}\n        self.inputs.append(my_inputs)\n        super().enter(method) \n```", "```py\nclass InputStack(InputStack):\n    def leave(self):\n        self.inputs.pop()\n        super().leave() \n```", "```py\nclass ScopedVars(AssignmentVars):\n    def method_init(self):\n        self.call_stack = self.create_call_stack(self.my_input)\n        self.event_locations = {self.call_stack.method_id: []}\n\n    def create_call_stack(self, i):\n        return InputStack(i) \n```", "```py\nclass ScopedVars(ScopedVars):\n    def method_enter(self, cxt, my_vars):\n        self.current_event = 'call'\n        self.call_stack.enter(cxt.method, my_vars)\n        self.accessed_seq_var[self.call_stack.method_id] = {}\n        self.event_locations[self.call_stack.method_id] = []\n        self.register_event(cxt)\n        self.update(my_vars) \n```", "```py\nclass ScopedVars(ScopedVars):\n    def update(self, v):\n        if self.current_event == 'call':\n            context = -2\n        elif self.current_event == 'line':\n            context = -1\n        else:\n            context = -1\n        for k, v in v.items():\n            self._set_kv(k, (v, self.call_stack.at(context)))\n        self.var_location_register(self.new_vars)\n        self.new_vars = set() \n```", "```py\nclass ScopedVars(ScopedVars):\n    def var_name(self, var):\n        return (var, self.call_stack.method_id,\n                self.accessed_seq_var[self.call_stack.method_id][var]) \n```", "```py\nclass ScopedVars(ScopedVars):\n    def var_access(self, var):\n        if var not in self.accessed_seq_var[self.call_stack.method_id]:\n            self.accessed_seq_var[self.call_stack.method_id][var] = 0\n        return self.var_name(var) \n```", "```py\nclass ScopedVars(ScopedVars):\n    def var_assign(self, var):\n        self.accessed_seq_var[self.call_stack.method_id][var] += 1\n        self.new_vars.add(self.var_name(var))\n        return self.var_name(var) \n```", "```py\nclass ScopedVars(ScopedVars):\n    def defined_vars(self, formatted=True):\n        def fmt(k):\n            method, i = k[1]\n            v = (method, i, k[0], self.var_def_lines[k])\n            return \"%s[%d]:%s@%s\" % v if formatted else v\n\n        return [(fmt(k), v) for k, v in self.defs.items()] \n```", "```py\nclass ScopedVars(ScopedVars):\n    def seq_vars(self, formatted=True):\n        def fmt(k):\n            method, i = k[1]\n            v = (method, i, k[0], self.var_def_lines[k], k[2])\n            return \"%s[%d]:%s@%s:%s\" % v if formatted else v\n\n        return {fmt(k): v for k, v in self.defs.items()} \n```", "```py\nclass ScopeTracker(AssignmentTracker):\n    def __init__(self, my_input, trace, **kwargs):\n        self.current_event = None\n        super().__init__(my_input, trace, **kwargs)\n\n    def create_assignments(self, *args):\n        return ScopedVars(*args) \n```", "```py\nclass ScopeTracker(ScopeTracker):\n    def is_input_fragment(self, var, value):\n        return self.my_assignments.call_stack.in_scope(var, value) \n```", "```py\nvehicle_traces = []\nwith Tracer(INVENTORY) as tracer:\n    process_inventory(tracer.my_input)\nsm = ScopeTracker(tracer.my_input, tracer.trace)\nvehicle_traces.append((tracer.my_input, sm))\nfor k, v in sm.my_assignments.seq_vars().items():\n    print(k, '=', repr(v)) \n```", "```py\nprocess_inventory[1]:inventory@22:1 = ('1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture', ('<start>', 0))\nprocess_inventory[1]:inventory@22:2 = ('1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_inventory[1]:vehicle@24:1 = ('1997,van,Ford,E350', ('process_inventory', 1))\nprocess_vehicle[2]:vehicle@29:1 = ('1997,van,Ford,E350', ('process_inventory', 1))\nprocess_vehicle[2]:vehicle@29:2 = ('1997,van,Ford,E350', ('process_vehicle', 2))\nprocess_vehicle[2]:year@30:1 = ('1997', ('process_vehicle', 2))\nprocess_vehicle[2]:kind@30:1 = ('van', ('process_vehicle', 2))\nprocess_vehicle[2]:company@30:1 = ('Ford', ('process_vehicle', 2))\nprocess_vehicle[2]:model@30:1 = ('E350', ('process_vehicle', 2))\nprocess_van[3]:year@40:1 = ('1997', ('process_vehicle', 2))\nprocess_van[3]:company@40:1 = ('Ford', ('process_vehicle', 2))\nprocess_van[3]:model@40:1 = ('E350', ('process_vehicle', 2))\nprocess_van[3]:year@40:2 = ('1997', ('process_van', 3))\nprocess_van[3]:company@40:2 = ('Ford', ('process_van', 3))\nprocess_van[3]:model@40:2 = ('E350', ('process_van', 3))\nprocess_inventory[1]:vehicle@24:2 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))\nprocess_vehicle[4]:vehicle@29:1 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))\nprocess_vehicle[4]:vehicle@29:2 = ('2000,car,Mercury,Cougar', ('process_vehicle', 4))\nprocess_vehicle[4]:year@30:1 = ('2000', ('process_vehicle', 4))\nprocess_vehicle[4]:kind@30:1 = ('car', ('process_vehicle', 4))\nprocess_vehicle[4]:company@30:1 = ('Mercury', ('process_vehicle', 4))\nprocess_vehicle[4]:model@30:1 = ('Cougar', ('process_vehicle', 4))\nprocess_car[5]:year@49:1 = ('2000', ('process_vehicle', 4))\nprocess_car[5]:company@49:1 = ('Mercury', ('process_vehicle', 4))\nprocess_car[5]:model@49:1 = ('Cougar', ('process_vehicle', 4))\nprocess_car[5]:year@49:2 = ('2000', ('process_car', 5))\nprocess_car[5]:company@49:2 = ('Mercury', ('process_car', 5))\nprocess_car[5]:model@49:2 = ('Cougar', ('process_car', 5))\nprocess_inventory[1]:vehicle@24:3 = ('1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_vehicle[6]:vehicle@29:1 = ('1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_vehicle[6]:vehicle@29:2 = ('1999,car,Chevy,Venture', ('process_vehicle', 6))\nprocess_vehicle[6]:year@30:1 = ('1999', ('process_vehicle', 6))\nprocess_vehicle[6]:kind@30:1 = ('car', ('process_vehicle', 6))\nprocess_vehicle[6]:company@30:1 = ('Chevy', ('process_vehicle', 6))\nprocess_vehicle[6]:model@30:1 = ('Venture', ('process_vehicle', 6))\nprocess_car[7]:year@49:1 = ('1999', ('process_vehicle', 6))\nprocess_car[7]:company@49:1 = ('Chevy', ('process_vehicle', 6))\nprocess_car[7]:model@49:1 = ('Venture', ('process_vehicle', 6))\nprocess_car[7]:year@49:2 = ('1999', ('process_car', 7))\nprocess_car[7]:company@49:2 = ('Chevy', ('process_car', 7))\nprocess_car[7]:model@49:2 = ('Venture', ('process_car', 7))\n\n```", "```py\ndef my_fn(stringval):\n    partA, partB = stringval.split('/')\n    return partA, partB\n\nsvalue = ...\nv1, v2 = my_fn(svalue) \n```", "```py\nclass ScopeTreeMiner(TreeMiner):\n    def mseq(self, key):\n        method, seq, var, lno = key\n        return seq \n```", "```py\nclass ScopeTreeMiner(ScopeTreeMiner):\n    def nt_var(self, key):\n        method, seq, var, lno = key\n        return to_nonterminal(\"%s@%d:%s\" % (method, lno, var)) \n```", "```py\nclass ScopeTreeMiner(ScopeTreeMiner):\n    def partition(self, part, value):\n        return value.partition(part)\n    def partition_by_part(self, pair, value):\n        (nt_var, nt_seq), (v, v_scope) = pair\n        prefix_k_suffix = [\n                    (nt_var, [(v, [], nt_seq)]) if i == 1 else (e, [])\n                    for i, e in enumerate(self.partition(v, value))\n                    if e]\n        return prefix_k_suffix\n\n    def insert_into_tree(self, my_tree, pair):\n        var, values, my_scope = my_tree\n        (nt_var, nt_seq), (v, v_scope) = pair\n        applied = False\n        for i, value_ in enumerate(values):\n            key, arr, scope = value_\n            self.log(2, \"-> [%d] %s\" % (i, repr(value_)))\n            if is_nonterminal(key):\n                applied = self.insert_into_tree(value_, pair)\n                if applied:\n                    break\n            else:\n                if v_scope != scope:\n                    if nt_seq > scope:\n                        continue\n                if not v or not self.string_part_of_value(v, key):\n                    continue\n                prefix_k_suffix = [(k, children, scope) for k, children\n                                   in self.partition_by_part(pair, key)]\n                del values[i]\n                for j, rep in enumerate(prefix_k_suffix):\n                    values.insert(j + i, rep)\n\n                applied = True\n                self.log(2, \" > %s\" % (repr([i[0] for i in prefix_k_suffix])))\n                break\n        return applied \n```", "```py\nclass ScopeTreeMiner(ScopeTreeMiner):\n    def apply_new_definition(self, tree, var, value_):\n        nt_var = self.nt_var(var)\n        seq = self.mseq(var)\n        val, (smethod, mseq) = value_\n        return self.insert_into_tree(tree, ((nt_var, seq), (val, mseq))) \n```", "```py\nclass ScopeTreeMiner(ScopeTreeMiner):\n    def get_derivation_tree(self):\n        tree = (START_SYMBOL, [(self.my_input, [], 0)], 0)\n        for var, value in self.my_assignments:\n            self.log(0, \"%s=%s\" % (var, repr(value)))\n            self.apply_new_definition(tree, var, value)\n        return tree \n```", "```py\nurl_dts = []\nfor inputstr in URLS_X:\n    clear_cache()\n    with Tracer(inputstr, files=['urllib/parse.py']) as tracer:\n        urlparse(tracer.my_input)\n    sm = ScopeTracker(tracer.my_input, tracer.trace)\n    for k, v in sm.my_assignments.defined_vars(formatted=False):\n        print(k, '=', repr(v))\n    dt = ScopeTreeMiner(\n        tracer.my_input,\n        sm.my_assignments.defined_vars(\n            formatted=False))\n    display_tree(dt.tree, graph_attr=lr_graph)\n    url_dts.append(dt) \n```", "```py\n('urlparse', 1, 'url', 374) = ('http://user:pass@www.google.com:80/?q=path#ref', ('<start>', 0))\n('urlparse', 1, 'url', 374) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))\n('urlsplit', 3, 'url', 492) = ('//user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))\n('urlsplit', 3, 'scheme', 492) = ('http', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//user:pass@www.google.com:80/?q=path#ref', ('_splitnetloc', 5))\n('urlsplit', 3, 'url', 494) = ('/?q=path#ref', ('urlsplit', 3))\n('urlsplit', 3, 'netloc', 494) = ('user:pass@www.google.com:80', ('urlsplit', 3))\n('urlsplit', 3, 'url', 502) = ('/?q=path', ('urlsplit', 3))\n('urlsplit', 3, 'fragment', 502) = ('ref', ('urlsplit', 3))\n('urlsplit', 3, 'query', 504) = ('q=path', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('user:pass@www.google.com:80', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('user:pass@www.google.com:80', ('_checknetloc', 6))\n('urlparse', 1, 'scheme', 396) = ('http', ('urlparse', 1))\n('urlparse', 1, 'netloc', 396) = ('user:pass@www.google.com:80', ('urlparse', 1))\n('urlparse', 1, 'query', 396) = ('q=path', ('urlparse', 1))\n('urlparse', 1, 'fragment', 396) = ('ref', ('urlparse', 1))\n('urlparse', 1, 'url', 374) = ('https://www.cispa.saarland:80/', ('<start>', 0))\n('urlparse', 1, 'url', 374) = ('https://www.cispa.saarland:80/', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('https://www.cispa.saarland:80/', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('https://www.cispa.saarland:80/', ('urlsplit', 3))\n('urlsplit', 3, 'url', 492) = ('//www.cispa.saarland:80/', ('urlsplit', 3))\n('urlsplit', 3, 'scheme', 492) = ('https', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//www.cispa.saarland:80/', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//www.cispa.saarland:80/', ('_splitnetloc', 5))\n('urlsplit', 3, 'netloc', 494) = ('www.cispa.saarland:80', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('www.cispa.saarland:80', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('www.cispa.saarland:80', ('_checknetloc', 6))\n('urlparse', 1, 'scheme', 396) = ('https', ('urlparse', 1))\n('urlparse', 1, 'netloc', 396) = ('www.cispa.saarland:80', ('urlparse', 1))\n('urlparse', 1, 'url', 374) = ('http://www.fuzzingbook.org/#News', ('<start>', 0))\n('urlparse', 1, 'url', 374) = ('http://www.fuzzingbook.org/#News', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('http://www.fuzzingbook.org/#News', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('http://www.fuzzingbook.org/#News', ('urlsplit', 3))\n('urlsplit', 3, 'url', 492) = ('//www.fuzzingbook.org/#News', ('urlsplit', 3))\n('urlsplit', 3, 'scheme', 492) = ('http', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//www.fuzzingbook.org/#News', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//www.fuzzingbook.org/#News', ('_splitnetloc', 5))\n('urlsplit', 3, 'url', 494) = ('/#News', ('urlsplit', 3))\n('urlsplit', 3, 'netloc', 494) = ('www.fuzzingbook.org', ('urlsplit', 3))\n('urlsplit', 3, 'fragment', 502) = ('News', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('www.fuzzingbook.org', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('www.fuzzingbook.org', ('_checknetloc', 6))\n('urlparse', 1, 'scheme', 396) = ('http', ('urlparse', 1))\n('urlparse', 1, 'netloc', 396) = ('www.fuzzingbook.org', ('urlparse', 1))\n('urlparse', 1, 'fragment', 396) = ('News', ('urlparse', 1))\n('urlparse', 1, 'url', 374) = ('ftp://freebsd.org/releases/5.8', ('<start>', 0))\n('urlparse', 1, 'url', 374) = ('ftp://freebsd.org/releases/5.8', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('ftp://freebsd.org/releases/5.8', ('urlparse', 1))\n('urlsplit', 3, 'url', 452) = ('ftp://freebsd.org/releases/5.8', ('urlsplit', 3))\n('urlsplit', 3, 'url', 492) = ('//freebsd.org/releases/5.8', ('urlsplit', 3))\n('urlsplit', 3, 'scheme', 492) = ('ftp', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//freebsd.org/releases/5.8', ('urlsplit', 3))\n('_splitnetloc', 5, 'url', 413) = ('//freebsd.org/releases/5.8', ('_splitnetloc', 5))\n('urlsplit', 3, 'url', 494) = ('/releases/5.8', ('urlsplit', 3))\n('urlsplit', 3, 'netloc', 494) = ('freebsd.org', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('freebsd.org', ('urlsplit', 3))\n('_checknetloc', 6, 'netloc', 421) = ('freebsd.org', ('_checknetloc', 6))\n('urlparse', 1, 'url', 396) = ('/releases/5.8', ('urlparse', 1))\n('urlparse', 1, 'scheme', 396) = ('ftp', ('urlparse', 1))\n('urlparse', 1, 'netloc', 396) = ('freebsd.org', ('urlparse', 1))\n\n```", "```py\nwith Tracer(INVENTORY) as tracer:\n    process_inventory(tracer.my_input)\n\nsm = ScopeTracker(tracer.my_input, tracer.trace)\nfor k, v in sm.my_assignments.defined_vars():\n    print(k, '=', repr(v))\ninventory_dt = ScopeTreeMiner(\n    tracer.my_input,\n    sm.my_assignments.defined_vars(\n        formatted=False))\ndisplay_tree(inventory_dt.tree, graph_attr=lr_graph) \n```", "```py\nprocess_inventory[1]:inventory@22 = ('1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture', ('<start>', 0))\nprocess_inventory[1]:inventory@22 = ('1997,van,Ford,E350\\n2000,car,Mercury,Cougar\\n1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_inventory[1]:vehicle@24 = ('1997,van,Ford,E350', ('process_inventory', 1))\nprocess_vehicle[2]:vehicle@29 = ('1997,van,Ford,E350', ('process_inventory', 1))\nprocess_vehicle[2]:vehicle@29 = ('1997,van,Ford,E350', ('process_vehicle', 2))\nprocess_vehicle[2]:year@30 = ('1997', ('process_vehicle', 2))\nprocess_vehicle[2]:kind@30 = ('van', ('process_vehicle', 2))\nprocess_vehicle[2]:company@30 = ('Ford', ('process_vehicle', 2))\nprocess_vehicle[2]:model@30 = ('E350', ('process_vehicle', 2))\nprocess_van[3]:year@40 = ('1997', ('process_vehicle', 2))\nprocess_van[3]:company@40 = ('Ford', ('process_vehicle', 2))\nprocess_van[3]:model@40 = ('E350', ('process_vehicle', 2))\nprocess_van[3]:year@40 = ('1997', ('process_van', 3))\nprocess_van[3]:company@40 = ('Ford', ('process_van', 3))\nprocess_van[3]:model@40 = ('E350', ('process_van', 3))\nprocess_inventory[1]:vehicle@24 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))\nprocess_vehicle[4]:vehicle@29 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))\nprocess_vehicle[4]:vehicle@29 = ('2000,car,Mercury,Cougar', ('process_vehicle', 4))\nprocess_vehicle[4]:year@30 = ('2000', ('process_vehicle', 4))\nprocess_vehicle[4]:kind@30 = ('car', ('process_vehicle', 4))\nprocess_vehicle[4]:company@30 = ('Mercury', ('process_vehicle', 4))\nprocess_vehicle[4]:model@30 = ('Cougar', ('process_vehicle', 4))\nprocess_car[5]:year@49 = ('2000', ('process_vehicle', 4))\nprocess_car[5]:company@49 = ('Mercury', ('process_vehicle', 4))\nprocess_car[5]:model@49 = ('Cougar', ('process_vehicle', 4))\nprocess_car[5]:year@49 = ('2000', ('process_car', 5))\nprocess_car[5]:company@49 = ('Mercury', ('process_car', 5))\nprocess_car[5]:model@49 = ('Cougar', ('process_car', 5))\nprocess_inventory[1]:vehicle@24 = ('1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_vehicle[6]:vehicle@29 = ('1999,car,Chevy,Venture', ('process_inventory', 1))\nprocess_vehicle[6]:vehicle@29 = ('1999,car,Chevy,Venture', ('process_vehicle', 6))\nprocess_vehicle[6]:year@30 = ('1999', ('process_vehicle', 6))\nprocess_vehicle[6]:kind@30 = ('car', ('process_vehicle', 6))\nprocess_vehicle[6]:company@30 = ('Chevy', ('process_vehicle', 6))\nprocess_vehicle[6]:model@30 = ('Venture', ('process_vehicle', 6))\nprocess_car[7]:year@49 = ('1999', ('process_vehicle', 6))\nprocess_car[7]:company@49 = ('Chevy', ('process_vehicle', 6))\nprocess_car[7]:model@49 = ('Venture', ('process_vehicle', 6))\nprocess_car[7]:year@49 = ('1999', ('process_car', 7))\nprocess_car[7]:company@49 = ('Chevy', ('process_car', 7))\nprocess_car[7]:model@49 = ('Venture', ('process_car', 7))\n\n```", "```py\nclass ScopedGrammarMiner(GrammarMiner):\n    def tree_to_grammar(self, tree):\n        key, children, scope = tree\n        one_alt = [ckey for ckey, gchildren, cscope in children if ckey != key]\n        hsh = {key: [one_alt] if one_alt else []}\n        for child in children:\n            (ckey, _gc, _cscope) = child\n            if not is_nonterminal(ckey):\n                continue\n            chsh = self.tree_to_grammar(child)\n            for k in chsh:\n                if k not in hsh:\n                    hsh[k] = chsh[k]\n                else:\n                    hsh[k].extend(chsh[k])\n        return hsh \n```", "```py\nsi = ScopedGrammarMiner()\nsi.add_tree(inventory_dt)\nsyntax_diagram(readable(si.grammar)) \n```", "```py\nstart\n\n```", "```py\nprocess_inventory@22:inventory\n\n```", "```py\nprocess_inventory@24:vehicle\n\n```", "```py\nprocess_vehicle@29:vehicle\n\n```", "```py\nprocess_vehicle@30:year\n\n```", "```py\nprocess_van@40:year\n\n```", "```py\nprocess_vehicle@30:kind\n\n```", "```py\nprocess_vehicle@30:company\n\n```", "```py\nprocess_van@40:company\n\n```", "```py\nprocess_vehicle@30:model\n\n```", "```py\nprocess_van@40:model\n\n```", "```py\nprocess_car@49:year\n\n```", "```py\nprocess_car@49:company\n\n```", "```py\nprocess_car@49:model\n\n```", "```py\nsu = ScopedGrammarMiner()\nfor t in url_dts:\n    su.add_tree(t)\nsyntax_diagram(readable(su.grammar)) \n```", "```py\nstart\n\n```", "```py\nurlparse@374:url\n\n```", "```py\nurlsplit@452:url\n\n```", "```py\nurlsplit@492:scheme\n\n```", "```py\nurlparse@396:scheme\n\n```", "```py\nurlsplit@492:url\n\n```", "```py\n_splitnetloc@413:url\n\n```", "```py\nurlsplit@494:netloc\n\n```", "```py\n_checknetloc@421:netloc\n\n```", "```py\nurlparse@396:netloc\n\n```", "```py\nurlsplit@494:url\n\n```", "```py\nurlsplit@502:url\n\n```", "```py\nurlsplit@504:query\n\n```", "```py\nurlparse@396:query\n\n```", "```py\nurlsplit@502:fragment\n\n```", "```py\nurlparse@396:fragment\n\n```", "```py\nurlparse@396:url\n\n```", "```py\nclass ScopedGrammarMiner(ScopedGrammarMiner):\n    def get_replacements(self, grammar):\n        replacements = {}\n        for k in grammar:\n            if k == START_SYMBOL:\n                continue\n            alts = grammar[k]\n            if len(set([str(i) for i in alts])) != 1:\n                continue\n            rule = alts[0]\n            if len(rule) != 1:\n                continue\n            tok = rule[0]\n            if not is_nonterminal(tok):\n                continue\n            replacements[k] = tok\n        return replacements \n```", "```py\nclass ScopedGrammarMiner(ScopedGrammarMiner):\n    def clean_grammar(self):\n        replacements = self.get_replacements(self.grammar)\n\n        while True:\n            changed = set()\n            for k in self.grammar:\n                if k in replacements:\n                    continue\n                new_alts = []\n                for alt in self.grammar[k]:\n                    new_alt = []\n                    for t in alt:\n                        if t in replacements:\n                            new_alt.append(replacements[t])\n                            changed.add(t)\n                        else:\n                            new_alt.append(t)\n                    new_alts.append(new_alt)\n                self.grammar[k] = new_alts\n            if not changed:\n                break\n            for k in changed:\n                self.grammar.pop(k, None)\n        return readable(self.grammar) \n```", "```py\nsi = ScopedGrammarMiner()\nsi.add_tree(inventory_dt)\nsyntax_diagram(readable(si.clean_grammar())) \n```", "```py\nstart\n\n```", "```py\nprocess_inventory@22:inventory\n\n```", "```py\nprocess_vehicle@29:vehicle\n\n```", "```py\nprocess_vehicle@30:year\n\n```", "```py\nprocess_van@40:year\n\n```", "```py\nprocess_vehicle@30:kind\n\n```", "```py\nprocess_vehicle@30:company\n\n```", "```py\nprocess_van@40:company\n\n```", "```py\nprocess_vehicle@30:model\n\n```", "```py\nprocess_van@40:model\n\n```", "```py\nprocess_car@49:year\n\n```", "```py\nprocess_car@49:company\n\n```", "```py\nprocess_car@49:model\n\n```", "```py\nclass ScopedGrammarMiner(ScopedGrammarMiner):\n    def update_grammar(self, inputstr, trace):\n        at = self.create_tracker(inputstr, trace)\n        dt = self.create_tree_miner(\n            inputstr, at.my_assignments.defined_vars(\n                formatted=False))\n        self.add_tree(dt)\n        return self.grammar\n\n    def create_tracker(self, *args):\n        return ScopeTracker(*args)\n\n    def create_tree_miner(self, *args):\n        return ScopeTreeMiner(*args) \n```", "```py\ndef recover_grammar(fn, inputs, **kwargs):\n    miner = ScopedGrammarMiner()\n    for inputstr in inputs:\n        with Tracer(inputstr, **kwargs) as tracer:\n            fn(tracer.my_input)\n        miner.update_grammar(tracer.my_input, tracer.trace)\n    return readable(miner.clean_grammar()) \n```", "```py\nurl_grammar = recover_grammar(url_parse, URLS_X, files=['urllib/parse.py']) \n```", "```py\nsyntax_diagram(url_grammar) \n```", "```py\nstart\n\n```", "```py\nurlsplit@452:url\n\n```", "```py\nurlparse@396:scheme\n\n```", "```py\n_splitnetloc@413:url\n\n```", "```py\nurlparse@396:netloc\n\n```", "```py\nurlsplit@494:url\n\n```", "```py\nurlsplit@502:url\n\n```", "```py\nurlparse@396:query\n\n```", "```py\nurlparse@396:fragment\n\n```", "```py\nurlparse@396:url\n\n```", "```py\nf = GrammarFuzzer(url_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\nftp://user:pass@www.google.com:80/\nftp://freebsd.org/?q=path#News\nftp://freebsd.org/\nftp://www.fuzzingbook.org/?q=path#News\nhttps://www.fuzzingbook.org/\nftp://www.fuzzingbook.org/#News\nftp://www.fuzzingbook.org/releases/5.8\nhttp://www.fuzzingbook.org/?q=path#ref\nhttp://freebsd.org/\nftp://user:pass@www.google.com:80/\n\n```", "```py\ninventory_grammar = recover_grammar(process_inventory, [INVENTORY]) \n```", "```py\nsyntax_diagram(inventory_grammar) \n```", "```py\nstart\n\n```", "```py\nprocess_inventory@22:inventory\n\n```", "```py\nprocess_vehicle@29:vehicle\n\n```", "```py\nprocess_vehicle@30:year\n\n```", "```py\nprocess_van@40:year\n\n```", "```py\nprocess_vehicle@30:kind\n\n```", "```py\nprocess_vehicle@30:company\n\n```", "```py\nprocess_van@40:company\n\n```", "```py\nprocess_vehicle@30:model\n\n```", "```py\nprocess_van@40:model\n\n```", "```py\nprocess_car@49:year\n\n```", "```py\nprocess_car@49:company\n\n```", "```py\nprocess_car@49:model\n\n```", "```py\nf = GrammarFuzzer(inventory_grammar)\nfor _ in range(10):\n    print(f.fuzz()) \n```", "```py\n1997,van,Mercury,E350\n1999,car,Ford,Venture\n2000,car,Ford,Cougar\n2000,van,Chevy,Venture\n1999,car,Mercury,E350\n1997,van,Ford,Venture\n1997,car,Chevy,Cougar\n1999,car,Ford,E350\n1999,car,Chevy,Cougar\n1997,car,Chevy,Venture\n1997,car,Ford,E350\n2000,car,Mercury,E350\n1999,van,Chevy,E350\n1997,van,Ford,Cougar\n1999,van,Chevy,Venture\n1999,car,Ford,E350\n1999,van,Mercury,Venture\n1997,car,Ford,Cougar\n1999,car,Mercury,Venture\n1997,van,Mercury,E350\n1999,car,Chevy,Cougar\n2000,van,Chevy,Venture\n2000,car,Ford,Venture\n1997,car,Mercury,E350\n1997,van,Chevy,E350\n1997,van,Ford,E350\n2000,car,Ford,E350\n1997,car,Chevy,Venture\n1997,van,Ford,E350\n2000,van,Chevy,Cougar\n\n```", "```py\nclass Vehicle:\n    def __init__(self, vehicle: str):\n        year, kind, company, model, *_ = vehicle.split(',')\n        self.year, self.kind, self.company, self.model = year, kind, company, model \n```", "```py\ndef process_inventory_with_obj(inventory: str) -> str:\n    res = []\n    for vehicle in inventory.split('\\n'):\n        ret = process_vehicle(vehicle)\n        res.extend(ret)\n\n    return '\\n'.join(res) \n```", "```py\ndef process_vehicle_with_obj(vehicle: str) -> List[str]:\n    v = Vehicle(vehicle)\n    if v.kind == 'van':\n        return process_van_with_obj(v)\n\n    elif v.kind == 'car':\n        return process_car_with_obj(v)\n\n    else:\n        raise Exception('Invalid entry') \n```", "```py\ndef process_van_with_obj(vehicle: Vehicle) -> List[str]:\n    res = [\n        \"We have a %s  %s van from %s vintage.\" % (vehicle.company,\n                                                  vehicle.model, vehicle.year)\n    ]\n    iyear = int(vehicle.year)\n    if iyear > 2010:\n        res.append(\"It is a recent model!\")\n    else:\n        res.append(\"It is an old but reliable model!\")\n    return res \n```", "```py\ndef process_car_with_obj(vehicle: Vehicle) -> List[str]:\n    res = [\n        \"We have a %s  %s car from %s vintage.\" % (vehicle.company,\n                                                  vehicle.model, vehicle.year)\n    ]\n    iyear = int(vehicle.year)\n    if iyear > 2016:\n        res.append(\"It is a recent model!\")\n    else:\n        res.append(\"It is an old but reliable model!\")\n    return res \n```", "```py\nvehicle_grammar = recover_grammar(\n    process_inventory_with_obj,\n    [INVENTORY],\n    methods=INVENTORY_METHODS) \n```", "```py\nsyntax_diagram(vehicle_grammar) \n```", "```py\nstart\n\n```", "```py\nprocess_vehicle@29:vehicle\n\n```", "```py\nprocess_vehicle@30:year\n\n```", "```py\nprocess_van@40:year\n\n```", "```py\nprocess_vehicle@30:kind\n\n```", "```py\nprocess_vehicle@30:company\n\n```", "```py\nprocess_van@40:company\n\n```", "```py\nprocess_vehicle@30:model\n\n```", "```py\nprocess_van@40:model\n\n```", "```py\nprocess_car@49:year\n\n```", "```py\nprocess_car@49:company\n\n```", "```py\nprocess_car@49:model\n\n```", "```py\n@incollection{fuzzingbook2023:GrammarMiner,\n    author = {Andreas Zeller and Rahul Gopinath and Marcel B{\\\"o}hme and Gordon Fraser and Christian Holler},\n    booktitle = {The Fuzzing Book},\n    title = {Mining Input Grammars},\n    year = {2023},\n    publisher = {CISPA Helmholtz Center for Information Security},\n    howpublished = {\\url{https://www.fuzzingbook.org/html/GrammarMiner.html}},\n    note = {Retrieved 2023-11-11 18:18:06+01:00},\n    url = {https://www.fuzzingbook.org/html/GrammarMiner.html},\n    urldate = {2023-11-11 18:18:06+01:00}\n}\n\n```"]