- en: Error Handling
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[http://www.fuzzingbook.org/html/ExpectError.html](http://www.fuzzingbook.org/html/ExpectError.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The code in this notebook helps with handling errors. Normally, an error in
    notebook code causes the execution of the code to stop; while an infinite loop
    in notebook code causes the notebook to run without end. This notebook provides
    two classes to help address these concerns.
  prefs: []
  type: TYPE_NORMAL
- en: '**Prerequisites**'
  prefs: []
  type: TYPE_NORMAL
- en: This notebook needs some understanding on advanced concepts in Python, notably
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: classes
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: the Python `with` statement
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: tracing
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: measuring time
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: exceptions
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Synopsis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To [use the code provided in this chapter](Importing.html), write
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: and then make use of the following features.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `ExpectError` class allows you to catch and report exceptions, yet resume
    execution. This is useful in notebooks, as they would normally interrupt execution
    as soon as an exception is raised. Its typical usage is in conjunction with a
    `with` clause:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The `ExpectTimeout` class allows you to interrupt execution after the specified
    time. This is useful for interrupting code that might otherwise run forever.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The exception and the associated traceback are printed as error messages. If
    you do not want that, use these keyword options:'
  prefs: []
  type: TYPE_NORMAL
- en: '`print_traceback` (default True) can be set to `False` to avoid the traceback
    being printed'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mute` (default False) can be set to `True` to completely avoid any output.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Catching Errors
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The class `ExpectError` allows to express that some code produces an exception.
    A typical usage looks as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: If an exception occurs, it is printed on standard error; yet, execution continues.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Here''s an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: We can specify the type of the expected exception. This way, if something else
    happens, we will get notified.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: Catching Timeouts
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The class `ExpectTimeout(seconds)` allows expressing that some code may run
    for a long or infinite time; execution is thus interrupted after `seconds` seconds.
    A typical usage looks as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: If an exception occurs, it is printed on standard error (as with `ExpectError`);
    yet, execution continues.
  prefs: []
  type: TYPE_NORMAL
- en: Should there be a need to cancel the timeout within the `with` block, `t.cancel()`
    will do the trick.
  prefs: []
  type: TYPE_NORMAL
- en: The implementation uses `sys.settrace()`, as this seems to be the most portable
    way to implement timeouts. It is not very efficient, though. Also, it only works
    on individual lines of Python code and will not interrupt a long-running system
    function.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'Here''s an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: Note that it is possible to nest multiple timeouts.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: That's it, folks – enjoy!
  prefs: []
  type: TYPE_NORMAL
- en: Lessons Learned
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: With the `ExpectError` class, it is very easy to handle errors without interrupting
    notebook execution.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)
    The content of this project is licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike
    4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).
    The source code that is part of the content, as well as the source code used to
    format and display that content is licensed under the [MIT License](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license).
    [Last change: 2023-11-11 18:25:46+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/ExpectError.ipynb)
    • [Cite](#citation) • [Imprint](https://cispa.de/en/impressum)'
  prefs: []
  type: TYPE_IMG
- en: How to Cite this Work
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler: "[Error Handling](https://www.fuzzingbook.org/html/ExpectError.html)".
    In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler, "[The Fuzzing Book](https://www.fuzzingbook.org/)", [https://www.fuzzingbook.org/html/ExpectError.html](https://www.fuzzingbook.org/html/ExpectError.html).
    Retrieved 2023-11-11 18:25:46+01:00.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
