- en: Greybox Fuzzing with Grammars
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[http://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html](http://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In this chapter, we introduce important extensions to our syntactic fuzzing
    techniques, all leveraging *syntactic* parts of *existing inputs*.
  prefs: []
  type: TYPE_NORMAL
- en: We show how to leverage *dictionaries* of input fragments during fuzzing. The
    idea is to integrate such dictionaries into a *mutator*, which would then inject
    these fragments (typically keywords and other items of importance) into population.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We show how to combine [parsing](Parser.html) and [fuzzing](GrammarFuzzer.html)
    with grammars. This allows *mutating* existing inputs while preserving syntactical
    correctness, and to *reuse* fragments from existing inputs while generating new
    ones. The combination of language-based parsing and generating, as demonstrated
    in this chapter, has been highly successful in practice: The *LangFuzz* fuzzer
    for JavaScript has found more than 2,600 bugs in JavaScript interpreters this
    way.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the previous chapters, we have used grammars in a *black-box* manner – that
    is, we have used them to generate inputs regardless of the program being tested.
    In this chapter, we introduce mutational *greybox fuzzing with grammars*: Techniques
    that make use of *feedback from the program under test* to guide test generations
    towards specific goals. As in [lexical greybox fuzzing](GreyboxFuzzer.html), this
    feedback is mostly *coverage*, allowing us to direct grammar-based testing towards
    uncovered code parts. This part is inspired by the *AFLSmart* fuzzer, which combines
    parsing and mutational fuzzing.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Prerequisites**'
  prefs: []
  type: TYPE_NORMAL
- en: We build on several concepts from [the chapter on greybox fuzzing (without grammars)](GreyboxFuzzer.html).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As the title suggests, you should know how to fuzz with grammars [from the chapter
    on grammars](Grammars.html).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Synopsis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To [use the code provided in this chapter](Importing.html), write
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: and then make use of the following features.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter introduces advanced methods for language-based grey-box fuzzing
    inspired by the *LangFuzz* and *AFLSmart* fuzzers.
  prefs: []
  type: TYPE_NORMAL
- en: Fuzzing with Dictionaries
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Rather than mutating strings randomly, the `DictMutator` class allows inserting
    tokens from a dictionary, thus increasing fuzzer performance. The dictionary comes
    as a list of strings, out of which random elements are picked and inserted - in
    addition to the given mutations such as deleting or inserting individual bytes.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'This `DictMutator` can be used as an argument to `GreyboxFuzzer`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '<svg width="306pt" height="152pt" viewBox="0.00 0.00 305.62 152.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 148.25)"><g
    id="node1" class="node"><title>DictMutator</title> <g id="a_node1"><a xlink:href="#"
    xlink:title="class DictMutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate strings using keywords from a dictionary"><text text-anchor="start"
    x="42.12" y="-43.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold"
    font-size="14.00" fill="#b03a2e">DictMutator</text> <g id="a_node1_0"><a xlink:href="#"
    xlink:title="DictMutator"><g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self,
    dictionary: List[str]) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Constructor. `dictionary` is the list of keywords to use."><text text-anchor="start"
    x="8" y="-21.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text></a></g>
    <g id="a_node1_2"><a xlink:href="#" xlink:title="insert_from_dictionary(self,
    s: str) -> str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns s with a keyword from the dictionary inserted"><text text-anchor="start"
    x="8" y="-7.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">insert_from_dictionary()</text></a></g></a></g></a></g></g>
    <g id="node2" class="node"><title>Mutator</title> <g id="a_node2"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="class Mutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate strings"><text text-anchor="start" x="54.12" y="-127.45" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
    <g id="a_node2_3"><a xlink:href="#" xlink:title="Mutator"><g id="a_node2_4"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor"><text text-anchor="start" x="50" y="-105.25" font-family="'Fira
    Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g></a></g></a></g></g> <g id="edge1"
    class="edge"><title>DictMutator->Mutator</title></g> <g id="node3" class="node"><title>Legend</title>
    <text text-anchor="start" x="178.38" y="-46.25" font-family="Patua One, Helvetica,
    sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
    <text text-anchor="start" x="178.38" y="-36.25" font-family="Patua One, Helvetica,
    sans-serif" font-size="10.00">• </text> <text text-anchor="start" x="184.38" y="-36.25"
    font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold"
    font-size="8.00">public_method()</text> <text text-anchor="start" x="178.38" y="-26.25"
    font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text> <text
    text-anchor="start" x="184.38" y="-26.25" font-family="'Fira Mono', 'Source Code
    Pro', 'Courier', monospace" font-size="8.00">private_method()</text> <text text-anchor="start"
    x="178.38" y="-16.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
    <text text-anchor="start" x="184.38" y="-16.25" font-family="'Fira Mono', 'Source
    Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
    <text text-anchor="start" x="178.38" y="-7.2" font-family="Helvetica,sans-Serif"
    font-size="9.00">Hover over names to see doc</text></g></g></svg>
  prefs: []
  type: TYPE_NORMAL
- en: Fuzzing with Input Fragments
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The `LangFuzzer` class introduces a *language-aware* fuzzer that can recombine
    fragments from existing inputs – inspired by the highly effective `LangFuzz` fuzzer.
    At its core is a `FragmentMutator` class that that takes a [*parser*](Parser.html)
    as argument:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The fuzzer itself is initialized with a list of seeds, the above `FragmentMutator`,
    and a power schedule:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '<svg width="462pt" height="389pt" viewBox="0.00 0.00 461.88 389.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 385)"><g
    id="node1" class="node"><title>LangFuzzer</title> <g id="a_node1"><a xlink:href="#"
    xlink:title="class LangFuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Blackbox fuzzer mutating input fragments. Roughly based on `LangFuzz`."><text
    text-anchor="start" x="52.62" y="-88.33" font-family="Patua One, Helvetica, sans-serif"
    font-weight="bold" font-size="14.00" fill="#b03a2e">LangFuzzer</text> <g id="a_node1_0"><a
    xlink:href="#" xlink:title="LangFuzzer"><g id="a_node1_1"><a xlink:href="#" xlink:title="create_candidate(self)
    -> GreyboxFuzzer.Seed:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns an input generated by fuzzing a seed in the population"><text text-anchor="start"
    x="34.25" y="-66.12" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">create_candidate()</text></a></g></a></g></a></g></g>
    <g id="node2" class="node"><title>AdvancedMutationFuzzer</title> <g id="a_node2"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="class AdvancedMutationFuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Base class for mutation-based fuzzing."><text text-anchor="start" x="8" y="-242.2"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">AdvancedMutationFuzzer</text> <g id="a_node2_2"><a xlink:href="#"
    xlink:title="AdvancedMutationFuzzer"><g id="a_node2_3"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="__init__(self, seeds: List[str], mutator: GreyboxFuzzer.Mutator,
    schedule: GreyboxFuzzer.PowerSchedule) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor.
  prefs: []
  type: TYPE_NORMAL
- en: '`seeds` - a list of (input) strings to mutate.'
  prefs: []
  type: TYPE_NORMAL
- en: '`mutator` - the mutator to apply.'
  prefs: []
  type: TYPE_NORMAL
- en: '`schedule` - the power schedule to apply."><text text-anchor="start" x="58.25"
    y="-220" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-style="italic" font-size="10.00">__init__()</text></a></g>
    <g id="a_node2_4"><a xlink:href="GreyboxFuzzer.html" xlink:title="fuzz(self) ->
    str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns first each seed once and then generates new inputs"><text text-anchor="start"
    x="58.25" y="-207.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text></a></g></a></g></a></g></g>
    <g id="edge1" class="edge"><title>LangFuzzer->AdvancedMutationFuzzer</title></g>
    <g id="node3" class="node"><title>Fuzzer</title> <g id="a_node3"><a xlink:href="Fuzzer.html"
    xlink:title="class Fuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Base class for fuzzers."><text text-anchor="start" x="67.62" y="-364.2" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Fuzzer</text>
    <g id="a_node3_5"><a xlink:href="#" xlink:title="Fuzzer"><g id="a_node3_6"><a
    xlink:href="Fuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Constructor"><text text-anchor="start" x="58.25" y="-342" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node3_7"><a xlink:href="Fuzzer.html"
    xlink:title="fuzz(self) -> str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Return fuzz input"><text text-anchor="start" x="58.25" y="-329.25" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">fuzz()</text></a></g> <g id="a_node3_8"><a xlink:href="Fuzzer.html"
    xlink:title="run(self, runner: Fuzzer.Runner = <Fuzzer.Runner object>) -> Tuple[subprocess.CompletedProcess,
    str]:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Run `runner` with fuzz input"><text text-anchor="start" x="58.25" y="-316.5"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-size="10.00">run()</text></a></g> <g id="a_node3_9"><a xlink:href="Fuzzer.html"
    xlink:title="runs(self, runner: Fuzzer.Runner = <Fuzzer.PrintRunner object>, trials:
    int = 10) -> List[Tuple[subprocess.CompletedProcess, str]]:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Run `runner` with fuzz input, `trials` times"><text text-anchor="start" x="58.25"
    y="-303.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-size="10.00">runs()</text></a></g></a></g></a></g></g>
    <g id="edge2" class="edge"><title>AdvancedMutationFuzzer->Fuzzer</title></g> <g
    id="node4" class="node"><title>FragmentMutator</title> <g id="a_node4"><a xlink:href="#"
    xlink:title="class FragmentMutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate inputs with input fragments from a pool"><text text-anchor="start" x="186.38"
    y="-145.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">FragmentMutator</text> <g id="a_node4_10"><a xlink:href="#" xlink:title="FragmentMutator"><g
    id="a_node4_11"><a xlink:href="#" xlink:title="__init__(self, parser):'
  prefs: []
  type: TYPE_NORMAL
- en: 'Initialize mutators"><text text-anchor="start" x="176.25" y="-123.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node4_12"><a xlink:href="#"
    xlink:title="add_to_fragment_pool(self, seed: SeedWithStructure) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Adds all fragments of a seed to the fragment pool"><text text-anchor="start"
    x="176.25" y="-110.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-size="10.00">add_to_fragment_pool()</text></a></g>
    <g id="a_node4_13"><a xlink:href="#" xlink:title="add_fragment(self, fragment:
    DerivationTree) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively adds fragments to the fragment pool"><text text-anchor="start"
    x="176.25" y="-97" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">add_fragment()</text></a></g> <g id="a_node4_14"><a
    xlink:href="#" xlink:title="count_nodes(self, fragment: DerivationTree) -> int:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns the number of nodes in the fragment"><text text-anchor="start" x="176.25"
    y="-84.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">count_nodes()</text></a></g> <g id="a_node4_15"><a xlink:href="#"
    xlink:title="delete_fragment(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Delete a random fragment"><text text-anchor="start" x="176.25" y="-71.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-size="10.00">delete_fragment()</text></a></g>
    <g id="a_node4_16"><a xlink:href="#" xlink:title="is_excluded(self, symbol: str)
    -> bool:'
  prefs: []
  type: TYPE_NORMAL
- en: Returns true if a fragment starting with a specific
  prefs: []
  type: TYPE_NORMAL
- en: 'symbol and all its decendents can be excluded"><text text-anchor="start" x="176.25"
    y="-58.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">is_excluded()</text></a></g> <g id="a_node4_17"><a xlink:href="#"
    xlink:title="mutate(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Implement structure-aware mutation. Memoize seeds."><text text-anchor="start"
    x="176.25" y="-47" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">mutate()</text></a></g> <g id="a_node4_18"><a
    xlink:href="#" xlink:title="recursive_delete(self, fragment: DerivationTree) ->
    DerivationTree:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively finds the fragment to delete"><text text-anchor="start" x="176.25"
    y="-33.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">recursive_delete()</text></a></g> <g id="a_node4_19"><a xlink:href="#"
    xlink:title="recursive_swap(self, fragment: DerivationTree) -> DerivationTree:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively finds the fragment to swap."><text text-anchor="start" x="176.25"
    y="-20.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">recursive_swap()</text></a></g> <g id="a_node4_20"><a xlink:href="#"
    xlink:title="swap_fragment(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Substitutes a random fragment with another with the same symbol"><text text-anchor="start"
    x="176.25" y="-7.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">swap_fragment()</text></a></g></a></g></a></g></g>
    <g id="node5" class="node"><title>Mutator</title> <g id="a_node5"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="class Mutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate strings"><text text-anchor="start" x="216.38" y="-235.82" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
    <g id="a_node5_21"><a xlink:href="#" xlink:title="Mutator"><g id="a_node5_22"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor"><text text-anchor="start" x="212.25" y="-213.62" font-family="'Fira
    Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g></a></g></a></g></g> <g id="edge3"
    class="edge"><title>FragmentMutator->Mutator</title></g> <g id="node6" class="node"><title>Legend</title>
    <text text-anchor="start" x="334.62" y="-97.25" font-family="Patua One, Helvetica,
    sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
    <text text-anchor="start" x="334.62" y="-87.25" font-family="Patua One, Helvetica,
    sans-serif" font-size="10.00">• </text> <text text-anchor="start" x="340.62" y="-87.25"
    font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold"
    font-size="8.00">public_method()</text> <text text-anchor="start" x="334.62" y="-77.25"
    font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text> <text
    text-anchor="start" x="340.62" y="-77.25" font-family="'Fira Mono', 'Source Code
    Pro', 'Courier', monospace" font-size="8.00">private_method()</text> <text text-anchor="start"
    x="334.62" y="-67.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
    <text text-anchor="start" x="340.62" y="-67.25" font-family="'Fira Mono', 'Source
    Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
    <text text-anchor="start" x="334.62" y="-58.2" font-family="Helvetica,sans-Serif"
    font-size="9.00">Hover over names to see doc</text></g></g></svg>
  prefs: []
  type: TYPE_NORMAL
- en: Fuzzing with Input Regions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The `GreyboxGrammarFuzzer` class uses two mutators:'
  prefs: []
  type: TYPE_NORMAL
- en: a *tree mutator* (a `RegionMutator` object) that can parse existing strings
    to identify *regions* in that string to be swapped or deleted.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: a *byte mutator* to apply bit- and character-level mutations.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: The *schedule* for the `GreyboxGrammarFuzzer` class can be a regular `PowerSchedule`
    object. However, a more sophisticated schedule is provided by `AFLSmartSchedule`,
    which assigns more [energy](GreyboxFuzzer.html#Power-Schedules) to seeds that
    have a higher degree of validity.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'The `GreyboxGrammarFuzzer` constructor takes a set of seeds as well as the
    two mutators and the schedule:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'As it relies on code coverage, it is typically combined with a `FunctionCoverageRunner`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '<svg width="638pt" height="511pt" viewBox="0.00 0.00 637.88 511.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 507)"><g
    id="node1" class="node"><title>GreyboxGrammarFuzzer</title> <g id="a_node1"><a
    xlink:href="#" xlink:title="class GreyboxGrammarFuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Greybox fuzzer using grammars."><text text-anchor="start" x="12.5" y="-56.45"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">GreyboxGrammarFuzzer</text> <g id="a_node1_0"><a xlink:href="#"
    xlink:title="GreyboxGrammarFuzzer"><g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self,
    seeds: List[str], byte_mutator: GreyboxFuzzer.Mutator, tree_mutator: FragmentMutator,
    schedule: GreyboxFuzzer.PowerSchedule) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor.
  prefs: []
  type: TYPE_NORMAL
- en: '`seeds` - set of inputs to mutate.'
  prefs: []
  type: TYPE_NORMAL
- en: '`byte_mutator` - a byte-level mutator.'
  prefs: []
  type: TYPE_NORMAL
- en: '`tree_mutator` = a tree-level mutator.'
  prefs: []
  type: TYPE_NORMAL
- en: '`schedule` - a power schedule."><text text-anchor="start" x="34.25" y="-34.25"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-style="italic" font-size="10.00">__init__()</text></a></g> <g id="a_node1_2"><a
    xlink:href="#" xlink:title="create_candidate(self) -> str:'
  prefs: []
  type: TYPE_NORMAL
- en: Returns an input generated by structural mutation
  prefs: []
  type: TYPE_NORMAL
- en: 'of a seed in the population"><text text-anchor="start" x="34.25" y="-21.5"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic"
    font-size="10.00">create_candidate()</text></a></g></a></g></a></g></g> <g id="node2"
    class="node"><title>GreyboxFuzzer</title> <g id="a_node2"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="class GreyboxFuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Coverage-guided mutational fuzzing."><text text-anchor="start" x="41.75" y="-210.32"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">GreyboxFuzzer</text> <g id="a_node2_3"><a xlink:href="#" xlink:title="GreyboxFuzzer"><g
    id="a_node2_4"><a xlink:href="GreyboxFuzzer.html" xlink:title="run(self, runner:
    MutationFuzzer.FunctionCoverageRunner) -> Tuple[Any, str]:'
  prefs: []
  type: TYPE_NORMAL
- en: Run function(inp) while tracking coverage.
  prefs: []
  type: TYPE_NORMAL
- en: If we reach new coverage,
  prefs: []
  type: TYPE_NORMAL
- en: 'add inp to population and its coverage to population_coverage"><text text-anchor="start"
    x="73.25" y="-188.12" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text></a></g></a></g></a></g></g>
    <g id="edge1" class="edge"><title>GreyboxGrammarFuzzer->GreyboxFuzzer</title></g>
    <g id="node3" class="node"><title>AdvancedMutationFuzzer</title> <g id="a_node3"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="class AdvancedMutationFuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Base class for mutation-based fuzzing."><text text-anchor="start" x="8" y="-364.2"
    font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">AdvancedMutationFuzzer</text> <g id="a_node3_5"><a xlink:href="#"
    xlink:title="AdvancedMutationFuzzer"><g id="a_node3_6"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="__init__(self, seeds: List[str], mutator: GreyboxFuzzer.Mutator,
    schedule: GreyboxFuzzer.PowerSchedule) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor.
  prefs: []
  type: TYPE_NORMAL
- en: '`seeds` - a list of (input) strings to mutate.'
  prefs: []
  type: TYPE_NORMAL
- en: '`mutator` - the mutator to apply.'
  prefs: []
  type: TYPE_NORMAL
- en: '`schedule` - the power schedule to apply."><text text-anchor="start" x="58.25"
    y="-342" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-style="italic" font-size="10.00">__init__()</text></a></g>
    <g id="a_node3_7"><a xlink:href="GreyboxFuzzer.html" xlink:title="fuzz(self) ->
    str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns first each seed once and then generates new inputs"><text text-anchor="start"
    x="58.25" y="-329.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text></a></g></a></g></a></g></g>
    <g id="edge2" class="edge"><title>GreyboxFuzzer->AdvancedMutationFuzzer</title></g>
    <g id="node4" class="node"><title>Fuzzer</title> <g id="a_node4"><a xlink:href="Fuzzer.html"
    xlink:title="class Fuzzer:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Base class for fuzzers."><text text-anchor="start" x="67.62" y="-486.2" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Fuzzer</text>
    <g id="a_node4_8"><a xlink:href="#" xlink:title="Fuzzer"><g id="a_node4_9"><a
    xlink:href="Fuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Constructor"><text text-anchor="start" x="58.25" y="-464" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node4_10"><a xlink:href="Fuzzer.html"
    xlink:title="fuzz(self) -> str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Return fuzz input"><text text-anchor="start" x="58.25" y="-451.25" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">fuzz()</text></a></g> <g id="a_node4_11"><a xlink:href="Fuzzer.html"
    xlink:title="run(self, runner: Fuzzer.Runner = <Fuzzer.Runner object>) -> Tuple[subprocess.CompletedProcess,
    str]:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Run `runner` with fuzz input"><text text-anchor="start" x="58.25" y="-438.5"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold"
    font-style="italic" font-size="10.00">run()</text></a></g> <g id="a_node4_12"><a
    xlink:href="Fuzzer.html" xlink:title="runs(self, runner: Fuzzer.Runner = <Fuzzer.PrintRunner
    object>, trials: int = 10) -> List[Tuple[subprocess.CompletedProcess, str]]:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Run `runner` with fuzz input, `trials` times"><text text-anchor="start" x="58.25"
    y="-425.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-weight="bold" font-size="10.00">runs()</text></a></g></a></g></a></g></g>
    <g id="edge3" class="edge"><title>AdvancedMutationFuzzer->Fuzzer</title></g> <g
    id="node5" class="node"><title>AFLSmartSchedule</title> <g id="a_node5"><a xlink:href="#"
    xlink:title="class AFLSmartSchedule:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Define how fuzzing time should be distributed across the population."><text
    text-anchor="start" x="200.5" y="-69.2" font-family="Patua One, Helvetica, sans-serif"
    font-weight="bold" font-size="14.00" fill="#b03a2e">AFLSmartSchedule</text> <g
    id="a_node5_13"><a xlink:href="#" xlink:title="AFLSmartSchedule"><g id="a_node5_14"><a
    xlink:href="#" xlink:title="__init__(self, parser: Parser.EarleyParser, exponent:
    float = 1.0):'
  prefs: []
  type: TYPE_NORMAL
- en: 'Constructor"><text text-anchor="start" x="198.25" y="-47" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node5_15"><a xlink:href="#"
    xlink:title="assignEnergy(self, population: Sequence[GreyboxFuzzer.Seed]):'
  prefs: []
  type: TYPE_NORMAL
- en: 'Assign exponential energy proportional to degree of validity"><text text-anchor="start"
    x="198.25" y="-34.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">assignEnergy()</text></a></g>
    <g id="a_node5_16"><a xlink:href="#" xlink:title="degree_of_validity(self, seed:
    GreyboxFuzzer.Seed) -> float:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns the proportion of a seed that is parsable"><text text-anchor="start"
    x="198.25" y="-20.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">degree_of_validity()</text></a></g> <g id="a_node5_17"><a
    xlink:href="#" xlink:title="parsable(self, seed: GreyboxFuzzer.Seed) -> str:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns the substring that is parsable"><text text-anchor="start" x="198.25"
    y="-7.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">parsable()</text></a></g></a></g></a></g></g> <g id="node6"
    class="node"><title>PowerSchedule</title> <g id="a_node6"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="class PowerSchedule:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Define how fuzzing time should be distributed across the population."><text
    text-anchor="start" x="211.38" y="-210.32" font-family="Patua One, Helvetica,
    sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">PowerSchedule</text>
    <g id="a_node6_18"><a xlink:href="#" xlink:title="PowerSchedule"><g id="a_node6_19"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Constructor"><text text-anchor="start" x="228.25" y="-188.12" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g></a></g></a></g></g> <g id="edge4"
    class="edge"><title>AFLSmartSchedule->PowerSchedule</title></g> <g id="node7"
    class="node"><title>RegionMutator</title> <g id="a_node7"><a xlink:href="#" xlink:title="class
    RegionMutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate inputs with input fragments from a pool"><text text-anchor="start" x="371"
    y="-62.83" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">RegionMutator</text> <g id="a_node7_20"><a xlink:href="#" xlink:title="RegionMutator"><g
    id="a_node7_21"><a xlink:href="#" xlink:title="add_to_fragment_pool(self, seed:
    SeedWithRegions) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mark fragments and regions in a seed file"><text text-anchor="start" x="352.25"
    y="-40.62" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-style="italic" font-size="10.00">add_to_fragment_pool()</text></a></g> <g
    id="a_node7_22"><a xlink:href="#" xlink:title="delete_fragment(self, seed: SeedWithRegions)
    -> SeedWithRegions:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Deletes a random region"><text text-anchor="start" x="352.25" y="-27.88" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic" font-size="10.00">delete_fragment()</text></a></g>
    <g id="a_node7_23"><a xlink:href="#" xlink:title="swap_fragment(self, seed: SeedWithRegions)
    -> SeedWithRegions:'
  prefs: []
  type: TYPE_NORMAL
- en: Chooses a random region and swaps it with a fragment
  prefs: []
  type: TYPE_NORMAL
- en: 'that starts with the same symbol"><text text-anchor="start" x="352.25" y="-15.12"
    font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic"
    font-size="10.00">swap_fragment()</text></a></g></a></g></a></g></g> <g id="node8"
    class="node"><title>FragmentMutator</title> <g id="a_node8"><a xlink:href="#"
    xlink:title="class FragmentMutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate inputs with input fragments from a pool"><text text-anchor="start" x="362.38"
    y="-267.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00"
    fill="#b03a2e">FragmentMutator</text> <g id="a_node8_24"><a xlink:href="#" xlink:title="FragmentMutator"><g
    id="a_node8_25"><a xlink:href="#" xlink:title="__init__(self, parser):'
  prefs: []
  type: TYPE_NORMAL
- en: 'Initialize mutators"><text text-anchor="start" x="352.25" y="-245.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g> <g id="a_node8_26"><a xlink:href="#"
    xlink:title="add_to_fragment_pool(self, seed: SeedWithStructure) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Adds all fragments of a seed to the fragment pool"><text text-anchor="start"
    x="352.25" y="-232.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-weight="bold" font-style="italic" font-size="10.00">add_to_fragment_pool()</text></a></g>
    <g id="a_node8_27"><a xlink:href="#" xlink:title="add_fragment(self, fragment:
    DerivationTree) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively adds fragments to the fragment pool"><text text-anchor="start"
    x="352.25" y="-219" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-size="10.00">add_fragment()</text></a></g> <g id="a_node8_28"><a
    xlink:href="#" xlink:title="count_nodes(self, fragment: DerivationTree) -> int:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns the number of nodes in the fragment"><text text-anchor="start" x="352.25"
    y="-206.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">count_nodes()</text></a></g> <g id="a_node8_29"><a xlink:href="#"
    xlink:title="delete_fragment(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Delete a random fragment"><text text-anchor="start" x="352.25" y="-194.5" font-family="''Fira
    Mono'', ''Source Code Pro'', ''Courier'', monospace" font-style="italic" font-size="10.00">delete_fragment()</text></a></g>
    <g id="a_node8_30"><a xlink:href="#" xlink:title="is_excluded(self, symbol: str)
    -> bool:'
  prefs: []
  type: TYPE_NORMAL
- en: Returns true if a fragment starting with a specific
  prefs: []
  type: TYPE_NORMAL
- en: 'symbol and all its decendents can be excluded"><text text-anchor="start" x="352.25"
    y="-180.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">is_excluded()</text></a></g> <g id="a_node8_31"><a xlink:href="#"
    xlink:title="mutate(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Implement structure-aware mutation. Memoize seeds."><text text-anchor="start"
    x="352.25" y="-169" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">mutate()</text></a></g> <g id="a_node8_32"><a
    xlink:href="#" xlink:title="recursive_delete(self, fragment: DerivationTree) ->
    DerivationTree:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively finds the fragment to delete"><text text-anchor="start" x="352.25"
    y="-155.25" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">recursive_delete()</text></a></g> <g id="a_node8_33"><a xlink:href="#"
    xlink:title="recursive_swap(self, fragment: DerivationTree) -> DerivationTree:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Recursively finds the fragment to swap."><text text-anchor="start" x="352.25"
    y="-142.5" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'', monospace"
    font-size="10.00">recursive_swap()</text></a></g> <g id="a_node8_34"><a xlink:href="#"
    xlink:title="swap_fragment(self, seed: SeedWithStructure) -> SeedWithStructure:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Substitutes a random fragment with another with the same symbol"><text text-anchor="start"
    x="352.25" y="-130.75" font-family="''Fira Mono'', ''Source Code Pro'', ''Courier'',
    monospace" font-style="italic" font-size="10.00">swap_fragment()</text></a></g></a></g></a></g></g>
    <g id="edge5" class="edge"><title>RegionMutator->FragmentMutator</title></g> <g
    id="node9" class="node"><title>Mutator</title> <g id="a_node9"><a xlink:href="GreyboxFuzzer.html"
    xlink:title="class Mutator:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mutate strings"><text text-anchor="start" x="392.38" y="-357.82" font-family="Patua
    One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Mutator</text>
    <g id="a_node9_35"><a xlink:href="#" xlink:title="Mutator"><g id="a_node9_36"><a
    xlink:href="GreyboxFuzzer.html" xlink:title="__init__(self) -> None:'
  prefs: []
  type: TYPE_NORMAL
- en: Constructor"><text text-anchor="start" x="388.25" y="-335.62" font-family="'Fira
    Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic"
    font-size="10.00">__init__()</text></a></g></a></g></a></g></g> <g id="edge6"
    class="edge"><title>FragmentMutator->Mutator</title></g> <g id="node10" class="node"><title>Legend</title>
    <text text-anchor="start" x="510.62" y="-59" font-family="Patua One, Helvetica,
    sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
    <text text-anchor="start" x="510.62" y="-49" font-family="Patua One, Helvetica,
    sans-serif" font-size="10.00">• </text> <text text-anchor="start" x="516.62" y="-49"
    font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold"
    font-size="8.00">public_method()</text> <text text-anchor="start" x="510.62" y="-39"
    font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text> <text
    text-anchor="start" x="516.62" y="-39" font-family="'Fira Mono', 'Source Code
    Pro', 'Courier', monospace" font-size="8.00">private_method()</text> <text text-anchor="start"
    x="510.62" y="-29" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
    <text text-anchor="start" x="516.62" y="-29" font-family="'Fira Mono', 'Source
    Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
    <text text-anchor="start" x="510.62" y="-19.95" font-family="Helvetica,sans-Serif"
    font-size="9.00">Hover over names to see doc</text></g></g></svg>
  prefs: []
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: First, we [recall](GreyboxFuzzer.html#Ingredients-for-Greybox-Fuzzing) a few
    basic ingredients for mutational fuzzers.
  prefs: []
  type: TYPE_NORMAL
- en: '**Seed**. A *seed* is an input that is used by the fuzzer to generate new inputs
    by applying a sequence of mutations.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Mutator**. A *mutator* implements a set of mutation operators that applied
    to an input produce a slightly modified input.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**PowerSchedule**. A *power schedule* assigns *energy* to a seed. A seed with
    higher energy is fuzzed more often throughout the fuzzing campaign.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**AdvancedMutationFuzzer**. Our *mutational blackbox fuzzer* generates inputs
    by mutating seeds in an initial population of inputs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**GreyboxFuzzer**. Our *greybox fuzzer* dynamically adds inputs to the population
    of seeds that increased coverage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**FunctionCoverageRunner**. Our *function coverage runner* collects coverage
    information for the execution of a given Python function.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's try to get a feeling for these concepts.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: The following command applies a mutation to the input "Hello World".
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: The default power schedule assigns energy uniformly across all seeds. Let's
    check whether this works.
  prefs: []
  type: TYPE_NORMAL
- en: We choose 10k times from a population of three seeds. As we see in the `hits`
    counter, each seed is chosen about a third of the time.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: Before explaining the function coverage runner, lets import Python's HTML parser
    as example...
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '... and create a *wrapper function* that passes each input into a new parser
    object.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: The `FunctionCoverageRunner` constructor takes a Python `function` to execute.
    The function `run()` takes an input, passes it on to the Python `function`, and
    collects the coverage information for this execution. The function `coverage()`
    returns a list of tuples `(function name, line number)` for each statement that
    has been covered in the Python `function`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Our greybox fuzzer takes a seed population, mutator, and power schedule. Let's
    generate 5000 fuzz inputs starting with an "empty" seed corpus.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: Fuzzing with Dictionaries
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To fuzz our HTML parser, it may be useful to inform a mutational fuzzer about
    important keywords in the input – that is, important HTML keywords. The general
    idea is to have a *dictionary* of pre-defined useful inputs that could then be
    inserted as such when mutating an input.
  prefs: []
  type: TYPE_NORMAL
- en: This concept is illustrated in the following diagram. When mutating an input,
    we may insert given keywords from the dictionary (in red).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ad252841dae610b22e63883e278cef44.png)'
  prefs: []
  type: TYPE_IMG
- en: To implement this concept, we extend our mutator to consider keywords from a
    dictionary.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: Let's try to add a few HTML tags and attributes and see whether the coverage
    with `DictMutator` increases.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: 'Clearly, it takes longer. In our experience, this means more code is covered:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: How do the fuzzers compare in terms of coverage over time?
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/b31dd1aa89f79cfc111fcb057d119f40.png)'
  prefs: []
  type: TYPE_IMG
- en: '***Summary.*** Informing the fuzzer about important keywords already goes a
    long way towards achieving lots of coverage quickly.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Try it.*** Open this chapter as Jupyter notebook and add other HTML-related
    keywords to the dictionary in order to see whether the difference in coverage
    actually increases (given the same budget of 5k generated test inputs).'
  prefs: []
  type: TYPE_NORMAL
- en: '***Read up.*** Michał Zalewski, author of AFL, wrote several great blog posts
    on [making up grammars with a dictionary in hand](https://lcamtuf.blogspot.com/2015/01/afl-fuzz-making-up-grammar-with.html)
    and [pulling JPEGs out of thin air](https://lcamtuf.blogspot.com/2014/11/pulling-jpegs-out-of-thin-air.html)!'
  prefs: []
  type: TYPE_NORMAL
- en: Fuzzing with Input Fragments
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: While dictionaries are helpful to inject important keywords into seed inputs,
    they do not allow maintaining the structural integrity of the generated inputs.
    Instead, we need to make the fuzzer aware of the *input structure*. We can do
    this using [grammars](Grammars.html). Our first approach
  prefs: []
  type: TYPE_NORMAL
- en: '[parses](Parser.html) the seed inputs,'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: disassembles them into input fragments, and
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: generates new files by reassembling these fragments according to the rules of
    the grammar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This combination of *parsing* and *fuzzing* can be very powerful. For instance,
    we can *swap* existing substructures in an input:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c2b3b4ed6d48adf859784a3e11c18825.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can also *replace* existing substructures by newly generated ones:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b68a0364c6313714fd0ef7c77e86977a.png)'
  prefs: []
  type: TYPE_IMG
- en: All these operations take place on [derivation trees](GrammarFuzzer.html), which
    can be parsed from and produced into strings at any time.
  prefs: []
  type: TYPE_NORMAL
- en: Parsing and Recombining JavaScript, or How to Make 50,000 USD in Four Weeks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In "Fuzzing with Code Fragments" [[Holler *et al*, 2012](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf)],
    Holler, Herzig, and Zeller apply these steps to fuzz a JavaScript interpreter.
    They use a JavaScript grammar to
  prefs: []
  type: TYPE_NORMAL
- en: '*parse* (valid) JavaScript inputs into parse trees,'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*disassemble* them into fragments (subtrees),'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*recombine* these fragments into valid JavaScript programs again, and'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*feed* these programs into a JavaScript interpreter for execution.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'As in most fuzzing scenarios, the aim is to cause the JavaScript interpreter
    to crash. Here is an example of LangFuzz-generated JavaScript code (from [[Holler
    *et al*, 2012](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf)])
    that caused a crash in the Mozilla JavaScript interpreter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: From a crash of the JavaScript interpreter, it is frequently possible to construct
    an *exploit* that will not only crash the interpreter, but instead have it execute
    code under the attacker's control. Therefore, such crashes are serious flaws,
    which is why you get a bug bounty if you report them.
  prefs: []
  type: TYPE_NORMAL
- en: In the first four weeks of running his *LangFuzz* tool, Christian Holler, first
    author of that paper, netted *more than USD 50,000 in bug bounties*. To date,
    LangFuzz has found more than 2,600 bugs in the JavaScript browsers of Mozilla
    Firefox, Google Chrome, and Microsoft Edge. If you use any of these browsers (say,
    on your Android phone), the combination of parsing and fuzzing has contributed
    significantly in making your browsing session secure.
  prefs: []
  type: TYPE_NORMAL
- en: (Note that these are the same Holler and Zeller who are co-authors of this book.
    If you ever wondered why we devote a couple of chapters on grammar-based fuzzing,
    that's because we have had some great experience with it.)
  prefs: []
  type: TYPE_NORMAL
- en: Parsing and Recombining HTML
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this book, let us stay with HTML input for a while. To generate valid HTML
    inputs for our Python `HTMLParser`, we should first define a simple grammar. It
    allows defining HTML tags with attributes. Our context-free grammar does not require
    that opening and closing tags must match. However, we will see that such context-sensitive
    features can be maintained in the derived input fragments, and thus in the generated
    inputs.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: In order to parse an input into a derivation tree, we use the [Earley parser](Parser.html#Parsing-Context-Free-Grammars).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: Let's run the parser on a simple HTML input and display all possible parse trees.
    A *parse tree* represents the input structure according to the given grammar.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: <svg width="337pt" height="223pt" viewBox="0.00 0.00 336.50 223.25" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 219.25)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="167.25"
    y="-201.95" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="167.25"
    y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="70.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="167.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="262.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge10" class="edge"><title>1->10</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-51.2" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif"
    font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-51.2" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-0.95" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="169.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="169.25" y="-0.95" font-family="Times,serif" font-size="14.00">Text</text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="224.25" y="-51.2" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="262.25" y="-51.2" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge12" class="edge"><title>10->12</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="311.25" y="-51.2" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge14" class="edge"><title>10->14</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="262.25" y="-0.95"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge13" class="edge"><title>12->13</title></g></g></svg><svg
    width="432pt" height="274pt" viewBox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="201.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge14" class="edge"><title>1->14</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-101.45" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="263.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge12" class="edge"><title>11->12</title></g>
    <g id="node14" class="node"><title>13</title> <text text-anchor="middle" x="263.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">ext</text></g> <g id="edge13"
    class="edge"><title>12->13</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="319.25" y="-101.45" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge16" class="edge"><title>14->16</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge18" class="edge"><title>14->18</title></g> <g id="node18"
    class="node"><title>17</title> <text text-anchor="middle" x="357.25" y="-51.2"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge17" class="edge"><title>16->17</title></g></g></svg><svg
    width="432pt" height="274pt" viewBox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="201.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge14" class="edge"><title>1->14</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-101.45" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">Te</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="263.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge12" class="edge"><title>11->12</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="263.25" y="-0.95" font-family="Times,serif" font-size="14.00">xt</text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="319.25" y="-101.45" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge15" class="edge"><title>14->15</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge16" class="edge"><title>14->16</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge18" class="edge"><title>14->18</title></g> <g id="node18"
    class="node"><title>17</title> <text text-anchor="middle" x="357.25" y="-51.2"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge17" class="edge"><title>16->17</title></g></g></svg><svg
    width="439pt" height="324pt" viewBox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="206.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="206.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>7->15</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>8->12</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="205.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge13" class="edge"><title>12->13</title></g>
    <g id="node15" class="node"><title>14</title> <text text-anchor="middle" x="205.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text></g> <g id="edge14"
    class="edge"><title>13->14</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="273.25" y="-51.2" font-family="Times,serif" font-size="14.00">xt</text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="326.25" y="-151.7" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge19" class="edge"><title>18->19</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge20" class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="364.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="432pt" height="274pt" viewBox="0.00 0.00 431.50 273.50" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="201.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="338.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge14" class="edge"><title>1->14</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-101.45" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-101.45" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-51.2" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="182.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="182.25" y="-0.95" font-family="Times,serif" font-size="14.00">Tex</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="263.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge12" class="edge"><title>11->12</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="263.25" y="-0.95" font-family="Times,serif" font-size="14.00">t
    (116)</text></g> <g id="edge13" class="edge"><title>12->13</title></g> <g id="node16"
    class="node"><title>15</title> <text text-anchor="middle" x="319.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"></</text></g> <g id="edge15" class="edge"><title>14->15</title></g>
    <g id="node17" class="node"><title>16</title> <text text-anchor="middle" x="357.25"
    y="-101.45" font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge16"
    class="edge"><title>14->16</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="406.25" y="-101.45" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge18" class="edge"><title>14->18</title></g> <g id="node18"
    class="node"><title>17</title> <text text-anchor="middle" x="357.25" y="-51.2"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge17" class="edge"><title>16->17</title></g></g></svg><svg
    width="439pt" height="324pt" viewBox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="206.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="206.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>7->15</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>8->12</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="205.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge13" class="edge"><title>12->13</title></g>
    <g id="node15" class="node"><title>14</title> <text text-anchor="middle" x="205.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">ex</text></g> <g id="edge14"
    class="edge"><title>13->14</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="273.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="273.25" y="-51.2" font-family="Times,serif" font-size="14.00">t
    (116)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="326.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"></</text></g> <g id="edge19" class="edge"><title>18->19</title></g>
    <g id="node21" class="node"><title>20</title> <text text-anchor="middle" x="364.25"
    y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge20"
    class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="364.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="439pt" height="324pt" viewBox="0.00 0.00 438.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="206.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="206.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="97.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="206.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="345.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="62.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="189.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="270.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>7->15</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="124.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>8->12</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="124.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="124.25" y="-0.95" font-family="Times,serif" font-size="14.00">Te</text></g>
    <g id="edge11" class="edge"><title>10->11</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="205.25" y="-0.95" font-family="Times,serif" font-size="14.00">x
    (120)</text></g> <g id="edge14" class="edge"><title>13->14</title></g> <g id="node17"
    class="node"><title>16</title> <text text-anchor="middle" x="273.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge16" class="edge"><title>15->16</title></g>
    <g id="node18" class="node"><title>17</title> <text text-anchor="middle" x="273.25"
    y="-51.2" font-family="Times,serif" font-size="14.00">t (116)</text></g> <g id="edge17"
    class="edge"><title>16->17</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="326.25" y="-151.7" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge19" class="edge"><title>18->19</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="364.25" y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge20" class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="413.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="364.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="439pt" height="374pt" viewBox="0.00 0.00 438.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="206.25"
    y="-352.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="206.25" y="-302.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="97.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="206.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="345.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge22" class="edge"><title>1->22</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-201.95" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="62.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="189.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="270.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge19" class="edge"><title>7->19</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="124.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="205.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge16" class="edge"><title>8->16</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="50.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="131.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge13" class="edge"><title>9->13</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="50.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge11" class="edge"><title>10->11</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="50.25" y="-0.95" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge12" class="edge"><title>11->12</title></g> <g id="node15"
    class="node"><title>14</title> <text text-anchor="middle" x="131.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge14" class="edge"><title>13->14</title></g>
    <g id="node16" class="node"><title>15</title> <text text-anchor="middle" x="131.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text></g> <g id="edge15"
    class="edge"><title>14->15</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="205.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="205.25" y="-51.2" font-family="Times,serif" font-size="14.00">x
    (120)</text></g> <g id="edge18" class="edge"><title>17->18</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="273.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge20" class="edge"><title>19->20</title></g>
    <g id="node22" class="node"><title>21</title> <text text-anchor="middle" x="273.25"
    y="-101.45" font-family="Times,serif" font-size="14.00">t (116)</text></g> <g
    id="edge21" class="edge"><title>20->21</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="326.25" y="-201.95" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge23" class="edge"><title>22->23</title></g> <g id="node25" class="node"><title>24</title>
    <text text-anchor="middle" x="364.25" y="-201.95" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge24" class="edge"><title>22->24</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="413.25" y="-201.95" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge26" class="edge"><title>22->26</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="364.25" y="-151.7"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge25" class="edge"><title>24->25</title></g></g></svg><svg
    width="445pt" height="374pt" viewBox="0.00 0.00 444.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="211.25"
    y="-352.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="211.25" y="-302.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="99.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="211.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="351.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge22" class="edge"><title>1->22</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-201.95" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="58.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="195.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="276.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge19" class="edge"><title>7->19</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="120.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="201.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>8->12</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="100.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="100.25" y="-51.2" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="168.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge13"
    class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="249.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge16" class="edge"><title>12->16</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="168.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="168.25" y="-0.95" font-family="Times,serif" font-size="14.00">e
    (101)</text></g> <g id="edge15" class="edge"><title>14->15</title></g> <g id="node18"
    class="node"><title>17</title> <text text-anchor="middle" x="249.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge17" class="edge"><title>16->17</title></g>
    <g id="node19" class="node"><title>18</title> <text text-anchor="middle" x="249.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text></g> <g id="edge18"
    class="edge"><title>17->18</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="298.25" y="-151.7" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="317.25" y="-101.45" font-family="Times,serif" font-size="14.00">t
    (116)</text></g> <g id="edge21" class="edge"><title>20->21</title></g> <g id="node24"
    class="node"><title>23</title> <text text-anchor="middle" x="332.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"></</text></g> <g id="edge23" class="edge"><title>22->23</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="370.25"
    y="-201.95" font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge24"
    class="edge"><title>22->24</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="419.25" y="-201.95" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge26" class="edge"><title>22->26</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="370.25" y="-151.7"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge25" class="edge"><title>24->25</title></g></g></svg><svg
    width="450pt" height="324pt" viewBox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="241.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge12"
    class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>11->15</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">e
    (101)</text></g> <g id="edge14" class="edge"><title>13->14</title></g> <g id="node17"
    class="node"><title>16</title> <text text-anchor="middle" x="322.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge16" class="edge"><title>15->16</title></g>
    <g id="node18" class="node"><title>17</title> <text text-anchor="middle" x="322.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">xt</text></g> <g id="edge17"
    class="edge"><title>16->17</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="337.25" y="-151.7" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge19" class="edge"><title>18->19</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="375.25" y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge20" class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="384.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="450pt" height="324pt" viewBox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="241.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge12"
    class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>11->15</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">ex</text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="322.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="322.25" y="-0.95" font-family="Times,serif" font-size="14.00">t
    (116)</text></g> <g id="edge17" class="edge"><title>16->17</title></g> <g id="node20"
    class="node"><title>19</title> <text text-anchor="middle" x="337.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"></</text></g> <g id="edge19" class="edge"><title>18->19</title></g>
    <g id="node21" class="node"><title>20</title> <text text-anchor="middle" x="375.25"
    y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge20"
    class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="384.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="456pt" height="374pt" viewBox="0.00 0.00 455.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-352.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="201.25" y="-302.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="362.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge22" class="edge"><title>1->22</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-201.95" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="167.25" y="-151.7" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="141.25" y="-101.45" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="250.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge12"
    class="edge"><title>11->12</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="331.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge19" class="edge"><title>11->19</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="208.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="289.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge16" class="edge"><title>12->16</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="208.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge14" class="edge"><title>13->14</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="208.25" y="-0.95" font-family="Times,serif" font-size="14.00">e
    (101)</text></g> <g id="edge15" class="edge"><title>14->15</title></g> <g id="node18"
    class="node"><title>17</title> <text text-anchor="middle" x="289.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge17" class="edge"><title>16->17</title></g>
    <g id="node19" class="node"><title>18</title> <text text-anchor="middle" x="289.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">x (120)</text></g> <g id="edge18"
    class="edge"><title>17->18</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge20" class="edge"><title>19->20</title></g> <g id="node22" class="node"><title>21</title>
    <text text-anchor="middle" x="357.25" y="-51.2" font-family="Times,serif" font-size="14.00">t
    (116)</text></g> <g id="edge21" class="edge"><title>20->21</title></g> <g id="node24"
    class="node"><title>23</title> <text text-anchor="middle" x="343.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"></</text></g> <g id="edge23" class="edge"><title>22->23</title></g>
    <g id="node25" class="node"><title>24</title> <text text-anchor="middle" x="381.25"
    y="-201.95" font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge24"
    class="edge"><title>22->24</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="430.25" y="-201.95" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge26" class="edge"><title>22->26</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="393.25" y="-151.7"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge25" class="edge"><title>24->25</title></g></g></svg><svg
    width="450pt" height="374pt" viewBox="0.00 0.00 449.50 374.00" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 370)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-352.7" font-family="Times,serif" font-size="14.00"><start></text></g> <g id="node2"
    class="node"><title>1</title> <text text-anchor="middle" x="201.25" y="-302.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge1"
    class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="356.25" y="-252.2" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge22" class="edge"><title>1->22</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-201.95" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-201.95"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-201.95" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-151.7" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="173.25" y="-151.7" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13"
    class="node"><title>12</title> <text text-anchor="middle" x="241.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge12"
    class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="322.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>11->15</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00">e
    (101)</text></g> <g id="edge14" class="edge"><title>13->14</title></g> <g id="node17"
    class="node"><title>16</title> <text text-anchor="middle" x="315.25" y="-101.45"
    font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g id="edge16"
    class="edge"><title>15->16</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="396.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge19" class="edge"><title>15->19</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="315.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="315.25" y="-0.95" font-family="Times,serif" font-size="14.00">x
    (120)</text></g> <g id="edge18" class="edge"><title>17->18</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="396.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge20" class="edge"><title>19->20</title></g>
    <g id="node22" class="node"><title>21</title> <text text-anchor="middle" x="396.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text></g> <g id="edge21"
    class="edge"><title>20->21</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="337.25" y="-201.95" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge23" class="edge"><title>22->23</title></g> <g id="node25" class="node"><title>24</title>
    <text text-anchor="middle" x="375.25" y="-201.95" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge24" class="edge"><title>22->24</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="424.25" y="-201.95" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge26" class="edge"><title>22->26</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="384.25" y="-151.7"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge25" class="edge"><title>24->25</title></g></g></svg><svg
    width="450pt" height="324pt" viewBox="0.00 0.00 449.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="201.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="201.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="96.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="201.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="356.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge18" class="edge"><title>1->18</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="66.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="182.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="263.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge11" class="edge"><title>7->11</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="173.25" y="-101.45" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="173.25" y="-51.2" font-family="Times,serif" font-size="14.00">Te</text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="241.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>11->12</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="322.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>11->15</title></g> <g id="node14" class="node"><title>13</title>
    <text text-anchor="middle" x="241.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge13" class="edge"><title>12->13</title></g> <g id="node15" class="node"><title>14</title>
    <text text-anchor="middle" x="241.25" y="-0.95" font-family="Times,serif" font-size="14.00">x
    (120)</text></g> <g id="edge14" class="edge"><title>13->14</title></g> <g id="node17"
    class="node"><title>16</title> <text text-anchor="middle" x="322.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge16" class="edge"><title>15->16</title></g>
    <g id="node18" class="node"><title>17</title> <text text-anchor="middle" x="322.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text></g> <g id="edge17"
    class="edge"><title>16->17</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="337.25" y="-151.7" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge19" class="edge"><title>18->19</title></g> <g id="node21" class="node"><title>20</title>
    <text text-anchor="middle" x="375.25" y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge20" class="edge"><title>18->20</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="424.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge22" class="edge"><title>18->22</title></g> <g id="node22"
    class="node"><title>21</title> <text text-anchor="middle" x="384.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge21" class="edge"><title>20->21</title></g></g></svg><svg
    width="469pt" height="324pt" viewBox="0.00 0.00 468.50 323.75" xmlns:xlink="http://www.w3.org/1999/xlink"><g
    id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)"><g
    id="node1" class="node"><title>0</title> <text text-anchor="middle" x="211.25"
    y="-302.45" font-family="Times,serif" font-size="14.00"><start></text></g> <g
    id="node2" class="node"><title>1</title> <text text-anchor="middle" x="211.25"
    y="-252.2" font-family="Times,serif" font-size="14.00"><xml-tree></text></g> <g
    id="edge1" class="edge"><title>0->1</title></g> <g id="node3" class="node"><title>2</title>
    <text text-anchor="middle" x="99.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-open-tag></text></g>
    <g id="edge2" class="edge"><title>1->2</title></g> <g id="node8" class="node"><title>7</title>
    <text text-anchor="middle" x="211.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge7" class="edge"><title>1->7</title></g> <g id="node23" class="node"><title>22</title>
    <text text-anchor="middle" x="375.25" y="-201.95" font-family="Times,serif" font-size="14.00"><xml-close-tag></text></g>
    <g id="edge22" class="edge"><title>1->22</title></g> <g id="node4" class="node"><title>3</title>
    <text text-anchor="middle" x="17.25" y="-151.7" font-family="Times,serif" font-size="14.00"><
    (60)</text></g> <g id="edge3" class="edge"><title>2->3</title></g> <g id="node5"
    class="node"><title>4</title> <text text-anchor="middle" x="66.25" y="-151.7"
    font-family="Times,serif" font-size="14.00"><id></text></g> <g id="edge4" class="edge"><title>2->4</title></g>
    <g id="node7" class="node"><title>6</title> <text text-anchor="middle" x="115.25"
    y="-151.7" font-family="Times,serif" font-size="14.00">> (62)</text></g> <g id="edge6"
    class="edge"><title>2->6</title></g> <g id="node6" class="node"><title>5</title>
    <text text-anchor="middle" x="52.25" y="-101.45" font-family="Times,serif" font-size="14.00">html</text></g>
    <g id="edge5" class="edge"><title>4->5</title></g> <g id="node9" class="node"><title>8</title>
    <text text-anchor="middle" x="195.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge8" class="edge"><title>7->8</title></g> <g id="node16" class="node"><title>15</title>
    <text text-anchor="middle" x="276.25" y="-151.7" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge15" class="edge"><title>7->15</title></g> <g id="node10" class="node"><title>9</title>
    <text text-anchor="middle" x="114.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge9" class="edge"><title>8->9</title></g> <g id="node13" class="node"><title>12</title>
    <text text-anchor="middle" x="195.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge12" class="edge"><title>8->12</title></g> <g id="node11" class="node"><title>10</title>
    <text text-anchor="middle" x="114.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge10" class="edge"><title>9->10</title></g> <g id="node12" class="node"><title>11</title>
    <text text-anchor="middle" x="114.25" y="-0.95" font-family="Times,serif" font-size="14.00">T
    (84)</text></g> <g id="edge11" class="edge"><title>10->11</title></g> <g id="node14"
    class="node"><title>13</title> <text text-anchor="middle" x="195.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge13" class="edge"><title>12->13</title></g>
    <g id="node15" class="node"><title>14</title> <text text-anchor="middle" x="195.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">e (101)</text></g> <g id="edge14"
    class="edge"><title>13->14</title></g> <g id="node17" class="node"><title>16</title>
    <text text-anchor="middle" x="276.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge16" class="edge"><title>15->16</title></g> <g id="node20" class="node"><title>19</title>
    <text text-anchor="middle" x="357.25" y="-101.45" font-family="Times,serif" font-size="14.00"><xml-tree></text></g>
    <g id="edge19" class="edge"><title>15->19</title></g> <g id="node18" class="node"><title>17</title>
    <text text-anchor="middle" x="276.25" y="-51.2" font-family="Times,serif" font-size="14.00"><text></text></g>
    <g id="edge17" class="edge"><title>16->17</title></g> <g id="node19" class="node"><title>18</title>
    <text text-anchor="middle" x="276.25" y="-0.95" font-family="Times,serif" font-size="14.00">x
    (120)</text></g> <g id="edge18" class="edge"><title>17->18</title></g> <g id="node21"
    class="node"><title>20</title> <text text-anchor="middle" x="357.25" y="-51.2"
    font-family="Times,serif" font-size="14.00"><text></text></g> <g id="edge20" class="edge"><title>19->20</title></g>
    <g id="node22" class="node"><title>21</title> <text text-anchor="middle" x="357.25"
    y="-0.95" font-family="Times,serif" font-size="14.00">t (116)</text></g> <g id="edge21"
    class="edge"><title>20->21</title></g> <g id="node24" class="node"><title>23</title>
    <text text-anchor="middle" x="356.25" y="-151.7" font-family="Times,serif" font-size="14.00"></</text></g>
    <g id="edge23" class="edge"><title>22->23</title></g> <g id="node25" class="node"><title>24</title>
    <text text-anchor="middle" x="394.25" y="-151.7" font-family="Times,serif" font-size="14.00"><id></text></g>
    <g id="edge24" class="edge"><title>22->24</title></g> <g id="node27" class="node"><title>26</title>
    <text text-anchor="middle" x="443.25" y="-151.7" font-family="Times,serif" font-size="14.00">>
    (62)</text></g> <g id="edge26" class="edge"><title>22->26</title></g> <g id="node26"
    class="node"><title>25</title> <text text-anchor="middle" x="419.25" y="-101.45"
    font-family="Times,serif" font-size="14.00">html</text></g> <g id="edge25" class="edge"><title>24->25</title></g></g></svg>
  prefs: []
  type: TYPE_NORMAL
- en: As we can see, the input starts with an opening tag, contains some text, and
    ends with a closing tag. Excellent. This is a structure that we can work with.
  prefs: []
  type: TYPE_NORMAL
- en: Building the Fragment Pool
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We are now ready to implement our first input-structure-aware mutator. Let's
    initialize the mutator with the dictionary `fragments` representing the empty
    fragment pool. It contains a key for each symbol in the grammar (and the empty
    set as value).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: The `FragmentMutator` adds fragments recursively. A *fragment* is a subtree
    in the parse tree and consists of the symbol of the current node and child nodes
    (i.e., descendant fragments). We can exclude fragments starting with symbols that
    are tokens, terminals, or not part of the grammar.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: Parsing can take a long time, particularly if there is too much ambiguity during
    the parsing. In order to maintain the efficiency of mutational fuzzing, we will
    limit the parsing time to 200ms.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: The function `add_to_fragment_pool()` parses a seed (no longer than 200ms) and
    adds all its fragments to the fragment pool. If the parsing of the `seed` was
    successful, the attribute `seed.has_structure` is set to `True`. Otherwise, it
    is set to `False`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: Let's see how `FragmentMutator` fills the fragment pool for a simple HTML seed
    input. We initialize mutator with the `EarleyParser` which itself is initialized
    with our `XML_GRAMMAR`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE53]'
  prefs: []
  type: TYPE_PRE
- en: For many symbols in the grammar, we have collected a number of fragments. There
    are several open and closing tags and several interesting fragments starting with
    the `xml-tree` symbol.
  prefs: []
  type: TYPE_NORMAL
- en: '***Summary***. For each interesting symbol in the grammar, the `FragmentMutator`
    has a set of fragments. These fragments are extracted by first parsing the inputs
    to be mutated.'
  prefs: []
  type: TYPE_NORMAL
- en: Fragment-Based Mutation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We can use the fragments in the fragment pool to generate new inputs. Every
    seed that is being mutated is disassembled into fragments, and memoized – i.e.,
    disassembled only the first time around.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: Our first structural mutation operator is `swap_fragments()`, which choses a
    random fragment in the given seed and substitutes it with a random fragment from
    the pool. We make sure that both fragments start with the same symbol. For instance,
    we may swap a closing tag in the seed HTML by another closing tag from the fragment
    pool.
  prefs: []
  type: TYPE_NORMAL
- en: In order to choose a random fragment, the mutator counts all fragments (`n_count`)
    below the root fragment associated with the start-symbol.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: In order to swap the chosen fragment – identified using the "global" variable
    `self.to_swap` – the seed's parse tree is traversed recursively.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: Our structural mutator chooses a random number between 2 (i.e., excluding the
    `start` symbol) and the total number of fragments (`n_count`) and uses the recursive
    swapping to generate the new fragment. The new fragment is serialized as string
    and returned as new seed.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE59]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE60]'
  prefs: []
  type: TYPE_PRE
- en: As we can see, one fragment has been substituted by another.
  prefs: []
  type: TYPE_NORMAL
- en: We can use a similar recursive traversal to *remove* a random fragment.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE61]'
  prefs: []
  type: TYPE_PRE
- en: We should also define the corresponding structural deletion operator, as well.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. We now have all ingredients for structure-aware fuzzing. Our
    mutator disassembles all seeds into fragments, which are then added to the fragment
    pool. Our mutator swaps random fragments in a given seed with fragments of the
    same type. And our mutator deletes random fragments in a given seed. This allows
    maintaining a high degree of validity for the generated inputs w.r.t. the given
    grammar.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Try it***. Try adding other structural mutation operators. How would an
    *add-operator* know the position in a given seed file, where it is okay to add
    a fragment starting with a certain symbol?'
  prefs: []
  type: TYPE_NORMAL
- en: Fragment-Based Fuzzing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We can now define an input-structure aware fuzzer as pioneered in LangFuzz.
    To implement LangFuzz, we modify our [blackbox mutational fuzzer](GreyboxFuzzer.html#Blackbox-Mutation-based-Fuzzer)
    to stack up to four structural mutations.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: Okay, let's take our first input-structure aware fuzzer for a spin. Being careful,
    we set n=300 for now.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE65]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE66]'
  prefs: []
  type: TYPE_PRE
- en: We observe that structural mutation is *sooo very slow*. This is despite our
    time budget of 200ms for parsing. In contrast, our blackbox fuzzer alone can generate
    about 10k inputs per second!
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE68]'
  prefs: []
  type: TYPE_PRE
- en: Indeed, our blackbox fuzzer is done in the blink of an eye.
  prefs: []
  type: TYPE_NORMAL
- en: '***Try it***. We can deal with this overhead using [deferred parsing](https://arxiv.org/abs/1811.09447).
    Instead of wasting time in the beginning of the fuzzing campaign when a byte-level
    mutator would make efficient progress, deferred parsing suggests to invest time
    in structural mutation only later in the fuzzing campaign when it becomes viable.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: Let's print some stats for our fuzzing campaigns. Since we'll need to print
    stats more often later, we should wrap this into a function. In order to measure
    coverage, we import the [population_coverage](Coverage.html#Coverage-of-Basic-Fuzzing)
    function. It takes a set of inputs and a Python function, executes the inputs
    on that function and collects coverage information. Specifically, it returns a
    tuple `(all_coverage, cumulative_coverage)` where `all_coverage` is the set of
    statements covered by all inputs, and `cumulative_coverage` is the number of statements
    covered as the number of executed inputs increases. We are just interested in
    the latter to plot coverage over time.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE72]'
  prefs: []
  type: TYPE_PRE
- en: For LangFuzzer, let's see how many of the inputs generated by LangFuzz are valid
    (i.e., parsable) and how many statements were covered.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE74]'
  prefs: []
  type: TYPE_PRE
- en: What are the stats for the mutational fuzzer that uses only byte-level mutation
    (and no grammars)?
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE76]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE77]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. Our fragment-level blackbox fuzzer (LangFuzzer) generates *more
    valid inputs* but achieves *less code coverage* than a fuzzer with our byte-level
    fuzzer. So, there is some value in generating inputs that do not stick to the
    provided grammar.'
  prefs: []
  type: TYPE_NORMAL
- en: Integration with Greybox Fuzzing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the following we integrate fragment-level blackbox fuzzing (LangFuzz-style)
    with [byte-level greybox fuzzing](GreyboxFuzzer.html#Greybox-Mutation-based-Fuzzer)
    (AFL-style). The additional coverage-feedback might allow us to increase code
    coverage more quickly.
  prefs: []
  type: TYPE_NORMAL
- en: A [greybox fuzzer](GreyboxFuzzer.html#Greybox-Mutation-based-Fuzzer) adds to
    the seed population all generated inputs which increase code coverage. Inputs
    are generated in two stages, stacking up to four structural mutations and up to
    32 byte-level mutations.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs: []
  type: TYPE_PRE
- en: Let's run our integrated fuzzer with the [standard byte-level mutator](GreyboxFuzzer.html#Mutator-and-Seed)
    and our [fragment-based structural mutator](#Fragment-based-Mutation) that was
    introduced above.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE80]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE81]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE82]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. Our structural greybox fuzzer'
  prefs: []
  type: TYPE_NORMAL
- en: runs faster than the fragment-based LangFuzzer,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: achieves more coverage than both the fragment-based LangFuzzer and the vanilla
    blackbox mutational fuzzer, and
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: generates fewer valid inputs than even the vanilla blackbox mutational fuzzer.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fuzzing with Input Regions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the previous section, we have seen that most inputs that are added as seeds
    are *invalid* w.r.t. our given grammar. Yet, in order to apply our fragment-based
    mutators, we need it to parse the seed successfully. Otherwise, the entire fragment-based
    approach becomes useless. The question arises: *How can we derive structure from
    (invalid) seeds that cannot be parsed successfully?*'
  prefs: []
  type: TYPE_NORMAL
- en: To this end, we introduce the idea of *region-based mutation*, first explored
    with the [AFLSmart](https://github.com/aflsmart/aflsmart) structural greybox fuzzer
    [[Van-Thuan Pham *et al*, 2018](https://arxiv.org/abs/1811.09447)]. AFLSmart implements
    byte-level, fragment-based, and region-based mutation as well as validity-based
    power schedules. We define *region-based mutators*, where a *region* is a consecutive
    sequence of bytes in the input that can be associated with a symbol in the grammar.
  prefs: []
  type: TYPE_NORMAL
- en: The basic idea of fuzzing with input regions is shown in the following diagram.
    After *parsing* an input (into a derivation tree), we can identify *regions* associated
    with specific subtrees of the derivation tree. These regions can then be deleted
    or swapped.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/43bec249ff48a249e214712d4f6d6f64.png)'
  prefs: []
  type: TYPE_IMG
- en: Such regions can also be determined even if the input is incomplete or invalid,
    allowing for robust parsing.
  prefs: []
  type: TYPE_NORMAL
- en: Determining Symbol Regions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: How can we obtain regions for a given input? The function `chart_parse()` of
    the [Earley parser](Parser.html#The-Parsing-Algorithm) produces a *parse table*
    for a string. For each letter in the string, this table gives the potential symbol
    and a *region* of neighboring letters that might belong to the same symbol.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE83]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE84]'
  prefs: []
  type: TYPE_PRE
- en: The number of columns in this table that are associated with potential symbols
    correspond to the number of letters that could be parsed successfully. In other
    words, we can use this table to compute the longest parsable substring.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE85]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE86]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE87]'
  prefs: []
  type: TYPE_PRE
- en: From this, we can compute the *degree of validity* for an input.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE88]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE89]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. Unlike input fragments, input regions can be derived even if
    the parser fails to generate the entire parse tree.'
  prefs: []
  type: TYPE_NORMAL
- en: Region-Based Mutation
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To fuzz invalid seeds, the region-based mutator associates symbols from the
    grammar with regions (i.e., indexed substrings) in the seed. The [overridden](#Building-the-Fragment-Pool)
    method `add_to_fragment_pool()` first tries to mine the fragments from the seed.
    If this fails, the region mutator uses [Earley parser](Parser.html#The-Parsing-Algorithm)
    to derive the parse table. For each column (i.e., letter), it extracts the symbols
    and corresponding regions. This allows the mutator to store the set of regions
    with each symbol.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE90]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE91]'
  prefs: []
  type: TYPE_PRE
- en: This is how these regions look like for our invalid seed. A region consists
    of a start and end index in the seed string.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE92]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE93]'
  prefs: []
  type: TYPE_PRE
- en: Now that we know which regions in the seed belong to which symbol, we can define
    region-based swap and delete operators.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE94]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE95]'
  prefs: []
  type: TYPE_PRE
- en: Let's try our new region-based mutator. We add a simple, valid seed to the fragment
    pool and attempt to mutate the invalid seed.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE96]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE97]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE98]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. We can use the Earley parser to generate a parse table and assign
    regions in the input to symbols in the grammar. Our region mutators can substitute
    these regions with fragments from the fragment pool that start with the same symbol,
    or delete these regions entirely.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Try it***. Implement a region pool (similar to the fragment pool) and a
    `swap_region()` mutator. You can execute your own code by opening this chapter
    as Jupyter notebook.'
  prefs: []
  type: TYPE_NORMAL
- en: Integration with Greybox Fuzzing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Let's try our shiny new region mutator by integrating it with our [structure-aware
    greybox fuzzer](#Integration-with-Greybox-Fuzzing).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE99]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE100]'
  prefs: []
  type: TYPE_PRE
- en: We can see that the structural greybox fuzzer with region-based mutator is slower
    than the [fragment-based mutator alone](#Fragment-based-Fuzzing). This is because
    region-based structural mutation is applicable for *all seeds*. In contrast, fragment-based
    mutators were applicable only for tiny number of parsable seeds. Otherwise, only
    (very efficient) byte-level mutators were applied.
  prefs: []
  type: TYPE_NORMAL
- en: Let's also print the average degree of validity for the seeds in the population.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE101]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE102]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE103]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. Compared to fragment-based mutation, a greybox fuzzer with region-based
    mutation achieves *higher coverage* but generates a *smaller number of valid inputs*.
    The higher coverage is explained by leveraging at least *some* structure for seeds
    that cannot be parsed successfully.'
  prefs: []
  type: TYPE_NORMAL
- en: Focusing on Valid Seeds
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In the previous section, we have a problem: The low (degree of) validity. To
    address this problem, a *validity-based power schedule* assigns more [energy](GreyboxFuzzer.html#Power-Schedules)
    to seeds that have a higher degree of validity. In other words, the fuzzer *spends
    more time fuzzing seeds that are more valid*.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE104]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE105]'
  prefs: []
  type: TYPE_PRE
- en: Let's play with the degree of validity by passing in a valid seed ...
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE106]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE107]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE108]'
  prefs: []
  type: TYPE_PRE
- en: '... and an invalid seed.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE109]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE110]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE111]'
  prefs: []
  type: TYPE_PRE
- en: Excellent. We can compute the degree of validity as the proportion of the string
    that can be parsed.
  prefs: []
  type: TYPE_NORMAL
- en: Let's plug the validity-based power schedule into the structure-aware greybox
    fuzzer.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE112]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE113]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE114]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE115]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE116]'
  prefs: []
  type: TYPE_PRE
- en: '***Summary***. Indeed, by spending more time fuzzing seeds with a higher degree
    of validity, we also generate inputs with a higher degree of validity. More inputs
    are entirely valid w.r.t. the given grammar.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Read up***. Learn more about region-based fuzzing, deferred parsing, and
    validity-based schedules in the original AFLSmart paper: "[Smart Greybox Fuzzing](https://arxiv.org/abs/1811.09447)"
    by Pham and co-authors. Download and improve AFLSmart: [https://github.com/aflsmart/aflsmart](https://github.com/aflsmart/aflsmart).'
  prefs: []
  type: TYPE_NORMAL
- en: Mining Seeds
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By now, it should have become clear that the *choice of seeds* can very much
    influence the success of fuzzing. One aspect is *variability* – our seeds should
    cover as many different features as possible in order to increase coverage. Another
    aspect, however, is the *likelihood of a seed to induce errors* – that is, if
    a seed was involved in causing a failure before, then a mutation of this very
    seed may be likely to induce failures again. This is because fixes for past failures
    typically are successful in letting the concrete failure no longer occur, but
    sometimes may fail to capture all conditions under which a failure may occur.
    Hence, even if the original failure is fixed, the likelihood of an error in the
    *surroundings* of the original failure-inducing input is still higher. It thus
    pays off to use as seeds *inputs that are known to have caused failures before*.
  prefs: []
  type: TYPE_NORMAL
- en: To put things in context, Holler's *LangFuzz* fuzzer used as seeds JavaScript
    inputs from CVE reports. These were published as failure-inducing inputs at a
    time when the error already had been fixed; thus they could do no harm anymore.
    Yet, by using such inputs as seeds, LangFuzz would create plenty of mutations
    and recombinations of all their features, many of which would (and do) find errors
    again and again.
  prefs: []
  type: TYPE_NORMAL
- en: Lessons Learned
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A **dictionary** is useful to inject important keywords into the generated inputs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Fragment-based mutation** first disassembles seeds into fragments, and reassembles
    these fragments to generate new inputs. A *fragment* is a subtree in the seed''s
    parse tree. However, fragment-based mutation requires that the seeds can be parsed
    successfully, which may not be true for seeds discovered by a coverage-based greybox
    fuzzer.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Region-based mutation** marks regions in the input as belonging to a certain
    symbol in the grammar. For instance, it may identify a substring ''</a>'' as closing
    tag. These regions can then be deleted or substituted by fragments or regions
    belonging to the same symbol. Unlike fragment-based mutation, region-based mutation
    is applicable to *all* seeds - even those that can be parsed only partially. However,
    the degree of validity is still quite low for the generated inputs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A **validity-based power schedule** invests more energy into seeds with a higher
    degree of validity. The inputs that are generated also have a higher degree of
    validity.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Mining seeds** from repositories of previous failure-inducing inputs results
    in input fragments associated with past failures, raising the likelihood to find
    more failures in the vicinity.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Background
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This chapter builds on the following two works:'
  prefs: []
  type: TYPE_NORMAL
- en: The *LangFuzz* fuzzer [[Holler *et al*, 2012](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final73.pdf)]
    is an efficient (and effective!) grammar-based fuzzer for (mostly) JavaScript.
    It uses the grammar for parsing seeds and recombining their inputs with generated
    parts and found 2,600 bugs in JavaScript interpreters to date.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Smart greybox fuzzing ([AFLSmart](https://github.com/aflsmart/aflsmart)) brings
    together coverage-based fuzzing and grammar-based (structural) fuzzing, as described
    in [[Van-Thuan Pham *et al*, 2018](https://arxiv.org/abs/1811.09447)]. The resulting
    AFLSMART tool has discovered 42 zero-day vulnerabilities in widely-used, well-tested
    tools and libraries; so far 17 CVEs were assigned.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Recent fuzzing work also brings together grammar-based fuzzing and coverage.
  prefs: []
  type: TYPE_NORMAL
- en: '*Superion* [[Junjie Wang *et al*, 2019](https://2019.icse-conferences.org/event/icse-2019-technical-papers-superion-grammar-aware-greybox-fuzzing)]
    is equivalent to our section "Integration with Greybox Fuzzing", as above – that
    is, a combination of LangFuzz and Greybox Fuzzing, but no AFL-style byte-level
    mutation. Superion can improve the code coverage (i.e., 16.7% and 8.8% in line
    and function coverage) and bug-finding capability over AFL and jsfunfuzz. According
    to the authors, they found 30 new bugs, among which they discovered 21 new vulnerabilities
    with 16 CVEs assigned and 3.2K USD bug bounty rewards received.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Nautilus* [[Cornelius Aschermann *et al*, 2019](https://www.ndss-symposium.org/ndss-paper/nautilus-fishing-for-deep-bugs-with-grammars/)]
    also combines grammar-based fuzzing with coverage feedback. It maintains the parse
    tree for all seeds and generated inputs. To allow AFL-style byte-level mutations,
    it "collapses" subtrees back to byte-level representations. This has the advantage
    of not having to re-parse generated seeds; however, over time, Nautilus degenerates
    to structure-unaware greybox fuzzing because it does not re-parse collapsed subtrees
    to reconstitute input structure for later seeds where most of the parse tree is
    collapsed. Nautilus identified bugs in mruby, PHP, ChakraCore, and in Lua; reporting
    these bugs was awarded with a sum of 2600 USD and 6 CVEs were assigned.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[FormatFuzzer](https://uds-se.github.io/FormatFuzzer/) is a framework for high-efficiency,
    high-quality generation and parsing of binary inputs. It takes a binary template
    that describes the format of a binary input and generates an executable that produces
    and parses the given binary format. From a binary template for GIF, for instance,
    FormatFuzzer produces a GIF generator - also known as GIF fuzzer. Generators produced
    by FormatFuzzer are highly efficient, producing thousands of valid test inputs
    per second. FormatFuzzer operates in black-box settings, but can also integrate
    with AFL to produce valid inputs that also aim for maximum coverage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Next Steps
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This chapter closes our discussion of syntactic fuzzing techniques.
  prefs: []
  type: TYPE_NORMAL
- en: In the [next chapter](Reducer.html), we discuss how to *reduce failure-inducing
    inputs* after a failure, keeping only those portions of the input that are necessary
    for reproducing the failure.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The [next part](04_Semantical_Fuzzing.html) will go from syntactical to *semantical*
    fuzzing, considering code semantics for targeted test generation.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Exercises
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Exercise 1: The Big Greybox Fuzzer Shoot-Out'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Use our implementations of greybox techniques and evaluate them on a benchmark.
    Which technique (and which sub-technique) has which impact and why? Also take
    into account the specific approaches of Superion [[Junjie Wang *et al*, 2019](https://2019.icse-conferences.org/event/icse-2019-technical-papers-superion-grammar-aware-greybox-fuzzing)]
    and Nautilus [[Cornelius Aschermann *et al*, 2019](https://www.ndss-symposium.org/ndss-paper/nautilus-fishing-for-deep-bugs-with-grammars/)],
    possibly even on the benchmarks used by these approaches.
  prefs: []
  type: TYPE_NORMAL
- en: '[Use the notebook](https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GreyboxGrammarFuzzer.ipynb#Exercises)
    to work on the exercises and see solutions.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Creative Commons License](../Images/2f3faa36146c6fb38bbab67add09aa5f.png)
    The content of this project is licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike
    4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).
    The source code that is part of the content, as well as the source code used to
    format and display that content is licensed under the [MIT License](https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license).
    [Last change: 2024-01-21 13:07:50+01:00](https://github.com/uds-se/fuzzingbook/commits/master/notebooks/GreyboxGrammarFuzzer.ipynb)
    • [Cite](#citation) • [Imprint](https://cispa.de/en/impressum)'
  prefs: []
  type: TYPE_IMG
- en: How to Cite this Work
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler: "[Greybox Fuzzing with Grammars](https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html)".
    In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian
    Holler, "[The Fuzzing Book](https://www.fuzzingbook.org/)", [https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html](https://www.fuzzingbook.org/html/GreyboxGrammarFuzzer.html).
    Retrieved 2024-01-21 13:07:50+01:00.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE117]'
  prefs: []
  type: TYPE_PRE
