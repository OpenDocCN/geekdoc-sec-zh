<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Mining Input Grammars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Mining Input Grammars</h1>
<blockquote>原文：<a href="http://www.fuzzingbook.org/html/GrammarMiner.html">http://www.fuzzingbook.org/html/GrammarMiner.html</a></blockquote>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>So far, the grammars we have seen have been mostly specified manually – that is, you (or the person knowing the input format) had to design and write a grammar in the first place.  While the grammars we have seen so far have been rather simple, creating a grammar for complex inputs can involve quite some effort.  In this chapter, we therefore introduce techniques that <em>automatically mine grammars from programs</em> – by executing the programs and observing how they process which parts of the input.  In conjunction with a grammar fuzzer, this allows us to</p>
<ol>
<li>take a program, </li>
<li>extract its input grammar, and </li>
<li>fuzz it with high efficiency and effectiveness, using the concepts in this book.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">"ddM1oL2LYDI"</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>You should have read the <a href="Grammars.html">chapter on grammars</a>.</li>
<li>The <a href="ConfigurationFuzzer.html">chapter on configuration fuzzing</a> introduces grammar mining for configuration options, as well as observing variables and values during execution.</li>
<li>We use the tracer from the <a href="Coverage.html">chapter on coverage</a>.</li>
<li>The concept of parsing from the <a href="Parser.html">chapter on parsers</a> is also useful.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis</h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="GrammarMiner.html" class="import" target="_blank">fuzzingbook.GrammarMiner</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter provides a number of classes to mine input grammars from existing programs.  The function <code>recover_grammar()</code> could be the easiest to use.  It takes a function and a set of inputs, and returns a grammar that describes its input language.</p>
<p>We apply <code>recover_grammar()</code> on a <code>url_parse()</code> function that takes and decomposes URLs:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">url_parse</span><span class="p">(</span><span class="s1">'https://www.fuzzingbook.org/'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">URLS</span>
<span class="p">[</span><span class="s1">'http://user:pass@www.google.com:80/?q=path#ref'</span><span class="p">,</span>
 <span class="s1">'https://www.cispa.saarland:80/'</span><span class="p">,</span>
 <span class="s1">'http://www.fuzzingbook.org/#News'</span><span class="p">]</span>
</pre></div>
<p>We extract the input grammar for <code>url_parse()</code> using <code>recover_grammar()</code>:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">url_parse</span><span class="p">,</span> <span class="n">URLS</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">grammar</span>
<span class="p">{</span><span class="s1">'&lt;start&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'&lt;urlsplit@452:url&gt;'</span><span class="p">],</span>
 <span class="s1">'&lt;urlsplit@452:url&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'&lt;urlparse@396:scheme&gt;:&lt;_splitnetloc@413:url&gt;'</span><span class="p">],</span>
 <span class="s1">'&lt;urlparse@396:scheme&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'http'</span><span class="p">,</span> <span class="s1">'https'</span><span class="p">],</span>
 <span class="s1">'&lt;_splitnetloc@413:url&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'//&lt;urlparse@396:netloc&gt;/'</span><span class="p">,</span>
  <span class="s1">'//&lt;urlparse@396:netloc&gt;&lt;urlsplit@494:url&gt;'</span><span class="p">],</span>
 <span class="s1">'&lt;urlparse@396:netloc&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'www.cispa.saarland:80'</span><span class="p">,</span>
  <span class="s1">'www.fuzzingbook.org'</span><span class="p">,</span>
  <span class="s1">'user:pass@www.google.com:80'</span><span class="p">],</span>
 <span class="s1">'&lt;urlsplit@494:url&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'&lt;urlsplit@502:url&gt;#&lt;urlparse@396:fragment&gt;'</span><span class="p">,</span>
  <span class="s1">'/#&lt;urlparse@396:fragment&gt;'</span><span class="p">],</span>
 <span class="s1">'&lt;urlsplit@502:url&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'/?&lt;urlparse@396:query&gt;'</span><span class="p">],</span>
 <span class="s1">'&lt;urlparse@396:query&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'q=path'</span><span class="p">],</span>
 <span class="s1">'&lt;urlparse@396:fragment&gt;'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'News'</span><span class="p">,</span> <span class="s1">'ref'</span><span class="p">]}</span>
</pre></div>
<p>The names of nonterminals are a bit technical; but the grammar nicely represents the structure of the input; for instance, the different schemes (<code>"http"</code>, <code>"https"</code>) are all identified:</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="n">syntax_diagram</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="n">start</span>
</pre></div>
<p><svg class="railroad-diagram" height="62" viewbox="0 0 276.0 62" width="276.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M236.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><rect height="22" width="156.0" x="60.0" y="20"/><text x="138.0" y="35">urlsplit@452:url</text></g></g><path d="M216.0 31h20"/></g><path d="M 236.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlsplit@452:url</code></pre>
<p><svg class="railroad-diagram" height="62" viewbox="0 0 560.0 62" width="560.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M520.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M500.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">urlparse@396:scheme</text></g><path d="M241.5 31h10"/><path d="M251.5 31h10"/><g class="terminal">
<path d="M261.5 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="261.5" y="20"/><text x="275.75" y="35">:</text></g><path d="M290.0 31h10"/><path d="M300.0 31h10"/><g class="non-terminal">
<path d="M310.0 31h0.0"/><path d="M500.0 31h0.0"/><rect height="22" width="190.0" x="310.0" y="20"/><text x="405.0" y="35">_splitnetloc@413:url</text></g></g><path d="M500.0 31h20"/></g><path d="M 520.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlparse@396:scheme</code></pre>
<p><svg class="railroad-diagram" height="92" viewbox="0 0 182.5 92" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M122.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M122.5 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="50"/><text x="91.25" y="65">https</text></g></g><path d="M122.5 61h20"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>_splitnetloc@413:url</code></pre>
<p><svg class="railroad-diagram" height="92" viewbox="0 0 534.5 92" width="534.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M494.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h63.75"/><path d="M410.75 31h63.75"/><g class="terminal">
<path d="M123.75 31h0.0"/><path d="M160.75 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="123.75" y="20"/><text x="142.25" y="35">//</text></g><path d="M160.75 31h10"/><path d="M170.75 31h10"/><g class="non-terminal">
<path d="M180.75 31h0.0"/><path d="M362.25 31h0.0"/><rect height="22" width="181.5" x="180.75" y="20"/><text x="271.5" y="35">urlparse@396:netloc</text></g><path d="M362.25 31h10"/><path d="M372.25 31h10"/><g class="terminal">
<path d="M382.25 31h0.0"/><path d="M410.75 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="382.25" y="20"/><text x="396.5" y="35">/</text></g></g><path d="M474.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M474.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M97.0 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="50"/><text x="78.5" y="65">//</text></g><path d="M97.0 61h10"/><path d="M107.0 61h10"/><g class="non-terminal">
<path d="M117.0 61h0.0"/><path d="M298.5 61h0.0"/><rect height="22" width="181.5" x="117.0" y="50"/><text x="207.75" y="65">urlparse@396:netloc</text></g><path d="M298.5 61h10"/><path d="M308.5 61h10"/><g class="non-terminal">
<path d="M318.5 61h0.0"/><path d="M474.5 61h0.0"/><rect height="22" width="156.0" x="318.5" y="50"/><text x="396.5" y="65">urlsplit@494:url</text></g></g><path d="M474.5 61h20"/></g><path d="M 494.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlparse@396:netloc</code></pre>
<p><svg class="railroad-diagram" height="122" viewbox="0 0 369.5 122" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M329.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M309.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M309.5 91h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="80"/><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g><path d="M309.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlsplit@494:url</code></pre>
<p><svg class="railroad-diagram" height="92" viewbox="0 0 543.0 92" width="543.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M503.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M483.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><rect height="22" width="156.0" x="60.0" y="20"/><text x="138.0" y="35">urlsplit@502:url</text></g><path d="M216.0 31h10"/><path d="M226.0 31h10"/><g class="terminal">
<path d="M236.0 31h0.0"/><path d="M264.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="236.0" y="20"/><text x="250.25" y="35">#</text></g><path d="M264.5 31h10"/><path d="M274.5 31h10"/><g class="non-terminal">
<path d="M284.5 31h0.0"/><path d="M483.0 31h0.0"/><rect height="22" width="198.5" x="284.5" y="20"/><text x="383.75" y="35">urlparse@396:fragment</text></g></g><path d="M483.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h83.75"/><path d="M399.25 61h83.75"/><g class="terminal">
<path d="M143.75 61h0.0"/><path d="M180.75 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="143.75" y="50"/><text x="162.25" y="65">/#</text></g><path d="M180.75 61h10"/><path d="M190.75 61h10"/><g class="non-terminal">
<path d="M200.75 61h0.0"/><path d="M399.25 61h0.0"/><rect height="22" width="198.5" x="200.75" y="50"/><text x="300.0" y="65">urlparse@396:fragment</text></g></g><path d="M483.0 61h20"/></g><path d="M 503.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlsplit@502:url</code></pre>
<p><svg class="railroad-diagram" height="62" viewbox="0 0 350.0 62" width="350.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M310.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M290.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">/?</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" width="173.0" x="117.0" y="20"/><text x="203.5" y="35">urlparse@396:query</text></g></g><path d="M290.0 31h20"/></g><path d="M 310.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlparse@396:query</code></pre>
<p><svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>

<pre><code>urlparse@396:fragment</code></pre>
<p><svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg></p>
<p>The grammar can be immediately used for fuzzing, producing arbitrary combinations of input elements, which are all syntactically valid.</p>
<div class="highlight"><pre><span/><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="GrammarCoverageFuzzer.html" class="import" target="_blank">GrammarCoverageFuzzer</a></span> <span class="kn">import</span> <span class="n">GrammarCoverageFuzzer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarCoverageFuzzer</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="p">[</span><span class="s1">'https://www.cispa.saarland:80/#ref'</span><span class="p">,</span>
 <span class="s1">'http://www.fuzzingbook.org/'</span><span class="p">,</span>
 <span class="s1">'http://user:pass@www.google.com:80/?q=path#News'</span><span class="p">,</span>
 <span class="s1">'https://www.fuzzingbook.org/?q=path#ref'</span><span class="p">,</span>
 <span class="s1">'http://www.cispa.saarland:80/#News'</span><span class="p">]</span>
</pre></div>
<p>Being able to automatically extract a grammar and to use this grammar for fuzzing makes for very effective test generation with a minimum of manual work.</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Grammar-Challenge">A Grammar Challenge</h2><p>Consider the <code>process_inventory()</code> method from the <a href="Parser.html">chapter on parsers</a>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils.setup</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/collections.abc.html" class="import" target="_blank">collections.abc</a></span> <span class="kn">import</span> <span class="n">Iterable</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Parser.html" class="import" target="_blank">Parser</a></span> <span class="kn">import</span> <span class="n">process_inventory</span><span class="p">,</span> <span class="n">process_vehicle</span><span class="p">,</span> <span class="n">process_car</span><span class="p">,</span> <span class="n">process_van</span><span class="p">,</span> <span class="n">lr_graph</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>It takes inputs of the following form.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">INVENTORY</span> <span class="o">=</span> <span class="s2">"""</span><span class="se">\</span>
<span class="s2">1997,van,Ford,E350</span>
<span class="s2">2000,car,Mercury,Cougar</span>
<span class="s2">1999,car,Chevy,Venture</span><span class="se">\</span>
<span class="s2">"""</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="nb">print</span><span class="p">(</span><span class="n">process_inventory</span><span class="p">(</span><span class="n">INVENTORY</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>We have a Ford E350 van from 1997 vintage.
It is an old but reliable model!
We have a Mercury Cougar car from 2000 vintage.
It is an old but reliable model!
We have a Chevy Venture car from 1999 vintage.
It is an old but reliable model!
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We found from the <a href="Parser.html">chapter on parsers</a> that coarse grammars do not work well for fuzzing when the input format includes details expressed only in code. That is, even though we have the formal specification of CSV files (<a href="https://tools.ietf.org/html/rfc4180">RFC 4180</a>), the inventory system includes further rules as to what is expected at each index of the CSV file. The solution of simply recombining existing inputs, while practical, is incomplete. In particular, it relies on a formal input specification being available in the first place. However, we have no assurance that the program obeys the input specification given.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One of the ways out of this predicament is to interrogate the program under test as to what its input specification is. That is, if the program under test is written in a style such that specific methods are responsible for handling specific parts of the input, one can recover the parse tree by observing the process of parsing. Further, one can recover a reasonable approximation of the grammar by abstraction from multiple input trees.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><em>We start with the assumption (1) that the program is written in such a fashion that specific methods are responsible for parsing specific fragments of the program -- This includes almost all ad hoc parsers.</em></p>
<p>The idea is as follows:</p>
<ul>
<li>Hook into the Python execution and observe the fragments of input string as they are produced and named in different methods.</li>
<li>Stitch the input fragments together in a tree structure to retrieve the <strong>Parse Tree</strong>.</li>
<li>Abstract common elements from multiple parse trees to produce the <strong>Context Free Grammar</strong> of the input.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Simple-Grammar-Miner">A Simple Grammar Miner</h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Say we want to obtain the input grammar for the function <code>process_vehicle()</code>. We first collect the sample inputs for this function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">VEHICLES</span> <span class="o">=</span> <span class="n">INVENTORY</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The set of methods responsible for processing inventory are the following.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">INVENTORY_METHODS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'process_inventory'</span><span class="p">,</span>
    <span class="s1">'process_vehicle'</span><span class="p">,</span>
    <span class="s1">'process_van'</span><span class="p">,</span>
    <span class="s1">'process_car'</span><span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We have seen from the chapter on <a href="ConfigurationFuzzer.html">configuration fuzzing</a> that one can hook into the Python runtime to observe the arguments to a function and any local variables created. We have also seen that one can obtain the context of execution by inspecting the <code>frame</code> argument. Here is a simple tracer that can return the local variables and other contextual information in a traced function. We reuse the <code>Coverage</code> tracing class.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Tracer">Tracer</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Coverage.html" class="import" target="_blank">Coverage</a></span> <span class="kn">import</span> <span class="n">Coverage</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Coverage</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">traceit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="n">method_name</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">function</span>
        <span class="k">if</span> <span class="n">method_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">INVENTORY_METHODS</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">filename</span>

        <span class="n">param_names</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargvalues</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
        <span class="n">lineno</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span>
        <span class="n">local_vars</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargvalues</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">locals</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">param_names</span><span class="p">,</span> <span class="n">local_vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traceit</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We run the code under trace context.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">()</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_vehicle</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>call Parser.ipynb 29 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350'}
line Parser.ipynb 30 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350'}
line Parser.ipynb 31 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}
line Parser.ipynb 32 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}
call Parser.ipynb 40 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line Parser.ipynb 40 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line Parser.ipynb 41 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line Parser.ipynb 42 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.']}
line Parser.ipynb 43 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.'], 'iyear': 1997}
line Parser.ipynb 46 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.'], 'iyear': 1997}
line Parser.ipynb 47 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.', 'It is an old but reliable model!'], 'iyear': 1997}
return Parser.ipynb 47 process_van ['year', 'company', 'model'] {'year': '1997', 'company': 'Ford', 'model': 'E350', 'res': ['We have a Ford E350 van from 1997 vintage.', 'It is an old but reliable model!'], 'iyear': 1997}
return Parser.ipynb 32 process_vehicle ['vehicle'] {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350', '_': []}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The main thing that we want out of tracing is a list of assignments of input fragments to different variables. We can use the tracing facility <code>settrace()</code> to get that as we showed above.</p>
<p>However, the <code>settrace()</code> function hooks into the Python debugging facility. When it is in operation, no debugger can hook into the program. That is, if there is a problem with our grammar miner, we will not be able to attach a debugger to it to understand what is happening. This is not ideal. Hence, we limit the tracer to the simplest implementation possible, and implement the core of grammar mining in later stages.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>traceit()</code> function relies on information from the <code>frame</code> variable which exposes Python internals. We define a <code>context</code> class that encapsulates the information that we need from the <code>frame</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Context">Context</h3><p>The <code>Context</code> class provides easy access to the information such as the current module, and parameter names.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Context</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">track_caller</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter_names</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargvalues</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_no</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">lineno</span>

    <span class="k">def</span> <span class="nf">_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_no</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
                <span class="s1">','</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">:</span><span class="si">%d</span><span class="s2">:</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here we add a few convenience methods that operate on the <code>frame</code> to <code>Context</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extract_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargvalues</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">locals</span>

    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_vars</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">qualified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_vars</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">"</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">all_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We hook printing the context to our <code>traceit()</code> to see it in action. First we define a <code>log_event()</code> for displaying events.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">log_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">({</span><span class="s1">'call'</span><span class="p">:</span> <span class="s1">'-&gt;'</span><span class="p">,</span> <span class="s1">'return'</span><span class="p">:</span> <span class="s1">'&lt;-'</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s1">'  '</span><span class="p">),</span> <span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And use the <code>log_event()</code> in the <code>traceit()</code> function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">traceit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="n">log_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">Context</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traceit</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Running <code>process_vehicle()</code> under trace prints the contexts encountered.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">()</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_vehicle</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-&gt; Parser.ipynb:29:process_vehicle(vehicle)
   Parser.ipynb:30:process_vehicle(vehicle)
   Parser.ipynb:31:process_vehicle(vehicle)
   Parser.ipynb:32:process_vehicle(vehicle)
-&gt; Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:41:process_van(year,company,model)
   Parser.ipynb:42:process_van(year,company,model)
   Parser.ipynb:43:process_van(year,company,model)
   Parser.ipynb:46:process_van(year,company,model)
   Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:32:process_vehicle(vehicle)
-&gt; Coverage.ipynb:102:__exit__(self,exc_type,exc_value,tb)
   Coverage.ipynb:105:__exit__(self,exc_type,exc_value,tb)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The trace produced by executing any function can get overwhelmingly large. Hence, we need to restrict our attention to specific modules. Further, we also restrict our attention exclusively to <code>str</code> variables since these variables are more likely to contain input fragments. (We will show how to deal with complex objects later in exercises.)</p>
<p>The <code>Context</code> class we developed earlier is used to decide which modules to monitor, and which variables to trace.</p>
<p>We store the current <em>input string</em> so that it can be used to determine if any particular string fragments came from the current input string. Any optional arguments are processed separately.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_input</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">my_input</span><span class="p">,</span> <span class="p">[]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We use an optional argument <code>files</code> to indicate the specific source files we are interested in, and <code>methods</code> to indicate which specific methods are of interest. Further, we also use <code>log</code> to specify whether verbose logging should be enabled during trace. We use the <code>log_event()</code> method we defined earlier for logging.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The options processing is as below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'files'</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'methods'</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log_event</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_evt</span><span class="p">,</span> <span class="n">_var</span><span class="p">:</span> <span class="kc">None</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>files</code> and <code>methods</code> are checked to determine, if a particular event should be traced or not</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">tracing_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="n">fres</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">cxt</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
        <span class="n">mres</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">cxt</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fres</span> <span class="ow">and</span> <span class="n">mres</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Similar to the context of events, we also want to restrict our attention to specific variables. For now, we want to focus only on strings. (See the Exercises at the end of the chapter on how to extend it to other kinds of objects).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">tracing_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We modify the <code>traceit()</code> to call an <code>on_event()</code> function with the context information only on the specific events we are interested in.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Tracer</span><span class="p">(</span><span class="n">Tracer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">create_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Context</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">traceit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="n">cxt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_context</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracing_context</span><span class="p">(</span><span class="n">cxt</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traceit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">cxt</span><span class="p">)</span>

        <span class="n">my_vars</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cxt</span><span class="o">.</span><span class="n">extract_vars</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracing_var</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traceit</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Tracer</code> class can now focus on specific kinds of events on specific files. Further, it provides a first level filter for variables that we find interesting. For example, we want to focus specifically on variables from <code>process_*</code> methods that contain input fragments. Here is how our updated <code>Tracer</code> can be used.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">methods</span><span class="o">=</span><span class="n">INVENTORY_METHODS</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_vehicle</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-&gt; Parser.ipynb:29:process_vehicle(vehicle)
   Parser.ipynb:30:process_vehicle(vehicle)
   Parser.ipynb:31:process_vehicle(vehicle)
   Parser.ipynb:32:process_vehicle(vehicle)
-&gt; Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:41:process_van(year,company,model)
   Parser.ipynb:42:process_van(year,company,model)
   Parser.ipynb:43:process_van(year,company,model)
   Parser.ipynb:46:process_van(year,company,model)
   Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:32:process_vehicle(vehicle)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The execution produced the following trace.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>call process_vehicle {'vehicle': '1997,van,Ford,E350'}
line process_vehicle {'vehicle': '1997,van,Ford,E350'}
line process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}
line process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}
call process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
line process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
return process_van {'year': '1997', 'company': 'Ford', 'model': 'E350'}
return process_vehicle {'vehicle': '1997,van,Ford,E350', 'year': '1997', 'kind': 'van', 'company': 'Ford', 'model': 'E350'}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Since we are saving the input already in <code>Tracer</code>, it is redundant to specify it separately again as an argument.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">methods</span><span class="o">=</span><span class="n">INVENTORY_METHODS</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_vehicle</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-&gt; Parser.ipynb:29:process_vehicle(vehicle)
   Parser.ipynb:30:process_vehicle(vehicle)
   Parser.ipynb:31:process_vehicle(vehicle)
   Parser.ipynb:32:process_vehicle(vehicle)
-&gt; Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:40:process_van(year,company,model)
   Parser.ipynb:41:process_van(year,company,model)
   Parser.ipynb:42:process_van(year,company,model)
   Parser.ipynb:43:process_van(year,company,model)
   Parser.ipynb:46:process_van(year,company,model)
   Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:47:process_van(year,company,model)
&lt;- Parser.ipynb:32:process_vehicle(vehicle)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="DefineTracker">DefineTracker</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define a <code>DefineTracker</code> class that processes the trace from the <code>Tracer</code>. The idea is to store different variable definitions which are input fragments.</p>
<p>The tracker identifies string fragments that are part of the input string, and stores them in a dictionary <code>my_assignments</code>. It saves the trace, and the corresponding input for processing. Finally, it calls <code>process()</code> to process the <code>trace</code> it was given. We will start with a simple tracker that relies on certain assumptions, and later see how these assumptions can be relaxed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_input</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span> <span class="o">=</span> <span class="n">my_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One of the problems of using substring search is that short string sequences tend to be included in other string sequences even though they may not have come from the original string. That is, say the input fragment is <code>v</code>, it could have equally come from either <code>van</code> or <code>chevy</code>. We rely on being able to predict the exact place in the input where a given fragment occurred. Hence, we define a constant <code>FRAGMENT_LEN</code> such that we ignore strings up to that length. We also incorporate a logging facility as before.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">FRAGMENT_LEN</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log_event</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_evt</span><span class="p">,</span> <span class="n">_var</span><span class="p">:</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fragment_len</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'fragment_len'</span><span class="p">,</span> <span class="n">FRAGMENT_LEN</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our tracer simply records the variable values as they occur. We next need to check if the variables contain values from the <strong>input string</strong>. Common ways to do this is to rely on symbolic execution or at least dynamic tainting, which are powerful, but also complex. However, one can obtain a reasonable approximation by simply relying on substring search. That is, we consider any value produced that is a substring of the original input string to have come from the original input.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define an <code>is_input_fragment()</code> method that relies on string inclusion to detect if the string came from the input.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">is_input_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_len</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can use <code>is_input_fragment()</code> to select only a subset of variables defined, as implemented below in <code>fragments()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="o">.</span><span class="n">items</span><span class="p">(</span>
        <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_input_fragment</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The tracker processes each event, and at each event, it updates the dictionary <code>my_assignments</code> with the current local variables that contain strings that are part of the input. Note that there is a choice here with respect to what happens during reassignment. We can either discard all the reassignments, or keep only the last assignment. Here, we choose the latter. If you want the former behavior, check whether the value exists in <code>my_assignments</code> before storing a fragment.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">track_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="p">(</span><span class="n">cxt</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">(</span><span class="n">my_vars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using the tracker, we can obtain the input fragments. For example, say we are only interested in strings that are at least <code>5</code> characters long.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">tracker</span> <span class="o">=</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">,</span> <span class="n">fragment_len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vehicle = '1997,van,Ford,E350'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Or strings that are <code>2</code> characters long (the default).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">tracker</span> <span class="o">=</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vehicle = '1997,van,Ford,E350'
year = '1997'
kind = 'van'
company = 'Ford'
model = 'E350'
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">DefineTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Assembling-a-Derivation-Tree">Assembling a Derivation Tree</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="Grammars.html" class="import" target="_blank">Grammars</a></span> <span class="kn">import</span> <span class="n">START_SYMBOL</span><span class="p">,</span> <span class="n">syntax_diagram</span><span class="p">,</span> \
    <span class="n">is_nonterminal</span><span class="p">,</span> <span class="n">Grammar</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="GrammarFuzzer.html" class="import" target="_blank">GrammarFuzzer</a></span> <span class="kn">import</span> <span class="n">GrammarFuzzer</span><span class="p">,</span> <span class="n">display_tree</span><span class="p">,</span> \
    <span class="n">DerivationTree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The input fragments from the <code>DefineTracker</code> only tell half the story. The fragments may be created at different stages of parsing. Hence, we need to assemble the fragments to a  derivation tree of the input. The basic idea is as follows:</p>
<p>Our input from the previous step was:</p>
<div class="highlight"><pre><span/><span class="s2">"1997,van,Ford,E350"</span>
</pre></div>
<p>We start a derivation tree, and associate it with the start symbol in the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">derivation_tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[(</span><span class="s2">"1997,van,Ford,E350"</span><span class="p">,</span> <span class="p">[])])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="120pt" height="73pt" viewbox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-68.5 115.75,-68.5 115.75,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="55.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M55.88,-50.46C55.88,-44.24 55.88,-34.15 55.88,-25.39"/>
<polygon fill="black" stroke="black" points="59.38,-25.6 55.88,-15.6 52.38,-25.6 59.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The next input was:</p>
<div class="highlight"><pre><span/><span class="n">vehicle</span> <span class="o">=</span> <span class="s2">"1997,van,Ford,E350"</span>
</pre></div>
<p>Since vehicle covers the <code>&lt;start&gt;</code> node's value completely, we replace the value with the vehicle node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">derivation_tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> 
                                   <span class="p">[(</span><span class="s1">'&lt;vehicle&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s2">"1997,van,Ford,E350"</span><span class="p">,</span> <span class="p">[])],</span>
                                                   <span class="p">[])])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="120pt" height="123pt" viewbox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-118.75 115.75,-118.75 115.75,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="55.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="55.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M55.88,-100.71C55.88,-94.49 55.88,-84.4 55.88,-75.64"/>
<polygon fill="black" stroke="black" points="59.38,-75.85 55.88,-65.85 52.38,-75.85 59.38,-75.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M55.88,-50.46C55.88,-44.24 55.88,-34.15 55.88,-25.39"/>
<polygon fill="black" stroke="black" points="59.38,-25.6 55.88,-15.6 52.38,-25.6 59.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The next input was:</p>
<div class="highlight"><pre><span/><span class="n">year</span> <span class="o">=</span> <span class="s1">'1997'</span>
</pre></div>
<p>Traversing the derivation tree from <code>&lt;start&gt;</code>, we see that it replaces a portion of the <code>&lt;vehicle&gt;</code> node's value. Hence we split the <code>&lt;vehicle&gt;</code> node's value to two children, where one corresponds to the value <code>"1997"</code> and the other to <code>",van,Ford,E350"</code>, and replace the first one with the node <code>&lt;year&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">derivation_tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> 
                                   <span class="p">[(</span><span class="s1">'&lt;vehicle&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'&lt;year&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'1997'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">",van,Ford,E350"</span><span class="p">,</span> <span class="p">[])],</span> <span class="p">[])])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="150pt" height="173pt" viewbox="0.00 0.00 150.25 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 146.25,-169 146.25,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="59.88" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="59.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M59.88,-150.96C59.88,-144.74 59.88,-134.65 59.88,-125.89"/>
<polygon fill="black" stroke="black" points="63.38,-126.1 59.88,-116.1 56.38,-126.1 63.38,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;year&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M54.97,-100.71C49.27,-93.84 39.67,-82.25 31.94,-72.93"/>
<polygon fill="black" stroke="black" points="34.86,-70.97 25.79,-65.5 29.47,-75.44 34.86,-70.97"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="99.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,Ford,E350</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M64.78,-100.71C70.48,-93.84 80.08,-82.25 87.81,-72.93"/>
<polygon fill="black" stroke="black" points="90.28,-75.44 93.96,-65.5 84.89,-70.97 90.28,-75.44"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M19.88,-50.46C19.88,-44.24 19.88,-34.15 19.88,-25.39"/>
<polygon fill="black" stroke="black" points="23.38,-25.6 19.88,-15.6 16.38,-25.6 23.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We perform similar operations for</p>
<div class="highlight"><pre><span/><span class="n">company</span> <span class="o">=</span> <span class="s1">'Ford'</span>
</pre></div>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">derivation_tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> 
                                   <span class="p">[(</span><span class="s1">'&lt;vehicle&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'&lt;year&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'1997'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">",van,"</span><span class="p">,</span> <span class="p">[]),</span>
                                                   <span class="p">(</span><span class="s1">'&lt;company&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'Ford'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">",E350"</span><span class="p">,</span> <span class="p">[])],</span> <span class="p">[])])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="228pt" height="173pt" viewbox="0.00 0.00 228.00 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 224,-169 224,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="102.88" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="102.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M102.88,-150.96C102.88,-144.74 102.88,-134.65 102.88,-125.89"/>
<polygon fill="black" stroke="black" points="106.38,-126.1 102.88,-116.1 99.38,-126.1 106.38,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;year&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M92.36,-100.51C79.27,-92.9 56.6,-79.73 40.1,-70.13"/>
<polygon fill="black" stroke="black" points="42.01,-67.2 31.61,-65.2 38.5,-73.25 42.01,-67.2"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="70.88" y="-51.2" font-family="Times,serif" font-size="14.00">,van,</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M98.95,-100.71C94.54,-94.05 87.19,-82.98 81.12,-73.82"/>
<polygon fill="black" stroke="black" points="84.11,-72 75.67,-65.6 78.28,-75.87 84.11,-72"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="135.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M106.92,-100.71C111.47,-94.05 119.05,-82.98 125.31,-73.82"/>
<polygon fill="black" stroke="black" points="128.18,-75.82 130.94,-65.59 122.41,-71.87 128.18,-75.82"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="203.88" y="-51.2" font-family="Times,serif" font-size="14.00">,E350</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M115.67,-100.51C132.06,-92.68 160.77,-78.97 180.97,-69.32"/>
<polygon fill="black" stroke="black" points="182.31,-72.56 189.82,-65.09 179.29,-66.24 182.31,-72.56"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M19.88,-50.46C19.88,-44.24 19.88,-34.15 19.88,-25.39"/>
<polygon fill="black" stroke="black" points="23.38,-25.6 19.88,-15.6 16.38,-25.6 23.38,-25.6"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="135.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M135.88,-50.46C135.88,-44.24 135.88,-34.15 135.88,-25.39"/>
<polygon fill="black" stroke="black" points="139.38,-25.6 135.88,-15.6 132.38,-25.6 139.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Similarly for</p>
<div class="highlight"><pre><span/><span class="n">kind</span> <span class="o">=</span> <span class="s1">'van'</span>
</pre></div>
<p>and</p>
<div class="highlight"><pre><span/><span class="n">model</span> <span class="o">=</span> <span class="s1">'E350'</span>
</pre></div>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">derivation_tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> 
                                   <span class="p">[(</span><span class="s1">'&lt;vehicle&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'&lt;year&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'1997'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="p">[]),</span>
                                                   <span class="p">(</span><span class="s2">"&lt;kind&gt;"</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'van'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="p">[]),</span>
                                                   <span class="p">(</span><span class="s1">'&lt;company&gt;'</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'Ford'</span><span class="p">,</span> <span class="p">[])]),</span>
                                                   <span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="p">[]),</span>
                                                   <span class="p">(</span><span class="s2">"&lt;model&gt;"</span><span class="p">,</span> <span class="p">[(</span><span class="s1">'E350'</span><span class="p">,</span> <span class="p">[])])</span>
                                                   <span class="p">],</span> <span class="p">[])])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="403pt" height="173pt" viewbox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 399.38,-169 399.38,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="178.88" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="178.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M178.88,-150.96C178.88,-144.74 178.88,-134.65 178.88,-125.89"/>
<polygon fill="black" stroke="black" points="182.38,-126.1 178.88,-116.1 175.38,-126.1 182.38,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;year&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M158.74,-100.51C131.42,-92.23 82.39,-77.35 50.5,-67.67"/>
<polygon fill="black" stroke="black" points="51.63,-64.35 41.05,-64.8 49.6,-71.05 51.63,-64.35"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M165.45,-100.51C148.17,-92.65 117.84,-78.84 96.62,-69.18"/>
<polygon fill="black" stroke="black" points="98.12,-66.02 87.57,-65.06 95.22,-72.39 98.12,-66.02"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="125.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;kind&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M172.38,-100.71C164.59,-93.62 151.29,-81.51 140.9,-72.06"/>
<polygon fill="black" stroke="black" points="143.3,-69.5 133.55,-65.36 138.58,-74.68 143.3,-69.5"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="178.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M178.88,-100.71C178.88,-94.49 178.88,-84.4 178.88,-75.64"/>
<polygon fill="black" stroke="black" points="182.38,-75.85 178.88,-65.85 175.38,-75.85 182.38,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>1-&gt;8</title>
<path fill="none" stroke="black" d="M187.23,-100.51C197.41,-93.08 214.83,-80.34 227.87,-70.81"/>
<polygon fill="black" stroke="black" points="229.56,-73.91 235.57,-65.18 225.43,-68.25 229.56,-73.91"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>1-&gt;10</title>
<path fill="none" stroke="black" d="M195.59,-100.51C218.19,-92.25 258.71,-77.44 285.19,-67.76"/>
<polygon fill="black" stroke="black" points="286.31,-71.08 294.5,-64.36 283.9,-64.51 286.31,-71.08"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="369.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>1-&gt;11</title>
<path fill="none" stroke="black" d="M203.07,-100.51C236.36,-92.1 296.52,-76.9 334.77,-67.24"/>
<polygon fill="black" stroke="black" points="335.58,-70.65 344.41,-64.81 333.86,-63.86 335.58,-70.65"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M19.88,-50.46C19.88,-44.24 19.88,-34.15 19.88,-25.39"/>
<polygon fill="black" stroke="black" points="23.38,-25.6 19.88,-15.6 16.38,-25.6 23.38,-25.6"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M125.88,-50.46C125.88,-44.24 125.88,-34.15 125.88,-25.39"/>
<polygon fill="black" stroke="black" points="129.38,-25.6 125.88,-15.6 122.38,-25.6 129.38,-25.6"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M244.88,-50.46C244.88,-44.24 244.88,-34.15 244.88,-25.39"/>
<polygon fill="black" stroke="black" points="248.38,-25.6 244.88,-15.6 241.38,-25.6 248.38,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M369.88,-50.46C369.88,-44.24 369.88,-34.15 369.88,-25.39"/>
<polygon fill="black" stroke="black" points="373.38,-25.6 369.88,-15.6 366.38,-25.6 373.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now develop the complete algorithm with the above described steps.
The derivation tree <code>TreeMiner</code> is initialized with the input string, and the variable assignments, and it converts the assignments to the corresponding derivation tree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_input</span><span class="p">,</span> <span class="n">my_assignments</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span> <span class="o">=</span> <span class="n">my_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span> <span class="o">=</span> <span class="n">my_assignments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_derivation_tree</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log_call</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_i</span><span class="p">,</span> <span class="n">_v</span><span class="p">:</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_derivation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>log_call()</code> is as follows.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">log_call</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span> <span class="o">*</span> <span class="n">indent</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The basic idea is as follows:</p>
<ul>
<li><strong>For now, we assume that the value assigned to a variable is stable. That is, it is never reassigned. In particular, there are no recursive calls, or multiple calls to the same function from different parts.</strong> (We will show how to overcome this limitation later).</li>
<li>For each pair <em>var</em>, <em>value</em> found in <code>my_assignments</code>:<ol>
<li>We search for occurrences of <em>value</em> <code>val</code> in the derivation tree recursively.</li>
<li>If an occurrence was found as a value <code>V1</code> of a node <code>P1</code>, we partition the value of the node <code>P1</code> into three parts, with the central part matching the <em>value</em> <code>val</code>, and the first and last part, the corresponding prefix and suffix in <code>V1</code>.</li>
<li>Reconstitute the node <code>P1</code> with three children, where prefix and suffix mentioned earlier are string values, and the matching value <code>val</code> is replaced by a node <code>var</code> with a single value <code>val</code>.</li>
</ol>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>First, we define a wrapper to generate a nonterminal from a variable name.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">to_nonterminal</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">"&lt;"</span> <span class="o">+</span> <span class="n">var</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">"&gt;"</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>string_part_of_value()</code> method checks whether the given <code>part</code> value was part of the whole.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">string_part_of_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">part</span> <span class="ow">in</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>partition_by_part()</code> splits the <code>value</code> by the given part if it matches, and returns a list containing the first part, the part that was replaced, and the last part. This is a format that can be used as a part of the list of children.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">partition_by_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">k</span><span class="p">,</span> <span class="n">part</span> <span class="o">=</span> <span class="n">pair</span>
        <span class="n">prefix_k_suffix</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[[</span><span class="n">part</span><span class="p">,</span> <span class="p">[]]])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">e</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">prefix_k_suffix</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>insert_into_tree()</code> method accepts a given tree <code>tree</code> and a <code>(k,v)</code> pair.  It recursively checks whether the given pair can be applied. If the pair can be applied, it applies the pair and returns <code>True</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">insert_into_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_tree</span><span class="p">,</span> <span class="n">pair</span><span class="p">):</span>
        <span class="n">var</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">my_tree</span>
        <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">pair</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"- Node: </span><span class="si">%s</span><span class="se">\t\t</span><span class="s2">? (</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">)"</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
        <span class="n">applied</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">value_</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"-&gt; [</span><span class="si">%d</span><span class="s2">] </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">value_</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">applied</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_part_of_value</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
                <span class="n">prefix_k_suffix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition_by_part</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prefix_k_suffix</span><span class="p">):</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span>
                <span class="n">applied</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">" &gt; </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prefix_k_suffix</span><span class="p">])))</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">return</span> <span class="n">applied</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is how <code>insert_into_tree()</code> is used.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">tree</span><span class="p">:</span> <span class="n">DerivationTree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[(</span><span class="s2">"1997,van,Ford,E350"</span><span class="p">,</span> <span class="p">[])])</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="p">{},</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>First, we have our input string as the only node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="120pt" height="73pt" viewbox="0.00 0.00 119.75 72.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 68.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-68.5 115.75,-68.5 115.75,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="55.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M55.88,-50.46C55.88,-44.24 55.88,-34.15 55.88,-25.39"/>
<polygon fill="black" stroke="black" points="59.38,-25.6 55.88,-15.6 52.38,-25.6 59.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Inserting the <code>&lt;vehicle&gt;</code> node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="s1">'&lt;vehicle&gt;'</span><span class="p">,</span> <span class="s2">"1997,van,Ford,E350"</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>	 - Node: &lt;start&gt;		? (&lt;vehicle&gt;:'1997,van,Ford,E350')
		 -&gt; [0] '1997,van,Ford,E350'
		  &gt; ['&lt;vehicle&gt;']
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="120pt" height="123pt" viewbox="0.00 0.00 119.75 122.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 118.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-118.75 115.75,-118.75 115.75,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="55.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="55.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M55.88,-100.71C55.88,-94.49 55.88,-84.4 55.88,-75.64"/>
<polygon fill="black" stroke="black" points="59.38,-75.85 55.88,-65.85 52.38,-75.85 59.38,-75.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="55.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997,van,Ford,E350</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M55.88,-50.46C55.88,-44.24 55.88,-34.15 55.88,-25.39"/>
<polygon fill="black" stroke="black" points="59.38,-25.6 55.88,-15.6 52.38,-25.6 59.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Inserting <code>&lt;model&gt;</code> node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="s1">'&lt;model&gt;'</span><span class="p">,</span> <span class="s1">'E350'</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>	 - Node: &lt;start&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] '1997,van,Ford,E350'
		  &gt; ['1997,van,Ford,', '&lt;model&gt;']
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">((</span><span class="n">tree</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="160pt" height="173pt" viewbox="0.00 0.00 160.12 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 156.12,-169 156.12,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="83.62" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="83.62" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M83.62,-150.96C83.62,-144.74 83.62,-134.65 83.62,-125.89"/>
<polygon fill="black" stroke="black" points="87.13,-126.1 83.63,-116.1 80.13,-126.1 87.13,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="41.62" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,Ford,</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M78.47,-100.71C72.49,-93.84 62.41,-82.25 54.3,-72.93"/>
<polygon fill="black" stroke="black" points="57.02,-70.73 47.81,-65.48 51.74,-75.32 57.02,-70.73"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="126.62" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>1-&gt;3</title>
<path fill="none" stroke="black" d="M88.9,-100.71C95.02,-93.84 105.35,-82.25 113.65,-72.93"/>
<polygon fill="black" stroke="black" points="116.26,-75.26 120.3,-65.47 111.04,-70.61 116.26,-75.26"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="126.62" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M126.62,-50.46C126.62,-44.24 126.62,-34.15 126.62,-25.39"/>
<polygon fill="black" stroke="black" points="130.13,-25.6 126.63,-15.6 123.13,-25.6 130.13,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Inserting <code>&lt;company&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="s1">'&lt;company&gt;'</span><span class="p">,</span> <span class="s1">'Ford'</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>	 - Node: &lt;start&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] '1997,van,Ford,'
		  &gt; ['1997,van,', '&lt;company&gt;', ',']
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="264pt" height="173pt" viewbox="0.00 0.00 263.50 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 259.5,-169 259.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="138" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="138" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M138,-150.96C138,-144.74 138,-134.65 138,-125.89"/>
<polygon fill="black" stroke="black" points="141.5,-126.1 138,-116.1 134.5,-126.1 141.5,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="27" y="-51.2" font-family="Times,serif" font-size="14.00">1997,van,</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M123.94,-100.51C105.68,-92.57 73.5,-78.59 51.25,-68.92"/>
<polygon fill="black" stroke="black" points="52.9,-65.82 42.33,-65.04 50.11,-72.24 52.9,-65.82"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="105" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>1-&gt;3</title>
<path fill="none" stroke="black" d="M133.95,-100.71C129.4,-94.05 121.83,-82.98 115.56,-73.82"/>
<polygon fill="black" stroke="black" points="118.47,-71.87 109.93,-65.59 112.69,-75.82 118.47,-71.87"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="171" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M142.05,-100.71C146.6,-94.05 154.17,-82.98 160.44,-73.82"/>
<polygon fill="black" stroke="black" points="163.31,-75.82 166.07,-65.59 157.53,-71.87 163.31,-75.82"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="230" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>1-&gt;6</title>
<path fill="none" stroke="black" d="M149.65,-100.51C164.38,-92.79 190.01,-79.35 208.36,-69.72"/>
<polygon fill="black" stroke="black" points="209.87,-72.88 217.1,-65.14 206.62,-66.68 209.87,-72.88"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="105" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M105,-50.46C105,-44.24 105,-34.15 105,-25.39"/>
<polygon fill="black" stroke="black" points="108.5,-25.6 105,-15.6 101.5,-25.6 108.5,-25.6"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="230" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6-&gt;7</title>
<path fill="none" stroke="black" d="M230,-50.46C230,-44.24 230,-34.15 230,-25.39"/>
<polygon fill="black" stroke="black" points="233.5,-25.6 230,-15.6 226.5,-25.6 233.5,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Inserting <code>&lt;kind&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="s1">'&lt;kind&gt;'</span><span class="p">,</span> <span class="s1">'van'</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>	 - Node: &lt;start&gt;		? (&lt;kind&gt;:'van')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;kind&gt;:'van')
		 -&gt; [0] '1997,van,'
		  &gt; ['1997,', '&lt;kind&gt;', ',']
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="347pt" height="173pt" viewbox="0.00 0.00 346.88 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 342.88,-169 342.88,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="155.38" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="155.38" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M155.38,-150.96C155.38,-144.74 155.38,-134.65 155.38,-125.89"/>
<polygon fill="black" stroke="black" points="158.88,-126.1 155.38,-116.1 151.88,-126.1 158.88,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="15.38" y="-51.2" font-family="Times,serif" font-size="14.00">1997,</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M137.64,-100.51C113.2,-92.09 69,-76.86 40.97,-67.2"/>
<polygon fill="black" stroke="black" points="42.43,-64 31.83,-64.05 40.15,-70.61 42.43,-64"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="69.38" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;kind&gt;</text>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>1-&gt;3</title>
<path fill="none" stroke="black" d="M144.48,-100.51C130.78,-92.83 106.98,-79.47 89.84,-69.86"/>
<polygon fill="black" stroke="black" points="91.93,-67.02 81.5,-65.18 88.51,-73.12 91.93,-67.02"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="122.38" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M151.33,-100.71C146.78,-94.05 139.2,-82.98 132.94,-73.82"/>
<polygon fill="black" stroke="black" points="135.84,-71.87 127.31,-65.59 130.07,-75.82 135.84,-71.87"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="188.38" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>1-&gt;6</title>
<path fill="none" stroke="black" d="M159.42,-100.71C163.97,-94.05 171.55,-82.98 177.81,-73.82"/>
<polygon fill="black" stroke="black" points="180.68,-75.82 183.44,-65.59 174.91,-71.87 180.68,-75.82"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="254.38" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>1-&gt;8</title>
<path fill="none" stroke="black" d="M167.91,-100.51C183.91,-92.72 211.86,-79.1 231.65,-69.45"/>
<polygon fill="black" stroke="black" points="233.12,-72.63 240.58,-65.1 230.06,-66.33 233.12,-72.63"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="313.38" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>1-&gt;9</title>
<path fill="none" stroke="black" d="M175.39,-100.51C202.45,-92.25 250.99,-77.43 282.68,-67.75"/>
<polygon fill="black" stroke="black" points="283.54,-71.15 292.08,-64.88 281.49,-64.45 283.54,-71.15"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="69.38" y="-0.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M69.38,-50.46C69.38,-44.24 69.38,-34.15 69.38,-25.39"/>
<polygon fill="black" stroke="black" points="72.88,-25.6 69.38,-15.6 65.88,-25.6 72.88,-25.6"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="188.38" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6-&gt;7</title>
<path fill="none" stroke="black" d="M188.38,-50.46C188.38,-44.24 188.38,-34.15 188.38,-25.39"/>
<polygon fill="black" stroke="black" points="191.88,-25.6 188.38,-15.6 184.88,-25.6 191.88,-25.6"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="313.38" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M313.38,-50.46C313.38,-44.24 313.38,-34.15 313.38,-25.39"/>
<polygon fill="black" stroke="black" points="316.88,-25.6 313.38,-15.6 309.88,-25.6 316.88,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Inserting <code>&lt;year&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="s1">'&lt;year&gt;'</span><span class="p">,</span> <span class="s1">'1997'</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>	 - Node: &lt;start&gt;		? (&lt;year&gt;:'1997')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;year&gt;:'1997')
		 -&gt; [0] '1997,'
		  &gt; ['&lt;year&gt;', ',']
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="403pt" height="173pt" viewbox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 399.38,-169 399.38,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="178.88" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="178.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M178.88,-150.96C178.88,-144.74 178.88,-134.65 178.88,-125.89"/>
<polygon fill="black" stroke="black" points="182.38,-126.1 178.88,-116.1 175.38,-126.1 182.38,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;year&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M158.74,-100.51C131.42,-92.23 82.39,-77.35 50.5,-67.67"/>
<polygon fill="black" stroke="black" points="51.63,-64.35 41.05,-64.8 49.6,-71.05 51.63,-64.35"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M165.45,-100.51C148.17,-92.65 117.84,-78.84 96.62,-69.18"/>
<polygon fill="black" stroke="black" points="98.12,-66.02 87.57,-65.06 95.22,-72.39 98.12,-66.02"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="125.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;kind&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M172.38,-100.71C164.59,-93.62 151.29,-81.51 140.9,-72.06"/>
<polygon fill="black" stroke="black" points="143.3,-69.5 133.55,-65.36 138.58,-74.68 143.3,-69.5"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="178.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M178.88,-100.71C178.88,-94.49 178.88,-84.4 178.88,-75.64"/>
<polygon fill="black" stroke="black" points="182.38,-75.85 178.88,-65.85 175.38,-75.85 182.38,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>1-&gt;8</title>
<path fill="none" stroke="black" d="M187.23,-100.51C197.41,-93.08 214.83,-80.34 227.87,-70.81"/>
<polygon fill="black" stroke="black" points="229.56,-73.91 235.57,-65.18 225.43,-68.25 229.56,-73.91"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>1-&gt;10</title>
<path fill="none" stroke="black" d="M195.59,-100.51C218.19,-92.25 258.71,-77.44 285.19,-67.76"/>
<polygon fill="black" stroke="black" points="286.31,-71.08 294.5,-64.36 283.9,-64.51 286.31,-71.08"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="369.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>1-&gt;11</title>
<path fill="none" stroke="black" d="M203.07,-100.51C236.36,-92.1 296.52,-76.9 334.77,-67.24"/>
<polygon fill="black" stroke="black" points="335.58,-70.65 344.41,-64.81 333.86,-63.86 335.58,-70.65"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M19.88,-50.46C19.88,-44.24 19.88,-34.15 19.88,-25.39"/>
<polygon fill="black" stroke="black" points="23.38,-25.6 19.88,-15.6 16.38,-25.6 23.38,-25.6"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M125.88,-50.46C125.88,-44.24 125.88,-34.15 125.88,-25.39"/>
<polygon fill="black" stroke="black" points="129.38,-25.6 125.88,-15.6 122.38,-25.6 129.38,-25.6"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M244.88,-50.46C244.88,-44.24 244.88,-34.15 244.88,-25.39"/>
<polygon fill="black" stroke="black" points="248.38,-25.6 244.88,-15.6 241.38,-25.6 248.38,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M369.88,-50.46C369.88,-44.24 369.88,-34.15 369.88,-25.39"/>
<polygon fill="black" stroke="black" points="373.38,-25.6 369.88,-15.6 366.38,-25.6 373.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To make life simple, we define a wrapper function <code>nt_var()</code> that will convert a token to its corresponding nonterminal symbol.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">nt_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">var</span> <span class="k">if</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">else</span> <span class="n">to_nonterminal</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now, we need to apply a new definition to an entire grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">apply_new_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">nt_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt_var</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">(</span><span class="n">nt_var</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This algorithm is implemented as <code>get_derivation_tree()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_derivation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="p">[])])</span>

        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_new_definition</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>TreeMiner</code> is used as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">VEHICLES</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_vehicle</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">assignments</span> <span class="o">=</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span><span class="o">.</span><span class="n">assignments</span><span class="p">()</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">assignments</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> vehicle='1997,van,Ford,E350'
	 - Node: &lt;start&gt;		? (&lt;vehicle&gt;:'1997,van,Ford,E350')
		 -&gt; [0] '1997,van,Ford,E350'
		  &gt; ['&lt;vehicle&gt;']
 year='1997'
	 - Node: &lt;start&gt;		? (&lt;year&gt;:'1997')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;year&gt;:'1997')
		 -&gt; [0] '1997,van,Ford,E350'
		  &gt; ['&lt;year&gt;', ',van,Ford,E350']
 kind='van'
	 - Node: &lt;start&gt;		? (&lt;kind&gt;:'van')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;kind&gt;:'van')
		 -&gt; [0] '&lt;year&gt;'
	 - Node: &lt;year&gt;		? (&lt;kind&gt;:'van')
		 -&gt; [0] '1997'
		 -&gt; [1] ',van,Ford,E350'
		  &gt; [',', '&lt;kind&gt;', ',Ford,E350']
 company='Ford'
	 - Node: &lt;start&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] '&lt;year&gt;'
	 - Node: &lt;year&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind&gt;'
	 - Node: &lt;kind&gt;		? (&lt;company&gt;:'Ford')
		 -&gt; [0] 'van'
		 -&gt; [3] ',Ford,E350'
		  &gt; [',', '&lt;company&gt;', ',E350']
 model='E350'
	 - Node: &lt;start&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] '&lt;vehicle&gt;'
	 - Node: &lt;vehicle&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] '&lt;year&gt;'
	 - Node: &lt;year&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind&gt;'
	 - Node: &lt;kind&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company&gt;'
	 - Node: &lt;company&gt;		? (&lt;model&gt;:'E350')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ',E350'
		  &gt; [',', '&lt;model&gt;']
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('&lt;start&gt;',
 [('&lt;vehicle&gt;',
   [('&lt;year&gt;', [['1997', []]]),
    (',', []),
    ('&lt;kind&gt;', [['van', []]]),
    (',', []),
    ('&lt;company&gt;', [['Ford', []]]),
    (',', []),
    ('&lt;model&gt;', [['E350', []]])])])
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The obtained derivation tree is as below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">display_tree</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">assignments</span><span class="p">)</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="403pt" height="173pt" viewbox="0.00 0.00 403.38 173.00" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 169)">
<polygon fill="white" stroke="none" points="-4,4 -4,-169 399.38,-169 399.38,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="178.88" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="178.88" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;vehicle&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M178.88,-150.96C178.88,-144.74 178.88,-134.65 178.88,-125.89"/>
<polygon fill="black" stroke="black" points="182.38,-126.1 178.88,-116.1 175.38,-126.1 182.38,-126.1"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="19.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;year&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M158.74,-100.51C131.42,-92.23 82.39,-77.35 50.5,-67.67"/>
<polygon fill="black" stroke="black" points="51.63,-64.35 41.05,-64.8 49.6,-71.05 51.63,-64.35"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="72.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M165.45,-100.51C148.17,-92.65 117.84,-78.84 96.62,-69.18"/>
<polygon fill="black" stroke="black" points="98.12,-66.02 87.57,-65.06 95.22,-72.39 98.12,-66.02"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="125.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;kind&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M172.38,-100.71C164.59,-93.62 151.29,-81.51 140.9,-72.06"/>
<polygon fill="black" stroke="black" points="143.3,-69.5 133.55,-65.36 138.58,-74.68 143.3,-69.5"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="178.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>1-&gt;7</title>
<path fill="none" stroke="black" d="M178.88,-100.71C178.88,-94.49 178.88,-84.4 178.88,-75.64"/>
<polygon fill="black" stroke="black" points="182.38,-75.85 178.88,-65.85 175.38,-75.85 182.38,-75.85"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="244.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;company&gt;</text>
</g>
<!-- 1&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>1-&gt;8</title>
<path fill="none" stroke="black" d="M187.23,-100.51C197.41,-93.08 214.83,-80.34 227.87,-70.81"/>
<polygon fill="black" stroke="black" points="229.56,-73.91 235.57,-65.18 225.43,-68.25 229.56,-73.91"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="310.88" y="-51.2" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 1&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>1-&gt;10</title>
<path fill="none" stroke="black" d="M195.59,-100.51C218.19,-92.25 258.71,-77.44 285.19,-67.76"/>
<polygon fill="black" stroke="black" points="286.31,-71.08 294.5,-64.36 283.9,-64.51 286.31,-71.08"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="369.88" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;model&gt;</text>
</g>
<!-- 1&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>1-&gt;11</title>
<path fill="none" stroke="black" d="M203.07,-100.51C236.36,-92.1 296.52,-76.9 334.77,-67.24"/>
<polygon fill="black" stroke="black" points="335.58,-70.65 344.41,-64.81 333.86,-63.86 335.58,-70.65"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="19.88" y="-0.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M19.88,-50.46C19.88,-44.24 19.88,-34.15 19.88,-25.39"/>
<polygon fill="black" stroke="black" points="23.38,-25.6 19.88,-15.6 16.38,-25.6 23.38,-25.6"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="125.88" y="-0.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M125.88,-50.46C125.88,-44.24 125.88,-34.15 125.88,-25.39"/>
<polygon fill="black" stroke="black" points="129.38,-25.6 125.88,-15.6 122.38,-25.6 129.38,-25.6"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="244.88" y="-0.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M244.88,-50.46C244.88,-44.24 244.88,-34.15 244.88,-25.39"/>
<polygon fill="black" stroke="black" points="248.38,-25.6 244.88,-15.6 241.38,-25.6 248.38,-25.6"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="369.88" y="-0.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M369.88,-50.46C369.88,-44.24 369.88,-34.15 369.88,-25.39"/>
<polygon fill="black" stroke="black" points="373.38,-25.6 369.88,-15.6 366.38,-25.6 373.38,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Combining all the pieces:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">trees</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">vehicle</span> <span class="ow">in</span> <span class="n">VEHICLES</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
        <span class="n">process_vehicle</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
    <span class="n">assignments</span> <span class="o">=</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span><span class="o">.</span><span class="n">assignments</span><span class="p">()</span>
    <span class="n">trees</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">assignments</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">assignments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">var</span> <span class="o">+</span> <span class="s2">" = "</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1997,van,Ford,E350
vehicle = '1997,van,Ford,E350'
year = '1997'
kind = 'van'
company = 'Ford'
model = 'E350'

2000,car,Mercury,Cougar
vehicle = '2000,car,Mercury,Cougar'
year = '2000'
kind = 'car'
company = 'Mercury'
model = 'Cougar'

1999,car,Chevy,Venture
vehicle = '1999,car,Chevy,Venture'
year = '1999'
kind = 'car'
company = 'Chevy'
model = 'Venture'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The corresponding derivation trees are below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">csv_dt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">inputstr</span><span class="p">,</span> <span class="n">assignments</span> <span class="ow">in</span> <span class="n">trees</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">inputstr</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">assignments</span><span class="p">)</span>
    <span class="n">csv_dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1997,van,Ford,E350
2000,car,Mercury,Cougar
1999,car,Chevy,Venture
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Recovering-Grammars-from-Derivation-Trees">Recovering Grammars from Derivation Trees</h3><p>We define a class <code>Miner</code> that can combine multiple derivation trees to produce the grammar. The initial grammar is empty.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GrammarMiner</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>tree_to_grammar()</code> method converts our derivation tree to a grammar by picking one node at a time, and adding it to the grammar. The node name becomes the key, and any list of children it has becomes another alternative for that key.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GrammarMiner</span><span class="p">(</span><span class="n">GrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">tree_to_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
        <span class="n">node</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">tree</span>
        <span class="n">one_alt</span> <span class="o">=</span> <span class="p">[</span><span class="n">ck</span> <span class="k">for</span> <span class="n">ck</span><span class="p">,</span> <span class="n">gc</span> <span class="ow">in</span> <span class="n">children</span><span class="p">]</span>
        <span class="n">hsh</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">[</span><span class="n">one_alt</span><span class="p">]</span> <span class="k">if</span> <span class="n">one_alt</span> <span class="k">else</span> <span class="p">[]}</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">chsh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_to_grammar</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">chsh</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hsh</span><span class="p">:</span>
                    <span class="n">hsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">chsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chsh</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">hsh</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">gm</span> <span class="o">=</span> <span class="n">GrammarMiner</span><span class="p">()</span>
<span class="n">gm</span><span class="o">.</span><span class="n">tree_to_grammar</span><span class="p">(</span><span class="n">csv_dt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{'&lt;start&gt;': [['&lt;vehicle&gt;']],
 '&lt;vehicle&gt;': [['&lt;year&gt;', ',', '&lt;kind&gt;', ',', '&lt;company&gt;', ',', '&lt;model&gt;']],
 '&lt;year&gt;': [['1997']],
 '&lt;kind&gt;': [['van']],
 '&lt;company&gt;': [['Ford']],
 '&lt;model&gt;': [['E350']]}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The grammar being generated here is <code>canonical</code>. We define a function <code>readable()</code> that takes in a canonical grammar and returns it in a readable form.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">readable</span><span class="p">(</span><span class="n">grammar</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">readable_rule</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">readable_rule</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">grammar</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">grammar</span><span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">readable</span><span class="p">(</span><span class="n">gm</span><span class="o">.</span><span class="n">tree_to_grammar</span><span class="p">(</span><span class="n">csv_dt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tree</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 199.5 62" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M159.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">vehicle</text></g></g><path d="M139.5 31h20"/></g><path d="M 159.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 575.5 62" width="575.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M535.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M515.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">year</text></g><path d="M114.0 31h10"/><path d="M124.0 31h10"/><g class="terminal">
<path d="M134.0 31h0.0"/><path d="M162.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="134.0" y="20"/><text x="148.25" y="35">,</text></g><path d="M162.5 31h10"/><path d="M172.5 31h10"/><g class="non-terminal">
<path d="M182.5 31h0.0"/><path d="M236.5 31h0.0"/><rect height="22" width="54.0" x="182.5" y="20"/><text x="209.5" y="35">kind</text></g><path d="M236.5 31h10"/><path d="M246.5 31h10"/><g class="terminal">
<path d="M256.5 31h0.0"/><path d="M285.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="256.5" y="20"/><text x="270.75" y="35">,</text></g><path d="M285.0 31h10"/><path d="M295.0 31h10"/><g class="non-terminal">
<path d="M305.0 31h0.0"/><path d="M384.5 31h0.0"/><rect height="22" width="79.5" x="305.0" y="20"/><text x="344.75" y="35">company</text></g><path d="M384.5 31h10"/><path d="M394.5 31h10"/><g class="terminal">
<path d="M404.5 31h0.0"/><path d="M433.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="404.5" y="20"/><text x="418.75" y="35">,</text></g><path d="M433.0 31h10"/><path d="M443.0 31h10"/><g class="non-terminal">
<path d="M453.0 31h0.0"/><path d="M515.5 31h0.0"/><rect height="22" width="62.5" x="453.0" y="20"/><text x="484.25" y="35">model</text></g></g><path d="M515.5 31h20"/></g><path d="M 535.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1997</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 165.5 62" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M125.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">van</text></g></g><path d="M105.5 31h20"/></g><path d="M 125.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">Ford</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">E350</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>add_tree()</code> method gets a combined list of non-terminals from current grammar, and the tree to be added to the grammar, and updates the definitions of each non-terminal.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/itertools.html" class="import" target="_blank">itertools</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GrammarMiner</span><span class="p">(</span><span class="n">GrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">add_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">t_grammar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_to_grammar</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> <span class="n">t_grammar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">t_grammar</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>add_tree()</code> is used as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">inventory_grammar_miner</span> <span class="o">=</span> <span class="n">GrammarMiner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">csv_dt</span><span class="p">:</span>
    <span class="n">inventory_grammar_miner</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">readable</span><span class="p">(</span><span class="n">inventory_grammar_miner</span><span class="o">.</span><span class="n">grammar</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 199.5 62" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M159.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">vehicle</text></g></g><path d="M139.5 31h20"/></g><path d="M 159.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 575.5 62" width="575.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M535.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M515.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">year</text></g><path d="M114.0 31h10"/><path d="M124.0 31h10"/><g class="terminal">
<path d="M134.0 31h0.0"/><path d="M162.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="134.0" y="20"/><text x="148.25" y="35">,</text></g><path d="M162.5 31h10"/><path d="M172.5 31h10"/><g class="non-terminal">
<path d="M182.5 31h0.0"/><path d="M236.5 31h0.0"/><rect height="22" width="54.0" x="182.5" y="20"/><text x="209.5" y="35">kind</text></g><path d="M236.5 31h10"/><path d="M246.5 31h10"/><g class="terminal">
<path d="M256.5 31h0.0"/><path d="M285.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="256.5" y="20"/><text x="270.75" y="35">,</text></g><path d="M285.0 31h10"/><path d="M295.0 31h10"/><g class="non-terminal">
<path d="M305.0 31h0.0"/><path d="M384.5 31h0.0"/><rect height="22" width="79.5" x="305.0" y="20"/><text x="344.75" y="35">company</text></g><path d="M384.5 31h10"/><path d="M394.5 31h10"/><g class="terminal">
<path d="M404.5 31h0.0"/><path d="M433.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="404.5" y="20"/><text x="418.75" y="35">,</text></g><path d="M433.0 31h10"/><path d="M443.0 31h10"/><g class="non-terminal">
<path d="M453.0 31h0.0"/><path d="M515.5 31h0.0"/><rect height="22" width="62.5" x="453.0" y="20"/><text x="484.25" y="35">model</text></g></g><path d="M515.5 31h20"/></g><path d="M 535.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 174.0 122" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M114.0 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M114.0 91h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="80"/><text x="87.0" y="95">1997</text></g></g><path d="M114.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 199.5 122" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h12.75"/><path d="M126.75 91h12.75"/><g class="terminal">
<path d="M72.75 91h0.0"/><path d="M126.75 91h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="72.75" y="80"/><text x="99.75" y="95">Ford</text></g></g><path d="M139.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 199.5 122" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h12.75"/><path d="M126.75 31h12.75"/><g class="terminal">
<path d="M72.75 31h0.0"/><path d="M126.75 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="72.75" y="20"/><text x="99.75" y="35">E350</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M135.25 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M135.25 61h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="50"/><text x="99.75" y="65">Cougar</text></g></g><path d="M139.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M139.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M139.5 91h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="80"/><text x="99.75" y="95">Venture</text></g></g><path d="M139.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Given execution traces from various inputs, one can define <code>update_grammar()</code> to obtain the complete grammar from the traces.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GrammarMiner</span><span class="p">(</span><span class="n">GrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">update_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">):</span>
        <span class="n">at</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tracker</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tree_miner</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">at</span><span class="o">.</span><span class="n">assignments</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span>

    <span class="k">def</span> <span class="nf">create_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_tree_miner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The complete grammar recovery is implemented in <code>recover_grammar()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">recover_grammar</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grammar</span><span class="p">:</span>
    <span class="n">miner</span> <span class="o">=</span> <span class="n">GrammarMiner</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">inputstr</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
            <span class="n">fn</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
        <span class="n">miner</span><span class="o">.</span><span class="n">update_grammar</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">readable</span><span class="p">(</span><span class="n">miner</span><span class="o">.</span><span class="n">grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note that the grammar could have been retrieved directly from the tracker, without the intermediate derivation tree stage. However, going through the derivation tree allows one to inspect the inputs being fragmented and verify that it happens correctly.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-1.-Recovering-the-Inventory-Grammar">Example 1. Recovering the Inventory Grammar</h4></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">inventory_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">process_vehicle</span><span class="p">,</span> <span class="n">VEHICLES</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">inventory_grammar</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{'&lt;start&gt;': ['&lt;vehicle&gt;'],
 '&lt;vehicle&gt;': ['&lt;year&gt;,&lt;kind&gt;,&lt;company&gt;,&lt;model&gt;'],
 '&lt;year&gt;': ['1999', '2000', '1997'],
 '&lt;kind&gt;': ['car', 'van'],
 '&lt;company&gt;': ['Mercury', 'Chevy', 'Ford'],
 '&lt;model&gt;': ['E350', 'Cougar', 'Venture']}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-2.-Recovering-URL-Grammar">Example 2. Recovering URL Grammar</h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our algorithm is robust enough to recover grammar from real world programs. For example, the <code>urlparse</code> function in the Python <code>urlib</code> module accepts the following sample URLs.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">URLS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'http://user:pass@www.google.com:80/?q=path#ref'</span><span class="p">,</span>
    <span class="s1">'https://www.cispa.saarland:80/'</span><span class="p">,</span>
    <span class="s1">'http://www.fuzzingbook.org/#News'</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The urllib caches its intermediate results for faster access. Hence, we need to disable it using <code>clear_cache()</code> after every invocation.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/urllib.parse.html" class="import" target="_blank">urllib.parse</a></span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">clear_cache</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We use the sample URLs to recover grammar as follows. The <code>urlparse</code> function tends to cache its previous parsing results. Hence, we define a new method <code>url_parse()</code> that clears the cache before each call.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">url_parse</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">clear_cache</span><span class="p">()</span>
    <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">trees</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">URLS</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
        <span class="n">url_parse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
    <span class="n">assignments</span> <span class="o">=</span> <span class="n">DefineTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span><span class="o">.</span><span class="n">assignments</span><span class="p">()</span>
    <span class="n">trees</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">assignments</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">assignments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">var</span> <span class="o">+</span> <span class="s2">" = "</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="n">url_dt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">inputstr</span><span class="p">,</span> <span class="n">assignments</span> <span class="ow">in</span> <span class="n">trees</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">inputstr</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">assignments</span><span class="p">)</span>
    <span class="n">url_dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>http://user:pass@www.google.com:80/?q=path#ref
url = 'http://user:pass@www.google.com:80/?q=path#ref'
scheme = 'http'
netloc = 'user:pass@www.google.com:80'
fragment = 'ref'
query = 'q=path'

https://www.cispa.saarland:80/
url = 'https://www.cispa.saarland:80/'
scheme = 'https'
netloc = 'www.cispa.saarland:80'

http://www.fuzzingbook.org/#News
url = 'http://www.fuzzingbook.org/#News'
scheme = 'http'
netloc = 'www.fuzzingbook.org'
fragment = 'News'

http://user:pass@www.google.com:80/?q=path#ref
https://www.cispa.saarland:80/
http://www.fuzzingbook.org/#News
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us use <code>url_parse()</code> to recover the grammar:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">url_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">url_parse</span><span class="p">,</span> <span class="n">URLS</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 165.5 62" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M125.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">url</text></g></g><path d="M105.5 31h20"/></g><path d="M 125.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 643.5 122" width="643.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M603.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M583.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">scheme</text></g><path d="M131.0 31h10"/><path d="M141.0 31h10"/><g class="terminal">
<path d="M151.0 31h0.0"/><path d="M196.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="151.0" y="20"/><text x="173.75" y="35">://</text></g><path d="M196.5 31h10"/><path d="M206.5 31h10"/><g class="non-terminal">
<path d="M216.5 31h0.0"/><path d="M287.5 31h0.0"/><rect height="22" width="71.0" x="216.5" y="20"/><text x="252.0" y="35">netloc</text></g><path d="M287.5 31h10"/><path d="M297.5 31h10"/><g class="terminal">
<path d="M307.5 31h0.0"/><path d="M344.5 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="307.5" y="20"/><text x="326.0" y="35">/?</text></g><path d="M344.5 31h10"/><path d="M354.5 31h10"/><g class="non-terminal">
<path d="M364.5 31h0.0"/><path d="M427.0 31h0.0"/><rect height="22" width="62.5" x="364.5" y="20"/><text x="395.75" y="35">query</text></g><path d="M427.0 31h10"/><path d="M437.0 31h10"/><g class="terminal">
<path d="M447.0 31h0.0"/><path d="M475.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="447.0" y="20"/><text x="461.25" y="35">#</text></g><path d="M475.5 31h10"/><path d="M485.5 31h10"/><g class="non-terminal">
<path d="M495.5 31h0.0"/><path d="M583.5 31h0.0"/><rect height="22" width="88.0" x="495.5" y="20"/><text x="539.5" y="35">fragment</text></g></g><path d="M583.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h123.75"/><path d="M459.75 61h123.75"/><g class="non-terminal">
<path d="M183.75 61h0.0"/><path d="M254.75 61h0.0"/><rect height="22" width="71.0" x="183.75" y="50"/><text x="219.25" y="65">scheme</text></g><path d="M254.75 61h10"/><path d="M264.75 61h10"/><g class="terminal">
<path d="M274.75 61h0.0"/><path d="M320.25 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="274.75" y="50"/><text x="297.5" y="65">://</text></g><path d="M320.25 61h10"/><path d="M330.25 61h10"/><g class="non-terminal">
<path d="M340.25 61h0.0"/><path d="M411.25 61h0.0"/><rect height="22" width="71.0" x="340.25" y="50"/><text x="375.75" y="65">netloc</text></g><path d="M411.25 61h10"/><path d="M421.25 61h10"/><g class="terminal">
<path d="M431.25 61h0.0"/><path d="M459.75 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="431.25" y="50"/><text x="445.5" y="65">/</text></g></g><path d="M583.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h65.5"/><path d="M518.0 91h65.5"/><g class="non-terminal">
<path d="M125.5 91h0.0"/><path d="M196.5 91h0.0"/><rect height="22" width="71.0" x="125.5" y="80"/><text x="161.0" y="95">scheme</text></g><path d="M196.5 91h10"/><path d="M206.5 91h10"/><g class="terminal">
<path d="M216.5 91h0.0"/><path d="M262.0 91h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="216.5" y="80"/><text x="239.25" y="95">://</text></g><path d="M262.0 91h10"/><path d="M272.0 91h10"/><g class="non-terminal">
<path d="M282.0 91h0.0"/><path d="M353.0 91h0.0"/><rect height="22" width="71.0" x="282.0" y="80"/><text x="317.5" y="95">netloc</text></g><path d="M353.0 91h10"/><path d="M363.0 91h10"/><g class="terminal">
<path d="M373.0 91h0.0"/><path d="M410.0 91h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="373.0" y="80"/><text x="391.5" y="95">/#</text></g><path d="M410.0 91h10"/><path d="M420.0 91h10"/><g class="non-terminal">
<path d="M430.0 91h0.0"/><path d="M518.0 91h0.0"/><rect height="22" width="88.0" x="430.0" y="80"/><text x="474.0" y="95">fragment</text></g></g><path d="M583.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 603.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>scheme
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 182.5 92" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M122.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M122.5 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="50"/><text x="91.25" y="65">https</text></g></g><path d="M122.5 61h20"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 369.5 122" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M329.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M309.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M309.5 91h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="80"/><text x="184.75" y="95">user:pass@www.google.com:80</text></g></g><path d="M309.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>query
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>fragment
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The recovered grammar describes the URL format reasonably well.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Fuzzing">Fuzzing</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now use our recovered grammar for fuzzing as follows.</p>
<p>First, the inventory grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">inventory_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1997,car,Mercury,E350
2000,car,Chevy,Cougar
1997,van,Mercury,Venture
1999,car,Ford,Venture
2000,car,Mercury,E350
2000,car,Mercury,Cougar
1997,car,Chevy,E350
1997,car,Chevy,E350
1997,car,Mercury,Cougar
1999,car,Chevy,E350
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Next, the URL grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://user:pass@www.google.com:80/
http://www.cispa.saarland:80/?q=path#News
https://user:pass@www.google.com:80/
https://user:pass@www.google.com:80/#ref
http://user:pass@www.google.com:80/
http://user:pass@www.google.com:80/#ref
http://user:pass@www.google.com:80/?q=path#News
http://www.fuzzingbook.org/?q=path#News
http://www.fuzzingbook.org/?q=path#ref
http://www.cispa.saarland:80/
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>What this means is that we can now take a program and a few samples, extract its grammar, and then use this very grammar for fuzzing.  Now that's quite an opportunity!</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Problems-with-the-Simple-Miner">Problems with the Simple Miner</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One of the problems with our simple grammar miner is the assumption that the values assigned to variables are stable. Unfortunately, that may not hold true in all cases. For example, here is a URL with a slightly different format.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">URLS_X</span> <span class="o">=</span> <span class="n">URLS</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'ftp://freebsd.org/releases/5.8'</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The grammar generated from this set of samples is not as nice as what we got earlier</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">url_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">url_parse</span><span class="p">,</span> <span class="n">URLS_X</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 413.0 92" width="413.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M373.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h123.75"/><path d="M229.25 31h123.75"/><g class="non-terminal">
<path d="M183.75 31h0.0"/><path d="M229.25 31h0.0"/><rect height="22" width="45.5" x="183.75" y="20"/><text x="206.5" y="35">url</text></g></g><path d="M353.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M353.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" width="71.0" x="60.0" y="50"/><text x="95.5" y="65">scheme</text></g><path d="M131.0 61h10"/><path d="M141.0 61h10"/><g class="terminal">
<path d="M151.0 61h0.0"/><path d="M196.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="151.0" y="50"/><text x="173.75" y="65">://</text></g><path d="M196.5 61h10"/><path d="M206.5 61h10"/><g class="non-terminal">
<path d="M216.5 61h0.0"/><path d="M287.5 61h0.0"/><rect height="22" width="71.0" x="216.5" y="50"/><text x="252.0" y="65">netloc</text></g><path d="M287.5 61h10"/><path d="M297.5 61h10"/><g class="non-terminal">
<path d="M307.5 61h0.0"/><path d="M353.0 61h0.0"/><rect height="22" width="45.5" x="307.5" y="50"/><text x="330.25" y="65">url</text></g></g><path d="M353.0 61h20"/></g><path d="M 373.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="152" viewbox="0 0 643.5 152" width="643.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 81v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 91h0.0"/><path d="M603.5 91h0.0"/><path d="M40.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 61h0.0"/><path d="M583.5 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" width="71.0" x="60.0" y="50"/><text x="95.5" y="65">scheme</text></g><path d="M131.0 61h10"/><path d="M141.0 61h10"/><g class="terminal">
<path d="M151.0 61h0.0"/><path d="M196.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="151.0" y="50"/><text x="173.75" y="65">://</text></g><path d="M196.5 61h10"/><path d="M206.5 61h10"/><g class="non-terminal">
<path d="M216.5 61h0.0"/><path d="M287.5 61h0.0"/><rect height="22" width="71.0" x="216.5" y="50"/><text x="252.0" y="65">netloc</text></g><path d="M287.5 61h10"/><path d="M297.5 61h10"/><g class="terminal">
<path d="M307.5 61h0.0"/><path d="M344.5 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="307.5" y="50"/><text x="326.0" y="65">/?</text></g><path d="M344.5 61h10"/><path d="M354.5 61h10"/><g class="non-terminal">
<path d="M364.5 61h0.0"/><path d="M427.0 61h0.0"/><rect height="22" width="62.5" x="364.5" y="50"/><text x="395.75" y="65">query</text></g><path d="M427.0 61h10"/><path d="M437.0 61h10"/><g class="terminal">
<path d="M447.0 61h0.0"/><path d="M475.5 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="447.0" y="50"/><text x="461.25" y="65">#</text></g><path d="M475.5 61h10"/><path d="M485.5 61h10"/><g class="non-terminal">
<path d="M495.5 61h0.0"/><path d="M583.5 61h0.0"/><rect height="22" width="88.0" x="495.5" y="50"/><text x="539.5" y="65">fragment</text></g></g><path d="M583.5 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 91a10 10 0 0 0 10 -10v-40a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h196.5"/><path d="M387.0 31h196.5"/><g class="terminal">
<path d="M256.5 31h0.0"/><path d="M387.0 31h0.0"/><rect height="22" rx="10" ry="10" width="130.5" x="256.5" y="20"/><text x="321.75" y="35">/releases/5.8</text></g></g><path d="M583.5 31a10 10 0 0 1 10 10v40a10 10 0 0 0 10 10"/><path d="M40.0 91h20"/><g>
<path d="M60.0 91h123.75"/><path d="M459.75 91h123.75"/><g class="non-terminal">
<path d="M183.75 91h0.0"/><path d="M254.75 91h0.0"/><rect height="22" width="71.0" x="183.75" y="80"/><text x="219.25" y="95">scheme</text></g><path d="M254.75 91h10"/><path d="M264.75 91h10"/><g class="terminal">
<path d="M274.75 91h0.0"/><path d="M320.25 91h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="274.75" y="80"/><text x="297.5" y="95">://</text></g><path d="M320.25 91h10"/><path d="M330.25 91h10"/><g class="non-terminal">
<path d="M340.25 91h0.0"/><path d="M411.25 91h0.0"/><rect height="22" width="71.0" x="340.25" y="80"/><text x="375.75" y="95">netloc</text></g><path d="M411.25 91h10"/><path d="M421.25 91h10"/><g class="terminal">
<path d="M431.25 91h0.0"/><path d="M459.75 91h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="431.25" y="80"/><text x="445.5" y="95">/</text></g></g><path d="M583.5 91h20"/><path d="M40.0 91a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 121h65.5"/><path d="M518.0 121h65.5"/><g class="non-terminal">
<path d="M125.5 121h0.0"/><path d="M196.5 121h0.0"/><rect height="22" width="71.0" x="125.5" y="110"/><text x="161.0" y="125">scheme</text></g><path d="M196.5 121h10"/><path d="M206.5 121h10"/><g class="terminal">
<path d="M216.5 121h0.0"/><path d="M262.0 121h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="216.5" y="110"/><text x="239.25" y="125">://</text></g><path d="M262.0 121h10"/><path d="M272.0 121h10"/><g class="non-terminal">
<path d="M282.0 121h0.0"/><path d="M353.0 121h0.0"/><rect height="22" width="71.0" x="282.0" y="110"/><text x="317.5" y="125">netloc</text></g><path d="M353.0 121h10"/><path d="M363.0 121h10"/><g class="terminal">
<path d="M373.0 121h0.0"/><path d="M410.0 121h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="373.0" y="110"/><text x="391.5" y="125">/#</text></g><path d="M410.0 121h10"/><path d="M420.0 121h10"/><g class="non-terminal">
<path d="M430.0 121h0.0"/><path d="M518.0 121h0.0"/><rect height="22" width="88.0" x="430.0" y="110"/><text x="474.0" y="125">fragment</text></g></g><path d="M583.5 121a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 603.5 91 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>scheme
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 182.5 122" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M114.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="68.5" y="50"/><text x="91.25" y="65">ftp</text></g></g><path d="M122.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="80"/><text x="91.25" y="95">https</text></g></g><path d="M122.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="152" viewbox="0 0 369.5 152" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 81v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 91h0.0"/><path d="M329.5 91h0.0"/><path d="M40.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 91a10 10 0 0 0 10 -10v-40a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v40a10 10 0 0 0 10 10"/><path d="M40.0 91h20"/><g>
<path d="M60.0 91h68.0"/><path d="M241.5 91h68.0"/><g class="terminal">
<path d="M128.0 91h0.0"/><path d="M241.5 91h0.0"/><rect height="22" rx="10" ry="10" width="113.5" x="128.0" y="80"/><text x="184.75" y="95">freebsd.org</text></g></g><path d="M309.5 91h20"/><path d="M40.0 91a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><g class="terminal">
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="110"/><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g><path d="M309.5 121a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 91 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>query
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>fragment
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Clearly, something has gone wrong.</p>
<p>To investigate why the <code>url</code> definition has gone wrong, let us inspect the trace for the URL.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">clear_cache</span><span class="p">()</span>
<span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">URLS_X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">urlparse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">'call'</span><span class="p">,</span> <span class="s1">'line'</span><span class="p">}</span> <span class="ow">and</span> <span class="s1">'parse.py'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">_t</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 374 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
1 394 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
5 129 ({'arg': ''},)
6 126 ({'arg': ''},)
7 131 ({'arg': ''},)
8 132 ({'arg': ''},)
10 395 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
11 452 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
12 474 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
16 129 ({'arg': ''},)
17 126 ({'arg': ''},)
18 131 ({'arg': ''},)
19 132 ({'arg': ''},)
21 477 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
22 478 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
23 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
24 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\t'},)
25 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\t'},)
26 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\t'},)
27 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\r'},)
28 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\r'},)
29 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\r'},)
30 481 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n'},)
31 482 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n'},)
32 480 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n'},)
33 484 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n'},)
34 485 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n'},)
35 486 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': ''},)
36 487 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': ''},)
37 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': ''},)
38 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'h'},)
39 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'h'},)
40 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)
41 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)
42 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)
43 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 't'},)
44 489 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)
45 488 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)
46 492 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': '', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)
47 493 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)
48 494 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': '', 'query': '', 'fragment': '', 'c': 'p'},)
49 413 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)
50 414 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)
51 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref'},)
52 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)
53 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)
54 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)
55 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '/'},)
56 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)
57 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)
58 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)
59 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '?'},)
60 416 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)
61 417 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)
62 418 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)
63 415 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)
64 419 ({'url': '//user:pass@www.google.com:80/?q=path#ref', 'c': '#'},)
66 495 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)
67 496 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)
68 498 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)
69 501 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)
70 502 ({'url': '/?q=path#ref', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': '', 'c': 'p'},)
71 503 ({'url': '/?q=path', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': 'ref', 'c': 'p'},)
72 504 ({'url': '/?q=path', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': '', 'fragment': 'ref', 'c': 'p'},)
73 505 ({'url': '/', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)
74 421 ({'netloc': 'user:pass@www.google.com:80'},)
75 422 ({'netloc': 'user:pass@www.google.com:80'},)
76 423 ({'netloc': 'user:pass@www.google.com:80'},)
78 506 ({'url': '/', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)
82 507 ({'url': '/', 'scheme': 'http', 'b': '\n', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'c': 'p'},)
87 396 ({'url': 'http://user:pass@www.google.com:80/?q=path#ref', 'scheme': ''},)
88 397 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref'},)
89 400 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref'},)
90 401 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'params': ''},)
94 402 ({'url': '/', 'scheme': 'http', 'netloc': 'user:pass@www.google.com:80', 'query': 'q=path', 'fragment': 'ref', 'params': ''},)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Notice how the value of <code>url</code> changes as the parsing progresses? This violates our assumption that the value assigned to a variable is stable. We next look at how this limitation can be removed.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Grammar-Miner-with-Reassignment">Grammar Miner with Reassignment</h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One way to uniquely identify different variables is to annotate them with <em>line numbers</em> both when they are defined and also when their value changes. Consider the code fragment below</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Tracking-variable-assignment-locations">Tracking variable assignment locations</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">cp_1</span><span class="p">):</span>
    <span class="n">c_2</span> <span class="o">=</span> <span class="n">cp_1</span> <span class="o">+</span> <span class="s1">'@2'</span>
    <span class="n">c_3</span> <span class="o">=</span> <span class="n">c_2</span> <span class="o">+</span> <span class="s1">'@3'</span>
    <span class="k">return</span> <span class="n">c_3</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">bp_7</span><span class="p">):</span>
    <span class="n">b_8</span> <span class="o">=</span> <span class="n">bp_7</span> <span class="o">+</span> <span class="s1">'@8'</span>
    <span class="k">return</span> <span class="n">C</span><span class="p">(</span><span class="n">b_8</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">A</span><span class="p">(</span><span class="n">ap_12</span><span class="p">):</span>
    <span class="n">a_13</span> <span class="o">=</span> <span class="n">ap_12</span> <span class="o">+</span> <span class="s1">'@13'</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_13</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'@14'</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">a_14</span> <span class="o">+</span> <span class="s1">'@15'</span>
    <span class="n">a_13</span> <span class="o">=</span> <span class="n">a_14</span> <span class="o">+</span> <span class="s1">'@16'</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_13</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'@17'</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_13</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'@18'</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Notice how all variables are either named corresponding to either where they are defined, or the value is annotated to indicate that it was changed.</p>
<p>Let us run this under the trace.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="s1">'____'</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">A</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"</span><span class="si">%d</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">line_no</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">method</span><span class="p">),</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>call 1:A {'ap_12': '____'}
line 2:A {'ap_12': '____'}
line 3:A {'ap_12': '____', 'a_13': '____@13'}
call 1:B {'bp_7': '____@13'}
line 2:B {'bp_7': '____@13'}
line 3:B {'bp_7': '____@13', 'b_8': '____@13@8'}
call 1:C {'cp_1': '____@13@8'}
line 2:C {'cp_1': '____@13@8'}
line 3:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2'}
line 4:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2', 'c_3': '____@13@8@2@3'}
return 4:C {'cp_1': '____@13@8', 'c_2': '____@13@8@2', 'c_3': '____@13@8@2@3'}
return 3:B {'bp_7': '____@13', 'b_8': '____@13@8'}
line 4:A {'ap_12': '____', 'a_13': '____@13', 'a_14': '____@13@8@2@3@14'}
line 5:A {'ap_12': '____', 'a_13': '____@13', 'a_14': '____@13@8@2@3@14@15'}
line 6:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15'}
call 1:B {'bp_7': '____@13@8@2@3@14@15@16'}
line 2:B {'bp_7': '____@13@8@2@3@14@15@16'}
line 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}
call 1:C {'cp_1': '____@13@8@2@3@14@15@16@8'}
line 2:C {'cp_1': '____@13@8@2@3@14@15@16@8'}
line 3:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2'}
line 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}
return 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}
return 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}
line 7:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15@16@8@2@3@17'}
call 1:B {'bp_7': '____@13@8@2@3@14@15@16'}
line 2:B {'bp_7': '____@13@8@2@3@14@15@16'}
line 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}
call 1:C {'cp_1': '____@13@8@2@3@14@15@16@8'}
line 2:C {'cp_1': '____@13@8@2@3@14@15@16@8'}
line 3:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2'}
line 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}
return 4:C {'cp_1': '____@13@8@2@3@14@15@16@8', 'c_2': '____@13@8@2@3@14@15@16@8@2', 'c_3': '____@13@8@2@3@14@15@16@8@2@3'}
return 3:B {'bp_7': '____@13@8@2@3@14@15@16', 'b_8': '____@13@8@2@3@14@15@16@8'}
return 7:A {'ap_12': '____', 'a_13': '____@13@8@2@3@14@15@16', 'a_14': '____@13@8@2@3@14@15@16@8@2@3@18'}
call 102:__exit__ {}
line 105:__exit__ {}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Each variable was referenced first as follows:</p>
<ul>
<li><code>cp_1</code> -- <em>call</em> <code>1:C</code></li>
<li><code>c_2</code> -- <em>line</em> <code>3:C</code> (but the previous event was <em>line</em> <code>2:C</code>)</li>
<li><code>c_3</code> -- <em>line</em> <code>4:C</code> (but the previous event was <em>line</em> <code>3:C</code>)</li>
<li><code>bp_7</code> -- <em>call</em> <code>7:B</code></li>
<li><code>b_8</code> -- <em>line</em> <code>9:B</code> (but the previous event was <em>line</em> <code>8:B</code>)</li>
<li><code>ap_12</code> -- <em>call</em> <code>12:A</code></li>
<li><code>a_13</code> -- <em>line</em> <code>14:A</code> (but the previous event was <em>line</em> <code>13:A</code>)</li>
<li><code>a_14</code> -- <em>line</em> <code>15:A</code> (the previous event was <em>return</em> <code>9:B</code>. However, the previous event in <code>A()</code> was <em>line</em> <code>14:A</code>)</li>
<li>reassign <code>a_14</code> at <em>15</em> -- <em>line</em> <code>16:A</code> (the previous event was <em>line</em> <code>15:A</code>)</li>
<li>reassign <code>a_13</code> at <em>16</em> -- <em>line</em> <code>17:A</code> (the previous event was <em>line</em> <code>16:A</code>)</li>
<li>reassign <code>a_14</code> at <em>17</em> -- <em>return</em> <code>17:A</code> (the previous event in <code>A()</code> was <em>line</em> <code>17:A</code>)</li>
<li>reassign <code>a_14</code> at <em>18</em> -- <em>return</em> <code>18:A</code> (the previous event in <code>A()</code> was <em>line</em> <code>18:A</code>)</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>So, our observations are that, if it is a call, the current location is the right one for any new variables being defined. On the other hand, if the variable being referenced for the first time (or reassigned a new value), then the  right location to consider is the previous location <em>in the same method invocation</em>. Next, let us see how we can incorporate this information into variable naming.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Next, we need a way to track the individual method calls as they are being made. For this we define the class <code>CallStack</code>. Each method invocation gets a separate identifier, and when the method call is over, the identifier is reset.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="CallStack">CallStack</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">CallStack</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_register</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">method_id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_register</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_register</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'call'</span><span class="p">,</span> <span class="s2">"</span><span class="si">%s%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">leave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'return'</span><span class="p">,</span> <span class="s2">"</span><span class="si">%s%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A few extra functions to make life simpler.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">CallStack</span><span class="p">(</span><span class="n">CallStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log_event</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'log'</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_evt</span><span class="p">,</span> <span class="n">_var</span><span class="p">:</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">indent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">)</span> <span class="o">*</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span>

    <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">mstack</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">:</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_id</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method_id</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We also define a convenience method to display a given stack.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">display_stack</span><span class="p">(</span><span class="n">istack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">stack_to_tree</span><span class="p">(</span><span class="n">stack</span><span class="p">):</span>
        <span class="n">current</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">stack</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rest</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">current</span><span class="p">),</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">current</span><span class="p">),</span> <span class="p">[</span><span class="n">stack_to_tree</span><span class="p">(</span><span class="n">rest</span><span class="p">)])</span>
    <span class="n">display_tree</span><span class="p">(</span><span class="n">stack_to_tree</span><span class="p">(</span><span class="n">istack</span><span class="o">.</span><span class="n">mstack</span><span class="p">),</span> <span class="n">graph_attr</span><span class="o">=</span><span class="n">lr_graph</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is how we can use the <code>CallStack</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span> <span class="o">=</span> <span class="n">CallStack</span><span class="p">()</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('&lt;start&gt;', 0)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('hello', 1)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="s1">'world'</span><span class="p">)</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('world', 2)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span><span class="o">.</span><span class="n">leave</span><span class="p">()</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('hello', 1)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="s1">'world'</span><span class="p">)</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('world', 3)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">cs</span><span class="o">.</span><span class="n">leave</span><span class="p">()</span>
<span class="n">display_stack</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="n">cs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('hello', 1)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In order to account for variable reassignments, we need to have a more intelligent data structure than a dictionary for storing variables. We first define a simple interface <code>Vars</code>. It acts as a container for variables, and is instantiated at <code>my_assignments</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Vars">Vars</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Vars</code> stores references to variables as they occur during parsing in its internal dictionary <code>defs</code>. We initialize the dictionary with the original string.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Vars</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span> <span class="o">=</span> <span class="n">original</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The dictionary needs two methods: <code>update()</code> that takes a set of key-value pairs to update itself, and <code>_set_kv()</code> that updates a particular key-value pair.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Vars</span><span class="p">(</span><span class="n">Vars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_set_kv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_kv</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_kv</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>Vars</code> is a proxy for the internal dictionary. For example, here is how one can use it.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span> <span class="o">=</span> <span class="n">Vars</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{}
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'X'</span>
<span class="n">v</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{'x': 'X'}
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">v</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">'x'</span><span class="p">:</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">:</span> <span class="s1">'y'</span><span class="p">})</span>
<span class="n">v</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{'x': 'x', 'y': 'y'}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="AssignmentVars">AssignmentVars</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now extend the simple <code>Vars</code> to account for variable reassignments. For this, we define <code>AssignmentVars</code>.</p>
<p>The idea for detecting reassignments and renaming variables is as follows: We keep track of the previous reassignments to particular variables using <code>accessed_seq_var</code>. It contains the last rename of any particular variable as its corresponding value. The <code>new_vars</code> contains a list of all new variables that were added on this iteration.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">Vars</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_init</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>method_init()</code> method takes care of keeping track of method invocations using records saved in the <code>call_stack</code>. <code>event_locations</code> is for keeping track of the locations accessed <em>within this method</em>. This is used for line number tracking of variable definitions.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span> <span class="o">=</span> <span class="n">CallStack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">:</span> <span class="p">[]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>update()</code> is now modified to track the changed line numbers if any, using <code>var_location_register()</code>. We reinitialize the <code>new_vars</code> after use for the next event.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_kv</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_location_register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The variable name now incorporates an index of how many reassignments it has gone through, effectively making each reassignment a unique variable.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>While storing variables, we need to first check whether it was previously known. If it is not, we need to initialize the rename count. This is accomplished by <code>var_access</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>During a variable reassignment, we update the <code>accessed_seq_var</code> to reflect the new count.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These methods can be used as follows</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span> <span class="o">=</span> <span class="n">AssignmentVars</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<span class="n">sav</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{}
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span><span class="o">.</span><span class="n">var_access</span><span class="p">(</span><span class="s1">'v1'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('v1', 0)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span><span class="o">.</span><span class="n">var_assign</span><span class="p">(</span><span class="s1">'v1'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('v1', 1)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Assigning to it again increments the counter.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span><span class="o">.</span><span class="n">var_assign</span><span class="p">(</span><span class="s1">'v1'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>('v1', 2)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The core of the logic is in <code>_set_kv()</code>. When a variable is being assigned, we get the sequenced variable name <code>s_var</code>. If the sequenced variable name was previously unknown in <code>defs</code>, then we have no further concerns. We add the sequenced variable to <code>defs</code>.</p>
<p>If the variable is previously known, then it is an indication of a possible reassignment. In this case, we look at the value the variable is holding. We check if the value changed. If it has not, then it is not.</p>
<p>If the value has changed, it is a reassignment. We first increment the variable usage sequence using <code>var_assign</code>, retrieve the new name, update the new name in <code>defs</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_set_kv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">s_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_access</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s_var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="p">[</span><span class="n">s_var</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var_assign</span><span class="p">(</span><span class="n">var</span><span class="p">)]</span> <span class="o">=</span> <span class="n">val</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is how it can be used. Assigning a variable the first time initializes its counter.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span> <span class="o">=</span> <span class="n">AssignmentVars</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<span class="n">sav</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'X'</span>
<span class="n">sav</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{('x', 1): 'X'}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If the variable is assigned again with the same value, it is probably not a reassignment.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'X'</span>
<span class="n">sav</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{('x', 1): 'X'}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, if the value changed, it is a reassignment.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">sav</span><span class="p">[</span><span class="s1">'x'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Y'</span>
<span class="n">sav</span><span class="o">.</span><span class="n">defs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{('x', 1): 'X', ('x', 2): 'Y'}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>There is a subtlety here. It is possible for a child method to be called from the middle of a parent method, and for both to use the same variable name with different values. In this case, when the child returns, parent will have the old variable with old value in context. With our implementation, we consider this as a reassignment. However, this is OK because adding a new reassignment is harmless, but missing one is not. Further, we will discuss later how this can be avoided.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We also define bookkeeping codes for <code>register_event()</code> <code>method_enter()</code> and <code>method_exit()</code> which are the methods responsible for keeping track of the method stack. The basic idea is that, each <code>method_enter()</code> represents a new method invocation. Hence, it merits a new method id, which is generated from the <code>method_register</code>, and saved in the <code>method_id</code>. Since this is a new method, the method stack is extended by one element with this id. In the case of <code>method_exit()</code>, we pop the method stack, and reset the current <code>method_id</code> to what was below the current one.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="s1">'call'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">cxt</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_event</span><span class="p">(</span><span class="n">cxt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_vars</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">method_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="s1">'return'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_event</span><span class="p">(</span><span class="n">cxt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">leave</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">method_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="s1">'line'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_event</span><span class="p">(</span><span class="n">cxt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_vars</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For each of the method events, we also register the event using <code>register_event()</code> which keeps track of the line numbers that were referenced in <em>this</em> method.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">register_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cxt</span><span class="o">.</span><span class="n">line_no</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>var_location_register()</code> keeps the locations of newly added variables. The definition location of variables in a <code>call</code> is the <em>current</em>  location. However, for a <code>line</code>, it would be the previous event in the current method.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_location_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">loc</span><span class="p">(</span><span class="n">mid</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">==</span> <span class="s1">'call'</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">==</span> <span class="s1">'line'</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">==</span> <span class="s1">'return'</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="n">mid</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="kc">False</span>

        <span class="n">my_loc</span> <span class="o">=</span> <span class="n">loc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">my_vars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_loc</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define <code>defined_vars()</code> which returns the names of variables annotated with the line numbers as below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">defined_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">@</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">v</span> <span class="k">if</span> <span class="n">formatted</span> <span class="k">else</span> <span class="n">v</span>

        <span class="k">return</span> <span class="p">[(</span><span class="n">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Similar to <code>defined_vars()</code> we define <code>seq_vars()</code> which annotates different variables with the number of times they were used.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">seq_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">@</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">v</span> <span class="k">if</span> <span class="n">formatted</span> <span class="k">else</span> <span class="n">v</span>

        <span class="k">return</span> <span class="p">{</span><span class="n">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="AssignmentTracker">AssignmentTracker</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>AssignmentTracker</code> keeps the assignment definitions using the <code>AssignmentVars</code> we defined previously.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentTracker</span><span class="p">(</span><span class="n">DefineTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_input</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_input</span> <span class="o">=</span> <span class="n">my_input</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_assignments</span><span class="p">(</span><span class="n">my_input</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AssignmentVars</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To fine-tune the process, we define an optional parameter called <code>track_return</code>. During tracing a method return, Python produces a virtual variable that contains the result of the returned value. If the <code>track_return</code> is set, we capture this value as a variable.</p>
<ul>
<li><code>track_return</code> -- if true, add a <em>virtual variable</em> to the Vars representing the return value</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentTracker</span><span class="p">(</span><span class="n">AssignmentTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_return</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'track_return'</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>There can be different kinds of events during a trace, which includes <code>call</code> when a function is entered, <code>return</code> when the function returns, <code>exception</code> when an exception is thrown and <code>line</code> when a statement is executed.</p>
<p>The previous <code>Tracker</code> was too simplistic in that it did not distinguish between the different events. We rectify that and define <code>on_call()</code>, <code>on_return()</code>, and <code>on_line()</code> respectively, which get called on their corresponding events.</p>
<p>Note that <code>on_line()</code> is called also for <code>on_return()</code>. The reason is, that Python invokes the trace function <em>before</em> the corresponding line is executed. Hence, effectively, the <code>on_return()</code> is called with the binding produced by the execution of the previous statement in the environment. Our processing in effect is done on values that were bound by the previous statement. Hence, calling <code>on_line()</code> here is appropriate as it provides the event handler a chance to work on the previous binding.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">AssignmentTracker</span><span class="p">(</span><span class="n">AssignmentTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="n">my_vars</span> <span class="o">=</span> <span class="n">cxt</span><span class="o">.</span><span class="n">parameters</span><span class="p">(</span><span class="n">my_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">method_enter</span><span class="p">(</span><span class="n">cxt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">(</span><span class="n">my_vars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">on_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">method_statement</span><span class="p">(</span><span class="n">cxt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">(</span><span class="n">my_vars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">on_return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_line</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>
        <span class="n">my_vars</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'&lt;-</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">cxt</span><span class="o">.</span><span class="n">method</span><span class="p">:</span> <span class="n">arg</span><span class="p">}</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_return</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">method_exit</span><span class="p">(</span><span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vara</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">track_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="n">event</span>
        <span class="n">dispatch</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">'call'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_call</span><span class="p">,</span>
            <span class="s1">'return'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_return</span><span class="p">,</span>
            <span class="s1">'line'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_line</span><span class="p">,</span>
            <span class="s1">'exception'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_exception</span>
        <span class="p">}</span>
        <span class="n">dispatch</span><span class="p">[</span><span class="n">event</span><span class="p">](</span><span class="n">arg</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now use <code>AssignmentTracker</code> to track the different variables. To verify that our variable line number inference works, we recover definitions from the functions <code>A()</code>, <code>B()</code> and <code>C()</code> (with data annotations removed so that the input fragments are correctly identified).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="n">cp_1</span><span class="p">):</span>
    <span class="n">c_2</span> <span class="o">=</span> <span class="n">cp_1</span>
    <span class="n">c_3</span> <span class="o">=</span> <span class="n">c_2</span>
    <span class="k">return</span> <span class="n">c_3</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">bp_7</span><span class="p">):</span>
    <span class="n">b_8</span> <span class="o">=</span> <span class="n">bp_7</span>
    <span class="k">return</span> <span class="n">C</span><span class="p">(</span><span class="n">b_8</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">A</span><span class="p">(</span><span class="n">ap_12</span><span class="p">):</span>
    <span class="n">a_13</span> <span class="o">=</span> <span class="n">ap_12</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_13</span><span class="p">)</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">a_14</span>
    <span class="n">a_13</span> <span class="o">=</span> <span class="n">a_14</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_13</span><span class="p">)</span>
    <span class="n">a_14</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">a_14</span><span class="p">)[</span><span class="mi">3</span><span class="p">:]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Running <code>A()</code> with sufficient input.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="s1">'---xxx'</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">A</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">seq_vars</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(</span><span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ap_12@1:1 = '---xxx'
a_13@2:1 = '---xxx'
bp_7@1:1 = '---xxx'
b_8@2:1 = '---xxx'
cp_1@1:1 = '---xxx'
c_2@2:1 = '---xxx'
c_3@3:1 = '---xxx'
a_14@3:1 = '---xxx'
a_14@7:2 = 'xxx'

ap_12@1 = '---xxx'
a_13@2 = '---xxx'
bp_7@1 = '---xxx'
b_8@2 = '---xxx'
cp_1@1 = '---xxx'
c_2@2 = '---xxx'
c_3@3 = '---xxx'
a_14@3 = '---xxx'
a_14@7 = 'xxx'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As can be seen, the line numbers are now correctly identified for each variable.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us try retrieving the assignments for a real world example.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">inputstr</span> <span class="ow">in</span> <span class="n">URLS_X</span><span class="p">:</span>
    <span class="n">clear_cache</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
        <span class="n">urlparse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">))</span>

    <span class="n">tracker</span> <span class="o">=</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tracker</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@374 = 'http://user:pass@www.google.com:80/?q=path#ref'
url@492 = '//user:pass@www.google.com:80/?q=path#ref'
scheme@492 = 'http'
url@494 = '/?q=path#ref'
netloc@494 = 'user:pass@www.google.com:80'
url@502 = '/?q=path'
fragment@502 = 'ref'
query@504 = 'q=path'
url@395 = 'http://user:pass@www.google.com:80/?q=path#ref'

url@374 = 'https://www.cispa.saarland:80/'
url@492 = '//www.cispa.saarland:80/'
scheme@492 = 'https'
netloc@494 = 'www.cispa.saarland:80'
url@395 = 'https://www.cispa.saarland:80/'

url@374 = 'http://www.fuzzingbook.org/#News'
url@492 = '//www.fuzzingbook.org/#News'
scheme@492 = 'http'
url@494 = '/#News'
netloc@494 = 'www.fuzzingbook.org'
fragment@502 = 'News'
url@395 = 'http://www.fuzzingbook.org/#News'

url@374 = 'ftp://freebsd.org/releases/5.8'
url@492 = '//freebsd.org/releases/5.8'
scheme@492 = 'ftp'
url@494 = '/releases/5.8'
netloc@494 = 'freebsd.org'
url@395 = 'ftp://freebsd.org/releases/5.8'
url@396 = '/releases/5.8'
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The line numbers of variables can be verified from the source code of <a href="https://github.com/python/cpython/blob/3.6/Lib/urllib/parse.py">urllib/parse.py</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Recovering-a-Derivation-Tree">Recovering a Derivation Tree</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Does handling variable reassignments help with our URL examples? We look at these next.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">TreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_derivation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="p">[])])</span>
        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_new_definition</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-1:-Recovering-URL-Derivation-Tree">Example 1: Recovering URL Derivation Tree</h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>First we obtain the derivation tree of the URL 1</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h5 id="URL-1-derivation-tree">URL 1 derivation tree</h5></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">clear_cache</span><span class="p">()</span>
<span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">URLS_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">urlparse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">())</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="506pt" height="324pt" viewbox="0.00 0.00 505.88 323.75" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 319.75)">
<polygon fill="white" stroke="none" points="-4,4 -4,-319.75 501.88,-319.75 501.88,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="123.38" y="-302.45" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="123.38" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;url@374&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M123.38,-301.71C123.38,-295.49 123.38,-285.4 123.38,-276.64"/>
<polygon fill="black" stroke="black" points="126.88,-276.85 123.38,-266.85 119.88,-276.85 126.88,-276.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="45.38" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;scheme@492&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M113.5,-251.26C101.24,-243.68 80.07,-230.58 64.57,-221"/>
<polygon fill="black" stroke="black" points="66.56,-218.12 56.22,-215.83 62.88,-224.07 66.56,-218.12"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="123.38" y="-201.95" font-family="Times,serif" font-size="14.00">: (58)</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M123.38,-251.46C123.38,-245.24 123.38,-235.15 123.38,-226.39"/>
<polygon fill="black" stroke="black" points="126.88,-226.6 123.38,-216.6 119.88,-226.6 126.88,-226.6"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="188.38" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;url@492&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M131.61,-251.26C141.53,-243.9 158.45,-231.34 171.25,-221.84"/>
<polygon fill="black" stroke="black" points="173.25,-224.71 179.2,-215.94 169.08,-219.09 173.25,-224.71"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00">http</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M45.38,-201.21C45.38,-194.99 45.38,-184.9 45.38,-176.14"/>
<polygon fill="black" stroke="black" points="48.88,-176.35 45.38,-166.35 41.88,-176.35 48.88,-176.35"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="125.38" y="-151.7" font-family="Times,serif" font-size="14.00">//</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M180.4,-201.01C169.74,-192.86 150.75,-178.31 138.11,-168.63"/>
<polygon fill="black" stroke="black" points="140.27,-165.87 130.2,-162.57 136.01,-171.43 140.27,-165.87"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="188.38" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;netloc@494&gt;</text>
</g>
<!-- 5&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>5-&gt;7</title>
<path fill="none" stroke="black" d="M188.38,-201.21C188.38,-194.99 188.38,-184.9 188.38,-176.14"/>
<polygon fill="black" stroke="black" points="191.88,-176.35 188.38,-166.35 184.88,-176.35 191.88,-176.35"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="336.38" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;url@494&gt;</text>
</g>
<!-- 5&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>5-&gt;9</title>
<path fill="none" stroke="black" d="M207.12,-201.01C232.25,-192.82 277.14,-178.19 306.84,-168.5"/>
<polygon fill="black" stroke="black" points="307.92,-171.83 316.34,-165.41 305.75,-165.18 307.92,-171.83"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="159.38" y="-101.45" font-family="Times,serif" font-size="14.00">user:pass@www.google.com:80</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M184.82,-150.96C180.86,-144.37 174.31,-133.47 168.84,-124.37"/>
<polygon fill="black" stroke="black" points="171.89,-122.66 163.74,-115.89 165.89,-126.26 171.89,-122.66"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="297.38" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;url@502&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M331.59,-150.96C326.1,-144.16 316.87,-132.74 309.38,-123.48"/>
<polygon fill="black" stroke="black" points="312.16,-121.34 303.15,-115.77 306.71,-125.74 312.16,-121.34"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="364.38" y="-101.45" font-family="Times,serif" font-size="14.00"># (35)</text>
</g>
<!-- 9&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>9-&gt;14</title>
<path fill="none" stroke="black" d="M339.81,-150.96C343.63,-144.37 349.96,-133.47 355.24,-124.37"/>
<polygon fill="black" stroke="black" points="358.16,-126.3 360.15,-115.9 352.11,-122.79 358.16,-126.3"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="448.38" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;fragment@502&gt;</text>
</g>
<!-- 9&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>9-&gt;15</title>
<path fill="none" stroke="black" d="M350.56,-150.76C368.99,-142.82 401.46,-128.84 423.9,-119.17"/>
<polygon fill="black" stroke="black" points="425.12,-122.46 432.92,-115.29 422.35,-116.03 425.12,-122.46"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="265.38" y="-51.2" font-family="Times,serif" font-size="14.00">/?</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M293.45,-100.71C289.04,-94.05 281.69,-82.98 275.62,-73.82"/>
<polygon fill="black" stroke="black" points="278.61,-72 270.17,-65.6 272.78,-75.87 278.61,-72"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="328.38" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;query@504&gt;</text>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>10-&gt;12</title>
<path fill="none" stroke="black" d="M301.18,-100.71C305.45,-94.05 312.57,-82.98 318.45,-73.82"/>
<polygon fill="black" stroke="black" points="321.26,-75.92 323.72,-65.61 315.37,-72.13 321.26,-75.92"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="328.38" y="-0.95" font-family="Times,serif" font-size="14.00">q=path</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M328.38,-50.46C328.38,-44.24 328.38,-34.15 328.38,-25.39"/>
<polygon fill="black" stroke="black" points="331.88,-25.6 328.38,-15.6 324.88,-25.6 331.88,-25.6"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="448.38" y="-51.2" font-family="Times,serif" font-size="14.00">ref</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M448.38,-100.71C448.38,-94.49 448.38,-84.4 448.38,-75.64"/>
<polygon fill="black" stroke="black" points="451.88,-75.85 448.38,-65.85 444.88,-75.85 451.88,-75.85"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Next, we obtain the derivation tree of URL 4</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h5 id="URL-4-derivation-tree">URL 4 derivation tree</h5></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">clear_cache</span><span class="p">()</span>
<span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">URLS_X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">urlparse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">())</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="322pt" height="274pt" viewbox="0.00 0.00 322.12 273.50" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 269.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-269.5 318.12,-269.5 318.12,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="123.38" y="-252.2" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="123.38" y="-201.95" font-family="Times,serif" font-size="14.00">&lt;url@374&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M123.38,-251.46C123.38,-245.24 123.38,-235.15 123.38,-226.39"/>
<polygon fill="black" stroke="black" points="126.88,-226.6 123.38,-216.6 119.88,-226.6 126.88,-226.6"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="45.38" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;scheme@492&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M113.5,-201.01C101.24,-193.43 80.07,-180.33 64.57,-170.75"/>
<polygon fill="black" stroke="black" points="66.56,-167.87 56.22,-165.58 62.88,-173.82 66.56,-167.87"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="123.38" y="-151.7" font-family="Times,serif" font-size="14.00">: (58)</text>
</g>
<!-- 1&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>1-&gt;4</title>
<path fill="none" stroke="black" d="M123.38,-201.21C123.38,-194.99 123.38,-184.9 123.38,-176.14"/>
<polygon fill="black" stroke="black" points="126.88,-176.35 123.38,-166.35 119.88,-176.35 126.88,-176.35"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="188.38" y="-151.7" font-family="Times,serif" font-size="14.00">&lt;url@492&gt;</text>
</g>
<!-- 1&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>1-&gt;5</title>
<path fill="none" stroke="black" d="M131.61,-201.01C141.53,-193.65 158.45,-181.09 171.25,-171.59"/>
<polygon fill="black" stroke="black" points="173.25,-174.46 179.2,-165.69 169.08,-168.84 173.25,-174.46"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="45.38" y="-101.45" font-family="Times,serif" font-size="14.00">ftp</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M45.38,-150.96C45.38,-144.74 45.38,-134.65 45.38,-125.89"/>
<polygon fill="black" stroke="black" points="48.88,-126.1 45.38,-116.1 41.88,-126.1 48.88,-126.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="125.38" y="-101.45" font-family="Times,serif" font-size="14.00">//</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M180.4,-150.76C169.74,-142.61 150.75,-128.06 138.11,-118.38"/>
<polygon fill="black" stroke="black" points="140.27,-115.62 130.2,-112.32 136.01,-121.18 140.27,-115.62"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="188.38" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;netloc@494&gt;</text>
</g>
<!-- 5&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>5-&gt;7</title>
<path fill="none" stroke="black" d="M188.38,-150.96C188.38,-144.74 188.38,-134.65 188.38,-125.89"/>
<polygon fill="black" stroke="black" points="191.88,-126.1 188.38,-116.1 184.88,-126.1 191.88,-126.1"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="280.38" y="-101.45" font-family="Times,serif" font-size="14.00">&lt;url@494&gt;</text>
</g>
<!-- 5&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>5-&gt;9</title>
<path fill="none" stroke="black" d="M200.03,-150.76C214.75,-143.04 240.38,-129.6 258.74,-119.97"/>
<polygon fill="black" stroke="black" points="260.25,-123.13 267.48,-115.39 257,-116.93 260.25,-123.13"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="188.38" y="-51.2" font-family="Times,serif" font-size="14.00">freebsd.org</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M188.38,-100.71C188.38,-94.49 188.38,-84.4 188.38,-75.64"/>
<polygon fill="black" stroke="black" points="191.88,-75.85 188.38,-65.85 184.88,-75.85 191.88,-75.85"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="280.38" y="-51.2" font-family="Times,serif" font-size="14.00">&lt;url@396&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M280.38,-100.71C280.38,-94.49 280.38,-84.4 280.38,-75.64"/>
<polygon fill="black" stroke="black" points="283.88,-75.85 280.38,-65.85 276.88,-75.85 283.88,-75.85"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="280.38" y="-0.95" font-family="Times,serif" font-size="14.00">/releases/5.8</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10-&gt;11</title>
<path fill="none" stroke="black" d="M280.38,-50.46C280.38,-44.24 280.38,-34.15 280.38,-25.39"/>
<polygon fill="black" stroke="black" points="283.88,-25.6 280.38,-15.6 276.88,-25.6 283.88,-25.6"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The derivation trees seem to belong to the same grammar. Hence, we obtain the grammar for the complete set. First, we update the <code>recover_grammar()</code> to use <code>AssignTracker</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Recover-Grammar">Recover Grammar</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">GrammarMiner</span><span class="p">(</span><span class="n">GrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">update_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">):</span>
        <span class="n">at</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tracker</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tree_miner</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">at</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span>

    <span class="k">def</span> <span class="nf">create_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_tree_miner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Next, we use the modified <code>recover_grammar()</code> on derivation trees obtained from URLs.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">url_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">url_parse</span><span class="p">,</span> <span class="n">URLS_X</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The recovered grammar is below.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 199.5 62" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M159.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">url@374</text></g></g><path d="M139.5 31h20"/></g><path d="M 159.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@374
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 373.0 62" width="373.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M333.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M313.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M165.0 31h0.0"/><rect height="22" width="105.0" x="60.0" y="20"/><text x="112.5" y="35">scheme@492</text></g><path d="M165.0 31h10"/><path d="M175.0 31h10"/><g class="terminal">
<path d="M185.0 31h0.0"/><path d="M213.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="185.0" y="20"/><text x="199.25" y="35">:</text></g><path d="M213.5 31h10"/><path d="M223.5 31h10"/><g class="non-terminal">
<path d="M233.5 31h0.0"/><path d="M313.0 31h0.0"/><rect height="22" width="79.5" x="233.5" y="20"/><text x="273.25" y="35">url@492</text></g></g><path d="M313.0 31h20"/></g><path d="M 333.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>scheme@492
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 182.5 122" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M114.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="68.5" y="50"/><text x="91.25" y="65">ftp</text></g></g><path d="M122.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="80"/><text x="91.25" y="95">https</text></g></g><path d="M122.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@492
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 381.5 92" width="381.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M341.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M321.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">//</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M222.0 31h0.0"/><rect height="22" width="105.0" x="117.0" y="20"/><text x="169.5" y="35">netloc@494</text></g><path d="M222.0 31h10"/><path d="M232.0 31h10"/><g class="non-terminal">
<path d="M242.0 31h0.0"/><path d="M321.5 31h0.0"/><rect height="22" width="79.5" x="242.0" y="20"/><text x="281.75" y="35">url@494</text></g></g><path d="M321.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h25.5"/><path d="M296.0 61h25.5"/><g class="terminal">
<path d="M85.5 61h0.0"/><path d="M122.5 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="85.5" y="50"/><text x="104.0" y="65">//</text></g><path d="M122.5 61h10"/><path d="M132.5 61h10"/><g class="non-terminal">
<path d="M142.5 61h0.0"/><path d="M247.5 61h0.0"/><rect height="22" width="105.0" x="142.5" y="50"/><text x="195.0" y="65">netloc@494</text></g><path d="M247.5 61h10"/><path d="M257.5 61h10"/><g class="terminal">
<path d="M267.5 61h0.0"/><path d="M296.0 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="267.5" y="50"/><text x="281.75" y="65">/</text></g></g><path d="M321.5 61h20"/></g><path d="M 341.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>netloc@494
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="152" viewbox="0 0 369.5 152" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 81v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 91h0.0"/><path d="M329.5 91h0.0"/><path d="M40.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 91a10 10 0 0 0 10 -10v-40a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v40a10 10 0 0 0 10 10"/><path d="M40.0 91h20"/><g>
<path d="M60.0 91h68.0"/><path d="M241.5 91h68.0"/><g class="terminal">
<path d="M128.0 91h0.0"/><path d="M241.5 91h0.0"/><rect height="22" rx="10" ry="10" width="113.5" x="128.0" y="80"/><text x="184.75" y="95">freebsd.org</text></g></g><path d="M309.5 91h20"/><path d="M40.0 91a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><g class="terminal">
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="110"/><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g><path d="M309.5 121a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 91 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@494
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 390.0 122" width="390.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M350.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h95.25"/><path d="M234.75 31h95.25"/><g class="non-terminal">
<path d="M155.25 31h0.0"/><path d="M234.75 31h0.0"/><rect height="22" width="79.5" x="155.25" y="20"/><text x="195.0" y="35">url@396</text></g></g><path d="M330.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h45.5"/><path d="M284.5 61h45.5"/><g class="terminal">
<path d="M105.5 61h0.0"/><path d="M142.5 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="105.5" y="50"/><text x="124.0" y="65">/#</text></g><path d="M142.5 61h10"/><path d="M152.5 61h10"/><g class="non-terminal">
<path d="M162.5 61h0.0"/><path d="M284.5 61h0.0"/><rect height="22" width="122.0" x="162.5" y="50"/><text x="223.5" y="65">fragment@502</text></g></g><path d="M330.0 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M330.0 91h0.0"/><g class="non-terminal">
<path d="M60.0 91h0.0"/><path d="M139.5 91h0.0"/><rect height="22" width="79.5" x="60.0" y="80"/><text x="99.75" y="95">url@502</text></g><path d="M139.5 91h10"/><path d="M149.5 91h10"/><g class="terminal">
<path d="M159.5 91h0.0"/><path d="M188.0 91h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="159.5" y="80"/><text x="173.75" y="95">#</text></g><path d="M188.0 91h10"/><path d="M198.0 91h10"/><g class="non-terminal">
<path d="M208.0 91h0.0"/><path d="M330.0 91h0.0"/><rect height="22" width="122.0" x="208.0" y="80"/><text x="269.0" y="95">fragment@502</text></g></g><path d="M330.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 350.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@502
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 273.5 62" width="273.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M233.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M213.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">/?</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M213.5 31h0.0"/><rect height="22" width="96.5" x="117.0" y="20"/><text x="165.25" y="35">query@504</text></g></g><path d="M213.5 31h20"/></g><path d="M 233.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>query@504
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>fragment@502
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>url@396
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 250.5 62" width="250.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M210.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><rect height="22" rx="10" ry="10" width="130.5" x="60.0" y="20"/><text x="125.25" y="35">/releases/5.8</text></g></g><path d="M190.5 31h20"/></g><path d="M 210.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us fuzz a little to see if the produced values are sane.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>http://freebsd.org/
ftp://freebsd.org/releases/5.8
http://www.cispa.saarland:80/
ftp://freebsd.org/releases/5.8
https://user:pass@www.google.com:80/releases/5.8
https://freebsd.org/
ftp://www.cispa.saarland:80/?q=path#News
http://www.fuzzingbook.org/
https://www.cispa.saarland:80/
ftp://user:pass@www.google.com:80/
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our modifications do seem to help. Next, we check whether we can still retrieve the grammar for inventory.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-2:-Recovering-Inventory-Grammar">Example 2: Recovering Inventory Grammar</h4></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">inventory_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">process_vehicle</span><span class="p">,</span> <span class="n">VEHICLES</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">inventory_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 225.0 62" width="225.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M185.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M165.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M165.0 31h0.0"/><rect height="22" width="105.0" x="60.0" y="20"/><text x="112.5" y="35">vehicle@29</text></g></g><path d="M165.0 31h20"/></g><path d="M 185.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vehicle@29
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 677.5 62" width="677.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M637.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M617.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">year@30</text></g><path d="M139.5 31h10"/><path d="M149.5 31h10"/><g class="terminal">
<path d="M159.5 31h0.0"/><path d="M188.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="159.5" y="20"/><text x="173.75" y="35">,</text></g><path d="M188.0 31h10"/><path d="M198.0 31h10"/><g class="non-terminal">
<path d="M208.0 31h0.0"/><path d="M287.5 31h0.0"/><rect height="22" width="79.5" x="208.0" y="20"/><text x="247.75" y="35">kind@30</text></g><path d="M287.5 31h10"/><path d="M297.5 31h10"/><g class="terminal">
<path d="M307.5 31h0.0"/><path d="M336.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="307.5" y="20"/><text x="321.75" y="35">,</text></g><path d="M336.0 31h10"/><path d="M346.0 31h10"/><g class="non-terminal">
<path d="M356.0 31h0.0"/><path d="M461.0 31h0.0"/><rect height="22" width="105.0" x="356.0" y="20"/><text x="408.5" y="35">company@30</text></g><path d="M461.0 31h10"/><path d="M471.0 31h10"/><g class="terminal">
<path d="M481.0 31h0.0"/><path d="M509.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="481.0" y="20"/><text x="495.25" y="35">,</text></g><path d="M509.5 31h10"/><path d="M519.5 31h10"/><g class="non-terminal">
<path d="M529.5 31h0.0"/><path d="M617.5 31h0.0"/><rect height="22" width="88.0" x="529.5" y="20"/><text x="573.5" y="35">model@30</text></g></g><path d="M617.5 31h20"/></g><path d="M 637.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>year@30
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 174.0 122" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M114.0 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M114.0 91h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="80"/><text x="87.0" y="95">1997</text></g></g><path d="M114.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>kind@30
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>company@30
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 199.5 122" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h12.75"/><path d="M126.75 91h12.75"/><g class="terminal">
<path d="M72.75 91h0.0"/><path d="M126.75 91h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="72.75" y="80"/><text x="99.75" y="95">Ford</text></g></g><path d="M139.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model@30
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 199.5 122" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h12.75"/><path d="M126.75 31h12.75"/><g class="terminal">
<path d="M72.75 31h0.0"/><path d="M126.75 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="72.75" y="20"/><text x="99.75" y="35">E350</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M135.25 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M135.25 61h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="50"/><text x="99.75" y="65">Cougar</text></g></g><path d="M139.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M139.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M139.5 91h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="80"/><text x="99.75" y="95">Venture</text></g></g><path d="M139.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using fuzzing to produce values from the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">inventory_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1997,van,Chevy,E350
1999,van,Mercury,E350
2000,van,Chevy,Venture
2000,van,Ford,E350
1997,van,Mercury,Cougar
1997,car,Ford,E350
1997,car,Mercury,Venture
1997,car,Mercury,E350
2000,van,Mercury,Cougar
1997,car,Chevy,Venture
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Problems-with-the-Grammar-Miner-with-Reassignment">Problems with the Grammar Miner with Reassignment</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One of the problems with our grammar miner is that it doesn't yet account for the current context. That is, when replacing, a variable can replace tokens that it does not have access to (and hence, it is not a fragment of). Consider this example.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">INVENTORY</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_inventory</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">AssignmentTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">())</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="n">lr_graph</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="508pt" height="598pt" viewbox="0.00 0.00 508.25 598.25" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 594.25)">
<polygon fill="white" stroke="none" points="-4,4 -4,-594.25 504.25,-594.25 504.25,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="19.88" y="-256.95" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="123" y="-256.95" font-family="Times,serif" font-size="14.00">&lt;inventory@22&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M39.42,-263.12C46.64,-263.12 55.33,-263.12 64.33,-263.12"/>
<polygon fill="black" stroke="black" points="64.3,-266.63 74.3,-263.13 64.3,-259.63 64.3,-266.63"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="247.12" y="-464.95" font-family="Times,serif" font-size="14.00">&lt;vehicle@24&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M128.06,-270.05C145.12,-299.1 211.24,-411.71 236.36,-454.5"/>
<polygon fill="black" stroke="black" points="233.32,-456.23 241.4,-463.08 239.36,-452.69 233.32,-456.23"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="247.12" y="-288.95" font-family="Times,serif" font-size="14.00">\n (10)</text>
</g>
<!-- 1&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>1-&gt;14</title>
<path fill="none" stroke="black" d="M151.1,-270.23C170.96,-275.43 197.84,-282.47 217.94,-287.74"/>
<polygon fill="black" stroke="black" points="216.87,-291.08 227.43,-290.23 218.64,-284.3 216.87,-291.08"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="247.12" y="-256.95" font-family="Times,serif" font-size="14.00">&lt;vehicle@24&gt;</text>
</g>
<!-- 1&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>1-&gt;15</title>
<path fill="none" stroke="black" d="M170.17,-263.12C178.25,-263.12 186.7,-263.12 194.91,-263.12"/>
<polygon fill="black" stroke="black" points="194.77,-266.63 204.77,-263.13 194.77,-259.63 194.77,-266.63"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="middle" x="247.12" y="-224.95" font-family="Times,serif" font-size="14.00">\n (10)</text>
</g>
<!-- 1&#45;&gt;27 -->
<g id="edge27" class="edge">
<title>1-&gt;27</title>
<path fill="none" stroke="black" d="M151.1,-256.02C170.96,-250.82 197.84,-243.78 217.94,-238.51"/>
<polygon fill="black" stroke="black" points="218.64,-241.95 227.43,-236.02 216.87,-235.17 218.64,-241.95"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="middle" x="247.12" y="-80.95" font-family="Times,serif" font-size="14.00">&lt;vehicle@24&gt;</text>
</g>
<!-- 1&#45;&gt;28 -->
<g id="edge28" class="edge">
<title>1-&gt;28</title>
<path fill="none" stroke="black" d="M128.94,-256.01C146.89,-230.14 208.98,-140.66 234.76,-103.5"/>
<polygon fill="black" stroke="black" points="237.57,-105.59 240.4,-95.38 231.82,-101.6 237.57,-105.59"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="370.5" y="-576.95" font-family="Times,serif" font-size="14.00">&lt;year@30&gt;</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M251.74,-478.02C261.22,-495.48 288.56,-541.82 324,-567.12 326.18,-568.69 328.54,-570.11 330.98,-571.4"/>
<polygon fill="black" stroke="black" points="329.39,-574.52 339.95,-575.39 332.23,-568.12 329.39,-574.52"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="370.5" y="-544.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 2&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>2-&gt;5</title>
<path fill="none" stroke="black" d="M254.59,-478.05C266.96,-490.91 295.28,-518.7 324,-535.12 330.5,-538.84 338.02,-541.92 345.05,-544.34"/>
<polygon fill="black" stroke="black" points="343.77,-547.61 354.36,-547.26 345.87,-540.93 343.77,-547.61"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="370.5" y="-512.95" font-family="Times,serif" font-size="14.00">&lt;kind@30&gt;</text>
</g>
<!-- 2&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>2-&gt;6</title>
<path fill="none" stroke="black" d="M264,-478.15C279.27,-484.83 303.06,-495.04 324,-503.12 328.48,-504.86 333.24,-506.62 337.93,-508.3"/>
<polygon fill="black" stroke="black" points="336.54,-511.53 347.14,-511.56 338.87,-504.93 336.54,-511.53"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="370.5" y="-480.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 2&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>2-&gt;8</title>
<path fill="none" stroke="black" d="M287.87,-476.36C306.49,-478.82 328.11,-481.67 344.42,-483.82"/>
<polygon fill="black" stroke="black" points="343.85,-487.27 354.22,-485.11 344.76,-480.33 343.85,-487.27"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="370.5" y="-448.95" font-family="Times,serif" font-size="14.00">&lt;company@30&gt;</text>
</g>
<!-- 2&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>2-&gt;9</title>
<path fill="none" stroke="black" d="M287.87,-465.89C295.85,-464.83 304.39,-463.71 312.82,-462.6"/>
<polygon fill="black" stroke="black" points="313.24,-466.07 322.7,-461.29 312.32,-459.13 313.24,-466.07"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="370.5" y="-416.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 2&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>2-&gt;11</title>
<path fill="none" stroke="black" d="M264,-464.1C279.27,-457.42 303.06,-447.21 324,-439.12 330.81,-436.5 338.25,-433.8 345.11,-431.39"/>
<polygon fill="black" stroke="black" points="346.14,-434.74 354.45,-428.17 343.86,-428.12 346.14,-434.74"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="370.5" y="-384.95" font-family="Times,serif" font-size="14.00">&lt;model@30&gt;</text>
</g>
<!-- 2&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>2-&gt;12</title>
<path fill="none" stroke="black" d="M254.59,-464.2C266.96,-451.34 295.28,-423.55 324,-407.12 327.03,-405.39 330.28,-403.8 333.59,-402.35"/>
<polygon fill="black" stroke="black" points="334.78,-405.64 342.82,-398.74 332.23,-399.13 334.78,-405.64"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="476.62" y="-576.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M403.31,-583.12C418.94,-583.12 437.46,-583.12 451.85,-583.12"/>
<polygon fill="black" stroke="black" points="451.74,-586.63 461.74,-583.13 451.74,-579.63 451.74,-586.63"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="476.62" y="-512.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6-&gt;7</title>
<path fill="none" stroke="black" d="M403.59,-519.12C420.6,-519.12 440.96,-519.12 455.69,-519.12"/>
<polygon fill="black" stroke="black" points="455.44,-522.63 465.44,-519.13 455.44,-515.63 455.44,-522.63"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="476.62" y="-448.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9-&gt;10</title>
<path fill="none" stroke="black" d="M416.87,-455.12C429.18,-455.12 442,-455.12 452.51,-455.12"/>
<polygon fill="black" stroke="black" points="452.49,-458.63 462.49,-455.13 452.49,-451.63 452.49,-458.63"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="476.62" y="-384.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12-&gt;13</title>
<path fill="none" stroke="black" d="M409.09,-391.12C423.07,-391.12 438.57,-391.12 451.08,-391.12"/>
<polygon fill="black" stroke="black" points="450.92,-394.63 460.92,-391.13 450.92,-387.63 450.92,-394.63"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="370.5" y="-352.95" font-family="Times,serif" font-size="14.00">&lt;year@30&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M273.22,-270.19C278.49,-272.46 283.74,-275.39 288,-279.12 312.54,-300.64 299,-322.14 324,-343.12 325.68,-344.54 327.5,-345.83 329.41,-347.01"/>
<polygon fill="black" stroke="black" points="327.59,-350.02 338.1,-351.35 330.72,-343.75 327.59,-350.02"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="370.5" y="-320.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 15&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>15-&gt;18</title>
<path fill="none" stroke="black" d="M269.48,-270.13C275.67,-272.57 282.29,-275.59 288,-279.12 306.2,-290.39 305.56,-300.26 324,-311.12 330.46,-314.93 337.96,-318.03 344.99,-320.45"/>
<polygon fill="black" stroke="black" points="343.72,-323.72 354.31,-323.35 345.8,-317.04 343.72,-323.72"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="370.5" y="-288.95" font-family="Times,serif" font-size="14.00">&lt;kind@30&gt;</text>
</g>
<!-- 15&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>15-&gt;19</title>
<path fill="none" stroke="black" d="M275.06,-270.23C291.72,-274.62 313.35,-280.32 331.71,-285.16"/>
<polygon fill="black" stroke="black" points="330.61,-288.49 341.17,-287.66 332.4,-281.72 330.61,-288.49"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="370.5" y="-256.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 15&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>15-&gt;21</title>
<path fill="none" stroke="black" d="M287.87,-263.12C306.49,-263.12 328.11,-263.12 344.42,-263.12"/>
<polygon fill="black" stroke="black" points="344.21,-266.63 354.21,-263.13 344.21,-259.63 344.21,-266.63"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="370.5" y="-224.95" font-family="Times,serif" font-size="14.00">&lt;company@30&gt;</text>
</g>
<!-- 15&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>15-&gt;22</title>
<path fill="none" stroke="black" d="M275.06,-256.02C291.72,-251.63 313.35,-245.93 331.71,-241.09"/>
<polygon fill="black" stroke="black" points="332.4,-244.53 341.17,-238.59 330.61,-237.76 332.4,-244.53"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="370.5" y="-192.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 15&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>15-&gt;24</title>
<path fill="none" stroke="black" d="M269.48,-256.12C275.67,-253.68 282.29,-250.66 288,-247.12 306.2,-235.86 305.56,-225.99 324,-215.12 330.46,-211.32 337.96,-208.22 344.99,-205.8"/>
<polygon fill="black" stroke="black" points="345.8,-209.21 354.31,-202.9 343.72,-202.53 345.8,-209.21"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="370.5" y="-160.95" font-family="Times,serif" font-size="14.00">&lt;model@30&gt;</text>
</g>
<!-- 15&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>15-&gt;25</title>
<path fill="none" stroke="black" d="M273.22,-256.06C278.49,-253.79 283.74,-250.86 288,-247.12 312.54,-225.61 299,-204.11 324,-183.12 325.68,-181.71 327.5,-180.42 329.41,-179.24"/>
<polygon fill="black" stroke="black" points="330.72,-182.5 338.1,-174.9 327.59,-176.23 330.72,-182.5"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="476.62" y="-352.95" font-family="Times,serif" font-size="14.00">2000</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M403.31,-359.12C418.94,-359.12 437.46,-359.12 451.85,-359.12"/>
<polygon fill="black" stroke="black" points="451.74,-362.63 461.74,-359.13 451.74,-355.63 451.74,-362.63"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="476.62" y="-288.95" font-family="Times,serif" font-size="14.00">car</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M403.59,-295.12C421.34,-295.12 442.73,-295.12 457.57,-295.12"/>
<polygon fill="black" stroke="black" points="457.16,-298.63 467.16,-295.13 457.16,-291.63 457.16,-298.63"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="476.62" y="-224.95" font-family="Times,serif" font-size="14.00">Mercury</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22-&gt;23</title>
<path fill="none" stroke="black" d="M416.87,-231.12C425.24,-231.12 433.84,-231.12 441.8,-231.12"/>
<polygon fill="black" stroke="black" points="441.74,-234.63 451.74,-231.13 441.74,-227.63 441.74,-234.63"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="476.62" y="-160.95" font-family="Times,serif" font-size="14.00">Cougar</text>
</g>
<!-- 25&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>25-&gt;26</title>
<path fill="none" stroke="black" d="M409.09,-167.12C420.98,-167.12 433.97,-167.12 445.29,-167.12"/>
<polygon fill="black" stroke="black" points="445.27,-170.63 455.27,-167.13 445.27,-163.63 445.27,-170.63"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="370.5" y="-128.95" font-family="Times,serif" font-size="14.00">&lt;year@30&gt;</text>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge29" class="edge">
<title>28-&gt;29</title>
<path fill="none" stroke="black" d="M264,-94.15C279.27,-100.83 303.06,-111.04 324,-119.12 328.48,-120.86 333.24,-122.62 337.93,-124.3"/>
<polygon fill="black" stroke="black" points="336.54,-127.53 347.14,-127.56 338.87,-120.93 336.54,-127.53"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="middle" x="370.5" y="-96.95" font-family="Times,serif" font-size="14.00">,car,</text>
</g>
<!-- 28&#45;&gt;31 -->
<g id="edge31" class="edge">
<title>28-&gt;31</title>
<path fill="none" stroke="black" d="M287.87,-92.36C307.81,-94.99 331.2,-98.08 347.81,-100.27"/>
<polygon fill="black" stroke="black" points="347.16,-103.71 357.53,-101.55 348.07,-96.77 347.16,-103.71"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="middle" x="370.5" y="-64.95" font-family="Times,serif" font-size="14.00">&lt;company@30&gt;</text>
</g>
<!-- 28&#45;&gt;32 -->
<g id="edge32" class="edge">
<title>28-&gt;32</title>
<path fill="none" stroke="black" d="M287.87,-81.89C295.85,-80.83 304.39,-79.71 312.82,-78.6"/>
<polygon fill="black" stroke="black" points="313.24,-82.07 322.7,-77.29 312.32,-75.13 313.24,-82.07"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="middle" x="370.5" y="-32.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 28&#45;&gt;34 -->
<g id="edge34" class="edge">
<title>28-&gt;34</title>
<path fill="none" stroke="black" d="M264,-80.1C279.27,-73.42 303.06,-63.21 324,-55.12 330.81,-52.5 338.25,-49.8 345.11,-47.39"/>
<polygon fill="black" stroke="black" points="346.14,-50.74 354.45,-44.17 343.86,-44.12 346.14,-50.74"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="370.5" y="-0.95" font-family="Times,serif" font-size="14.00">&lt;model@30&gt;</text>
</g>
<!-- 28&#45;&gt;35 -->
<g id="edge35" class="edge">
<title>28-&gt;35</title>
<path fill="none" stroke="black" d="M254.59,-80.2C266.96,-67.34 295.28,-39.55 324,-23.12 327.03,-21.39 330.28,-19.8 333.59,-18.35"/>
<polygon fill="black" stroke="black" points="334.78,-21.64 342.82,-14.74 332.23,-15.13 334.78,-21.64"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="middle" x="476.62" y="-128.95" font-family="Times,serif" font-size="14.00">1999</text>
</g>
<!-- 29&#45;&gt;30 -->
<g id="edge30" class="edge">
<title>29-&gt;30</title>
<path fill="none" stroke="black" d="M403.31,-135.12C418.94,-135.12 437.46,-135.12 451.85,-135.12"/>
<polygon fill="black" stroke="black" points="451.74,-138.63 461.74,-135.13 451.74,-131.63 451.74,-138.63"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="middle" x="476.62" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text>
</g>
<!-- 32&#45;&gt;33 -->
<g id="edge33" class="edge">
<title>32-&gt;33</title>
<path fill="none" stroke="black" d="M416.87,-71.12C427.5,-71.12 438.52,-71.12 448.1,-71.12"/>
<polygon fill="black" stroke="black" points="447.81,-74.63 457.81,-71.13 447.81,-67.63 447.81,-74.63"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="middle" x="476.62" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text>
</g>
<!-- 35&#45;&gt;36 -->
<g id="edge36" class="edge">
<title>35-&gt;36</title>
<path fill="none" stroke="black" d="M409.09,-7.12C420.64,-7.12 433.22,-7.12 444.31,-7.12"/>
<polygon fill="black" stroke="black" points="444.11,-10.63 454.11,-7.13 444.11,-3.63 444.11,-10.63"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As can be seen, the derivation tree obtained is not quite what we expected. The issue is easily seen if we enable logging in the <code>TreeMiner</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">dt</span> <span class="o">=</span> <span class="n">TreeMiner</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(),</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> inventory@22='1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture'
	 - Node: &lt;start&gt;		? (&lt;inventory@22&gt;:'1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture')
		 -&gt; [0] '1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture'
		  &gt; ['&lt;inventory@22&gt;']
 vehicle@24='1997,van,Ford,E350'
	 - Node: &lt;start&gt;		? (&lt;vehicle@24&gt;:'1997,van,Ford,E350')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;vehicle@24&gt;:'1997,van,Ford,E350')
		 -&gt; [0] '1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture'
		  &gt; ['&lt;vehicle@24&gt;', '\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture']
 year@30='1997'
	 - Node: &lt;start&gt;		? (&lt;year@30&gt;:'1997')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;year@30&gt;:'1997')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'1997')
		 -&gt; [0] '1997,van,Ford,E350'
		  &gt; ['&lt;year@30&gt;', ',van,Ford,E350']
 kind@30='van'
	 - Node: &lt;start&gt;		? (&lt;kind@30&gt;:'van')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;kind@30&gt;:'van')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;kind@30&gt;:'van')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;kind@30&gt;:'van')
		 -&gt; [0] '1997'
		 -&gt; [1] ',van,Ford,E350'
		  &gt; [',', '&lt;kind@30&gt;', ',Ford,E350']
 company@30='Ford'
	 - Node: &lt;start&gt;		? (&lt;company@30&gt;:'Ford')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;company@30&gt;:'Ford')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Ford')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Ford')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;company@30&gt;:'Ford')
		 -&gt; [0] 'van'
		 -&gt; [3] ',Ford,E350'
		  &gt; [',', '&lt;company@30&gt;', ',E350']
 model@30='E350'
	 - Node: &lt;start&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'E350')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ',E350'
		  &gt; [',', '&lt;model@30&gt;']
 vehicle@24='2000,car,Mercury,Cougar'
	 - Node: &lt;start&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;vehicle@24&gt;:'2000,car,Mercury,Cougar')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture'
		  &gt; ['\n', '&lt;vehicle@24&gt;', '\n1999,car,Chevy,Venture']
 year@30='2000'
	 - Node: &lt;start&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'2000')
		 -&gt; [0] '2000,car,Mercury,Cougar'
		  &gt; ['&lt;year@30&gt;', ',car,Mercury,Cougar']
 kind@30='car'
	 - Node: &lt;start&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;kind@30&gt;:'car')
		 -&gt; [0] '2000'
		 -&gt; [1] ',car,Mercury,Cougar'
		  &gt; [',', '&lt;kind@30&gt;', ',Mercury,Cougar']
 company@30='Mercury'
	 - Node: &lt;start&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;company@30&gt;:'Mercury')
		 -&gt; [0] 'car'
		 -&gt; [3] ',Mercury,Cougar'
		  &gt; [',', '&lt;company@30&gt;', ',Cougar']
 model@30='Cougar'
	 - Node: &lt;start&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] 'car'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'Cougar')
		 -&gt; [0] 'Mercury'
		 -&gt; [5] ',Cougar'
		  &gt; [',', '&lt;model@30&gt;']
 vehicle@24='1999,car,Chevy,Venture'
	 - Node: &lt;start&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'car'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'Mercury'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;vehicle@24&gt;:'1999,car,Chevy,Venture')
		 -&gt; [0] 'Cougar'
		 -&gt; [3] '\n1999,car,Chevy,Venture'
		  &gt; ['\n', '&lt;vehicle@24&gt;']
 year@30='1999'
	 - Node: &lt;start&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'car'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'Mercury'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] 'Cougar'
		 -&gt; [3] '\n'
		 -&gt; [4] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;year@30&gt;:'1999')
		 -&gt; [0] '1999,car,Chevy,Venture'
		  &gt; ['&lt;year@30&gt;', ',car,Chevy,Venture']
 company@30='Chevy'
	 - Node: &lt;start&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'car'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'Mercury'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] 'Cougar'
		 -&gt; [3] '\n'
		 -&gt; [4] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;company@30&gt;:'Chevy')
		 -&gt; [0] '1999'
		 -&gt; [1] ',car,Chevy,Venture'
		  &gt; [',car,', '&lt;company@30&gt;', ',Venture']
 model@30='Venture'
	 - Node: &lt;start&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '&lt;inventory@22&gt;'
	 - Node: &lt;inventory@22&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '1997'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'van'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'Ford'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'E350'
		 -&gt; [1] '\n'
		 -&gt; [2] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '2000'
		 -&gt; [1] ','
		 -&gt; [2] '&lt;kind@30&gt;'
	 - Node: &lt;kind@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'car'
		 -&gt; [3] ','
		 -&gt; [4] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'Mercury'
		 -&gt; [5] ','
		 -&gt; [6] '&lt;model@30&gt;'
	 - Node: &lt;model@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'Cougar'
		 -&gt; [3] '\n'
		 -&gt; [4] '&lt;vehicle@24&gt;'
	 - Node: &lt;vehicle@24&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '&lt;year@30&gt;'
	 - Node: &lt;year@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] '1999'
		 -&gt; [1] ',car,'
		 -&gt; [2] '&lt;company@30&gt;'
	 - Node: &lt;company@30&gt;		? (&lt;model@30&gt;:'Venture')
		 -&gt; [0] 'Chevy'
		 -&gt; [3] ',Venture'
		  &gt; [',', '&lt;model@30&gt;']
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Look at the last statement. We have a value <code>1999,car,</code> where only the <code>year</code> got replaced. We no longer have a <code>'car'</code> variable to continue the replacement here. This happens because the <code>'car'</code> value in <code>'1999,car,Chevy,Venture'</code> is not treated as a new value because the value <code>'car'</code> had occurred for <code>'vehicle'</code> variable in the exact same location for a <em>different</em> method call (for <code>'2000,car,Mercury,Cougar'</code>).</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Grammar-Miner-with-Scope">A Grammar Miner with Scope</h2><p>We need to incorporate inspection of the variables in the current context. We already have a stack of method calls so that we can obtain the current method at any point. We need to do the same for variables.</p>
<p>For that, we extend the <code>CallStack</code> to a new class <code>InputStack</code> which holds the method invoked as well as the parameters observed. It is essentially the record of activation of the method. We start with the original input at the base of the stack, and for each new method-call, we push the parameters of that call into the stack as a new record.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Input-Stack">Input Stack</h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">CallStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment_len</span><span class="o">=</span><span class="n">FRAGMENT_LEN</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[{</span><span class="n">START_SYMBOL</span><span class="p">:</span> <span class="n">i</span><span class="p">}]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fragment_len</span> <span class="o">=</span> <span class="n">fragment_len</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In order to check if a particular variable be saved, we define <code>in_current_record()</code> which checks only the variables in the current scope for inclusion (rather than the original input string).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">InputStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">in_current_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span> <span class="o">=</span> <span class="n">InputStack</span><span class="p">(</span><span class="s1">'hello my world'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">in_current_record</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">in_current_record</span><span class="p">(</span><span class="s1">'bye'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'greeting'</span><span class="p">:</span> <span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'location'</span><span class="p">:</span> <span class="s1">'world'</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">in_current_record</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">in_current_record</span><span class="p">(</span><span class="s1">'my'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define the method <code>ignored()</code> that returns true if either the variable is not a string, or the variable length is less than the defined <code>fragment_len</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">InputStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">ignored</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_len</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span> <span class="o">=</span> <span class="n">InputStack</span><span class="p">(</span><span class="s1">'hello world'</span><span class="p">)</span>
<span class="n">my_istack</span><span class="o">.</span><span class="n">ignored</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">ignored</span><span class="p">(</span><span class="s1">'a'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">my_istack</span><span class="o">.</span><span class="n">ignored</span><span class="p">(</span><span class="s1">'help'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now define the <code>in_scope()</code> method that checks whether the variable needs to be ignored, and if it is not to be ignored, whether the variable value is present in the current scope.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">InputStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">in_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignored</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_current_record</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Finally, we update <code>enter()</code> that pushes relevant variables in the current context to the stack.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">InputStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">my_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_scope</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_inputs</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When a method returns, we also need a corresponding <code>leave()</code> to pop out the inputs and unwind the stack.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">InputStack</span><span class="p">(</span><span class="n">InputStack</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">leave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">leave</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="ScopedVars">ScopedVars</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We need to update our <code>AssignmentVars</code> to include information about which scope the variable was defined in. We start by updating <code>method_init()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">AssignmentVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_call_stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">def</span> <span class="nf">create_call_stack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">InputStack</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Similarly, the <code>method_enter()</code> now initializes the <code>accessed_seq_var</code> for the current method call.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">method_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cxt</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="s1">'call'</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">cxt</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">my_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_locations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_event</span><span class="p">(</span><span class="n">cxt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_vars</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>update()</code> method now saves the context in which the value is defined. In the case of a parameter to a function, the context should be the context in which the function was called. On the other hand, a value defined during a statement execution would have the current context.</p>
<p>Further, we annotate on value rather than key because we do not want to duplicate variables when parameters are in context in the next line. They will have same value, but different context because they are present in a statement execution.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">==</span> <span class="s1">'call'</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">==</span> <span class="s1">'line'</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_kv</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">context</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_location_register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We also need to save the current method invocation to determine which variables are in scope. This information is now incorporated in the variable name as <code>accessed_seq_var[method_id][var]</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">][</span><span class="n">var</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As before, <code>var_access</code> simply initializes the corresponding counter, this time in the context of <code>method_id</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>During a variable reassignment, we update the <code>accessed_seq_var</code> to reflect the new count.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">var_assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accessed_seq_var</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">method_id</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_name</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now update <code>defined_vars()</code> to account for the new information.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">defined_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">method</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">[</span><span class="si">%d</span><span class="s2">]:</span><span class="si">%s</span><span class="s2">@</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">v</span> <span class="k">if</span> <span class="n">formatted</span> <span class="k">else</span> <span class="n">v</span>

        <span class="k">return</span> <span class="p">[(</span><span class="n">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Updating <code>seq_vars()</code> to account for new information.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedVars</span><span class="p">(</span><span class="n">ScopedVars</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">seq_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">method</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_def_lines</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">return</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">[</span><span class="si">%d</span><span class="s2">]:</span><span class="si">%s</span><span class="s2">@</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">v</span> <span class="k">if</span> <span class="n">formatted</span> <span class="k">else</span> <span class="n">v</span>

        <span class="k">return</span> <span class="p">{</span><span class="n">fmt</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Scope-Tracker">Scope Tracker</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With the <code>InputStack</code> and <code>Vars</code> defined, we can now define the <code>ScopeTracker</code>. The <code>ScopeTracker</code> only saves variables if the value is present in the current scope.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTracker</span><span class="p">(</span><span class="n">AssignmentTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_input</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_event</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">my_input</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_assignments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ScopedVars</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define a wrapper for checking whether a variable is present in the scope.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTracker</span><span class="p">(</span><span class="n">ScopeTracker</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">is_input_fragment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">call_stack</span><span class="o">.</span><span class="n">in_scope</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can use the <code>ScopeTracker</code> as follows.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">vehicle_traces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">INVENTORY</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_inventory</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">ScopeTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="n">vehicle_traces</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">sm</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">seq_vars</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory[1]:inventory@22:1 = ('1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture', ('&lt;start&gt;', 0))
process_inventory[1]:inventory@22:2 = ('1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture', ('process_inventory', 1))
process_inventory[1]:vehicle@24:1 = ('1997,van,Ford,E350', ('process_inventory', 1))
process_vehicle[2]:vehicle@29:1 = ('1997,van,Ford,E350', ('process_inventory', 1))
process_vehicle[2]:vehicle@29:2 = ('1997,van,Ford,E350', ('process_vehicle', 2))
process_vehicle[2]:year@30:1 = ('1997', ('process_vehicle', 2))
process_vehicle[2]:kind@30:1 = ('van', ('process_vehicle', 2))
process_vehicle[2]:company@30:1 = ('Ford', ('process_vehicle', 2))
process_vehicle[2]:model@30:1 = ('E350', ('process_vehicle', 2))
process_van[3]:year@40:1 = ('1997', ('process_vehicle', 2))
process_van[3]:company@40:1 = ('Ford', ('process_vehicle', 2))
process_van[3]:model@40:1 = ('E350', ('process_vehicle', 2))
process_van[3]:year@40:2 = ('1997', ('process_van', 3))
process_van[3]:company@40:2 = ('Ford', ('process_van', 3))
process_van[3]:model@40:2 = ('E350', ('process_van', 3))
process_inventory[1]:vehicle@24:2 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))
process_vehicle[4]:vehicle@29:1 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))
process_vehicle[4]:vehicle@29:2 = ('2000,car,Mercury,Cougar', ('process_vehicle', 4))
process_vehicle[4]:year@30:1 = ('2000', ('process_vehicle', 4))
process_vehicle[4]:kind@30:1 = ('car', ('process_vehicle', 4))
process_vehicle[4]:company@30:1 = ('Mercury', ('process_vehicle', 4))
process_vehicle[4]:model@30:1 = ('Cougar', ('process_vehicle', 4))
process_car[5]:year@49:1 = ('2000', ('process_vehicle', 4))
process_car[5]:company@49:1 = ('Mercury', ('process_vehicle', 4))
process_car[5]:model@49:1 = ('Cougar', ('process_vehicle', 4))
process_car[5]:year@49:2 = ('2000', ('process_car', 5))
process_car[5]:company@49:2 = ('Mercury', ('process_car', 5))
process_car[5]:model@49:2 = ('Cougar', ('process_car', 5))
process_inventory[1]:vehicle@24:3 = ('1999,car,Chevy,Venture', ('process_inventory', 1))
process_vehicle[6]:vehicle@29:1 = ('1999,car,Chevy,Venture', ('process_inventory', 1))
process_vehicle[6]:vehicle@29:2 = ('1999,car,Chevy,Venture', ('process_vehicle', 6))
process_vehicle[6]:year@30:1 = ('1999', ('process_vehicle', 6))
process_vehicle[6]:kind@30:1 = ('car', ('process_vehicle', 6))
process_vehicle[6]:company@30:1 = ('Chevy', ('process_vehicle', 6))
process_vehicle[6]:model@30:1 = ('Venture', ('process_vehicle', 6))
process_car[7]:year@49:1 = ('1999', ('process_vehicle', 6))
process_car[7]:company@49:1 = ('Chevy', ('process_vehicle', 6))
process_car[7]:model@49:1 = ('Venture', ('process_vehicle', 6))
process_car[7]:year@49:2 = ('1999', ('process_car', 7))
process_car[7]:company@49:2 = ('Chevy', ('process_car', 7))
process_car[7]:model@49:2 = ('Venture', ('process_car', 7))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Recovering-a-Derivation-Tree">Recovering a Derivation Tree</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The main difference in <code>apply_new_definition()</code> is that we add a second condition that checks for scope. In particular, variables are only allowed to replace portions of string fragments that were in scope.
The variable scope is indicated by <code>scope</code>. However, merely accounting for scope is not sufficient. For example, consider the fragment below.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="highlight"><pre><span/><span class="k">def</span> <span class="nf">my_fn</span><span class="p">(</span><span class="n">stringval</span><span class="p">):</span>
    <span class="n">partA</span><span class="p">,</span> <span class="n">partB</span> <span class="o">=</span> <span class="n">stringval</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">partA</span><span class="p">,</span> <span class="n">partB</span>

<span class="n">svalue</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">my_fn</span><span class="p">(</span><span class="n">svalue</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here, <code>v1</code> and <code>v2</code> get their values from a previous function call. Not from their current context. That is, we have to provide an exception for cases where an internal child method call may have generated a large fragment as we showed above. To account for that, we define <code>mseq()</code> that retrieves the method call sequence. In the above case, the <code>mseq()</code> of the internal child method call would be larger than the current <code>mseq()</code>. If so, we allow the replacement to proceed.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTreeMiner</span><span class="p">(</span><span class="n">TreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">mseq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">method</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">lno</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">return</span> <span class="n">seq</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>nt_var()</code> method needs to take the tuple and generate a non-terminal symbol out of it. We skip the method sequence because it is not relevant for the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTreeMiner</span><span class="p">(</span><span class="n">ScopeTreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">nt_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">method</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">lno</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">return</span> <span class="n">to_nonterminal</span><span class="p">(</span><span class="s2">"</span><span class="si">%s</span><span class="s2">@</span><span class="si">%d</span><span class="s2">:</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">lno</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now redefine the <code>apply_new_definition()</code> to account for context and scope. In particular, a variable is allowed to replace a part of a value only if the variable is in <em>scope</em> -- that is, it's scope (method sequence number of either its calling context in case it is a parameter or the current context in case it is a statement) is same as that of the value's method sequence number. An exception is made when the value's method sequence number is greater than the variable's method sequence number. In that case, the value may have come from an internal call. We allow the replacement to proceed in that case.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTreeMiner</span><span class="p">(</span><span class="n">ScopeTreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">partition_by_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pair</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="p">(</span><span class="n">nt_var</span><span class="p">,</span> <span class="n">nt_seq</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v_scope</span><span class="p">)</span> <span class="o">=</span> <span class="n">pair</span>
        <span class="n">prefix_k_suffix</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">nt_var</span><span class="p">,</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span> <span class="p">[],</span> <span class="n">nt_seq</span><span class="p">)])</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">e</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">prefix_k_suffix</span>

    <span class="k">def</span> <span class="nf">insert_into_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_tree</span><span class="p">,</span> <span class="n">pair</span><span class="p">):</span>
        <span class="n">var</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">my_scope</span> <span class="o">=</span> <span class="n">my_tree</span>
        <span class="p">(</span><span class="n">nt_var</span><span class="p">,</span> <span class="n">nt_seq</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v_scope</span><span class="p">)</span> <span class="o">=</span> <span class="n">pair</span>
        <span class="n">applied</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">value_</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"-&gt; [</span><span class="si">%d</span><span class="s2">] </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value_</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">value_</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">applied</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">v_scope</span> <span class="o">!=</span> <span class="n">scope</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nt_seq</span> <span class="o">&gt;</span> <span class="n">scope</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_part_of_value</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">prefix_k_suffix</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">children</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">children</span>
                                   <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">partition_by_part</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="n">key</span><span class="p">)]</span>
                <span class="k">del</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prefix_k_suffix</span><span class="p">):</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span>

                <span class="n">applied</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">" &gt; </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prefix_k_suffix</span><span class="p">])))</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">applied</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>apply_new_definition()</code> is now modified to carry additional contextual information <code>mseq</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTreeMiner</span><span class="p">(</span><span class="n">ScopeTreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">apply_new_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value_</span><span class="p">):</span>
        <span class="n">nt_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt_var</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mseq</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="n">smethod</span><span class="p">,</span> <span class="n">mseq</span><span class="p">)</span> <span class="o">=</span> <span class="n">value_</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_into_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="p">((</span><span class="n">nt_var</span><span class="p">,</span> <span class="n">seq</span><span class="p">),</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">mseq</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We also modify <code>get_derivation_tree()</code> so that the initial node carries the context.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopeTreeMiner</span><span class="p">(</span><span class="n">ScopeTreeMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_derivation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="p">(</span><span class="n">START_SYMBOL</span><span class="p">,</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">)],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_new_definition</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-1:-Recovering-URL-Parse-Tree">Example 1: Recovering URL Parse Tree</h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We verify that our URL parse tree recovery still works as expected.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">url_dts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">inputstr</span> <span class="ow">in</span> <span class="n">URLS_X</span><span class="p">:</span>
    <span class="n">clear_cache</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
        <span class="n">urlparse</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ScopeTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(</span><span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">ScopeTreeMiner</span><span class="p">(</span>
        <span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(</span>
            <span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">display_tree</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="n">lr_graph</span><span class="p">)</span>
    <span class="n">url_dts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>('urlparse', 1, 'url', 374) = ('http://user:pass@www.google.com:80/?q=path#ref', ('&lt;start&gt;', 0))
('urlparse', 1, 'url', 374) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('http://user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))
('urlsplit', 3, 'url', 492) = ('//user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))
('urlsplit', 3, 'scheme', 492) = ('http', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//user:pass@www.google.com:80/?q=path#ref', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//user:pass@www.google.com:80/?q=path#ref', ('_splitnetloc', 5))
('urlsplit', 3, 'url', 494) = ('/?q=path#ref', ('urlsplit', 3))
('urlsplit', 3, 'netloc', 494) = ('user:pass@www.google.com:80', ('urlsplit', 3))
('urlsplit', 3, 'url', 502) = ('/?q=path', ('urlsplit', 3))
('urlsplit', 3, 'fragment', 502) = ('ref', ('urlsplit', 3))
('urlsplit', 3, 'query', 504) = ('q=path', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('user:pass@www.google.com:80', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('user:pass@www.google.com:80', ('_checknetloc', 6))
('urlparse', 1, 'scheme', 396) = ('http', ('urlparse', 1))
('urlparse', 1, 'netloc', 396) = ('user:pass@www.google.com:80', ('urlparse', 1))
('urlparse', 1, 'query', 396) = ('q=path', ('urlparse', 1))
('urlparse', 1, 'fragment', 396) = ('ref', ('urlparse', 1))
('urlparse', 1, 'url', 374) = ('https://www.cispa.saarland:80/', ('&lt;start&gt;', 0))
('urlparse', 1, 'url', 374) = ('https://www.cispa.saarland:80/', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('https://www.cispa.saarland:80/', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('https://www.cispa.saarland:80/', ('urlsplit', 3))
('urlsplit', 3, 'url', 492) = ('//www.cispa.saarland:80/', ('urlsplit', 3))
('urlsplit', 3, 'scheme', 492) = ('https', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//www.cispa.saarland:80/', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//www.cispa.saarland:80/', ('_splitnetloc', 5))
('urlsplit', 3, 'netloc', 494) = ('www.cispa.saarland:80', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('www.cispa.saarland:80', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('www.cispa.saarland:80', ('_checknetloc', 6))
('urlparse', 1, 'scheme', 396) = ('https', ('urlparse', 1))
('urlparse', 1, 'netloc', 396) = ('www.cispa.saarland:80', ('urlparse', 1))
('urlparse', 1, 'url', 374) = ('http://www.fuzzingbook.org/#News', ('&lt;start&gt;', 0))
('urlparse', 1, 'url', 374) = ('http://www.fuzzingbook.org/#News', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('http://www.fuzzingbook.org/#News', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('http://www.fuzzingbook.org/#News', ('urlsplit', 3))
('urlsplit', 3, 'url', 492) = ('//www.fuzzingbook.org/#News', ('urlsplit', 3))
('urlsplit', 3, 'scheme', 492) = ('http', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//www.fuzzingbook.org/#News', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//www.fuzzingbook.org/#News', ('_splitnetloc', 5))
('urlsplit', 3, 'url', 494) = ('/#News', ('urlsplit', 3))
('urlsplit', 3, 'netloc', 494) = ('www.fuzzingbook.org', ('urlsplit', 3))
('urlsplit', 3, 'fragment', 502) = ('News', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('www.fuzzingbook.org', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('www.fuzzingbook.org', ('_checknetloc', 6))
('urlparse', 1, 'scheme', 396) = ('http', ('urlparse', 1))
('urlparse', 1, 'netloc', 396) = ('www.fuzzingbook.org', ('urlparse', 1))
('urlparse', 1, 'fragment', 396) = ('News', ('urlparse', 1))
('urlparse', 1, 'url', 374) = ('ftp://freebsd.org/releases/5.8', ('&lt;start&gt;', 0))
('urlparse', 1, 'url', 374) = ('ftp://freebsd.org/releases/5.8', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('ftp://freebsd.org/releases/5.8', ('urlparse', 1))
('urlsplit', 3, 'url', 452) = ('ftp://freebsd.org/releases/5.8', ('urlsplit', 3))
('urlsplit', 3, 'url', 492) = ('//freebsd.org/releases/5.8', ('urlsplit', 3))
('urlsplit', 3, 'scheme', 492) = ('ftp', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//freebsd.org/releases/5.8', ('urlsplit', 3))
('_splitnetloc', 5, 'url', 413) = ('//freebsd.org/releases/5.8', ('_splitnetloc', 5))
('urlsplit', 3, 'url', 494) = ('/releases/5.8', ('urlsplit', 3))
('urlsplit', 3, 'netloc', 494) = ('freebsd.org', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('freebsd.org', ('urlsplit', 3))
('_checknetloc', 6, 'netloc', 421) = ('freebsd.org', ('_checknetloc', 6))
('urlparse', 1, 'url', 396) = ('/releases/5.8', ('urlparse', 1))
('urlparse', 1, 'scheme', 396) = ('ftp', ('urlparse', 1))
('urlparse', 1, 'netloc', 396) = ('freebsd.org', ('urlparse', 1))
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Example-2:-Recovering-Inventory-Parse-Tree">Example 2: Recovering Inventory Parse Tree</h4></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Next, we look at recovering the parse tree from <code>process_inventory()</code> which failed last time.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">INVENTORY</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
    <span class="n">process_inventory</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">ScopeTracker</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="n">inventory_dt</span> <span class="o">=</span> <span class="n">ScopeTreeMiner</span><span class="p">(</span>
    <span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(</span>
        <span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">inventory_dt</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="n">lr_graph</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory[1]:inventory@22 = ('1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture', ('&lt;start&gt;', 0))
process_inventory[1]:inventory@22 = ('1997,van,Ford,E350\n2000,car,Mercury,Cougar\n1999,car,Chevy,Venture', ('process_inventory', 1))
process_inventory[1]:vehicle@24 = ('1997,van,Ford,E350', ('process_inventory', 1))
process_vehicle[2]:vehicle@29 = ('1997,van,Ford,E350', ('process_inventory', 1))
process_vehicle[2]:vehicle@29 = ('1997,van,Ford,E350', ('process_vehicle', 2))
process_vehicle[2]:year@30 = ('1997', ('process_vehicle', 2))
process_vehicle[2]:kind@30 = ('van', ('process_vehicle', 2))
process_vehicle[2]:company@30 = ('Ford', ('process_vehicle', 2))
process_vehicle[2]:model@30 = ('E350', ('process_vehicle', 2))
process_van[3]:year@40 = ('1997', ('process_vehicle', 2))
process_van[3]:company@40 = ('Ford', ('process_vehicle', 2))
process_van[3]:model@40 = ('E350', ('process_vehicle', 2))
process_van[3]:year@40 = ('1997', ('process_van', 3))
process_van[3]:company@40 = ('Ford', ('process_van', 3))
process_van[3]:model@40 = ('E350', ('process_van', 3))
process_inventory[1]:vehicle@24 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))
process_vehicle[4]:vehicle@29 = ('2000,car,Mercury,Cougar', ('process_inventory', 1))
process_vehicle[4]:vehicle@29 = ('2000,car,Mercury,Cougar', ('process_vehicle', 4))
process_vehicle[4]:year@30 = ('2000', ('process_vehicle', 4))
process_vehicle[4]:kind@30 = ('car', ('process_vehicle', 4))
process_vehicle[4]:company@30 = ('Mercury', ('process_vehicle', 4))
process_vehicle[4]:model@30 = ('Cougar', ('process_vehicle', 4))
process_car[5]:year@49 = ('2000', ('process_vehicle', 4))
process_car[5]:company@49 = ('Mercury', ('process_vehicle', 4))
process_car[5]:model@49 = ('Cougar', ('process_vehicle', 4))
process_car[5]:year@49 = ('2000', ('process_car', 5))
process_car[5]:company@49 = ('Mercury', ('process_car', 5))
process_car[5]:model@49 = ('Cougar', ('process_car', 5))
process_inventory[1]:vehicle@24 = ('1999,car,Chevy,Venture', ('process_inventory', 1))
process_vehicle[6]:vehicle@29 = ('1999,car,Chevy,Venture', ('process_inventory', 1))
process_vehicle[6]:vehicle@29 = ('1999,car,Chevy,Venture', ('process_vehicle', 6))
process_vehicle[6]:year@30 = ('1999', ('process_vehicle', 6))
process_vehicle[6]:kind@30 = ('car', ('process_vehicle', 6))
process_vehicle[6]:company@30 = ('Chevy', ('process_vehicle', 6))
process_vehicle[6]:model@30 = ('Venture', ('process_vehicle', 6))
process_car[7]:year@49 = ('1999', ('process_vehicle', 6))
process_car[7]:company@49 = ('Chevy', ('process_vehicle', 6))
process_car[7]:model@49 = ('Venture', ('process_vehicle', 6))
process_car[7]:year@49 = ('1999', ('process_car', 7))
process_car[7]:company@49 = ('Chevy', ('process_car', 7))
process_car[7]:model@49 = ('Venture', ('process_car', 7))
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">


<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Pages: 1 -->
<svg width="1852pt" height="662pt" viewbox="0.00 0.00 1851.50 662.25" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 658.25)">
<polygon fill="white" stroke="none" points="-4,4 -4,-658.25 1847.5,-658.25 1847.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="middle" x="19.88" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="174.38" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;process_inventory@22:inventory&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0-&gt;1</title>
<path fill="none" stroke="black" d="M39.57,-327.12C46.61,-327.12 55.2,-327.12 64.6,-327.12"/>
<polygon fill="black" stroke="black" points="64.46,-330.63 74.46,-327.13 64.46,-323.63 64.46,-330.63"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="407.62" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;process_inventory@22:inventory&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1-&gt;2</title>
<path fill="none" stroke="black" d="M272.78,-327.12C281.09,-327.12 289.54,-327.12 297.93,-327.12"/>
<polygon fill="black" stroke="black" points="297.82,-330.63 307.82,-327.13 297.82,-323.63 297.82,-330.63"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="middle" x="634.5" y="-432.95" font-family="Times,serif" font-size="14.00">&lt;process_inventory@24:vehicle&gt;</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2-&gt;3</title>
<path fill="none" stroke="black" d="M422.69,-334.13C460.08,-352.75 562.26,-403.64 609.26,-427.05"/>
<polygon fill="black" stroke="black" points="607.57,-430.12 618.08,-431.45 610.69,-423.86 607.57,-430.12"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="634.5" y="-352.95" font-family="Times,serif" font-size="14.00">\n (10)</text>
</g>
<!-- 2&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>2-&gt;23</title>
<path fill="none" stroke="black" d="M458.53,-334.23C503.52,-340.63 568.1,-349.82 604.91,-355.06"/>
<polygon fill="black" stroke="black" points="604.37,-358.51 614.76,-356.46 605.35,-351.58 604.37,-358.51"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="middle" x="634.5" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;process_inventory@24:vehicle&gt;</text>
</g>
<!-- 2&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>2-&gt;24</title>
<path fill="none" stroke="black" d="M505.95,-327.12C514.27,-327.12 522.71,-327.12 531.07,-327.12"/>
<polygon fill="black" stroke="black" points="530.9,-330.63 540.9,-327.13 530.9,-323.63 530.9,-330.63"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="middle" x="634.5" y="-288.95" font-family="Times,serif" font-size="14.00">\n (10)</text>
</g>
<!-- 2&#45;&gt;44 -->
<g id="edge44" class="edge">
<title>2-&gt;44</title>
<path fill="none" stroke="black" d="M458.53,-320.02C503.52,-313.62 568.1,-304.43 604.91,-299.19"/>
<polygon fill="black" stroke="black" points="605.35,-302.67 614.76,-297.79 604.37,-295.74 605.35,-302.67"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="middle" x="634.5" y="-216.95" font-family="Times,serif" font-size="14.00">&lt;process_inventory@24:vehicle&gt;</text>
</g>
<!-- 2&#45;&gt;45 -->
<g id="edge45" class="edge">
<title>2-&gt;45</title>
<path fill="none" stroke="black" d="M423.73,-320.14C461.56,-302.64 560.74,-256.78 607.89,-234.97"/>
<polygon fill="black" stroke="black" points="609.18,-238.23 616.79,-230.85 606.25,-231.87 609.18,-238.23"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="848.62" y="-464.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3-&gt;4</title>
<path fill="none" stroke="black" d="M682.58,-446.23C714.16,-450.99 755.97,-457.3 789.61,-462.37"/>
<polygon fill="black" stroke="black" points="788.77,-465.79 799.18,-463.82 789.82,-458.86 788.77,-465.79"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="1056.38" y="-528.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4-&gt;5</title>
<path fill="none" stroke="black" d="M872.43,-478.22C908.75,-489.52 979.93,-511.66 1022,-524.74"/>
<polygon fill="black" stroke="black" points="1020.75,-528.02 1031.34,-527.65 1022.83,-521.34 1020.75,-528.02"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="1269.75" y="-640.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:year&gt;</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>5-&gt;6</title>
<path fill="none" stroke="black" d="M1063.65,-542.09C1080.32,-560.11 1127.91,-608.46 1178.25,-631.12 1183.39,-633.44 1188.84,-635.42 1194.41,-637.12"/>
<polygon fill="black" stroke="black" points="1193.2,-640.41 1203.76,-639.64 1195.02,-633.66 1193.2,-640.41"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="1269.75" y="-608.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 5&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>5-&gt;10</title>
<path fill="none" stroke="black" d="M1067.86,-542.14C1088.22,-555.42 1134.91,-584.23 1178.25,-599.12 1199.69,-606.49 1225.2,-610.61 1243.66,-612.81"/>
<polygon fill="black" stroke="black" points="1243.1,-616.27 1253.42,-613.87 1243.85,-609.31 1243.1,-616.27"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="1269.75" y="-576.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:kind&gt;</text>
</g>
<!-- 5&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>5-&gt;11</title>
<path fill="none" stroke="black" d="M1081.77,-542.23C1106.08,-549.15 1144.54,-559.7 1178.25,-567.12 1189.47,-569.6 1201.54,-571.94 1213.09,-574.04"/>
<polygon fill="black" stroke="black" points="1212.47,-577.49 1222.92,-575.79 1213.69,-570.59 1212.47,-577.49"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="1269.75" y="-544.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 5&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>5-&gt;13</title>
<path fill="none" stroke="black" d="M1142.13,-541.54C1178.68,-544.31 1218.71,-547.34 1243.78,-549.23"/>
<polygon fill="black" stroke="black" points="1243.36,-552.71 1253.6,-549.98 1243.89,-545.73 1243.36,-552.71"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="1269.75" y="-512.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:company&gt;</text>
</g>
<!-- 5&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>5-&gt;14</title>
<path fill="none" stroke="black" d="M1142.13,-528.71C1150.34,-528.09 1158.73,-527.45 1167.09,-526.82"/>
<polygon fill="black" stroke="black" points="1167.22,-530.32 1176.93,-526.08 1166.69,-523.34 1167.22,-530.32"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="1269.75" y="-480.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 5&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>5-&gt;18</title>
<path fill="none" stroke="black" d="M1081.77,-528.02C1106.08,-521.1 1144.54,-510.55 1178.25,-503.12 1200.26,-498.28 1225.53,-493.91 1243.76,-490.96"/>
<polygon fill="black" stroke="black" points="1244.05,-494.46 1253.38,-489.44 1242.96,-487.55 1244.05,-494.46"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="1269.75" y="-448.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:model&gt;</text>
</g>
<!-- 5&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>5-&gt;19</title>
<path fill="none" stroke="black" d="M1067.86,-528.11C1088.22,-514.83 1134.91,-486.02 1178.25,-471.12 1185.82,-468.52 1193.91,-466.33 1202.01,-464.48"/>
<polygon fill="black" stroke="black" points="1202.47,-467.95 1211.54,-462.47 1201.03,-461.1 1202.47,-467.95"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="1479" y="-640.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:year&gt;</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6-&gt;7</title>
<path fill="none" stroke="black" d="M1347.63,-647.12C1364.64,-647.12 1382.68,-647.12 1399.74,-647.12"/>
<polygon fill="black" stroke="black" points="1399.28,-650.63 1409.28,-647.13 1399.28,-643.63 1399.28,-650.63"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="1678.5" y="-640.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:year&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7-&gt;8</title>
<path fill="none" stroke="black" d="M1547.14,-647.12C1563.93,-647.12 1582.08,-647.12 1599.35,-647.12"/>
<polygon fill="black" stroke="black" points="1599.03,-650.63 1609.03,-647.13 1599.03,-643.63 1599.03,-650.63"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="1819.88" y="-640.95" font-family="Times,serif" font-size="14.00">1997</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8-&gt;9</title>
<path fill="none" stroke="black" d="M1746.74,-647.12C1764.04,-647.12 1781.54,-647.12 1794.98,-647.12"/>
<polygon fill="black" stroke="black" points="1794.95,-650.63 1804.95,-647.13 1794.95,-643.63 1794.95,-650.63"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="1479" y="-576.95" font-family="Times,serif" font-size="14.00">van</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11-&gt;12</title>
<path fill="none" stroke="black" d="M1347.92,-583.12C1387.52,-583.12 1432.63,-583.12 1457.97,-583.12"/>
<polygon fill="black" stroke="black" points="1457.77,-586.63 1467.77,-583.13 1457.77,-579.63 1457.77,-586.63"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="1479" y="-512.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:company&gt;</text>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>14-&gt;15</title>
<path fill="none" stroke="black" d="M1361.05,-519.12C1369.37,-519.12 1377.82,-519.12 1386.15,-519.12"/>
<polygon fill="black" stroke="black" points="1385.92,-522.63 1395.92,-519.13 1385.92,-515.63 1385.92,-522.63"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="1678.5" y="-512.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:company&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15-&gt;16</title>
<path fill="none" stroke="black" d="M1560.62,-519.12C1568.83,-519.12 1577.21,-519.12 1585.54,-519.12"/>
<polygon fill="black" stroke="black" points="1585.31,-522.63 1595.31,-519.13 1585.31,-515.63 1585.31,-522.63"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="middle" x="1819.88" y="-512.95" font-family="Times,serif" font-size="14.00">Ford</text>
</g>
<!-- 16&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>16-&gt;17</title>
<path fill="none" stroke="black" d="M1760.17,-519.12C1773.21,-519.12 1785.72,-519.12 1795.82,-519.12"/>
<polygon fill="black" stroke="black" points="1795.66,-522.63 1805.66,-519.13 1795.66,-515.63 1795.66,-522.63"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="1479" y="-448.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:model&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19-&gt;20</title>
<path fill="none" stroke="black" d="M1353.26,-455.12C1366.66,-455.12 1380.56,-455.12 1394,-455.12"/>
<polygon fill="black" stroke="black" points="1393.65,-458.63 1403.65,-455.13 1393.65,-451.63 1393.65,-458.63"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="1678.5" y="-448.95" font-family="Times,serif" font-size="14.00">&lt;process_van@40:model&gt;</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20-&gt;21</title>
<path fill="none" stroke="black" d="M1552.7,-455.12C1566.02,-455.12 1580.02,-455.12 1593.63,-455.12"/>
<polygon fill="black" stroke="black" points="1593.44,-458.63 1603.44,-455.13 1593.44,-451.63 1593.44,-458.63"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="1819.88" y="-448.95" font-family="Times,serif" font-size="14.00">E350</text>
</g>
<!-- 21&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>21-&gt;22</title>
<path fill="none" stroke="black" d="M1752.05,-455.12C1767.36,-455.12 1782.49,-455.12 1794.48,-455.12"/>
<polygon fill="black" stroke="black" points="1794.18,-458.63 1804.18,-455.13 1794.18,-451.63 1794.18,-458.63"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="848.62" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24-&gt;25</title>
<path fill="none" stroke="black" d="M726.69,-327.12C734.95,-327.12 743.33,-327.12 751.63,-327.12"/>
<polygon fill="black" stroke="black" points="751.37,-330.63 761.37,-327.13 751.37,-323.63 751.37,-330.63"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="1056.38" y="-320.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 25&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>25-&gt;26</title>
<path fill="none" stroke="black" d="M934.5,-327.12C942.72,-327.12 951.1,-327.12 959.41,-327.12"/>
<polygon fill="black" stroke="black" points="959.18,-330.63 969.18,-327.13 959.18,-323.63 959.18,-330.63"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="middle" x="1269.75" y="-416.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:year&gt;</text>
</g>
<!-- 26&#45;&gt;27 -->
<g id="edge27" class="edge">
<title>26-&gt;27</title>
<path fill="none" stroke="black" d="M1065.21,-334.02C1083.55,-349.75 1131.27,-388.37 1178.25,-407.12 1184.33,-409.55 1190.78,-411.61 1197.33,-413.36"/>
<polygon fill="black" stroke="black" points="1196.38,-416.73 1206.92,-415.66 1198.02,-409.92 1196.38,-416.73"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="middle" x="1269.75" y="-384.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 26&#45;&gt;31 -->
<g id="edge31" class="edge">
<title>26-&gt;31</title>
<path fill="none" stroke="black" d="M1072.3,-334.2C1094.79,-344.59 1138.93,-363.97 1178.25,-375.12 1199.93,-381.28 1225.23,-385.51 1243.57,-388.07"/>
<polygon fill="black" stroke="black" points="1242.88,-391.51 1253.25,-389.35 1243.8,-384.57 1242.88,-391.51"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="middle" x="1269.75" y="-352.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:kind&gt;</text>
</g>
<!-- 26&#45;&gt;32 -->
<g id="edge32" class="edge">
<title>26-&gt;32</title>
<path fill="none" stroke="black" d="M1104.29,-334.23C1135.76,-338.99 1177.42,-345.3 1210.94,-350.37"/>
<polygon fill="black" stroke="black" points="1210.06,-353.78 1220.47,-351.82 1211.11,-346.86 1210.06,-353.78"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="middle" x="1269.75" y="-320.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 26&#45;&gt;34 -->
<g id="edge34" class="edge">
<title>26-&gt;34</title>
<path fill="none" stroke="black" d="M1142.13,-327.12C1178.68,-327.12 1218.71,-327.12 1243.78,-327.12"/>
<polygon fill="black" stroke="black" points="1243.6,-330.63 1253.6,-327.13 1243.6,-323.63 1243.6,-330.63"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="1269.75" y="-288.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:company&gt;</text>
</g>
<!-- 26&#45;&gt;35 -->
<g id="edge35" class="edge">
<title>26-&gt;35</title>
<path fill="none" stroke="black" d="M1104.29,-320.02C1135.76,-315.26 1177.42,-308.95 1210.94,-303.88"/>
<polygon fill="black" stroke="black" points="1211.11,-307.39 1220.47,-302.43 1210.06,-300.47 1211.11,-307.39"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="middle" x="1269.75" y="-256.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 26&#45;&gt;39 -->
<g id="edge39" class="edge">
<title>26-&gt;39</title>
<path fill="none" stroke="black" d="M1072.3,-320.05C1094.79,-309.66 1138.93,-290.28 1178.25,-279.12 1199.93,-272.97 1225.23,-268.74 1243.57,-266.18"/>
<polygon fill="black" stroke="black" points="1243.8,-269.68 1253.25,-264.9 1242.88,-262.74 1243.8,-269.68"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="middle" x="1269.75" y="-224.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:model&gt;</text>
</g>
<!-- 26&#45;&gt;40 -->
<g id="edge40" class="edge">
<title>26-&gt;40</title>
<path fill="none" stroke="black" d="M1065.21,-320.23C1083.55,-304.5 1131.27,-265.88 1178.25,-247.12 1184.33,-244.7 1190.78,-242.64 1197.33,-240.89"/>
<polygon fill="black" stroke="black" points="1198.02,-244.33 1206.92,-238.59 1196.38,-237.52 1198.02,-244.33"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="middle" x="1479" y="-416.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:year&gt;</text>
</g>
<!-- 27&#45;&gt;28 -->
<g id="edge28" class="edge">
<title>27-&gt;28</title>
<path fill="none" stroke="black" d="M1347.63,-423.12C1365.11,-423.12 1383.68,-423.12 1401.16,-423.12"/>
<polygon fill="black" stroke="black" points="1400.96,-426.63 1410.96,-423.13 1400.96,-419.63 1400.96,-426.63"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="1678.5" y="-416.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:year&gt;</text>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge29" class="edge">
<title>28-&gt;29</title>
<path fill="none" stroke="black" d="M1545.49,-423.12C1563.07,-423.12 1582.25,-423.12 1600.4,-423.12"/>
<polygon fill="black" stroke="black" points="1600.34,-426.63 1610.34,-423.13 1600.34,-419.63 1600.34,-426.63"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="middle" x="1819.88" y="-416.95" font-family="Times,serif" font-size="14.00">2000</text>
</g>
<!-- 29&#45;&gt;30 -->
<g id="edge30" class="edge">
<title>29-&gt;30</title>
<path fill="none" stroke="black" d="M1745.11,-423.12C1763.05,-423.12 1781.36,-423.12 1795.25,-423.12"/>
<polygon fill="black" stroke="black" points="1795.11,-426.63 1805.11,-423.13 1795.11,-419.63 1795.11,-426.63"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="middle" x="1479" y="-352.95" font-family="Times,serif" font-size="14.00">car</text>
</g>
<!-- 32&#45;&gt;33 -->
<g id="edge33" class="edge">
<title>32-&gt;33</title>
<path fill="none" stroke="black" d="M1347.92,-359.12C1388.31,-359.12 1434.44,-359.12 1459.47,-359.12"/>
<polygon fill="black" stroke="black" points="1459.25,-362.63 1469.25,-359.13 1459.25,-355.63 1459.25,-362.63"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="middle" x="1479" y="-288.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:company&gt;</text>
</g>
<!-- 35&#45;&gt;36 -->
<g id="edge36" class="edge">
<title>35-&gt;36</title>
<path fill="none" stroke="black" d="M1361.05,-295.12C1369.85,-295.12 1378.78,-295.12 1387.58,-295.12"/>
<polygon fill="black" stroke="black" points="1387.53,-298.63 1397.53,-295.13 1387.53,-291.63 1387.53,-298.63"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="middle" x="1678.5" y="-288.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:company&gt;</text>
</g>
<!-- 36&#45;&gt;37 -->
<g id="edge37" class="edge">
<title>36-&gt;37</title>
<path fill="none" stroke="black" d="M1559.19,-295.12C1568.35,-295.12 1577.74,-295.12 1587.03,-295.12"/>
<polygon fill="black" stroke="black" points="1586.78,-298.63 1596.78,-295.13 1586.78,-291.63 1586.78,-298.63"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="middle" x="1819.88" y="-288.95" font-family="Times,serif" font-size="14.00">Mercury</text>
</g>
<!-- 37&#45;&gt;38 -->
<g id="edge38" class="edge">
<title>37-&gt;38</title>
<path fill="none" stroke="black" d="M1758.55,-295.12C1767.88,-295.12 1776.98,-295.12 1785.17,-295.12"/>
<polygon fill="black" stroke="black" points="1784.92,-298.63 1794.92,-295.13 1784.92,-291.63 1784.92,-298.63"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="middle" x="1479" y="-224.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:model&gt;</text>
</g>
<!-- 40&#45;&gt;41 -->
<g id="edge41" class="edge">
<title>40-&gt;41</title>
<path fill="none" stroke="black" d="M1353.26,-231.12C1367.1,-231.12 1381.47,-231.12 1395.32,-231.12"/>
<polygon fill="black" stroke="black" points="1395.3,-234.63 1405.3,-231.13 1395.3,-227.63 1395.3,-234.63"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="middle" x="1678.5" y="-224.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:model&gt;</text>
</g>
<!-- 41&#45;&gt;42 -->
<g id="edge42" class="edge">
<title>41-&gt;42</title>
<path fill="none" stroke="black" d="M1551.3,-231.12C1565.43,-231.12 1580.36,-231.12 1594.83,-231.12"/>
<polygon fill="black" stroke="black" points="1594.79,-234.63 1604.79,-231.13 1594.79,-227.63 1594.79,-234.63"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="middle" x="1819.88" y="-224.95" font-family="Times,serif" font-size="14.00">Cougar</text>
</g>
<!-- 42&#45;&gt;43 -->
<g id="edge43" class="edge">
<title>42-&gt;43</title>
<path fill="none" stroke="black" d="M1750.82,-231.12C1764.2,-231.12 1777.5,-231.12 1788.74,-231.12"/>
<polygon fill="black" stroke="black" points="1788.53,-234.63 1798.53,-231.13 1788.53,-227.63 1788.53,-234.63"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="middle" x="848.62" y="-136.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 45&#45;&gt;46 -->
<g id="edge46" class="edge">
<title>45-&gt;46</title>
<path fill="none" stroke="black" d="M654.32,-216.03C691.36,-202.06 773.91,-170.93 818.2,-154.22"/>
<polygon fill="black" stroke="black" points="819.3,-157.55 827.43,-150.74 816.83,-151 819.3,-157.55"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1056.38" y="-112.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@29:vehicle&gt;</text>
</g>
<!-- 46&#45;&gt;47 -->
<g id="edge47" class="edge">
<title>46-&gt;47</title>
<path fill="none" stroke="black" d="M910.52,-136.02C933.33,-133.36 959.47,-130.31 983.2,-127.54"/>
<polygon fill="black" stroke="black" points="983.6,-131.02 993.13,-126.39 982.79,-124.07 983.6,-131.02"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="middle" x="1269.75" y="-192.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:year&gt;</text>
</g>
<!-- 47&#45;&gt;48 -->
<g id="edge48" class="edge">
<title>47-&gt;48</title>
<path fill="none" stroke="black" d="M1067.86,-126.14C1088.22,-139.42 1134.91,-168.23 1178.25,-183.12 1185.82,-185.73 1193.91,-187.92 1202.01,-189.77"/>
<polygon fill="black" stroke="black" points="1201.03,-193.15 1211.54,-191.78 1202.47,-186.3 1201.03,-193.15"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="middle" x="1269.75" y="-160.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 47&#45;&gt;52 -->
<g id="edge52" class="edge">
<title>47-&gt;52</title>
<path fill="none" stroke="black" d="M1081.77,-126.23C1106.08,-133.15 1144.54,-143.7 1178.25,-151.12 1200.26,-155.97 1225.53,-160.34 1243.76,-163.29"/>
<polygon fill="black" stroke="black" points="1242.96,-166.7 1253.38,-164.81 1244.05,-159.79 1242.96,-166.7"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="middle" x="1269.75" y="-128.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:kind&gt;</text>
</g>
<!-- 47&#45;&gt;53 -->
<g id="edge53" class="edge">
<title>47-&gt;53</title>
<path fill="none" stroke="black" d="M1142.13,-125.54C1154.62,-126.49 1167.51,-127.46 1180.08,-128.41"/>
<polygon fill="black" stroke="black" points="1179.75,-131.9 1189.99,-129.16 1180.28,-124.92 1179.75,-131.9"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="middle" x="1269.75" y="-96.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 47&#45;&gt;55 -->
<g id="edge55" class="edge">
<title>47-&gt;55</title>
<path fill="none" stroke="black" d="M1142.13,-112.71C1178.68,-109.94 1218.71,-106.91 1243.78,-105.02"/>
<polygon fill="black" stroke="black" points="1243.89,-108.52 1253.6,-104.27 1243.36,-101.54 1243.89,-108.52"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1269.75" y="-64.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:company&gt;</text>
</g>
<!-- 47&#45;&gt;56 -->
<g id="edge56" class="edge">
<title>47-&gt;56</title>
<path fill="none" stroke="black" d="M1081.77,-112.02C1106.08,-105.1 1144.54,-94.55 1178.25,-87.12 1189.47,-84.65 1201.54,-82.31 1213.09,-80.21"/>
<polygon fill="black" stroke="black" points="1213.69,-83.66 1222.92,-78.46 1212.47,-76.76 1213.69,-83.66"/>
</g>
<!-- 60 -->
<g id="node61" class="node">
<title>60</title>
<text text-anchor="middle" x="1269.75" y="-32.95" font-family="Times,serif" font-size="14.00">, (44)</text>
</g>
<!-- 47&#45;&gt;60 -->
<g id="edge60" class="edge">
<title>47-&gt;60</title>
<path fill="none" stroke="black" d="M1067.86,-112.11C1088.22,-98.83 1134.91,-70.02 1178.25,-55.12 1199.69,-47.76 1225.2,-43.64 1243.66,-41.44"/>
<polygon fill="black" stroke="black" points="1243.85,-44.94 1253.42,-40.38 1243.1,-37.98 1243.85,-44.94"/>
</g>
<!-- 61 -->
<g id="node62" class="node">
<title>61</title>
<text text-anchor="middle" x="1269.75" y="-0.95" font-family="Times,serif" font-size="14.00">&lt;process_vehicle@30:model&gt;</text>
</g>
<!-- 47&#45;&gt;61 -->
<g id="edge61" class="edge">
<title>47-&gt;61</title>
<path fill="none" stroke="black" d="M1063.65,-112.16C1080.32,-94.14 1127.91,-45.79 1178.25,-23.12 1183.39,-20.81 1188.84,-18.83 1194.41,-17.13"/>
<polygon fill="black" stroke="black" points="1195.02,-20.59 1203.76,-14.61 1193.2,-13.84 1195.02,-20.59"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="middle" x="1479" y="-192.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:year&gt;</text>
</g>
<!-- 48&#45;&gt;49 -->
<g id="edge49" class="edge">
<title>48-&gt;49</title>
<path fill="none" stroke="black" d="M1347.63,-199.12C1365.11,-199.12 1383.68,-199.12 1401.16,-199.12"/>
<polygon fill="black" stroke="black" points="1400.96,-202.63 1410.96,-199.13 1400.96,-195.63 1400.96,-202.63"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="middle" x="1678.5" y="-192.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:year&gt;</text>
</g>
<!-- 49&#45;&gt;50 -->
<g id="edge50" class="edge">
<title>49-&gt;50</title>
<path fill="none" stroke="black" d="M1545.49,-199.12C1563.07,-199.12 1582.25,-199.12 1600.4,-199.12"/>
<polygon fill="black" stroke="black" points="1600.34,-202.63 1610.34,-199.13 1600.34,-195.63 1600.34,-202.63"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="middle" x="1819.88" y="-192.95" font-family="Times,serif" font-size="14.00">1999</text>
</g>
<!-- 50&#45;&gt;51 -->
<g id="edge51" class="edge">
<title>50-&gt;51</title>
<path fill="none" stroke="black" d="M1745.11,-199.12C1763.05,-199.12 1781.36,-199.12 1795.25,-199.12"/>
<polygon fill="black" stroke="black" points="1795.11,-202.63 1805.11,-199.13 1795.11,-195.63 1795.11,-202.63"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="middle" x="1479" y="-128.95" font-family="Times,serif" font-size="14.00">car</text>
</g>
<!-- 53&#45;&gt;54 -->
<g id="edge54" class="edge">
<title>53-&gt;54</title>
<path fill="none" stroke="black" d="M1347.92,-135.12C1388.31,-135.12 1434.44,-135.12 1459.47,-135.12"/>
<polygon fill="black" stroke="black" points="1459.25,-138.63 1469.25,-135.13 1459.25,-131.63 1459.25,-138.63"/>
</g>
<!-- 57 -->
<g id="node58" class="node">
<title>57</title>
<text text-anchor="middle" x="1479" y="-64.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:company&gt;</text>
</g>
<!-- 56&#45;&gt;57 -->
<g id="edge57" class="edge">
<title>56-&gt;57</title>
<path fill="none" stroke="black" d="M1361.05,-71.12C1369.85,-71.12 1378.78,-71.12 1387.58,-71.12"/>
<polygon fill="black" stroke="black" points="1387.53,-74.63 1397.53,-71.13 1387.53,-67.63 1387.53,-74.63"/>
</g>
<!-- 58 -->
<g id="node59" class="node">
<title>58</title>
<text text-anchor="middle" x="1678.5" y="-64.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:company&gt;</text>
</g>
<!-- 57&#45;&gt;58 -->
<g id="edge58" class="edge">
<title>57-&gt;58</title>
<path fill="none" stroke="black" d="M1559.19,-71.12C1568.35,-71.12 1577.74,-71.12 1587.03,-71.12"/>
<polygon fill="black" stroke="black" points="1586.78,-74.63 1596.78,-71.13 1586.78,-67.63 1586.78,-74.63"/>
</g>
<!-- 59 -->
<g id="node60" class="node">
<title>59</title>
<text text-anchor="middle" x="1819.88" y="-64.95" font-family="Times,serif" font-size="14.00">Chevy</text>
</g>
<!-- 58&#45;&gt;59 -->
<g id="edge59" class="edge">
<title>58-&gt;59</title>
<path fill="none" stroke="black" d="M1758.55,-71.12C1770.09,-71.12 1781.27,-71.12 1790.82,-71.12"/>
<polygon fill="black" stroke="black" points="1790.79,-74.63 1800.79,-71.13 1790.79,-67.63 1790.79,-74.63"/>
</g>
<!-- 62 -->
<g id="node63" class="node">
<title>62</title>
<text text-anchor="middle" x="1479" y="-0.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:model&gt;</text>
</g>
<!-- 61&#45;&gt;62 -->
<g id="edge62" class="edge">
<title>61-&gt;62</title>
<path fill="none" stroke="black" d="M1353.26,-7.12C1367.1,-7.12 1381.47,-7.12 1395.32,-7.12"/>
<polygon fill="black" stroke="black" points="1395.3,-10.63 1405.3,-7.13 1395.3,-3.63 1395.3,-10.63"/>
</g>
<!-- 63 -->
<g id="node64" class="node">
<title>63</title>
<text text-anchor="middle" x="1678.5" y="-0.95" font-family="Times,serif" font-size="14.00">&lt;process_car@49:model&gt;</text>
</g>
<!-- 62&#45;&gt;63 -->
<g id="edge63" class="edge">
<title>62-&gt;63</title>
<path fill="none" stroke="black" d="M1551.3,-7.12C1565.43,-7.12 1580.36,-7.12 1594.83,-7.12"/>
<polygon fill="black" stroke="black" points="1594.79,-10.63 1604.79,-7.13 1594.79,-3.63 1594.79,-10.63"/>
</g>
<!-- 64 -->
<g id="node65" class="node">
<title>64</title>
<text text-anchor="middle" x="1819.88" y="-0.95" font-family="Times,serif" font-size="14.00">Venture</text>
</g>
<!-- 63&#45;&gt;64 -->
<g id="edge64" class="edge">
<title>63-&gt;64</title>
<path fill="none" stroke="black" d="M1750.82,-7.12C1763.67,-7.12 1776.44,-7.12 1787.39,-7.12"/>
<polygon fill="black" stroke="black" points="1787.37,-10.63 1797.37,-7.13 1787.37,-3.63 1787.37,-10.63"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The recovered parse tree seems reasonable.</p>
<p>One of the things that one might notice from our Example (2) is that the three subtrees -- <code>vehicle[2:1]</code>, <code>vehicle[4:1]</code> and <code>vehicle[6:1]</code> are quite alike. We will examine how this can be exploited to generate a grammar directly, next.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Grammar-Mining">Grammar Mining</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>tree_to_grammar()</code> is now redefined as follows, to account for the extra scope in nodes.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedGrammarMiner</span><span class="p">(</span><span class="n">GrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">tree_to_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">children</span><span class="p">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">tree</span>
        <span class="n">one_alt</span> <span class="o">=</span> <span class="p">[</span><span class="n">ckey</span> <span class="k">for</span> <span class="n">ckey</span><span class="p">,</span> <span class="n">gchildren</span><span class="p">,</span> <span class="n">cscope</span> <span class="ow">in</span> <span class="n">children</span> <span class="k">if</span> <span class="n">ckey</span> <span class="o">!=</span> <span class="n">key</span><span class="p">]</span>
        <span class="n">hsh</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="n">one_alt</span><span class="p">]</span> <span class="k">if</span> <span class="n">one_alt</span> <span class="k">else</span> <span class="p">[]}</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="p">(</span><span class="n">ckey</span><span class="p">,</span> <span class="n">_gc</span><span class="p">,</span> <span class="n">_cscope</span><span class="p">)</span> <span class="o">=</span> <span class="n">child</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">ckey</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">chsh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_to_grammar</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">chsh</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hsh</span><span class="p">:</span>
                    <span class="n">hsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">chsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hsh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chsh</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">hsh</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The grammar is in canonical form, which needs to be massaged to display. First, the recovered grammar for inventory.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">si</span> <span class="o">=</span> <span class="n">ScopedGrammarMiner</span><span class="p">()</span>
<span class="n">si</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">inventory_dt</span><span class="p">)</span>
<span class="n">syntax_diagram</span><span class="p">(</span><span class="n">readable</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">grammar</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 395.0 62" width="395.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M355.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><rect height="22" width="275.0" x="60.0" y="20"/><text x="197.5" y="35">process_inventory@22:inventory</text></g></g><path d="M335.0 31h20"/></g><path d="M 355.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory@22:inventory
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 1031.0 62" width="1031.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M991.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M971.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M318.0 31h0.0"/><rect height="22" width="258.0" x="60.0" y="20"/><text x="189.0" y="35">process_inventory@24:vehicle</text></g><path d="M318.0 31h10"/><path d="M328.0 31h10"/><g class="terminal">
<path d="M338.0 31h0.0"/><path d="M366.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="338.0" y="20"/><text x="352.25" y="35">
</text></g><path d="M366.5 31h10"/><path d="M376.5 31h10"/><g class="non-terminal">
<path d="M386.5 31h0.0"/><path d="M644.5 31h0.0"/><rect height="22" width="258.0" x="386.5" y="20"/><text x="515.5" y="35">process_inventory@24:vehicle</text></g><path d="M644.5 31h10"/><path d="M654.5 31h10"/><g class="terminal">
<path d="M664.5 31h0.0"/><path d="M693.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="664.5" y="20"/><text x="678.75" y="35">
</text></g><path d="M693.0 31h10"/><path d="M703.0 31h10"/><g class="non-terminal">
<path d="M713.0 31h0.0"/><path d="M971.0 31h0.0"/><rect height="22" width="258.0" x="713.0" y="20"/><text x="842.0" y="35">process_inventory@24:vehicle</text></g></g><path d="M971.0 31h20"/></g><path d="M 991.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory@24:vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 361.0 62" width="361.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M321.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M301.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M301.0 31h0.0"/><rect height="22" width="241.0" x="60.0" y="20"/><text x="180.5" y="35">process_vehicle@29:vehicle</text></g></g><path d="M301.0 31h20"/></g><path d="M 321.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@29:vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 1221.5 62" width="1221.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M1181.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M1161.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><rect height="22" width="215.5" x="60.0" y="20"/><text x="167.75" y="35">process_vehicle@30:year</text></g><path d="M275.5 31h10"/><path d="M285.5 31h10"/><g class="terminal">
<path d="M295.5 31h0.0"/><path d="M324.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="295.5" y="20"/><text x="309.75" y="35">,</text></g><path d="M324.0 31h10"/><path d="M334.0 31h10"/><g class="non-terminal">
<path d="M344.0 31h0.0"/><path d="M559.5 31h0.0"/><rect height="22" width="215.5" x="344.0" y="20"/><text x="451.75" y="35">process_vehicle@30:kind</text></g><path d="M559.5 31h10"/><path d="M569.5 31h10"/><g class="terminal">
<path d="M579.5 31h0.0"/><path d="M608.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="579.5" y="20"/><text x="593.75" y="35">,</text></g><path d="M608.0 31h10"/><path d="M618.0 31h10"/><g class="non-terminal">
<path d="M628.0 31h0.0"/><path d="M869.0 31h0.0"/><rect height="22" width="241.0" x="628.0" y="20"/><text x="748.5" y="35">process_vehicle@30:company</text></g><path d="M869.0 31h10"/><path d="M879.0 31h10"/><g class="terminal">
<path d="M889.0 31h0.0"/><path d="M917.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="889.0" y="20"/><text x="903.25" y="35">,</text></g><path d="M917.5 31h10"/><path d="M927.5 31h10"/><g class="non-terminal">
<path d="M937.5 31h0.0"/><path d="M1161.5 31h0.0"/><rect height="22" width="224.0" x="937.5" y="20"/><text x="1049.5" y="35">process_vehicle@30:model</text></g></g><path d="M1161.5 31h20"/></g><path d="M 1181.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 301.5 92" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M261.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">process_car@49:year</text></g></g><path d="M241.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><rect height="22" width="181.5" x="60.0" y="50"/><text x="150.75" y="65">process_van@40:year</text></g></g><path d="M241.5 61h20"/></g><path d="M 261.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1997</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 327.0 92" width="327.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M287.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><rect height="22" width="207.0" x="60.0" y="20"/><text x="163.5" y="35">process_van@40:company</text></g></g><path d="M267.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><rect height="22" width="207.0" x="60.0" y="50"/><text x="163.5" y="65">process_car@49:company</text></g></g><path d="M267.0 61h20"/></g><path d="M 287.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">Ford</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 310.0 92" width="310.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M270.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><rect height="22" width="190.0" x="60.0" y="20"/><text x="155.0" y="35">process_van@40:model</text></g></g><path d="M250.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><rect height="22" width="190.0" x="60.0" y="50"/><text x="155.0" y="65">process_car@49:model</text></g></g><path d="M250.0 61h20"/></g><path d="M 270.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">E350</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M135.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M135.25 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="20"/><text x="99.75" y="35">Cougar</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="50"/><text x="99.75" y="65">Venture</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The recovered grammar for URLs.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">su</span> <span class="o">=</span> <span class="n">ScopedGrammarMiner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">url_dts</span><span class="p">:</span>
    <span class="n">su</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">syntax_diagram</span><span class="p">(</span><span class="n">readable</span><span class="p">(</span><span class="n">su</span><span class="o">.</span><span class="n">grammar</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 276.0 62" width="276.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M236.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><rect height="22" width="156.0" x="60.0" y="20"/><text x="138.0" y="35">urlparse@374:url</text></g></g><path d="M216.0 31h20"/></g><path d="M 236.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@374:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 276.0 62" width="276.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M236.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><rect height="22" width="156.0" x="60.0" y="20"/><text x="138.0" y="35">urlsplit@452:url</text></g></g><path d="M216.0 31h20"/></g><path d="M 236.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@452:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 526.0 62" width="526.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M486.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M466.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">urlsplit@492:scheme</text></g><path d="M241.5 31h10"/><path d="M251.5 31h10"/><g class="terminal">
<path d="M261.5 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="261.5" y="20"/><text x="275.75" y="35">:</text></g><path d="M290.0 31h10"/><path d="M300.0 31h10"/><g class="non-terminal">
<path d="M310.0 31h0.0"/><path d="M466.0 31h0.0"/><rect height="22" width="156.0" x="310.0" y="20"/><text x="388.0" y="35">urlsplit@492:url</text></g></g><path d="M466.0 31h20"/></g><path d="M 486.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@492:scheme
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 301.5 62" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M261.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">urlparse@396:scheme</text></g></g><path d="M241.5 31h20"/></g><path d="M 261.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:scheme
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 182.5 122" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M114.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="68.5" y="50"/><text x="91.25" y="65">ftp</text></g></g><path d="M122.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="80"/><text x="91.25" y="95">https</text></g></g><path d="M122.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@492:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 310.0 62" width="310.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M270.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><rect height="22" width="190.0" x="60.0" y="20"/><text x="155.0" y="35">_splitnetloc@413:url</text></g></g><path d="M250.0 31h20"/></g><path d="M 270.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>_splitnetloc@413:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 534.5 92" width="534.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M494.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M474.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">//</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M298.5 31h0.0"/><rect height="22" width="181.5" x="117.0" y="20"/><text x="207.75" y="35">urlsplit@494:netloc</text></g><path d="M298.5 31h10"/><path d="M308.5 31h10"/><g class="non-terminal">
<path d="M318.5 31h0.0"/><path d="M474.5 31h0.0"/><rect height="22" width="156.0" x="318.5" y="20"/><text x="396.5" y="35">urlsplit@494:url</text></g></g><path d="M474.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h63.75"/><path d="M410.75 61h63.75"/><g class="terminal">
<path d="M123.75 61h0.0"/><path d="M160.75 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="123.75" y="50"/><text x="142.25" y="65">//</text></g><path d="M160.75 61h10"/><path d="M170.75 61h10"/><g class="non-terminal">
<path d="M180.75 61h0.0"/><path d="M362.25 61h0.0"/><rect height="22" width="181.5" x="180.75" y="50"/><text x="271.5" y="65">urlsplit@494:netloc</text></g><path d="M362.25 61h10"/><path d="M372.25 61h10"/><g class="terminal">
<path d="M382.25 61h0.0"/><path d="M410.75 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="382.25" y="50"/><text x="396.5" y="65">/</text></g></g><path d="M474.5 61h20"/></g><path d="M 494.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@494:netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 335.5 62" width="335.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M295.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><rect height="22" width="215.5" x="60.0" y="20"/><text x="167.75" y="35">_checknetloc@421:netloc</text></g></g><path d="M275.5 31h20"/></g><path d="M 295.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>_checknetloc@421:netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 301.5 62" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M261.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">urlparse@396:netloc</text></g></g><path d="M241.5 31h20"/></g><path d="M 261.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="152" viewbox="0 0 369.5 152" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 81v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 91h0.0"/><path d="M329.5 91h0.0"/><path d="M40.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 91a10 10 0 0 0 10 -10v-40a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v40a10 10 0 0 0 10 10"/><path d="M40.0 91h20"/><g>
<path d="M60.0 91h68.0"/><path d="M241.5 91h68.0"/><g class="terminal">
<path d="M128.0 91h0.0"/><path d="M241.5 91h0.0"/><rect height="22" rx="10" ry="10" width="113.5" x="128.0" y="80"/><text x="184.75" y="95">freebsd.org</text></g></g><path d="M309.5 91h20"/><path d="M40.0 91a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><g class="terminal">
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="110"/><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g><path d="M309.5 121a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 91 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@494:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 543.0 122" width="543.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M503.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h133.5"/><path d="M349.5 31h133.5"/><g class="non-terminal">
<path d="M193.5 31h0.0"/><path d="M349.5 31h0.0"/><rect height="22" width="156.0" x="193.5" y="20"/><text x="271.5" y="35">urlparse@396:url</text></g></g><path d="M483.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M483.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M216.0 61h0.0"/><rect height="22" width="156.0" x="60.0" y="50"/><text x="138.0" y="65">urlsplit@502:url</text></g><path d="M216.0 61h10"/><path d="M226.0 61h10"/><g class="terminal">
<path d="M236.0 61h0.0"/><path d="M264.5 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="236.0" y="50"/><text x="250.25" y="65">#</text></g><path d="M264.5 61h10"/><path d="M274.5 61h10"/><g class="non-terminal">
<path d="M284.5 61h0.0"/><path d="M483.0 61h0.0"/><rect height="22" width="198.5" x="284.5" y="50"/><text x="383.75" y="65">urlsplit@502:fragment</text></g></g><path d="M483.0 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h83.75"/><path d="M399.25 91h83.75"/><g class="terminal">
<path d="M143.75 91h0.0"/><path d="M180.75 91h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="143.75" y="80"/><text x="162.25" y="95">/#</text></g><path d="M180.75 91h10"/><path d="M190.75 91h10"/><g class="non-terminal">
<path d="M200.75 91h0.0"/><path d="M399.25 91h0.0"/><rect height="22" width="198.5" x="200.75" y="80"/><text x="300.0" y="95">urlsplit@502:fragment</text></g></g><path d="M483.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 503.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@502:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 350.0 62" width="350.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M310.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M290.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">/?</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" width="173.0" x="117.0" y="20"/><text x="203.5" y="35">urlsplit@504:query</text></g></g><path d="M290.0 31h20"/></g><path d="M 310.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@504:query
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 293.0 62" width="293.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M253.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M233.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M233.0 31h0.0"/><rect height="22" width="173.0" x="60.0" y="20"/><text x="146.5" y="35">urlparse@396:query</text></g></g><path d="M233.0 31h20"/></g><path d="M 253.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:query
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@502:fragment
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 318.5 62" width="318.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M278.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M258.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M258.5 31h0.0"/><rect height="22" width="198.5" x="60.0" y="20"/><text x="159.25" y="35">urlparse@396:fragment</text></g></g><path d="M258.5 31h20"/></g><path d="M 278.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:fragment
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 250.5 62" width="250.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M210.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><rect height="22" rx="10" ry="10" width="130.5" x="60.0" y="20"/><text x="125.25" y="35">/releases/5.8</text></g></g><path d="M190.5 31h20"/></g><path d="M 210.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One might notice that the grammar is not entirely human-readable, with a number of single token definitions.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Hence, the last piece of the puzzle is the cleanup method <code>clean_grammar()</code>, which cleans up such definitions. The idea is to look for single token definitions such that a key is defined exactly by another key (single alternative, single token, nonterminal).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedGrammarMiner</span><span class="p">(</span><span class="n">ScopedGrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_replacements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">):</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">grammar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">START_SYMBOL</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">alts</span> <span class="o">=</span> <span class="n">grammar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">alts</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">rule</span> <span class="o">=</span> <span class="n">alts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_nonterminal</span><span class="p">(</span><span class="n">tok</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">replacements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tok</span>
        <span class="k">return</span> <span class="n">replacements</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Once we have such a list, iteratively replace the original key where ever it is used with the token we found earlier. Repeat until none is left.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedGrammarMiner</span><span class="p">(</span><span class="n">ScopedGrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">clean_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_replacements</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">new_alts</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">alt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="n">new_alt</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">alt</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
                            <span class="n">new_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replacements</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
                            <span class="n">changed</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">new_alt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">new_alts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_alts</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">changed</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">changed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">readable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>clean_grammar()</code> is used as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">si</span> <span class="o">=</span> <span class="n">ScopedGrammarMiner</span><span class="p">()</span>
<span class="n">si</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">inventory_dt</span><span class="p">)</span>
<span class="n">syntax_diagram</span><span class="p">(</span><span class="n">readable</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">clean_grammar</span><span class="p">()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 395.0 62" width="395.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M355.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><rect height="22" width="275.0" x="60.0" y="20"/><text x="197.5" y="35">process_inventory@22:inventory</text></g></g><path d="M335.0 31h20"/></g><path d="M 355.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory@22:inventory
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 980.0 62" width="980.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M940.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M920.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M301.0 31h0.0"/><rect height="22" width="241.0" x="60.0" y="20"/><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><path d="M301.0 31h10"/><path d="M311.0 31h10"/><g class="terminal">
<path d="M321.0 31h0.0"/><path d="M349.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="321.0" y="20"/><text x="335.25" y="35">
</text></g><path d="M349.5 31h10"/><path d="M359.5 31h10"/><g class="non-terminal">
<path d="M369.5 31h0.0"/><path d="M610.5 31h0.0"/><rect height="22" width="241.0" x="369.5" y="20"/><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><path d="M610.5 31h10"/><path d="M620.5 31h10"/><g class="terminal">
<path d="M630.5 31h0.0"/><path d="M659.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="630.5" y="20"/><text x="644.75" y="35">
</text></g><path d="M659.0 31h10"/><path d="M669.0 31h10"/><g class="non-terminal">
<path d="M679.0 31h0.0"/><path d="M920.0 31h0.0"/><rect height="22" width="241.0" x="679.0" y="20"/><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g><path d="M920.0 31h20"/></g><path d="M 940.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@29:vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 1221.5 62" width="1221.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M1181.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M1161.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><rect height="22" width="215.5" x="60.0" y="20"/><text x="167.75" y="35">process_vehicle@30:year</text></g><path d="M275.5 31h10"/><path d="M285.5 31h10"/><g class="terminal">
<path d="M295.5 31h0.0"/><path d="M324.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="295.5" y="20"/><text x="309.75" y="35">,</text></g><path d="M324.0 31h10"/><path d="M334.0 31h10"/><g class="non-terminal">
<path d="M344.0 31h0.0"/><path d="M559.5 31h0.0"/><rect height="22" width="215.5" x="344.0" y="20"/><text x="451.75" y="35">process_vehicle@30:kind</text></g><path d="M559.5 31h10"/><path d="M569.5 31h10"/><g class="terminal">
<path d="M579.5 31h0.0"/><path d="M608.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="579.5" y="20"/><text x="593.75" y="35">,</text></g><path d="M608.0 31h10"/><path d="M618.0 31h10"/><g class="non-terminal">
<path d="M628.0 31h0.0"/><path d="M869.0 31h0.0"/><rect height="22" width="241.0" x="628.0" y="20"/><text x="748.5" y="35">process_vehicle@30:company</text></g><path d="M869.0 31h10"/><path d="M879.0 31h10"/><g class="terminal">
<path d="M889.0 31h0.0"/><path d="M917.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="889.0" y="20"/><text x="903.25" y="35">,</text></g><path d="M917.5 31h10"/><path d="M927.5 31h10"/><g class="non-terminal">
<path d="M937.5 31h0.0"/><path d="M1161.5 31h0.0"/><rect height="22" width="224.0" x="937.5" y="20"/><text x="1049.5" y="35">process_vehicle@30:model</text></g></g><path d="M1161.5 31h20"/></g><path d="M 1181.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 301.5 92" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M261.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">process_car@49:year</text></g></g><path d="M241.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><rect height="22" width="181.5" x="60.0" y="50"/><text x="150.75" y="65">process_van@40:year</text></g></g><path d="M241.5 61h20"/></g><path d="M 261.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1997</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 327.0 92" width="327.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M287.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><rect height="22" width="207.0" x="60.0" y="20"/><text x="163.5" y="35">process_van@40:company</text></g></g><path d="M267.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><rect height="22" width="207.0" x="60.0" y="50"/><text x="163.5" y="65">process_car@49:company</text></g></g><path d="M267.0 61h20"/></g><path d="M 287.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">Ford</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 310.0 92" width="310.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M270.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><rect height="22" width="190.0" x="60.0" y="20"/><text x="155.0" y="35">process_van@40:model</text></g></g><path d="M250.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><rect height="22" width="190.0" x="60.0" y="50"/><text x="155.0" y="65">process_car@49:model</text></g></g><path d="M250.0 61h20"/></g><path d="M 270.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">E350</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M135.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M135.25 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="20"/><text x="99.75" y="35">Cougar</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="50"/><text x="99.75" y="65">Venture</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We update the <code>update_grammar()</code> to use the right tracker and miner.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">ScopedGrammarMiner</span><span class="p">(</span><span class="n">ScopedGrammarMiner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">update_grammar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">):</span>
        <span class="n">at</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tracker</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="n">trace</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_tree_miner</span><span class="p">(</span>
            <span class="n">inputstr</span><span class="p">,</span> <span class="n">at</span><span class="o">.</span><span class="n">my_assignments</span><span class="o">.</span><span class="n">defined_vars</span><span class="p">(</span>
                <span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span>

    <span class="k">def</span> <span class="nf">create_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ScopeTracker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_tree_miner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ScopeTreeMiner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>recover_grammar()</code> uses the right miner, and returns a cleaned grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">recover_grammar</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">miner</span> <span class="o">=</span> <span class="n">ScopedGrammarMiner</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">inputstr</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Tracer</span><span class="p">(</span><span class="n">inputstr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracer</span><span class="p">:</span>
            <span class="n">fn</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">)</span>
        <span class="n">miner</span><span class="o">.</span><span class="n">update_grammar</span><span class="p">(</span><span class="n">tracer</span><span class="o">.</span><span class="n">my_input</span><span class="p">,</span> <span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">readable</span><span class="p">(</span><span class="n">miner</span><span class="o">.</span><span class="n">clean_grammar</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">url_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">url_parse</span><span class="p">,</span> <span class="n">URLS_X</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'urllib/parse.py'</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 276.0 62" width="276.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M236.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M216.0 31h0.0"/><rect height="22" width="156.0" x="60.0" y="20"/><text x="138.0" y="35">urlsplit@452:url</text></g></g><path d="M216.0 31h20"/></g><path d="M 236.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@452:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 560.0 62" width="560.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M520.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M500.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">urlparse@396:scheme</text></g><path d="M241.5 31h10"/><path d="M251.5 31h10"/><g class="terminal">
<path d="M261.5 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="261.5" y="20"/><text x="275.75" y="35">:</text></g><path d="M290.0 31h10"/><path d="M300.0 31h10"/><g class="non-terminal">
<path d="M310.0 31h0.0"/><path d="M500.0 31h0.0"/><rect height="22" width="190.0" x="310.0" y="20"/><text x="405.0" y="35">_splitnetloc@413:url</text></g></g><path d="M500.0 31h20"/></g><path d="M 520.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:scheme
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 182.5 122" width="182.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M142.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M118.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M118.25 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="64.25" y="20"/><text x="91.25" y="35">http</text></g></g><path d="M122.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M114.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="68.5" y="50"/><text x="91.25" y="65">ftp</text></g></g><path d="M122.5 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><g class="terminal">
<path d="M60.0 91h0.0"/><path d="M122.5 91h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="60.0" y="80"/><text x="91.25" y="95">https</text></g></g><path d="M122.5 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 142.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>_splitnetloc@413:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 534.5 92" width="534.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M494.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h63.75"/><path d="M410.75 31h63.75"/><g class="terminal">
<path d="M123.75 31h0.0"/><path d="M160.75 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="123.75" y="20"/><text x="142.25" y="35">//</text></g><path d="M160.75 31h10"/><path d="M170.75 31h10"/><g class="non-terminal">
<path d="M180.75 31h0.0"/><path d="M362.25 31h0.0"/><rect height="22" width="181.5" x="180.75" y="20"/><text x="271.5" y="35">urlparse@396:netloc</text></g><path d="M362.25 31h10"/><path d="M372.25 31h10"/><g class="terminal">
<path d="M382.25 31h0.0"/><path d="M410.75 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="382.25" y="20"/><text x="396.5" y="35">/</text></g></g><path d="M474.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M474.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M97.0 61h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="50"/><text x="78.5" y="65">//</text></g><path d="M97.0 61h10"/><path d="M107.0 61h10"/><g class="non-terminal">
<path d="M117.0 61h0.0"/><path d="M298.5 61h0.0"/><rect height="22" width="181.5" x="117.0" y="50"/><text x="207.75" y="65">urlparse@396:netloc</text></g><path d="M298.5 61h10"/><path d="M308.5 61h10"/><g class="non-terminal">
<path d="M318.5 61h0.0"/><path d="M474.5 61h0.0"/><rect height="22" width="156.0" x="318.5" y="50"/><text x="396.5" y="65">urlsplit@494:url</text></g></g><path d="M474.5 61h20"/></g><path d="M 494.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:netloc
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="152" viewbox="0 0 369.5 152" width="369.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 81v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 91h0.0"/><path d="M329.5 91h0.0"/><path d="M40.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 61h34.0"/><path d="M275.5 61h34.0"/><g class="terminal">
<path d="M94.0 61h0.0"/><path d="M275.5 61h0.0"/><rect height="22" rx="10" ry="10" width="181.5" x="94.0" y="50"/><text x="184.75" y="65">www.fuzzingbook.org</text></g></g><path d="M309.5 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 91a10 10 0 0 0 10 -10v-40a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h25.5"/><path d="M284.0 31h25.5"/><g class="terminal">
<path d="M85.5 31h0.0"/><path d="M284.0 31h0.0"/><rect height="22" rx="10" ry="10" width="198.5" x="85.5" y="20"/><text x="184.75" y="35">www.cispa.saarland:80</text></g></g><path d="M309.5 31a10 10 0 0 1 10 10v40a10 10 0 0 0 10 10"/><path d="M40.0 91h20"/><g>
<path d="M60.0 91h68.0"/><path d="M241.5 91h68.0"/><g class="terminal">
<path d="M128.0 91h0.0"/><path d="M241.5 91h0.0"/><rect height="22" rx="10" ry="10" width="113.5" x="128.0" y="80"/><text x="184.75" y="95">freebsd.org</text></g></g><path d="M309.5 91h20"/><path d="M40.0 91a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><g class="terminal">
<path d="M60.0 121h0.0"/><path d="M309.5 121h0.0"/><rect height="22" rx="10" ry="10" width="249.5" x="60.0" y="110"/><text x="184.75" y="125">user:pass@www.google.com:80</text></g></g><path d="M309.5 121a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 329.5 91 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@494:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="122" viewbox="0 0 543.0 122" width="543.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M503.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h133.5"/><path d="M349.5 31h133.5"/><g class="non-terminal">
<path d="M193.5 31h0.0"/><path d="M349.5 31h0.0"/><rect height="22" width="156.0" x="193.5" y="20"/><text x="271.5" y="35">urlparse@396:url</text></g></g><path d="M483.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M483.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M216.0 61h0.0"/><rect height="22" width="156.0" x="60.0" y="50"/><text x="138.0" y="65">urlsplit@502:url</text></g><path d="M216.0 61h10"/><path d="M226.0 61h10"/><g class="terminal">
<path d="M236.0 61h0.0"/><path d="M264.5 61h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="236.0" y="50"/><text x="250.25" y="65">#</text></g><path d="M264.5 61h10"/><path d="M274.5 61h10"/><g class="non-terminal">
<path d="M284.5 61h0.0"/><path d="M483.0 61h0.0"/><rect height="22" width="198.5" x="284.5" y="50"/><text x="383.75" y="65">urlparse@396:fragment</text></g></g><path d="M483.0 61h20"/><path d="M40.0 61a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><g>
<path d="M60.0 91h83.75"/><path d="M399.25 91h83.75"/><g class="terminal">
<path d="M143.75 91h0.0"/><path d="M180.75 91h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="143.75" y="80"/><text x="162.25" y="95">/#</text></g><path d="M180.75 91h10"/><path d="M190.75 91h10"/><g class="non-terminal">
<path d="M200.75 91h0.0"/><path d="M399.25 91h0.0"/><rect height="22" width="198.5" x="200.75" y="80"/><text x="300.0" y="95">urlparse@396:fragment</text></g></g><path d="M483.0 91a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/></g><path d="M 503.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlsplit@502:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 350.0 62" width="350.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M310.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M290.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M97.0 31h0.0"/><rect height="22" rx="10" ry="10" width="37.0" x="60.0" y="20"/><text x="78.5" y="35">/?</text></g><path d="M97.0 31h10"/><path d="M107.0 31h10"/><g class="non-terminal">
<path d="M117.0 31h0.0"/><path d="M290.0 31h0.0"/><rect height="22" width="173.0" x="117.0" y="20"/><text x="203.5" y="35">urlparse@396:query</text></g></g><path d="M290.0 31h20"/></g><path d="M 310.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:query
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 191.0 62" width="191.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M151.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M131.0 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="60.0" y="20"/><text x="95.5" y="35">q=path</text></g></g><path d="M131.0 31h20"/></g><path d="M 151.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:fragment
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">News</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h4.25"/><path d="M109.75 61h4.25"/><g class="terminal">
<path d="M64.25 61h0.0"/><path d="M109.75 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="64.25" y="50"/><text x="87.0" y="65">ref</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>urlparse@396:url
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 250.5 62" width="250.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M210.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M190.5 31h0.0"/><rect height="22" rx="10" ry="10" width="130.5" x="60.0" y="20"/><text x="125.25" y="35">/releases/5.8</text></g></g><path d="M190.5 31h20"/></g><path d="M 210.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">url_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ftp://user:pass@www.google.com:80/
ftp://freebsd.org/?q=path#News
ftp://freebsd.org/
ftp://www.fuzzingbook.org/?q=path#News
https://www.fuzzingbook.org/
ftp://www.fuzzingbook.org/#News
ftp://www.fuzzingbook.org/releases/5.8
http://www.fuzzingbook.org/?q=path#ref
http://freebsd.org/
ftp://user:pass@www.google.com:80/
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">inventory_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span><span class="n">process_inventory</span><span class="p">,</span> <span class="p">[</span><span class="n">INVENTORY</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">inventory_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 395.0 62" width="395.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M355.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M335.0 31h0.0"/><rect height="22" width="275.0" x="60.0" y="20"/><text x="197.5" y="35">process_inventory@22:inventory</text></g></g><path d="M335.0 31h20"/></g><path d="M 355.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_inventory@22:inventory
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 980.0 62" width="980.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M940.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M920.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M301.0 31h0.0"/><rect height="22" width="241.0" x="60.0" y="20"/><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><path d="M301.0 31h10"/><path d="M311.0 31h10"/><g class="terminal">
<path d="M321.0 31h0.0"/><path d="M349.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="321.0" y="20"/><text x="335.25" y="35">
</text></g><path d="M349.5 31h10"/><path d="M359.5 31h10"/><g class="non-terminal">
<path d="M369.5 31h0.0"/><path d="M610.5 31h0.0"/><rect height="22" width="241.0" x="369.5" y="20"/><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><path d="M610.5 31h10"/><path d="M620.5 31h10"/><g class="terminal">
<path d="M630.5 31h0.0"/><path d="M659.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="630.5" y="20"/><text x="644.75" y="35">
</text></g><path d="M659.0 31h10"/><path d="M669.0 31h10"/><g class="non-terminal">
<path d="M679.0 31h0.0"/><path d="M920.0 31h0.0"/><rect height="22" width="241.0" x="679.0" y="20"/><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g><path d="M920.0 31h20"/></g><path d="M 940.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@29:vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 1221.5 62" width="1221.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M1181.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M1161.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><rect height="22" width="215.5" x="60.0" y="20"/><text x="167.75" y="35">process_vehicle@30:year</text></g><path d="M275.5 31h10"/><path d="M285.5 31h10"/><g class="terminal">
<path d="M295.5 31h0.0"/><path d="M324.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="295.5" y="20"/><text x="309.75" y="35">,</text></g><path d="M324.0 31h10"/><path d="M334.0 31h10"/><g class="non-terminal">
<path d="M344.0 31h0.0"/><path d="M559.5 31h0.0"/><rect height="22" width="215.5" x="344.0" y="20"/><text x="451.75" y="35">process_vehicle@30:kind</text></g><path d="M559.5 31h10"/><path d="M569.5 31h10"/><g class="terminal">
<path d="M579.5 31h0.0"/><path d="M608.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="579.5" y="20"/><text x="593.75" y="35">,</text></g><path d="M608.0 31h10"/><path d="M618.0 31h10"/><g class="non-terminal">
<path d="M628.0 31h0.0"/><path d="M869.0 31h0.0"/><rect height="22" width="241.0" x="628.0" y="20"/><text x="748.5" y="35">process_vehicle@30:company</text></g><path d="M869.0 31h10"/><path d="M879.0 31h10"/><g class="terminal">
<path d="M889.0 31h0.0"/><path d="M917.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="889.0" y="20"/><text x="903.25" y="35">,</text></g><path d="M917.5 31h10"/><path d="M927.5 31h10"/><g class="non-terminal">
<path d="M937.5 31h0.0"/><path d="M1161.5 31h0.0"/><rect height="22" width="224.0" x="937.5" y="20"/><text x="1049.5" y="35">process_vehicle@30:model</text></g></g><path d="M1161.5 31h20"/></g><path d="M 1181.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 301.5 92" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M261.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">process_car@49:year</text></g></g><path d="M241.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><rect height="22" width="181.5" x="60.0" y="50"/><text x="150.75" y="65">process_van@40:year</text></g></g><path d="M241.5 61h20"/></g><path d="M 261.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1997</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 327.0 92" width="327.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M287.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><rect height="22" width="207.0" x="60.0" y="20"/><text x="163.5" y="35">process_van@40:company</text></g></g><path d="M267.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><rect height="22" width="207.0" x="60.0" y="50"/><text x="163.5" y="65">process_car@49:company</text></g></g><path d="M267.0 61h20"/></g><path d="M 287.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">Ford</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 310.0 92" width="310.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M270.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><rect height="22" width="190.0" x="60.0" y="20"/><text x="155.0" y="35">process_van@40:model</text></g></g><path d="M250.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><rect height="22" width="190.0" x="60.0" y="50"/><text x="155.0" y="65">process_car@49:model</text></g></g><path d="M250.0 61h20"/></g><path d="M 270.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">E350</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M135.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M135.25 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="20"/><text x="99.75" y="35">Cougar</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="50"/><text x="99.75" y="65">Venture</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">f</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">inventory_grammar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1997,van,Mercury,E350
1999,car,Ford,Venture
2000,car,Ford,Cougar
2000,van,Chevy,Venture
1999,car,Mercury,E350
1997,van,Ford,Venture
1997,car,Chevy,Cougar
1999,car,Ford,E350
1999,car,Chevy,Cougar
1997,car,Chevy,Venture
1997,car,Ford,E350
2000,car,Mercury,E350
1999,van,Chevy,E350
1997,van,Ford,Cougar
1999,van,Chevy,Venture
1999,car,Ford,E350
1999,van,Mercury,Venture
1997,car,Ford,Cougar
1999,car,Mercury,Venture
1997,van,Mercury,E350
1999,car,Chevy,Cougar
2000,van,Chevy,Venture
2000,car,Ford,Venture
1997,car,Mercury,E350
1997,van,Chevy,E350
1997,van,Ford,E350
2000,car,Ford,E350
1997,car,Chevy,Venture
1997,van,Ford,E350
2000,van,Chevy,Cougar
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see how tracking scope helps us to extract an even more precise grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Notice that we use <em>String</em> inclusion testing as a way of determining whether a particular string fragment came from the original input string. While this may seem rather error-prone compared to dynamic tainting, we note that numerous tracing tools such as <code>dtrace()</code> and <code>ptrace()</code> allow one to obtain the information we seek from execution of binaries directly in different platforms. However, methods for obtaining dynamic taints almost always involve instrumenting the binaries before they can be used. Hence, this method of string inclusion can be more generally applied than dynamic tainting approaches. Further, dynamic taints are often lost due to implicit transmission, or at the boundary between <em>Python</em> and <em>C</em> code. String inclusion has not such problems. Hence, our approach can often obtain better results than relying on dynamic tainting.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned</h2><ul>
<li>Given a set of sample inputs for a program, we can learn an input grammar by examining variable values during execution if the program relies on handwritten parsers.</li>
<li>Simple string inclusion checks are sufficient to obtain reasonably accurate grammars from real world programs.</li>
<li>The resulting grammars can be directly used for fuzzing, and can have a multiplier effect on any samples you have.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps</h2><ul>
<li>Learn how to use <a href="InformationFlow.html">information flow</a> to further improve mapping inputs to states.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background</h2><p>Recovering the language from a <em>set of samples</em> (i.e., not taking into account a possible program that might process them) is a well researched topic.  The excellent reference by Higuera [De la Higuera <em>et al</em>, 2010] covers all the classical approaches. The current state of the art in black box grammar mining is described by Clark [Clark <em>et al</em>, 2013].</p>
<p>Learning an input language from a <em>program</em>, with or without samples, is yet an emerging topic, despite its potential for fuzzing.  The pioneering work in this area was done by Lin et al. [<a href="https://doi.org/10.1145/1453101.1453114">Lin <em>et al</em>, 2008</a>] who invented a way to retrieve the parse trees from top down and bottom up parsers. The approach described in this chapter is based directly on the AUTOGRAM work of Hoschele et al. [<a href="https://doi.org/10.1109/ICSE-C.2017.14">Höschele <em>et al</em>, 2017</a>].</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises</h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Flattening-complex-objects">Exercise 1: Flattening complex objects</h3><p>Our grammar miners only check for string fragments. However, programs may often pass containers or custom objects containing input fragments. For example, consider the plausible modification for our inventory processor, where we use a custom object <code>Vehicle</code> to carry fragments.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">class</span> <span class="nc">Vehicle</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">year</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">company</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">company</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">year</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">company</span><span class="p">,</span> <span class="n">model</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">process_inventory_with_obj</span><span class="p">(</span><span class="n">inventory</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vehicle</span> <span class="ow">in</span> <span class="n">inventory</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">process_vehicle</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">process_vehicle_with_obj</span><span class="p">(</span><span class="n">vehicle</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">Vehicle</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'van'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">process_van_with_obj</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">'car'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">process_car_with_obj</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">'Invalid entry'</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">process_van_with_obj</span><span class="p">(</span><span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"We have a </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> van from </span><span class="si">%s</span><span class="s2"> vintage."</span> <span class="o">%</span> <span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">company</span><span class="p">,</span>
                                                  <span class="n">vehicle</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">iyear</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">iyear</span> <span class="o">&gt;</span> <span class="mi">2010</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"It is a recent model!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"It is an old but reliable model!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="k">def</span> <span class="nf">process_car_with_obj</span><span class="p">(</span><span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"We have a </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> car from </span><span class="si">%s</span><span class="s2"> vintage."</span> <span class="o">%</span> <span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">company</span><span class="p">,</span>
                                                  <span class="n">vehicle</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">iyear</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">iyear</span> <span class="o">&gt;</span> <span class="mi">2016</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"It is a recent model!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"It is an old but reliable model!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We recover the grammar as before.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">vehicle_grammar</span> <span class="o">=</span> <span class="n">recover_grammar</span><span class="p">(</span>
    <span class="n">process_inventory_with_obj</span><span class="p">,</span>
    <span class="p">[</span><span class="n">INVENTORY</span><span class="p">],</span>
    <span class="n">methods</span><span class="o">=</span><span class="n">INVENTORY_METHODS</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The new vehicle grammar is missing in details, especially as to the different models and company for a van and car.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span/><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">vehicle_grammar</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>start
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 980.0 62" width="980.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M940.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M920.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M301.0 31h0.0"/><rect height="22" width="241.0" x="60.0" y="20"/><text x="180.5" y="35">process_vehicle@29:vehicle</text></g><path d="M301.0 31h10"/><path d="M311.0 31h10"/><g class="terminal">
<path d="M321.0 31h0.0"/><path d="M349.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="321.0" y="20"/><text x="335.25" y="35">
</text></g><path d="M349.5 31h10"/><path d="M359.5 31h10"/><g class="non-terminal">
<path d="M369.5 31h0.0"/><path d="M610.5 31h0.0"/><rect height="22" width="241.0" x="369.5" y="20"/><text x="490.0" y="35">process_vehicle@29:vehicle</text></g><path d="M610.5 31h10"/><path d="M620.5 31h10"/><g class="terminal">
<path d="M630.5 31h0.0"/><path d="M659.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="630.5" y="20"/><text x="644.75" y="35">
</text></g><path d="M659.0 31h10"/><path d="M669.0 31h10"/><g class="non-terminal">
<path d="M679.0 31h0.0"/><path d="M920.0 31h0.0"/><rect height="22" width="241.0" x="679.0" y="20"/><text x="799.5" y="35">process_vehicle@29:vehicle</text></g></g><path d="M920.0 31h20"/></g><path d="M 940.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@29:vehicle
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 1221.5 62" width="1221.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M1181.5 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M1161.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M275.5 31h0.0"/><rect height="22" width="215.5" x="60.0" y="20"/><text x="167.75" y="35">process_vehicle@30:year</text></g><path d="M275.5 31h10"/><path d="M285.5 31h10"/><g class="terminal">
<path d="M295.5 31h0.0"/><path d="M324.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="295.5" y="20"/><text x="309.75" y="35">,</text></g><path d="M324.0 31h10"/><path d="M334.0 31h10"/><g class="non-terminal">
<path d="M344.0 31h0.0"/><path d="M559.5 31h0.0"/><rect height="22" width="215.5" x="344.0" y="20"/><text x="451.75" y="35">process_vehicle@30:kind</text></g><path d="M559.5 31h10"/><path d="M569.5 31h10"/><g class="terminal">
<path d="M579.5 31h0.0"/><path d="M608.0 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="579.5" y="20"/><text x="593.75" y="35">,</text></g><path d="M608.0 31h10"/><path d="M618.0 31h10"/><g class="non-terminal">
<path d="M628.0 31h0.0"/><path d="M869.0 31h0.0"/><rect height="22" width="241.0" x="628.0" y="20"/><text x="748.5" y="35">process_vehicle@30:company</text></g><path d="M869.0 31h10"/><path d="M879.0 31h10"/><g class="terminal">
<path d="M889.0 31h0.0"/><path d="M917.5 31h0.0"/><rect height="22" rx="10" ry="10" width="28.5" x="889.0" y="20"/><text x="903.25" y="35">,</text></g><path d="M917.5 31h10"/><path d="M927.5 31h10"/><g class="non-terminal">
<path d="M937.5 31h0.0"/><path d="M1161.5 31h0.0"/><rect height="22" width="224.0" x="937.5" y="20"/><text x="1049.5" y="35">process_vehicle@30:model</text></g></g><path d="M1161.5 31h20"/></g><path d="M 1181.5 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 301.5 92" width="301.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M261.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M241.5 31h0.0"/><rect height="22" width="181.5" x="60.0" y="20"/><text x="150.75" y="35">process_car@49:year</text></g></g><path d="M241.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M241.5 61h0.0"/><rect height="22" width="181.5" x="60.0" y="50"/><text x="150.75" y="65">process_van@40:year</text></g></g><path d="M241.5 61h20"/></g><path d="M 261.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1997</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:kind
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 165.5 92" width="165.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M125.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M105.5 31h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="20"/><text x="82.75" y="35">car</text></g></g><path d="M105.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M105.5 61h0.0"/><rect height="22" rx="10" ry="10" width="45.5" x="60.0" y="50"/><text x="82.75" y="65">van</text></g></g><path d="M105.5 61h20"/></g><path d="M 125.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 327.0 92" width="327.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M287.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M267.0 31h0.0"/><rect height="22" width="207.0" x="60.0" y="20"/><text x="163.5" y="35">process_van@40:company</text></g></g><path d="M267.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M267.0 61h0.0"/><rect height="22" width="207.0" x="60.0" y="50"/><text x="163.5" y="65">process_car@49:company</text></g></g><path d="M267.0 61h20"/></g><path d="M 287.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">Ford</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_vehicle@30:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 310.0 92" width="310.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M270.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><g class="non-terminal">
<path d="M60.0 31h0.0"/><path d="M250.0 31h0.0"/><rect height="22" width="190.0" x="60.0" y="20"/><text x="155.0" y="35">process_van@40:model</text></g></g><path d="M250.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><g class="non-terminal">
<path d="M60.0 61h0.0"/><path d="M250.0 61h0.0"/><rect height="22" width="190.0" x="60.0" y="50"/><text x="155.0" y="65">process_car@49:model</text></g></g><path d="M250.0 61h20"/></g><path d="M 270.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_van@40:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="62" viewbox="0 0 174.0 62" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 21v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 31h0.0"/><path d="M134.0 31h0.0"/><path d="M40.0 31h20"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">E350</text></g></g><path d="M114.0 31h20"/></g><path d="M 134.0 31 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:year
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 174.0 92" width="174.0">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M134.0 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M114.0 31h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="20"/><text x="87.0" y="35">1999</text></g></g><path d="M114.0 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M114.0 61h0.0"/><rect height="22" rx="10" ry="10" width="54.0" x="60.0" y="50"/><text x="87.0" y="65">2000</text></g></g><path d="M114.0 61h20"/></g><path d="M 134.0 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:company
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><g class="terminal">
<path d="M60.0 31h0.0"/><path d="M139.5 31h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="20"/><text x="99.75" y="35">Mercury</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h8.5"/><path d="M131.0 61h8.5"/><g class="terminal">
<path d="M68.5 61h0.0"/><path d="M131.0 61h0.0"/><rect height="22" rx="10" ry="10" width="62.5" x="68.5" y="50"/><text x="99.75" y="65">Chevy</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>process_car@49:model
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg class="railroad-diagram" height="92" viewbox="0 0 199.5 92" width="199.5">
<g transform="translate(.5 .5)">
<style>/* &amp;lt;![CDATA[ */
    svg.railroad-diagram {
    }
    svg.railroad-diagram path {
        stroke-width:3;
        stroke:black;
        fill:white;
    }
    svg.railroad-diagram text {
        font:14px "Fira Mono", monospace;
        text-anchor:middle;
    }
    svg.railroad-diagram text.label{
        text-anchor:start;
    }
    svg.railroad-diagram text.comment{
        font:italic 12px "Fira Mono", monospace;
    }
    svg.railroad-diagram rect{
        stroke-width:2;
        stroke:black;
        fill:mistyrose;
    }

/* ]]&amp;gt; */
</style><g>
<path d="M20 51v20m10 -20v20m-10 -10h20"/></g><g>
<path d="M40 61h0.0"/><path d="M159.5 61h0.0"/><path d="M40.0 61a10 10 0 0 0 10 -10v-10a10 10 0 0 1 10 -10"/><g>
<path d="M60.0 31h4.25"/><path d="M135.25 31h4.25"/><g class="terminal">
<path d="M64.25 31h0.0"/><path d="M135.25 31h0.0"/><rect height="22" rx="10" ry="10" width="71.0" x="64.25" y="20"/><text x="99.75" y="35">Cougar</text></g></g><path d="M139.5 31a10 10 0 0 1 10 10v10a10 10 0 0 0 10 10"/><path d="M40.0 61h20"/><g>
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><g class="terminal">
<path d="M60.0 61h0.0"/><path d="M139.5 61h0.0"/><rect height="22" rx="10" ry="10" width="79.5" x="60.0" y="50"/><text x="99.75" y="65">Venture</text></g></g><path d="M139.5 61h20"/></g><path d="M 159.5 61 h 20 m -10 -10 v 20 m 10 -20 v 20"/></g></svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The problem is that, we are looking specifically for string objects that contain fragments of the input string during tracing. Can you modify our grammar miner to correctly account for the complex objects too?</p>

    
<p/><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises" target="_blank">Use the notebook</a> to work on the exercises and see solutions.</div>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-2:-Incorporating-Taints-from-InformationFlow">Exercise 2: Incorporating Taints from InformationFlow</h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We have been using <em>string inclusion</em> to check whether a particular fragment came from the input string. This is unsatisfactory as it required us to compromise on the size of the strings tracked, which was limited to those greater than <code>FRAGMENT_LEN</code>. Further, it is possible that a single method could process a string where a fragment repeats, but is part of different tokens. For example, an embedded comma in the CSV file would cause our parser to fail. One way to avoid this is to rely on <em>dynamic taints</em>, and check for taint inclusion rather than string inclusion.</p>
<p>The chapter on <a href="InformationFlow.html">information flow</a> details how to incorporate dynamic taints. Can you update our grammar miner based on scope to use <em>dynamic taints</em> instead?</p>

    
<p/><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/fuzzingbook/HEAD?labpath=docs%2Fnotebooks/GrammarMiner.ipynb#Exercises" target="_blank">Use the notebook</a> to work on the exercises and see solutions.</div>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="../Images/2f3faa36146c6fb38bbab67add09aa5f.png" alt="Creative Commons License" data-original-src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/>
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/fuzzingbook/commits/master/notebooks/GrammarMiner.ipynb" target="_blank)">Last change: 2023-11-11 18:18:06+01:00</a> • 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> •
<a href="https://cispa.de/en/impressum" target="_blank">Imprint</a>
</p>



<div id="citation" class="citation" style="display: none;">
<a name="citation"/>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler: "<a href="https://www.fuzzingbook.org/html/GrammarMiner.html">Mining Input Grammars</a>".  In Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler, "<a href="https://www.fuzzingbook.org/">The Fuzzing Book</a>", <a href="https://www.fuzzingbook.org/html/GrammarMiner.html">https://www.fuzzingbook.org/html/GrammarMiner.html</a>.  Retrieved 2023-11-11 18:18:06+01:00.
</p>
<pre>
@incollection{fuzzingbook2023:GrammarMiner,
    author = {Andreas Zeller and Rahul Gopinath and Marcel B{\"o}hme and Gordon Fraser and Christian Holler},
    booktitle = {The Fuzzing Book},
    title = {Mining Input Grammars},
    year = {2023},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.fuzzingbook.org/html/GrammarMiner.html}},
    note = {Retrieved 2023-11-11 18:18:06+01:00},
    url = {https://www.fuzzingbook.org/html/GrammarMiner.html},
    urldate = {2023-11-11 18:18:06+01:00}
}
</pre>
</div>

          
</body>
</html>